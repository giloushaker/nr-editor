import{G as v,u as k,b as $,a as _}from"./editorStore.a61e5abb.js";import{b as w,a as M,f as r,i as a,w as C,v as b,M as N,F as m,l as f,t as d,q as h,p as g,o as l}from"./entry.55626a63.js";function I(s){return Math.round(s*100)/100}function T(s){let t="";s=v(s,n=>n.name);for(const n of s)if(n.value!=0){let u="";n.name.length!=0&&(u=" "+n.name),t=`${t}<span class='cost'>${I(n.value)}${u}</span>`}return t.length==0?t:`<span class="costList">${t}</span>`}const B=w({setup(){return{store:k()}},data(){return{filter:"",results:null,count:null,searching:!1,more:!1,page:0,max_display:30,max_results:1e3}},computed:{async system(){return await this.store.get_or_load_system(this.$route.params.id)},data(){return{filter:this.filter}},from(){return this.count===null?0:Math.min(this.page*this.max_display,this.count)},to(){return this.count===null?0:Math.min(this.page*this.max_display+this.max_display,this.count)},last_page(){return this.count===null?0:Math.ceil(this.count/this.max_display)-1},displayed_results(){let s=0;const t=this.from,n=this.to,u={};console.log(`to=${n}, from=${t}`);for(const p in this.results){const i=this.results[p],e=i.length;let c=e;if(s+e>n){const o=s+e,y=Math.max(o-n,0);c=e-y}if(s+e>=t){const o=Math.max(t-s,0);e&&c>o&&(u[p]=i.slice(o,c))}if(console.log(p,"n=",s,"count=",e,"start=","end=",c),s+=e,s>n)break}return u},displayed_count(){let s=0;for(const t in this.displayed_results)s+=this.displayed_results[t].length;return s}},methods:{getName:$,getNameExtra:_,async search(){try{this.searching=!0,await new Promise(t=>setTimeout(t,5)),await this.$nextTick(()=>this.$forceUpdate());const s=await this.store.system_search(await this.system,this.data,this.max_results);if(!s){this.results=null,this.count=null,this.more=!1;return}this.more=s.more,this.results=s.grouped,this.count=s.all.length}catch(s){console.error(s)}finally{this.page=0,this.searching=!1}},costs(s){var p;const t=[],n=s.getCatalogue(),u=s.getCosts();for(const i of u){const e=((p=n.findOptionById(i.typeId))==null?void 0:p.name)||i.name||i.typeId;e&&t.push({name:e,value:i.value,typeId:i.typeId})}return T(t)}}}),E={class:"ml-20px mt-10px h-full overflow-y-auto"},D={key:0},L=a("div",null,null,-1),S={key:0,class:"pb-50px"},V={class:"bold"},x={class:"ml-8px"},F=["onClick"],H={class:"typeIcon-wrapper"},K=["src"],P={key:0,class:"gray"},U=["innerHTML"];function q(s,t,n,u,p,i){return l(),r("div",E,[a("div",null,[C(a("input",{type:"search","onUpdate:modelValue":t[0]||(t[0]=e=>s.filter=e),onKeydown:t[1]||(t[1]=N((...e)=>s.search&&s.search(...e),["enter"]))},null,544),[[b,s.filter]]),a("button",{class:"inputstyle",onClick:t[2]||(t[2]=(...e)=>s.search&&s.search(...e))}," Search "),s.searching?(l(),r("span",D,"Searching...")):s.count!==null?(l(),r(m,{key:1},[a("span",null,[f("Found "+d(s.count),1),s.more?(l(),r(m,{key:0},[f("+")],64)):h("",!0),f(" results")]),a("span",null,", Displaying "+d(s.displayed_count)+" results",1)],64)):h("",!0)]),a("button",{class:"inputstyle w-28px",onClick:t[3]||(t[3]=e=>s.page=Math.max(0,s.page-1))}," < "),a("button",{class:"inputstyle w-28px",onClick:t[4]||(t[4]=e=>s.page=Math.min(s.last_page,s.page+1))}," > "),f(" Page "+d(s.page+1)+" / "+d(s.last_page+1)+" ",1),L,s.results?(l(),r("div",S,[(l(!0),r(m,null,g(s.displayed_results,(e,c)=>(l(),r("div",null,[a("span",V,d(c),1),a("div",x,[(l(!0),r(m,null,g(e,o=>(l(),r("div",{class:"hover-darken cursor-pointer",onClick:y=>s.store.goto(o)},[a("span",null,[a("span",H,[a("img",{class:"typeIcon mr-4px",src:`/assets/bsicons/${o.editorTypeName}.png`},null,8,K)]),a("span",null,d(s.getName(o)),1),s.getNameExtra(o)?(l(),r("span",P,"Â "+d(s.getNameExtra(o)),1)):h("",!0),s.costs(o)?(l(),r("span",{key:1,class:"ml-10px",innerHTML:s.costs(o)},null,8,U)):h("",!0)])],8,F))),256))])]))),256))])):h("",!0)])}const O=M(B,[["render",q]]);export{O as default,T as formatCosts};
//# sourceMappingURL=_id_.127f77d6.js.map
