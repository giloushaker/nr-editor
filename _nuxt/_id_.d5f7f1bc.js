import{e as w,U as $,J as C,L as N,K as M,a4 as _,a as b,r as P,b as i,i as e,w as g,v as F,Q as I,F as f,s as y,t as p,l as c,m as T,D as k,o as r,c as B}from"./entry.018f42ce.js";import{N as E}from"./NodePath.789c7c47.js";function D(s){return Math.round(s*100)/100}function L(s){let t="";s=$(s,n=>n.name);for(const n of s)if(n.value!=0){let h="";n.name.length!=0&&(h=" "+n.name),t=`${t}<span class='cost'>${D(n.value)}${h}</span>`}return t.length==0?t:`<span class="costList">${t}</span>`}const S=w({setup(){return{store:C()}},data(){return{filter:"",results:null,count:null,searching:!1,more:!1,page:0,max_display:30,max_results:1e3,showFullPath:!1}},computed:{async system(){return await this.store.get_or_load_system(this.$route.params.id)},data(){return{filter:this.filter}},from(){return this.count===null?0:Math.min(this.page*this.max_display,this.count)},to(){return this.count===null?0:Math.min(this.page*this.max_display+this.max_display,this.count)},last_page(){return this.count===null?0:Math.ceil(this.count/this.max_display)-1},displayed_results(){let s=0;const t=this.from,n=this.to,h={};for(const m in this.results){const u=this.results[m],o=u.length;let a=o;if(s+o>n){const d=s+o,l=Math.max(d-n,0);a=o-l}if(s+o>=t){const d=Math.max(t-s,0);o&&a>d&&(h[m]=u.slice(d,a))}if(s+=o,s>n)break}return h},displayed_count(){let s=0;for(const t in this.displayed_results)s+=this.displayed_results[t].length;return s}},methods:{getName:N,getNameExtra:M,path(s){const t=_(s);return t.pop(),t.shift(),t},async search(){try{this.searching=!0,await this.$nextTick(()=>this.$forceUpdate()),await new Promise(t=>setTimeout(t,5));const s=await this.store.system_search(await this.system,this.data,this.max_results);if(!s){this.results=null,this.count=null,this.more=!1;return}this.more=s.more,this.results=s.grouped,this.count=s.all.length}catch(s){console.error(s)}finally{this.page=0,this.searching=!1}},costs(s){var t;try{const n=[],h=s.getCatalogue(),m=s.getCosts();for(const u of m){const o=((t=h.findOptionById(u.typeId))==null?void 0:t.name)||u.name||u.typeId;o&&n.push({name:o,value:u.value,typeId:u.typeId})}return L(n)}catch{return""}}},components:{NodePath:E}}),V={class:"ml-20px mt-10px h-full overflow-y-auto"},U={key:0},K=e("label",{for:"show-fullpath"},"Show Full Path",-1),H=e("div",null,null,-1),A={key:0,class:"pb-50px"},J={class:"bold"},O={class:"ml-8px"},Q=["onClick"],j={class:"typeIcon-wrapper"},q=["src"],x={key:0,class:"gray"},z=["innerHTML"];function G(s,t,n,h,m,u){const o=P("NodePath");return r(),i("div",V,[e("div",null,[g(e("input",{type:"search","onUpdate:modelValue":t[0]||(t[0]=a=>s.filter=a),onKeydown:t[1]||(t[1]=I((...a)=>s.search&&s.search(...a),["enter"]))},null,544),[[F,s.filter]]),e("button",{class:"inputstyle",onClick:t[2]||(t[2]=(...a)=>s.search&&s.search(...a))}," Search "),s.searching?(r(),i("span",U," Searching...")):s.count!==null?(r(),i(f,{key:1},[e("span",null,[y("Found "+p(s.count),1),s.more?(r(),i(f,{key:0},[y("+")],64)):c("",!0),y(" results")]),e("span",null,", Displaying "+p(s.displayed_count)+" results",1)],64)):c("",!0)]),e("button",{class:"inputstyle w-28px",onClick:t[3]||(t[3]=a=>s.page=Math.max(0,s.page-1))}," < "),e("button",{class:"inputstyle w-28px",onClick:t[4]||(t[4]=a=>s.page=Math.min(s.last_page,s.page+1))}," > "),y(" Page "+p(s.page+1)+" / "+p(s.last_page+1)+" ",1),g(e("input",{type:"checkbox",id:"show-fullpath","onUpdate:modelValue":t[5]||(t[5]=a=>s.showFullPath=a)},null,512),[[T,s.showFullPath]]),K,H,s.results?(r(),i("div",A,[(r(!0),i(f,null,k(s.displayed_results,(a,d)=>(r(),i("div",null,[e("span",J,p(d),1),e("div",O,[(r(!0),i(f,null,k(a,l=>(r(),i("div",{class:"hover-darken cursor-pointer",onClick:v=>s.store.goto(l)},[s.showFullPath&&s.path(l).length?(r(),B(o,{key:0,path:s.path(l),onClick:v=>s.store.goto(l),class:"inline hover-darken cursor-pointer p-1px","end-arrow":""},null,8,["path","onClick"])):c("",!0),e("span",null,[e("span",j,[e("img",{class:"typeIcon mr-4px",src:`/assets/bsicons/${l.editorTypeName}.png`},null,8,q)]),e("span",null,p(s.getName(l)),1),s.getNameExtra(l)?(r(),i("span",x,"Â "+p(s.getNameExtra(l)),1)):c("",!0),s.costs(l)?(r(),i("span",{key:1,class:"ml-10px",innerHTML:s.costs(l)},null,8,z)):c("",!0)])],8,Q))),256))])]))),256))])):c("",!0)])}const X=b(S,[["render",G]]);export{X as default,L as formatCosts};
//# sourceMappingURL=_id_.d5f7f1bc.js.map
