import{b as oe,e as He,a as _,o as s,f as c,h as m,i as l,w as h,v,F as b,r as G,j as R,k,l as p,m as S,p as A,t as C,q as y,s as N,x as P,y as be,n as le,z as ve,g as ke,A as U,B as L,C as xe,c as f,D as Ke,E as Ye,T as ze}from"./entry.b2358470.js";import{_ as Xe}from"./Loading.839874f9.js";import{g as Te,s as Fe,a as Q,b as Z,_ as We,c as he,u as $,C as Je,d as Ze,f as et,e as W,h as tt,i as nt,P as at,j as lt,k as ot,l as it,m as st,n as dt}from"./editorStore.ffc3c2b9.js";import{_ as x,a as ut}from"./SplitView.1b410627.js";const rt=t=>Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0)),ct=(t,e)=>(a,u)=>(He(()=>t({...rt(a),...u.attrs},u)),()=>{var d,n;return e?(n=(d=u.slots).default)==null?void 0:n.call(d):null}),gt=oe({name:"Title",inheritAttrs:!1,setup:ct((t,{slots:e})=>{var u,d,n;return{title:((n=(d=(u=e.default)==null?void 0:u.call(e))==null?void 0:d[0])==null?void 0:n.children)||null}})}),mt=oe({name:"Head",inheritAttrs:!1,setup:(t,e)=>()=>{var a,u;return(u=(a=e.slots).default)==null?void 0:u.call(a)}}),ht={emits:["change","update:modelValue"],props:{modelValue:{type:[String,Number,Array]},placeholder:{type:String,default:""}},methods:{change(t){t.target&&(this.$emit("update:modelValue",t.target.outerText),this.$emit("change"))},get(){return this.$refs.div},toHtml(t){return t.replace(/\n/g,"<br />")},onpaste(t){var a;t.preventDefault();var e=((a=t.clipboardData)==null?void 0:a.getData("text/plain"))??"";document.execCommand("insertText",!1,e),this.$emit("update:modelValue",this.get().innerText),this.$emit("change")}},mounted(){this.get().innerText=`${this.modelValue??""}`},watch:{modelValue(){this.get().innerText!=this.modelValue&&(this.get().innerText=`${this.modelValue??""}`)}}};const _t=["placeholder"];function Ct(t,e,a,u,d,n){return s(),c("div",{placeholder:a.placeholder,class:"editableDiv",onInput:e[0]||(e[0]=(...o)=>n.change&&n.change(...o)),onPaste:e[1]||(e[1]=(...o)=>n.onpaste&&n.onpaste(...o)),contenteditable:"true",ref:"div"},null,40,_t)}const ie=_(ht,[["render",Ct],["__scopeId","data-v-3a6cd79d"]]),pt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},computed:{comment:{get(){return(Array.isArray(this.item.comment)?this.item.comment[0]:this.item.comment)||""},set(t){this.item.comment=t?[t]:void 0}}},methods:{changed(){this.$emit("catalogueChanged")}}},yt=l("legend",null,"Comment",-1);function ft(t,e,a,u,d,n){const o=ie;return s(),c("fieldset",null,[yt,m(o,{modelValue:n.comment,"onUpdate:modelValue":e[0]||(e[0]=i=>n.comment=i),onChange:n.changed},null,8,["modelValue","onChange"])])}const w=_(pt,[["render",ft]]),bt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")},refresh(){this.id=Te(),this.changed()}},computed:{id:{get(){return this.item.id},set(t){const e=this.item,a=e.getCatalogue();a.removeFromIndex(e),e.id=t,a.addToIndex(e)}}}},vt=""+new URL("back.33e845c9.png",import.meta.url).href;const kt=l("legend",null,"Basics",-1),xt={class:"editorTable"},Tt=l("td",null,"Unique ID:",-1),Ft={class:"flex gap-2px"},wt=l("span",null,[l("img",{class:"h-20px w-20px icon",src:vt,title:"Generated Id"})],-1),It=[wt],Nt=l("td",null,"Name:",-1);function Pt(t,e,a,u,d,n){return s(),c("fieldset",null,[kt,l("table",xt,[l("tr",null,[Tt,l("td",Ft,[h(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>n.id=o),onChange:e[1]||(e[1]=(...o)=>n.changed&&n.changed(...o)),class:"flex flex-shrink"},null,544),[[v,n.id]]),l("button",{class:"btn !w-34px flex items-center mr-8px",onClick:e[2]||(e[2]=(...o)=>n.refresh&&n.refresh(...o))},It)])]),l("tr",null,[Nt,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>a.item.name=o),onChange:e[4]||(e[4]=(...o)=>n.changed&&n.changed(...o))},null,544),[[v,a.item.name]])])])])])}const O=_(bt,[["render",Pt]]),Rt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},At=l("legend",null,"Publication",-1),Ot={class:"editorTable"},Et=l("td",null,"Short Name",-1),Vt=l("td",null,"Publication:",-1),St=l("td",null,"Publication Date:",-1),Ut=l("td",null,"Publication URL:",-1);function Lt(t,e,a,u,d,n){return s(),c("fieldset",null,[At,l("table",Ot,[l("tr",null,[Et,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.shortName=o),onChange:e[1]||(e[1]=(...o)=>n.changed&&n.changed(...o))},null,544),[[v,a.item.shortName]])])]),l("tr",null,[Vt,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>a.item.publisher=o),onChange:e[3]||(e[3]=(...o)=>n.changed&&n.changed(...o))},null,544),[[v,a.item.publisher]])])]),l("tr",null,[St,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=o=>a.item.publicationDate=o),onChange:e[5]||(e[5]=(...o)=>n.changed&&n.changed(...o))},null,544),[[v,a.item.publicationDate]])])]),l("tr",null,[Ut,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=o=>a.item.publisherUrl=o),onChange:e[7]||(e[7]=(...o)=>n.changed&&n.changed(...o))},null,544),[[v,a.item.publisherUrl]])])])])])}const qt=_(Rt,[["render",Lt]]),jt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Bt(t,e,a,u,d,n){const o=w,i=O,r=qt;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{class:"section",item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"])],64)}const $t=_(jt,[["render",Bt]]),Dt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Gt=l("label",{for:"hidden"},"Hidden",-1);function Mt(t,e,a,u,d,n){return s(),c("fieldset",null,[l("legend",null,[G(t.$slots,"default")]),h(l("input",{id:"hidden",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.hidden=o),onChange:e[1]||(e[1]=(...o)=>n.changed&&n.changed(...o))},null,544),[[R,a.item.hidden]]),Gt])}const H=_(Dt,[["render",Mt]]),Qt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Ht={class:"section"},Kt=l("legend",null,"Limit",-1),Yt={class:"editorTable"},zt=l("td",null,"Default Cost Limit: ",-1),Xt=l("span",{class:"gray ml-10px"},"-1 = No limit",-1);function Wt(t,e,a,u,d,n){const o=w,i=O,r=H;return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Cost Types ")]),_:1},8,["item","onCatalogueChanged"]),l("div",Ht,[l("fieldset",null,[Kt,l("table",Yt,[l("tr",null,[zt,l("td",null,[h(l("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=g=>a.item.defaultCostLimit=g),onChange:e[1]||(e[1]=(...g)=>n.changed&&n.changed(...g))},null,544),[[v,a.item.defaultCostLimit]]),Xt])])])])])])}const Jt=_(Qt,[["render",Wt]]),Zt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},data(){return{selectedType:null}},computed:{selected:{set(t){this.selectedType=this.item.characteristicTypes.find(e=>e.id===t)||null},get(){var t;return((t=this.selectedType)==null?void 0:t.id)||null}}},methods:{add(){this.item.characteristicTypes||(this.item.characteristicTypes=[]),this.item.characteristicTypes.push({id:Te(),name:"New Characteristic Type"}),this.changed()},del(){if(this.selectedType&&this.item.characteristicTypes){const t=this.item.characteristicTypes.indexOf(this.selectedType);t!=-1&&(this.item.characteristicTypes.splice(t,1),this.selectedType=this.item.characteristicTypes[0])}},changed(){this.$emit("catalogueChanged")},init(){var t;(t=this.item.characteristicTypes)!=null&&t.length&&(this.selectedType=this.item.characteristicTypes[0])}},created(){this.init()},watch:{item(){this.init()}}},en="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV8/RCkVB4uIOASsTlZERRy1CkWoEGqFVh1MLv2CJg1Jiouj4Fpw8GOx6uDirKuDqyAIfoA4OjkpukiJ/0sKLWI8OO7Hu3uPu3eAv15mqhkcB1TNMlKJuJDJrgqdrwiiDyGMYUhipj4nikl4jq97+Ph6F+NZ3uf+HN1KzmSATyCeZbphEW8QT29aOud94ggrSgrxOfGoQRckfuS67PIb54LDfp4ZMdKpeeIIsVBoY7mNWdFQiaeIo4qqUb4/47LCeYuzWq6y5j35C8M5bWWZ6zQHkcAiliBCgIwqSijDQoxWjRQTKdqPe/gHHL9ILplcJTByLKACFZLjB/+D392a+ckJNykcBzpebPtjGOjcBRo12/4+tu3GCRB4Bq60lr9SB2Y+Sa+1tOgR0LMNXFy3NHkPuNwB+p90yZAcKUDTn88D72f0TVmg9xYIrbm9Nfdx+gCkqavkDXBwCIwUKHvd491d7b39e6bZ3w+TdnK04tslPQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB+YEFgsEBONvEkAAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAfklEQVQ4y+2VOw7AMAhDTdVj5nbknnTpkCIMapqt8YYELx9LRlDLXC34IAOgQ63BAelpvrmTucY4EoD6xEvayDOsk533jVZC6f9NzR6kwbupzm3vPipgK8zpgdMpcFobuIG/AGoSoixglQHFB2UhGeC0v9wZxc4JyW9z8cG4AK8CG5AjF625AAAAAElFTkSuQmCC";const K=t=>(N("data-v-872b6126"),t=t(),P(),t),tn=K(()=>l("legend",null,"Profil Type",-1)),nn=K(()=>l("h3",null,"Characteristic Types",-1)),an=["value"],ln={class:"section add"},on=K(()=>l("img",{src:x},null,-1)),sn=K(()=>l("img",{src:en},null,-1)),dn=K(()=>l("h3",{class:"section"},"Selected Characteristic Type",-1)),un={class:"editorTable"},rn=K(()=>l("td",null,"Unique Id:",-1)),cn=K(()=>l("td",null,"Name:",-1));function gn(t,e,a,u,d,n){return s(),c("fieldset",null,[tn,nn,l("div",null,[h(l("select",{size:"2","onUpdate:modelValue":e[0]||(e[0]=o=>n.selected=o)},[(s(!0),c(b,null,A(a.item.characteristicTypes,o=>(s(),c("option",{value:o.id},C(o.name),9,an))),256))],512),[[S,n.selected]]),l("div",ln,[l("button",{class:"bouton",onClick:e[1]||(e[1]=(...o)=>n.add&&n.add(...o))},[on,p(" Add ")]),l("button",{class:"bouton",onClick:e[2]||(e[2]=(...o)=>n.del&&n.del(...o))},[sn,p(" Delete ")])]),d.selectedType?(s(),c(b,{key:0},[dn,l("table",un,[l("tr",null,[rn,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>d.selectedType.id=o),onChange:e[4]||(e[4]=(...o)=>n.changed&&n.changed(...o))},null,544),[[v,d.selectedType.id]])])]),l("tr",null,[cn,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=o=>d.selectedType.name=o),onChange:e[6]||(e[6]=(...o)=>n.changed&&n.changed(...o))},null,544),[[v,d.selectedType.name]])])])])],64)):y("",!0)])])}const mn=_(Zt,[["render",gn],["__scopeId","data-v-872b6126"]]),hn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function _n(t,e,a,u,d,n){const o=w,i=O,r=mn;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{class:"section",item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"])],64)}const Cn=_(hn,[["render",_n]]),pn={props:{modelValue:String,placeholder:{type:String,default:"Search..."},min:{type:Number,default:0},max:{type:Number,default:1e3},options:{type:[Array,Function],required:!0},valueField:{type:String,default:""},filterField:{type:[String,Function],default:""},lazy:{type:Boolean,default:!1},default:{type:Object},nullable:{type:Boolean,default:!1}},created(){this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset()},data(){return{searchPattern:"",lastSearch:null,editing:!1,selectedOption:null,sleeping:this.lazy}},computed:{computedOptions(){return Array.isArray(this.options)?this.options:this.sleeping?[]:this.options()},foundOptions(){const t=this.textSearchRegex(this.searchPattern),e=[];this.nullable&&e.push({option:void 0});const a=this.computedOptions,u=this.max||a.length;for(let d=0;d<a.length;d++){const n=a[d];let o=this.getField(n);if(o&&o.match&&o.match(t)&&(e.push({option:n}),e.length>=u-1))break}return e}},methods:{getField(t){return this.filterField?this.filterField instanceof Function?this.filterField(t):t[this.filterField]:t},escapeRegex(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},textSearchRegex(t){const a=`^(?=.*\\b${this.escapeRegex(t).split(" ").join(".*)(?=.*\\b")}).*$`;return new RegExp(a,"i")},targetSelected(t){let e=t.option;this.valueField.length&&(this.nullable&&!t.option?e=void 0:e=t.option[this.valueField]),this.selectedOption={option:t.option,selected:!0},this.$emit("update:modelValue",e),this.$emit("change")},reset(){if(this.searchPattern="",this.selectedOption=null,this.modelValue){let t=this.computedOptions.find(e=>{let a=e;return this.valueField&&(a=e[this.valueField]),a===this.modelValue});t?this.selectedOption={option:t,selected:!0}:this.selectedOption=null}},onClickOutside(){this.editing=!1},suggest(){this.searchPattern.length<this.min?this.editing=!1:this.startEditing()},maySuggest(){this.sleeping=!1,this.searchPattern="",this.min==0&&this.suggest()},clicked(){this.editing=!1},startEditing(){this.editing||(this.sleeping=!1,this.editing=!0,this.searchPattern="")}},watch:{options(){this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset()},modelValue(){this.editing||(this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset())},async editing(){this.editing&&(await this.$nextTick(),this.$refs.edit&&this.$refs.edit.focus())}}};const yn={class:"autocomplete container"},fn=["placeholder"],bn={key:0,class:"gray"},vn=["onClickCapture"];function kn(t,e,a,u,d,n){const o=be("click-outside");return s(),c("div",yn,[d.editing?h((s(),c("input",{key:0,class:"input autocomplete-input",type:"text",ref:"edit",onInput:e[0]||(e[0]=(...i)=>n.suggest&&n.suggest(...i)),onClick:e[1]||(e[1]=(...i)=>n.maySuggest&&n.maySuggest(...i)),"onUpdate:modelValue":e[2]||(e[2]=i=>d.searchPattern=i),placeholder:a.placeholder},null,40,fn)),[[v,d.searchPattern],[o,n.onClickOutside]]):(s(),c("div",{key:1,onClick:e[3]||(e[3]=(...i)=>n.startEditing&&n.startEditing(...i)),class:"autocomplete-input"},[d.selectedOption?G(t.$slots,"option",le(ve({key:1},d.selectedOption))):(s(),c("span",bn,C(a.placeholder),1))])),l("div",{class:U(["suggestions",{hidden:!d.editing}])},[(s(!0),c(b,null,A(n.foundOptions,i=>(s(),c("div",{onClickCapture:r=>n.targetSelected(i)},[G(t.$slots,"option",le(ke(i)))],40,vn))),256))],2)])}const Y=_(pn,[["render",kn]]),xn={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},computed:{publications(){return Fe([...this.catalogue.iteratePublications()],t=>(t==null?void 0:t.name)||"")}},methods:{getNameExtra:Q,getName:Z,changed(){this.$emit("catalogueChanged")}}},Tn=l("legend",null,"Reference",-1),Fn={class:"editorTable"},wn=l("td",null,"Publication:",-1),In={class:"flex align-items flex-row"},Nn=["src"],Pn={class:"inline"},Rn={class:"grey"},An=["src"],On=l("span",{class:"inline"},"None",-1),En=l("td",null,"Page:",-1);function Vn(t,e,a,u,d,n){const o=Y;return s(),c("fieldset",null,[Tn,l("table",Fn,[l("tr",null,[wn,l("td",null,[m(o,{options:n.publications,filterField:i=>i.getName(),valueField:"id",modelValue:a.item.publicationId,"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.publicationId=i),onChange:n.changed,nullable:""},{option:k(({option:i})=>[l("div",In,[i?(s(),c(b,{key:0},[l("img",{class:"mr-1 my-auto",src:`assets/bsicons/${i.editorTypeName}.png`},null,8,Nn),l("span",Pn,[p(C(n.getName(i))+" ",1),l("span",Rn,C(n.getNameExtra(i)),1)])],64)):(s(),c(b,{key:1},[l("img",{class:"mr-1 my-auto",src:"assets/bsicons/bullet.png"},null,8,An),On],64))])]),_:1},8,["options","filterField","modelValue","onChange"])])]),l("tr",null,[En,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=i=>a.item.page=i),onChange:e[2]||(e[2]=(...i)=>n.changed&&n.changed(...i))},null,544),[[v,a.item.page]])])])])])}const q=_(xn,[["render",Vn]]),Sn=""+globalThis.__publicAssetsURL("assets/icons/undo.svg"),Un=""+globalThis.__publicAssetsURL("assets/icons/redo.svg"),Ln=""+new URL("collapse-all.40557dca.svg",import.meta.url).href,z=t=>(N("data-v-c76a967e"),t=t(),P(),t),qn={class:"leftPanel"},jn={class:"static sticky flex items-center h-28px z-1"},Bn={class:"absolute right-30px"},$n=z(()=>l("option",{value:"none"},"No Sorting ",-1)),Dn=z(()=>l("option",{value:"asc"},"Ascending ",-1)),Gn=z(()=>l("option",{value:"desc"},"Descending ",-1)),Mn=z(()=>l("option",{value:"type"},"Type",-1)),Qn=[$n,Dn,Gn,Mn],Hn={class:"bottom static"},Kn={key:0},Yn=z(()=>l("label",{class:"unselectable cursor-pointer",for:"showimport"},"Show Imported",-1)),zn=z(()=>l("span",null," Â ",-1)),Xn={class:"absolute right-5px"},Wn=z(()=>l("label",{class:"unselectable cursor-pointer",for:"ignoreProfilesRules"},"Ignore Profiles/Rules",-1));function Jn(t,e,a,u,d,n){const o=he,i=L("CatalogueEntry");return s(),c("div",qn,[l("div",jn,[l("span",{class:U([{grey:!t.store.can_back(),"cursor-pointer":t.store.can_back(),"hover-darken":t.store.can_back()},"bold p-4px unselectable icon"]),onClick:e[0]||(e[0]=(...r)=>t.store.back&&t.store.back(...r)),title:"Back"}," ðŸ¡° ",2),l("span",{class:U([{grey:!t.store.can_forward(),"cursor-pointer":t.store.can_forward(),"hover-darken":t.store.can_forward()},"bold p-4px unselectable ml-4px icon"]),onClick:e[1]||(e[1]=(...r)=>t.store.forward&&t.store.forward(...r)),title:"Forward"}," ðŸ¡² ",2),l("img",{class:U([{grey:!t.store.can_undo(),"cursor-pointer":t.store.can_undo(),"hover-darken":t.store.can_undo()},"bold p-4px unselectable ml-5px w-24px h-24px icon"]),onClick:e[2]||(e[2]=(...r)=>t.store.undo&&t.store.undo(...r)),title:"Undo",src:Sn},null,2),l("img",{class:U([{grey:!t.store.can_redo(),"cursor-pointer":t.store.can_redo(),"hover-darken":t.store.can_redo()},"bold p-4px unselectable ml-4px w-24px h-24px icon"]),onClick:e[3]||(e[3]=(...r)=>t.store.redo&&t.store.redo(...r)),title:"Redo",src:Un},null,2),l("div",Bn,[p(" Sort "),h(l("select",{class:"h-24px p-2px !text-sm","onUpdate:modelValue":e[4]||(e[4]=r=>t.settings.sort=r)},Qn,512),[[S,t.settings.sort]])]),l("img",{onClick:e[5]||(e[5]=(...r)=>t.uistate.collapse_all&&t.uistate.collapse_all(...r)),class:"align-middle absolute right-0 p-2px hover-darken cursor-pointer icon",title:"Collapse All",src:Ln}),m(o,{errors:t.catalogue.errors,showNumber:"",clickable:"",class:"z-1"},null,8,["errors"])]),l("div",{class:"top rightborder scrollable",ref:"scrollable",onScroll:e[6]||(e[6]=(...r)=>t.onscroll&&t.onscroll(...r)),onKeydownCapture:e[7]||(e[7]=(...r)=>t.keydown&&t.keydown(...r))},[m(i,{class:"mb-40px",item:t.catalogue,grouped:"",id:"editor-entries",showImported:t.showImported},null,8,["item","showImported"])],544),l("div",Hn,[t.catalogue.isGameSystem()?y("",!0):(s(),c("span",Kn,[h(l("input",{class:"cursor-pointer","onUpdate:modelValue":e[8]||(e[8]=r=>t.showImported=r),type:"checkbox",id:"showimport"},null,512),[[R,t.showImported]]),Yn])),zn,l("span",Xn,[h(l("input",{class:"cursor-pointer","onUpdate:modelValue":e[9]||(e[9]=r=>t.ignoreProfilesRules=r),type:"checkbox",id:"ignoreProfilesRules"},null,512),[[R,t.ignoreProfilesRules]]),Wn]),h(l("input",{"onUpdate:modelValue":e[10]||(e[10]=r=>t.filter=r),ref:"editor-searchbox",type:"search",placeholder:"search... ctrl+f",class:"w-full"},null,512),[[v,t.filter]])])])}const Zn=_(We,[["render",Jn],["__scopeId","data-v-c76a967e"]]),ea={emits:["catalogueChanged"],setup(){return{store:$()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},methods:{changed(){this.$emit("catalogueChanged")},add(t,e){this.store.create_child("constraints",this.item,{type:t,scope:e,value:1,select:!1})}}};const T=t=>(N("data-v-efc90550"),t=t(),P(),t),ta=T(()=>l("legend",null,"Quick Constraints",-1)),na={class:"columns"},aa={class:"column"},la=T(()=>l("img",{src:x},null,-1)),oa=T(()=>l("span",{class:"text"},"MIN 1 IN PARENT",-1)),ia=[la,oa],sa=T(()=>l("img",{src:x},null,-1)),da=T(()=>l("span",{class:"text"},"MIN 1 IN CATEGORY",-1)),ua=[sa,da],ra=T(()=>l("img",{src:x},null,-1)),ca=T(()=>l("span",{class:"text"},"MIN 1 IN FORCE",-1)),ga=[ra,ca],ma=T(()=>l("img",{src:x},null,-1)),ha=T(()=>l("span",{class:"text"},"MIN 1 IN ROSTER",-1)),_a=[ma,ha],Ca={class:"column"},pa=T(()=>l("img",{src:x},null,-1)),ya=T(()=>l("span",{class:"text"},"MAX 1 IN PARENT",-1)),fa=[pa,ya],ba=T(()=>l("img",{src:x},null,-1)),va=T(()=>l("span",{class:"text"},"MAX 1 IN CATEGORY",-1)),ka=[ba,va],xa=T(()=>l("img",{src:x},null,-1)),Ta=T(()=>l("span",{class:"text"},"MAX 1 IN FORCE",-1)),Fa=[xa,Ta],wa=T(()=>l("img",{src:x},null,-1)),Ia=T(()=>l("span",{class:"text"},"MAX 1 IN ROSTER",-1)),Na=[wa,Ia],Pa={class:"column"},Ra=T(()=>l("img",{src:x},null,-1)),Aa=T(()=>l("span",{class:"text"},"EXACTLY 1 IN PARENT",-1)),Oa=[Ra,Aa],Ea=T(()=>l("img",{src:x},null,-1)),Va=T(()=>l("span",{class:"text"},"EXACTLY 1 IN CATEGORY",-1)),Sa=[Ea,Va],Ua=T(()=>l("img",{src:x},null,-1)),La=T(()=>l("span",{class:"text"},"EXACTLY 1 IN FORCE",-1)),qa=[Ua,La],ja=T(()=>l("img",{src:x},null,-1)),Ba=T(()=>l("span",{class:"text"},"EXACTLY 1 IN ROSTER",-1)),$a=[ja,Ba];function Da(t,e,a,u,d,n){return s(),c("fieldset",null,[ta,l("div",na,[l("div",aa,[l("button",{class:"bouton",onClick:e[0]||(e[0]=o=>n.add("min","parent"))},ia),a.withCategory?(s(),c("button",{key:0,class:"bouton",onClick:e[1]||(e[1]=o=>n.add("min","parent"))},ua)):y("",!0),l("button",{class:"bouton",onClick:e[2]||(e[2]=o=>n.add("min","force"))},ga),l("button",{class:"bouton",onClick:e[3]||(e[3]=o=>n.add("min","roster"))},_a)]),l("div",Ca,[l("button",{class:"bouton",onClick:e[4]||(e[4]=o=>n.add("max","parent"))},fa),a.withCategory?(s(),c("button",{key:0,class:"bouton",onClick:e[5]||(e[5]=o=>n.add("max","parent"))},ka)):y("",!0),l("button",{class:"bouton",onClick:e[6]||(e[6]=o=>n.add("max","force"))},Fa),l("button",{class:"bouton",onClick:e[7]||(e[7]=o=>n.add("max","roster"))},Na)]),l("div",Pa,[l("button",{class:"bouton",onClick:e[8]||(e[8]=o=>n.add("exactly","parent"))},Oa),a.withCategory?(s(),c("button",{key:0,class:"bouton",onClick:e[9]||(e[9]=o=>n.add("exactly","parent"))},Sa)):y("",!0),l("button",{class:"bouton",onClick:e[10]||(e[10]=o=>n.add("exactly","force"))},qa),l("button",{class:"bouton",onClick:e[11]||(e[11]=o=>n.add("exactly","roster"))},$a)])])])}const ee=_(ea,[["render",Da],["__scopeId","data-v-efc90550"]]),Ga={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ma(t,e,a,u,d,n){const o=w,i=O,r=q,g=H,F=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(F,{item:a.item,onCatalogueChanged:n.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Qa=_(Ga,[["render",Ma]]),Ha={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ka(t,e,a,u,d,n){const o=w,i=O,r=q,g=H,F=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(F,{item:a.item,onCatalogueChanged:n.changed,withCategory:!0,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Ya=_(Ha,[["render",Ka]]),za={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{getName:Z,getNameExtra:Q,changedType(){this.item.getCatalogue().refreshErrors(this.item),this.$emit("catalogueChanged")},changed(){this.$emit("catalogueChanged")}},computed:{profileTypes(){return[...this.catalogue.iterateProfileTypes()]},charactacteristics(){var u;const t={};for(const d of this.item.characteristics||[])t[d.name]=d.$text;if(!this.item.typeId)return[];const e=this.catalogue.findOptionById(this.item.typeId);this.item.isLink()||(this.item.typeName=e==null?void 0:e.name);const a=(u=e==null?void 0:e.characteristicTypes)==null?void 0:u.map(d=>({name:d.name,typeId:d.id,$text:t[d.name]||""}));return this.item.characteristics=a,a}}},Xa=l("legend",null,"Characteristics",-1),Wa={class:"editorTable"},Ja=l("td",null,"Profile Type: ",-1),Za={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},el=["src"],tl={class:"inline"},nl={class:"grey"},al={class:"editorTable"};function ll(t,e,a,u,d,n){const o=Y,i=ie;return s(),c("fieldset",null,[Xa,l("table",Wa,[l("tr",null,[Ja,l("td",null,[m(o,{options:n.profileTypes,filterField:r=>r.getName(),valueField:"id",modelValue:a.item.typeId,"onUpdate:modelValue":e[0]||(e[0]=r=>a.item.typeId=r),onChange:n.changed},{option:k(({option:r})=>[l("div",Za,[l("img",{class:"mr-1 my-auto",src:`assets/bsicons/${r.editorTypeName}.png`},null,8,el),l("span",tl,[p(C(n.getName(r))+" ",1),l("span",nl,C(n.getNameExtra(r)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])])])]),l("table",al,[(s(!0),c(b,null,A(n.charactacteristics,r=>(s(),c("tr",null,[l("td",null,C(r.name)+": ",1),l("td",null,[m(i,{modelValue:r.$text,"onUpdate:modelValue":g=>r.$text=g,onChange:n.changed},null,8,["modelValue","onUpdate:modelValue","onChange"])])]))),256))])])}const ol=_(za,[["render",ll]]),il={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function sl(t,e,a,u,d,n){const o=w,i=O,r=q,g=H,F=ol;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(F,{class:"section",item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const dl=_(il,[["render",sl]]),ul={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},rl=l("legend",null,"Description",-1);function cl(t,e,a,u,d,n){const o=ie;return s(),c("fieldset",null,[rl,m(o,{modelValue:a.item.description,"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.description=i),onChange:n.changed},null,8,["modelValue","onChange"])])}const gl=_(ul,[["render",cl]]),ml={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function hl(t,e,a,u,d,n){const o=w,i=O,r=q,g=H,F=gl;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(F,{class:"section",item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const _l=_(ml,[["render",hl]]),Cl={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},pl={class:"editorTable"},yl=l("td",null,"Type:",-1),fl=xe('<option value="model">Model</option><option value="upgrade">Upgrade</option><option value="unit">Unit</option><option value="mount">Mount</option><option value="crew">Crew</option>',5),bl=[fl];function vl(t,e,a,u,d,n){return s(),c("fieldset",null,[l("legend",null,[G(t.$slots,"default")]),l("table",pl,[l("tr",null,[yl,l("td",null,[h(l("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.item.type=o),onChange:e[1]||(e[1]=(...o)=>n.changed&&n.changed(...o))},bl,544),[[S,a.item.type]])])])])])}const kl=_(Cl,[["render",vl]]),xl={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{placeholder(){return`${this.item.isLink()&&this.item.getDefaultAmount()||"unset"}`}}};const we=t=>(N("data-v-202b280a"),t=t(),P(),t),Tl=we(()=>l("legend",null,"Creation",-1)),Fl={class:"editorTable"},wl=we(()=>l("td",null,"Default Amount:",-1)),Il=["placeholder"];function Nl(t,e,a,u,d,n){return s(),c("fieldset",null,[Tl,l("table",Fl,[l("tr",null,[wl,l("td",null,[h(l("input",{class:"input",type:"number","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.defaultAmount=o),onChange:e[1]||(e[1]=(...o)=>n.changed&&n.changed(...o)),placeholder:n.placeholder},null,40,Il),[[v,a.item.defaultAmount]])])])])])}const Ie=_(xl,[["render",Nl],["__scopeId","data-v-202b280a"]]),Pl={props:{modelValue:{type:[Number,String]},required:{type:Boolean,required:!1},min:{type:Number,required:!1},max:{type:Number,required:!1}},data(){return{stringValue:null,intValue:0}},watch:{modelValue(){this.refresh()}},created(){this.refresh()},methods:{refresh(){this.intValue=this.modelValue||0,this.stringValue=""+this.modelValue},update(){this.stringValue!=null&&(this.intValue=parseFloat(this.stringValue),this.$emit("update:modelValue",this.intValue),this.$emit("change"))}}},Rl=["required","min","max"];function Al(t,e,a,u,d,n){return h((s(),c("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>d.stringValue=o),type:"number",onChange:e[1]||(e[1]=(...o)=>n.update&&n.update(...o)),required:a.required,min:a.min,max:a.max},null,40,Rl)),[[v,d.stringValue]])}const X=_(Pl,[["render",Al]]),Ol={emits:["catalogueChanged"],data(){return{selectedCosts:{}}},created(){this.update()},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{costTypes(){let t=[];for(let e of this.catalogue.iterateCostTypes())t.push(e);return t}},methods:{changed(){this.item.costs=Object.values(this.selectedCosts).filter(t=>isFinite(t.value)),this.$emit("catalogueChanged")},update(){this.selectedCosts={};const t=this.item.isLink()?void 0:0;for(let e of Object.values(this.costTypes))this.selectedCosts[e.id]={name:e.name,typeId:e.id,value:t};if(this.item.costs)for(let e of this.item.costs)this.selectedCosts[e.typeId]={name:e.name,typeId:e.typeId,value:e.value}}},watch:{item(){this.update()}}};const El=t=>(N("data-v-bad156ce"),t=t(),P(),t),Vl=El(()=>l("legend",null,"Costs",-1)),Sl={class:"costs"};function Ul(t,e,a,u,d,n){const o=X;return s(),c("fieldset",null,[Vl,l("div",Sl,[(s(!0),c(b,null,A(n.costTypes,i=>(s(),c("div",null,[l("label",null,C(i.name)+": ",1),d.selectedCosts[i.id]!=null?(s(),f(o,{key:0,modelValue:d.selectedCosts[i.id].value,"onUpdate:modelValue":r=>d.selectedCosts[i.id].value=r,class:"input",onChange:n.changed,placeholder:"unset"},null,8,["modelValue","onUpdate:modelValue","onChange"])):y("",!0)]))),256))])])}const Ne=_(Ol,[["render",Ul],["__scopeId","data-v-bad156ce"]]),Ll={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{fields(){return[{name:"Hidden",status:this.hidden,field:"hidden"},{name:"Collective",status:this.collective,field:"collective",title:"indicates that multiple instances of this entry may be combined into one entry with an amount"},{name:"Import",status:this.eimport,field:"import",title:"Indicates that this entry may be imported by other catalogues"}]},hidden(){return!0},collective(){var t;if((t=this.item.parent)!=null&&t.isCatalogue()){const e=this.item.parentKey;if(e==="selectionEntries"||e==="entryLinks")return 0}switch(this.item.editorTypeName){case"selectionEntryLink":return 1;case"selectionEntryGroupLink":return 1;case"selectionEntry":return 1;case"selectionEntryGroup":return 1;case"categoryLink":return-1;case"infoLink":return-1;case"profileLink":return-1;case"ruleLink":return-1;case"infoGroupLink":return-1}return 1},eimport(){var t;if((t=this.item.parent)!=null&&t.isCatalogue())return 1;switch(this.item.editorTypeName){case"selectionEntryLink":return 0;case"selectionEntryGroupLink":return 0;case"selectionEntry":return 0;case"selectionEntryGroup":return 0;case"categoryLink":return-1;case"infoLink":return-1;case"profileLink":return-1;case"ruleLink":return-1;case"infoGroupLink":return-1}return 0}}};const ql={class:"booleans"},jl=["id","onUpdate:modelValue","disabled"],Bl=["for","title"];function $l(t,e,a,u,d,n){return s(),c("fieldset",null,[l("legend",null,[G(t.$slots,"default",{},void 0,!0)]),l("div",ql,[(s(!0),c(b,null,A(n.fields.filter(o=>o.status!=-1),o=>(s(),c("div",null,[h(l("input",{class:U({"cursor-pointer":o.status!==0}),id:o.field,type:"checkbox","onUpdate:modelValue":i=>a.item[o.field]=i,onChange:e[0]||(e[0]=(...i)=>n.changed&&n.changed(...i)),disabled:o.status==0},null,42,jl),[[R,a.item[o.field]]]),l("label",{class:U({"cursor-pointer":o.status!==0,gray:o.status==0,hastooltip:!!o.title}),for:o.field,title:o.title},C(o.name),11,Bl)]))),256))])])}const _e=_(Ll,[["render",$l],["__scopeId","data-v-8aa7e0e5"]]),Dl=oe({props:{category:{required:!0,type:Object},item:{type:Object,required:!0}},setup(){return{store:$()}},data(){return{contextmenuopen:!1}},methods:{menu(t){return{show:(e,a)=>{this.contextmenuopen=!0,this.$nextTick(()=>{var u;(u=this.$refs[t])==null||u.show(e,a)})},close:(e,a)=>{var u;(u=this.$refs[t])==null||u.close(e,a),this.contextmenuopen=!1}}},hasCategory(t){var a;let e=(a=this.item.categoryLinks)==null?void 0:a.find(u=>{var d;return((d=u.target)==null?void 0:d.id)===t.id});return e?e.primary?2:1:0}},computed:{contextmenu(){return this.menu("contextmenu")}},components:{ContextMenu:Je}});const Gl=["checked"],Ml=["id","checked"],Ql=["for"],Hl={class:"gray"},Kl={class:"gray"};function Yl(t,e,a,u,d,n){const o=L("ContextMenu");return s(),c("div",{class:"category",onContextmenu:e[4]||(e[4]=Ke((...i)=>t.contextmenu.show&&t.contextmenu.show(...i),["stop"]))},[l("div",null,[l("input",{name:"primary",type:"radio",checked:t.hasCategory(t.category)==2,onChange:e[0]||(e[0]=i=>t.$emit("primaryChanged",t.category))},null,40,Gl),p(" Primary? ")]),l("div",null,[l("input",{id:`category-${t.category.id}`,type:"checkbox",checked:t.hasCategory(t.category)!=0,onChange:e[1]||(e[1]=i=>t.$emit("secondaryChanged",t.category))},null,40,Ml),l("label",{for:`category-${t.category.id}`},[p(C(t.category.name),1),l("span",Hl," ["+C(t.category.catalogue.name)+"]",1)],8,Ql)]),t.contextmenuopen?(s(),f(o,{key:0,modelValue:t.contextmenuopen,"onUpdate:modelValue":e[3]||(e[3]=i=>t.contextmenuopen=i),ref:"contextmenu"},{default:k(()=>{var i;return[l("div",{onClick:e[2]||(e[2]=r=>t.store.goto(t.category))},[p(" Goto "+C(t.category.getName())+" ",1),l("span",Kl," Â ("+C((i=t.category.catalogue)==null?void 0:i.getName())+") ",1)])]}),_:1},8,["modelValue"])):y("",!0)],32)}const zl=_(Dl,[["render",Yl]]),Xl={components:{Category:zl},emits:["catalogueChanged"],data(){return{filter:"",primaries:new Set,secondaries:new Set}},setup(){return{settings:Ye()}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{hasCategory(t){var a;let e=(a=this.item.categoryLinks)==null?void 0:a.find(u=>{var d;return((d=u.target)==null?void 0:d.id)===t.id});return e?e.primary?2:1:0},primaryChanged(t){this.refreshCategories(this.item,t,!0)},secondaryChanged(t){this.refreshCategories(this.item,t,!1)},refreshCategories(t,e,a){t.categoryLinks||(t.categoryLinks=[]);const u=t.categoryLinks;if(a&&u.forEach(d=>d.primary=!1),e){const d=u.find(n=>n.targetId===(e==null?void 0:e.id));d&&a?d.primary=!0:d?this.removeLink(u,d):this.addLink(u,e,a)}this.changed()},removeLink(t,e){const a=t.findIndex(u=>u===e);if(a!==-1){const[u]=t.splice(a,1);this.catalogue.removeFromIndex(u);const d=u.target.links;if(d){const n=d==null?void 0:d.findIndex(o=>o===u);n!==-1&&(d==null||d.splice(n,1))}}},addLink(t,e,a=!1){var n;if(!e.isCategory())throw Error("Invalid argument, target must be a category");const u=Ze({targetId:e.id,target:e,id:this.catalogue.generateNonConflictingId(),primary:a,catalogue:this.catalogue,name:e.name},"categoryLinks");t.push(u),this.catalogue.addToIndex(u);const d=e;return d.links||(d.links=[]),(n=d.links)==null||n.push(u),u},changed(){this.$emit("catalogueChanged")},noPrimary(){let t=!0;if(this.item.categoryLinks){for(let e of this.item.categoryLinks)if(e.primary)return!1}return t}},computed:{badLinks(){const t=[],e=new Set;for(const a of this.catalogue.iterateCategoryEntries())e.add(a.id);for(const a of this.item.categoryLinks||[])e.has(a.targetId)||t.push(a);return t},count(){var t;return((t=this.item.categoryLinks)==null?void 0:t.length)||0},categories(){let t=[];for(let e of this.catalogue.iterateCategoryEntries())this.settings.showOnlyEnabledCategories&&this.hasCategory(e)==0||e.getName().toLowerCase().includes(this.filter.toLowerCase())&&t.push(e);return t}}};const Wl=t=>(N("data-v-9420b160"),t=t(),P(),t),Jl={class:"section inline"},Zl=Wl(()=>l("label",{for:"onlyEnabled"},"Only show selected categories",-1)),eo={class:"section categoryList"},to=["checked"],no=["checked","onChange"],ao=["id","onChange"],lo=["for"];function oo(t,e,a,u,d,n){const o=L("Category"),i=he;return s(),c("fieldset",null,[l("legend",null,"Categories ("+C(n.count)+")",1),h(l("input",{class:"section",type:"text","onUpdate:modelValue":e[0]||(e[0]=r=>d.filter=r),placeholder:"Filter categories..."},null,512),[[v,d.filter]]),l("div",Jl,[h(l("input",{type:"checkbox",id:"onlyEnabled","onUpdate:modelValue":e[1]||(e[1]=r=>u.settings.showOnlyEnabledCategories=r)},null,512),[[R,u.settings.showOnlyEnabledCategories]]),Zl]),l("div",eo,[l("div",null,[l("input",{name:"primary",type:"radio",checked:n.noPrimary,onChange:e[2]||(e[2]=r=>n.primaryChanged(null))},null,40,to),p(" No Primary ")]),(s(!0),c(b,null,A(n.categories,r=>(s(),f(o,{category:r,item:a.item,key:r.id,onPrimaryChanged:n.primaryChanged,onSecondaryChanged:n.secondaryChanged},null,8,["category","item","onPrimaryChanged","onSecondaryChanged"]))),128)),(s(!0),c(b,null,A(n.badLinks,r=>(s(),c("div",{class:"category",key:r.id},[l("div",null,[l("input",{name:"primary",type:"radio",checked:n.hasCategory(r)==2,onChange:g=>n.primaryChanged(r)},null,40,no),p(" Primary? ")]),l("div",null,[l("input",{id:`bad${r.id}`,type:"checkbox",checked:!0,onChange:g=>n.removeLink(a.item.categoryLinks,r)},null,40,ao),l("label",{for:`bad${r.id}`},C(r.name),9,lo),m(i,{class:"ml-5px inline",errors:[{msg:`Couldn't find category with id: ${r.targetId}`,severity:"error"}]},null,8,["errors"])])]))),128))])])}const Ce=_(Xl,[["render",oo],["__scopeId","data-v-9420b160"]]),io={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function so(t,e,a,u,d,n){const o=w,i=O,r=q,g=kl,F=Ie,V=Ne,I=_e,D=Ce,B=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Selection Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(F,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(V,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(I,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(D,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(B,{item:a.item,onCatalogueChanged:n.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const uo=_(io,[["render",so]]),ro={setup(){return{store:$()}},emits:["catalogueChanged"],data(){return{filter:"",val:null}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},type:{type:String,required:!0}},computed:{allowEntries(){return!0},allowGroups(){var t;return!((t=this.item.parent)!=null&&t.isCatalogue()&&this.item.parentKey==="entryLinks")}},methods:{getNameExtra:Q,availableTargets(){if(this.type==="catalogue"){const e=this.catalogue.gameSystemId||this.catalogue.id;return Object.values(this.store.get_system(e).catalogueFiles).map(d=>({id:d.catalogue.id,name:d.catalogue.name,editorTypeName:"catalogueLink"}))}const t=[];for(const e of this.catalogue.iterateAllImported())this.targetIsValid(e)&&(e.isLink()||t.push(e));return Fe(t,e=>e.name)},typeChanged(){},targetIdChanged(){this.updateLink(),this.changed()},async updateLink(){var t;if(this.type==="catalogue"&&this.item.targetId){const e=this.catalogue.gameSystemId||this.catalogue.id;await this.catalogue.reload(this.store.get_system(e));const a=this.item.target;this.item.name=((t=this.item.target)==null?void 0:t.name)||"Unknown",this.item.type=(a==null?void 0:a.editorTypeName)||this.type}else{this.catalogue.updateLink(this.item);const e=this.item.target;this.item.name=(e==null?void 0:e.name)||"Unknown",this.item.type=(e==null?void 0:e.editorTypeName)||this.item.type}},changedImportRootEntries(){this.changed()},changed(){this.$emit("catalogueChanged")},getType(t){return t.target?t.target.editorTypeName:"bullet"},itemName(t){return t.name},itemValue(t){return t.name},targetIsValid(t){return this.item.type==null||this.item.type==="category"?t.editorTypeName=="category":t.editorTypeName==this.item.type},showCatalogue(t){var e;return!(!t.catalogue||t.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))}}},Pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAFKSURBVDhPpZLBSgJRFIbvuTtHXyBaWEG0TRxFCAJd9B6B4CLoXaKVLVr4FK3GTRGEMwvXYYPQI1TQ4D2d/3gVnEFh7IPBc37mHD2/P5kcH63WuVssBmxMT9pjaESUOmPGhnl4miQJtBXrBfNOp/KbZXdS9kUsLAaylGXJY4Xo9jCOv6Hpi374SZpL9CuOosgYa03a7cqojHsc80tAdIUlFgK+OT8MbK2mTx5LdPHDfK81bpbPPppSEF2/NxqhhWHbbt6FzhANrHd7L2RJDx7oX7UndTXxP4ihlPq6NHL+3Drnxr4vMGu3zSwMNzKQI7Li5FATVh5eED1YzbbE04sbnEwm+mxhdBbHb2oiss3Mzyp7bLXqq2Uic7wGWXaDYh2gz2Yz0HhKwnYEC6eOMHwwnX5BKLyIeCJhCIm0dWjqthiWyc342dCWGPMHCdh2fZxOhd0AAAAASUVORK5CYII=";const E=t=>(N("data-v-add104af"),t=t(),P(),t),co=E(()=>l("legend",null,"Link",-1)),go={class:"editorTable"},mo={key:0},ho=E(()=>l("td",null,"Link Type:",-1)),_o={key:0,value:"selectionEntry"},Co={key:1,value:"selectionEntryGroup"},po={key:1},yo=E(()=>l("td",null,"Link Type:",-1)),fo=E(()=>l("option",{value:"profile"},"Profile",-1)),bo=E(()=>l("option",{value:"rule"}," Rule ",-1)),vo=E(()=>l("option",{value:"infoGroup"}," Info Group ",-1)),ko=[fo,bo,vo],xo=E(()=>l("td",null,"Link To:",-1)),To=["src"],Fo=E(()=>l("img",{class:"errIcon",src:Pe},null,-1)),wo=E(()=>l("td",null,"Target ID:",-1)),Io=E(()=>l("td",null,"Target:",-1)),No={style:{"white-space":"nowrap"}},Po=["src"],Ro={class:"gray"},Ao={key:0,class:"shared"},Oo={key:1,class:"catalogueName"},Eo={key:2},Vo=E(()=>l("td",null,null,-1)),So=E(()=>l("label",{for:"importRoot"},"Import Root Entries",-1));function Uo(t,e,a,u,d,n){const o=Y;return s(),c("fieldset",null,[co,l("table",go,[a.type=="entry"?(s(),c("tr",mo,[ho,l("td",null,[h(l("select",{onChange:e[0]||(e[0]=(...i)=>n.typeChanged&&n.typeChanged(...i)),"onUpdate:modelValue":e[1]||(e[1]=i=>a.item.type=i)},[n.allowEntries?(s(),c("option",_o,"Selection Entry")):y("",!0),n.allowGroups?(s(),c("option",Co," Selection Entry Group ")):y("",!0)],544),[[S,a.item.type]])])])):y("",!0),a.type=="info"?(s(),c("tr",po,[yo,l("td",null,[h(l("select",{onChange:e[2]||(e[2]=(...i)=>n.typeChanged&&n.typeChanged(...i)),"onUpdate:modelValue":e[3]||(e[3]=i=>a.item.type=i)},ko,544),[[S,a.item.type]])])])):y("",!0),l("tr",null,[xo,l("td",null,[a.item.target?(s(),c(b,{key:0},[a.item.type?(s(),c("img",{key:0,class:"linkIcon",src:`assets/bsicons/${n.getType(a.item)}.png`},null,8,To)):y("",!0),p(" "+C(a.item.target.name),1)],64)):(s(),c(b,{key:1},[Fo,p(" No target selected ")],64))])]),l("tr",null,[wo,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=i=>a.item.targetId=i),onChange:e[5]||(e[5]=(...i)=>n.targetIdChanged&&n.targetIdChanged(...i))},null,544),[[v,a.item.targetId]])])]),l("tr",null,[Io,l("td",null,[m(o,{modelValue:a.item.targetId,"onUpdate:modelValue":e[6]||(e[6]=i=>a.item.targetId=i),placeholder:"Search Target...",options:n.availableTargets,valueField:"id",filterField:"name",onChange:n.targetIdChanged},{option:k(i=>[l("div",No,[l("img",{class:"mr-1 align-middle",src:`assets/bsicons/${i.option.editorTypeName}.png`},null,8,Po),p(" "+C(i.option.name)+" ",1),l("span",Ro,C(n.getNameExtra(i.option,!1)),1),i.option.shared?(s(),c("span",Ao," (shared)")):y("",!0),n.showCatalogue(i.option)?(s(),c("span",Oo," ["+C(i.option.catalogue.name)+"]",1)):y("",!0)])]),_:1},8,["modelValue","placeholder","options","onChange"])])]),a.type==="catalogue"?(s(),c("tr",Eo,[Vo,l("td",null,[h(l("input",{onChange:e[7]||(e[7]=(...i)=>n.changedImportRootEntries&&n.changedImportRootEntries(...i)),id:"importRoot",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=i=>a.item.importRootEntries=i)},null,544),[[R,a.item.importRootEntries]]),So])])):y("",!0)])])}const Lo=_(ro,[["render",Uo],["__scopeId","data-v-add104af"]]),qo={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},type:{type:String,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function jo(t,e,a,u,d,n){const o=w,i=O,r=q,g=Lo,F=Ne,V=Ie,I=_e,D=Ce,B=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),a.type!="catalogue"?(s(),f(r,{key:0,item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):y("",!0),m(g,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section",type:a.type},null,8,["item","catalogue","onCatalogueChanged","type"]),a.item.editorTypeName=="selectionEntryLink"?(s(),f(F,{key:1,item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):y("",!0),a.item.editorTypeName=="selectionEntryLink"?(s(),f(V,{key:2,item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):y("",!0),a.type!="catalogue"?(s(),f(I,{key:3,item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Entry ")]),_:1},8,["item","onCatalogueChanged"])):y("",!0),a.item.editorTypeName=="selectionEntryLink"||a.item.editorTypeName=="selectionEntryGroupLink"?(s(),f(D,{key:4,item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):y("",!0),a.type=="entry"||a.type=="category"?(s(),f(B,{key:5,item:a.item,onCatalogueChanged:n.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])):y("",!0)],64)}const Bo=_(qo,[["render",jo]]),$o={props:{modelValue:{type:Object},placeholder:{type:String,default:"Search..."},fetch:{type:Function,required:!0},disabled:{type:Boolean,default:!1}},created(){this.reset()},data(){return{searchPattern:"",lastSearch:null,editing:!1,selectedOption:null,availableOptions:[]}},methods:{async foundOptions(){return(await this.fetch()).map(e=>({option:e}))},targetSelected(t){let e=t.option;this.selectedOption={option:t.option,selected:!0},this.$emit("update:modelValue",e),this.$emit("change",t.option),this.editing=!1},reset(){this.searchPattern="",this.selectedOption=null,this.modelValue&&(this.selectedOption={option:this.modelValue,selected:!0})},onClickOutside(){this.editing=!1},async startEditing(){this.disabled||(this.editing=!0,this.availableOptions=await this.foundOptions())},clicked(){this.editing=!1}}};const Do={key:0,class:"gray"},Go=["onClick"];function Mo(t,e,a,u,d,n){const o=be("click-outside");return s(),c("div",{class:U(["container",{disabled:a.disabled}])},[h((s(),c("div",{onClick:e[0]||(e[0]=(...i)=>n.startEditing&&n.startEditing(...i)),class:"iconselect-input"},[d.selectedOption?G(t.$slots,"option",le(ve({key:1},d.selectedOption))):(s(),c("span",Do,C(a.placeholder),1))])),[[o,n.onClickOutside]]),l("div",{class:U(["suggestions",{hidden:!d.editing}])},[(s(!0),c(b,null,A(d.availableOptions,i=>(s(),c("div",{onClick:r=>n.targetSelected(i)},[G(t.$slots,"option",le(ke(i)))],8,Go))),256))],2)],2)}const Re=_($o,[["render",Mo]]),Qo={selectionEntry:["costs","name","page","hidden","category","constraints"],selectionEntryLink:["costs","name","page","hidden","category","constraints"],selectionEntryGroup:["name","page","hidden","category","constraints","defaultSelectionEntryId"],selectionEntryGroupLink:["name","page","hidden","category","constraints","defaultSelectionEntryId"],profile:["characteristics","name","description","page","hidden"],profileLink:["characteristics","name","description","page","hidden"],rule:["name","description","page","hidden"],ruleLink:["name","description","page","hidden"],infoLink:["name","page","hidden"],infoGroup:["name","page","hidden"],infoGroupLink:["name","page","hidden"],force:["name","page","hidden","constraints"],category:["name","page","hidden","constraints"],categoryLink:["name","page","hidden","constraints"]},Ho={costs:"number",name:"string",page:"string",hidden:"boolean",description:"string",category:"category",defaultSelectionEntryId:"defaultSelectionEntryId",constraints:"number"},Ko={components:{ErrorIcon:he},emits:["catalogueChanged"],data(){return{value:"",selectedField:null,selectedOperation:null,selectedValue:null}},created(){this.update()},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{getName:Z,getNameExtra:Q,changed(){this.selectedField&&(this.item.field=this.selectedField.id),this.selectedOperation&&(this.item.type=this.selectedOperation.id),this.$emit("catalogueChanged")},getDefaultFieldValue(t,e,a){var u;switch(t){case"number":return typeof a=="number"?a:0;case"category":return this.allCategories[0].id;case"string":let d;if(e==="name"){const n=this.item;d=n.getName&&n.getName()||""}else d="";return typeof a=="string"?a:d;case"string-or-number":return["strint","number"].includes(typeof a)?a:"";case"boolean":return typeof a=="boolean"?a:!1;case"defaultSelectionEntryId":return(u=et(this.allGroupEntries))==null?void 0:u.id;default:throw Error(`fieldType "${t}" has no default value set"`)}},fieldChanged(){this.selectedOperation=this.operations[0],this.selectedField&&(this.item.value=this.getDefaultFieldValue(this.selectedField.type,this.selectedField.name,this.item.value)),this.changed()},update(){this.selectedField=this.fieldData.find(t=>t.id===this.item.field)||null,this.selectedOperation=this.operations.find(t=>t.id===this.item.type)||null,this.selectedField||(this.selectedField=this.fieldData[0]),this.selectedOperation||(this.selectedOperation=this.operations[0]||null)}},watch:{item(){this.update()}},computed:{inputType(){var t,e;return this.selectedField?this.selectedField.type==="category"?"category":this.selectedField.type==="defaultSelectionEntryId"?"defaultSelectionEntryId":this.selectedField.type==="number"?"number":this.selectedField.type==="boolean"?"boolean":((t=this.selectedOperation)==null?void 0:t.id)==="increment"||((e=this.selectedOperation)==null?void 0:e.id)==="decrement"?"number":"string":""},parent(){return W(this.item)},allCategories(){let t=[];for(let e of this.catalogue.iterateCategoryEntries())t.push(e);return t},allGroupEntries(){var t;return[...((t=this.parent)==null?void 0:t.selectionsIterator())||[]]},operations(){return this.selectedField?{number:[{id:"set",name:"Set",word:"to"},{id:"increment",name:"Increment",word:"by"},{id:"decrement",name:"Decrement",word:"by"}],string:[{id:"set",name:"Set",word:"to"},{id:"append",name:"Append",word:"to"}],"string-or-number":[{id:"set",name:"Set",word:"to"},{id:"append",name:"Append",word:"to"},{id:"increment",name:"Increment",word:"by"},{id:"decrement",name:"Decrement",word:"by"}],boolean:[{id:"set",name:"Set",word:"to"}],defaultSelectionEntryId:[{id:"set",name:"Set",word:""}],category:[{id:"add",name:"Add",word:""},{id:"remove",name:"Remove",word:""},{id:"set-primary",name:"Set Primary",word:"to"},{id:"unset-primary",name:"Unset Primary",word:"to"}]}[this.selectedField.type]:[]},errors(){return[]},fieldData(){if(!this.parent)return[];let t=Qo[this.parent.editorTypeName];const e=[];if(!t)return[];if(t.includes("costs"))for(const a of this.catalogue.iterateCostTypes())e.push({id:a.id,name:a.name,type:"number",modifierType:"cost"});if(t.includes("constraints"))for(const a of this.parent.constraintsIterator())e.push({id:a.id,name:Z(a),type:"number",modifierType:"constraint"});if(t.includes("characteristics")){const a=this.parent.isLink()?this.parent.target:this.parent;a!=null&&a.characteristics&&e.push(...a.characteristics.map(u=>({id:u.typeId,name:u.name,type:"string-or-number",modifierType:"characteristic",value:u.$text})))}return t.includes("category")&&e.push({id:"category",name:"Category",type:"category",modifierType:"category"}),t=t.filter(a=>["costs","constraints","category","characteristics"].includes(a)==!1),t.map(a=>({id:a,name:a,type:Ho[a],modifierType:"bullet"})).concat(e)}}};const se=t=>(N("data-v-1b95edf8"),t=t(),P(),t),Yo=se(()=>l("legend",null,"Modifier",-1)),zo={class:"modifier"},Xo=["value"],Wo={class:"flex align-items flex-row"},Jo=["src"],Zo={class:"inline"},ei={key:1},ti=se(()=>l("option",{value:!0},"True",-1)),ni=se(()=>l("option",{value:!1},"False",-1)),ai=[ti,ni],li={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},oi=["src"],ii={class:"inline"},si={class:"grey"},di={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},ui=["src"],ri={class:"inline"},ci={class:"grey"},gi={class:"mt-8px flex items-center"},mi=se(()=>l("img",{src:Pe},null,-1)),hi={class:"ml-10px"};function _i(t,e,a,u,d,n){const o=Re,i=X,r=Y;return s(),c("fieldset",null,[Yo,l("div",zo,[d.selectedOperation?h((s(),c("select",{key:0,"onUpdate:modelValue":e[0]||(e[0]=g=>d.selectedOperation=g),onChange:e[1]||(e[1]=(...g)=>n.changed&&n.changed(...g))},[(s(!0),c(b,null,A(n.operations,g=>(s(),c("option",{value:g},C(g.name),9,Xo))),256))],544)),[[S,d.selectedOperation]]):y("",!0),m(o,{modelValue:d.selectedField,"onUpdate:modelValue":e[2]||(e[2]=g=>d.selectedField=g),fetch:()=>n.fieldData,onChange:n.fieldChanged,class:"modType min-w-200px"},{option:k(g=>[l("div",Wo,[l("img",{class:"mr-1 my-auto",src:`assets/bsicons/${g.option.modifierType}.png`},null,8,Jo),l("span",Zo,C(g.option.name),1)])]),_:1},8,["modelValue","fetch","onChange"]),d.selectedOperation?(s(),c("span",ei,C(d.selectedOperation.word),1)):y("",!0),n.inputType==="number"?(s(),f(i,{key:2,onChange:n.changed,modelValue:a.item.value,"onUpdate:modelValue":e[3]||(e[3]=g=>a.item.value=g)},null,8,["onChange","modelValue"])):y("",!0),n.inputType=="boolean"?h((s(),c("select",{key:3,onChange:e[4]||(e[4]=(...g)=>n.changed&&n.changed(...g)),"onUpdate:modelValue":e[5]||(e[5]=g=>a.item.value=g)},ai,544)),[[S,a.item.value]]):y("",!0),n.inputType.includes("string")?h((s(),c("input",{key:4,onChange:e[6]||(e[6]=(...g)=>n.changed&&n.changed(...g)),type:"text","onUpdate:modelValue":e[7]||(e[7]=g=>a.item.value=g)},null,544)),[[v,a.item.value]]):y("",!0),n.inputType=="category"?(s(),f(r,{key:5,options:n.allCategories,filterField:g=>g.getName(),valueField:"id",modelValue:a.item.value,"onUpdate:modelValue":e[8]||(e[8]=g=>a.item.value=g),onChange:n.changed},{option:k(({option:g})=>[l("div",li,[l("img",{class:"mr-1 my-auto",src:`assets/bsicons/${g.editorTypeName}.png`},null,8,oi),l("span",ii,[p(C(n.getName(g))+" ",1),l("span",si,C(n.getNameExtra(g)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])):y("",!0),n.inputType=="defaultSelectionEntryId"?(s(),f(r,{key:6,options:n.allGroupEntries,filterField:g=>g.getName(),valueField:"id",modelValue:a.item.value,"onUpdate:modelValue":e[9]||(e[9]=g=>a.item.value=g),onChange:n.changed},{option:k(({option:g})=>[l("div",di,[l("img",{class:"mr-1 my-auto",src:`assets/bsicons/${g.editorTypeName}.png`},null,8,ui),l("span",ri,[p(C(n.getName(g))+" ",1),l("span",ci,C(n.getNameExtra(g)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])):y("",!0)]),(s(!0),c(b,null,A(n.errors,g=>(s(),c("div",gi,[mi,l("span",hi,C(g.msg),1)]))),256))])}const Ci=_(Ko,[["render",_i],["__scopeId","data-v-1b95edf8"]]),pi={emits:["catalogueChanged"],setup(){return{store:$()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},computed:{type(){return this.item.editorTypeName},parent(){return this.item.parent}},methods:{changed(){this.$emit("catalogueChanged")},add(t,e,a,u){e==="id"&&(e=this.item.id);let d=this.item;this.store.create_child("conditions",d,{scope:t,field:e,type:a,value:u,childId:"any"})}}};const j=t=>(N("data-v-5d031eba"),t=t(),P(),t),yi=j(()=>l("legend",null,"Quick Conditions",-1)),fi={class:"columns"},bi={class:"buttonList"},vi=j(()=>l("img",{src:x},null,-1)),ki=j(()=>l("img",{src:x},null,-1)),xi=j(()=>l("img",{src:x},null,-1)),Ti=j(()=>l("img",{src:x},null,-1)),Fi={class:"buttonList"},wi=j(()=>l("img",{src:x},null,-1)),Ii=j(()=>l("img",{src:x},null,-1)),Ni=j(()=>l("img",{src:x},null,-1)),Pi=j(()=>l("img",{src:x},null,-1));function Ri(t,e,a,u,d,n){return s(),c("fieldset",null,[yi,l("div",fi,[l("div",bi,[l("button",{class:"bouton",onClick:e[0]||(e[0]=o=>n.add("parent","selections","atLeast",1))},[vi,p("PARENT ATLEAST 1 ")]),l("button",{class:"bouton",onClick:e[1]||(e[1]=o=>n.add("force","selections","atLeast",1))},[ki,p("FORCE ATLEAST 1 ")]),l("button",{class:"bouton",onClick:e[2]||(e[2]=o=>n.add("roster","selections","atLeast",1))},[xi,p("ROSTER ATLEAST 1 ")]),l("button",{class:"bouton",onClick:e[3]||(e[3]=o=>n.add("ancestor","selections","instanceOf",1))},[Ti,p("ANCESTOR INSTANCE OF ")])]),l("div",Fi,[l("button",{class:"bouton",onClick:e[4]||(e[4]=o=>n.add("parent","selections","lessThan",1))},[wi,p("PARENT LESS THAN 1 ")]),l("button",{class:"bouton",onClick:e[5]||(e[5]=o=>n.add("force","selections","lessThan",1))},[Ii,p("FORCE LESS THAN 1 ")]),l("button",{class:"bouton",onClick:e[6]||(e[6]=o=>n.add("roster","selections","lessThan",1))},[Ni,p("ROSTER LESS THAN 1 ")]),l("button",{class:"bouton",onClick:e[7]||(e[7]=o=>n.add("ancestor","selections","notInstanceOf",1))},[Pi,p("ANCESTOR NOT INSTANCE OF ")])])])])}const Ae=_(pi,[["render",Ri],["__scopeId","data-v-5d031eba"]]),Ai={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Oi(t,e,a,u,d,n){const o=w,i=Ci,r=Ae;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{class:"section",item:a.item,onCatalogueChanged:n.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),m(r,{item:a.item,onCatalogueChanged:n.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Ei=_(Ai,[["render",Oi]]),Vi={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};const J=t=>(N("data-v-5aec87f9"),t=t(),P(),t),Si=J(()=>l("legend",null,"Constraint",-1)),Ui={class:"editorTable"},Li=J(()=>l("td",null,"Unique ID:",-1)),qi={class:"constraint"},ji=J(()=>l("option",{value:"min"},"Minimum",-1)),Bi=J(()=>l("option",{value:"max"},"Maximum",-1)),$i=J(()=>l("option",{value:"exactly"},"Exactly",-1)),Di=[ji,Bi,$i],Gi=J(()=>l("label",{for:"percent"},"Percentage?",-1));function Mi(t,e,a,u,d,n){const o=X;return s(),c("fieldset",null,[Si,l("table",Ui,[l("tr",null,[Li,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>a.item.id=i),onChange:e[1]||(e[1]=(...i)=>n.changed&&n.changed(...i))},null,544),[[v,a.item.id]])])])]),l("div",qi,[h(l("select",{"onUpdate:modelValue":e[2]||(e[2]=i=>a.item.type=i),onChange:e[3]||(e[3]=(...i)=>n.changed&&n.changed(...i))},Di,544),[[S,a.item.type]]),m(o,{modelValue:a.item.value,"onUpdate:modelValue":e[4]||(e[4]=i=>a.item.value=i),onChange:n.changed},null,8,["modelValue","onChange"]),l("div",null,[h(l("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=i=>a.item.percentValue=i),onChange:e[6]||(e[6]=(...i)=>n.changed&&n.changed(...i))},null,544),[[R,a.item.percentValue]]),Gi])])])}const Qi=_(Vi,[["render",Mi],["__scopeId","data-v-5aec87f9"]]);function de(t){var e;return((e=t.catalogue)==null?void 0:e.getName())??null}function ue(t,e,a,u=0){var d,n;for(const o of t[e]())a.push({name:o.name,editorTypeName:o.editorTypeName,id:o.id,indent:u,catalogue:de(o),shared:((n=(d=M(o))==null?void 0:d.parentKey)==null?void 0:n.includes("shared"))||!1}),ue(o,e,a,u+1)}function Hi(t,e,a,u,d=0){var n,o;for(const i of t[e]())u.push({name:i.name,editorTypeName:i.editorTypeName,id:i.id,indent:d,catalogue:de(i),shared:((o=(n=M(i))==null?void 0:n.parentKey)==null?void 0:o.includes("shared"))||!1}),ue(i,e,u,d+1)}function pe(t,e){let a=[];return ue(t,e,a),a}function ge(t,e){const a=[];return ue(t,e?"iterateSelectionEntriesWithRoot":"iterateSelectionEntries",a),a}function Ki(t,e){const a=[],u=t.getPrimaryCategory();return Hi(e,"iterateAllRootEntries",d=>M(d).getPrimaryCategory()===u,a),a}function Oe(t){var a,u;const e=[];for(let d of t.iterateCategoryEntries()){const n=d;n.isCatalogue()||e.push({name:n.name,editorTypeName:n.editorTypeName,id:n.id,indent:0,catalogue:de(n),shared:((u=(a=M(n))==null?void 0:a.parentKey)==null?void 0:u.includes("shared"))||!1})}return e}function Yi(t){const e=[];for(const a of Object.values(t.manager.getAllCatalogueFiles())){if(!a.catalogue)continue;const u=tt(a);e.push({name:u.name,editorTypeName:"catalogue",id:u.id,indent:0,catalogue:null,shared:!1})}return e}function zi(t){let e=0,a=W(t);for(;a;)e++,a=a.parent;return e}function Xi(t){var n,o;let e=[],a=t,u=0;const d=zi(t)-1;for(a=W(t);a!=null&&!a.isCatalogue();)a.editorTypeName==="selectionEntry"&&(e.push({name:a.name,id:a.id,editorTypeName:a.editorTypeName,indent:u,catalogue:de(a),shared:((o=(n=M(a))==null?void 0:n.parentKey)==null?void 0:o.includes("shared"))||!1}),u++),a=a.parent;return e=e.reverse(),e.forEach((i,r)=>{i.indent=r+d}),e}function me(t){const e=pe(t,"iterateRootEntries");return e.splice(0,1),e}function Wi(t){return["self","parent","ancestor","primary-category","primary-catalogue","force","roster"].includes(t.scope)==!1}function M(t){let e=t;for(;e.parent!=null&&e.parent.editorTypeName!="gameSystem"&&e.parent.editorTypeName!="catalogue";)e=e.parent;return e}function Ji(t,e){if(["primary-catalogue","roster","force","ancestor"].includes(t.scope))return ge(e,!0);const u=ge(e,!1);if(t.scope=="self"){const n=W(t);return n?u.concat(me(n)):u}if(t.scope=="parent"){if(M(t))return ge(e,!0);const n=W(t);return n!=null&&n.parent?u.concat(me(n.parent)):u}if(t.scope=="primary-category")return Ki(M(t),e);const d=e.findOptionById(t.scope);return d?u.concat(me(d)):u}const Zi={emits:["catalogueChanged"],data(){return{itemField:null}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},childForces:{type:Boolean,default:!1},childSelections:{type:Boolean,default:!1},shared:{type:Boolean,default:!1}},methods:{getNameExtra:Q,changed(){this.$emit("catalogueChanged")},fieldChanged(){this.item.field=this.itemField.value,this.changed()},showCatalogue(t){var e;return!(!t.catalogue||t.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))}},computed:{instanceOf(){var t;return["instanceOf","notInstanceOf"].includes((t=this.item)==null?void 0:t.type)},fieldTypes(){const t=[];this.instanceOf&&t.push({name:"",value:void 0,type:null}),t.push({name:"Selections",value:"selections",type:"bullet"}),t.push({name:"Forces",value:"forces",type:"bullet"});for(const e of this.costTypes)t.push({name:e.name,value:e.id,type:"cost"}),this.item.scope==="roster"&&t.push({name:`${e.name} Limit`,value:`limit::${e.id}`,type:"cost"});return t},includeCategories(){return this.item.field!=="forces"},includeForces(){return!0},includeSelections(){return this.item.field!="forces"},parent(){return this.item.parent},costTypes(){let t=[];for(let e of this.catalogue.iterateCostTypes())t.push(e);return t},allSelections(){return this.includeSelections?Xi(this.item):[]},allCategories(){return this.includeCategories?Oe(this.catalogue):[]},allForces(){return this.includeForces?pe(this.catalogue,"forcesIterator"):[]},allScopes(){let t=[{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"}];return this.item.field!="forces"&&["condition"].includes(this.item.editorTypeName)&&(t=[{id:"self",name:"Self",editorTypeName:"bullet"},{id:"parent",name:"Parent",editorTypeName:"bullet"},{id:"ancestor",name:"Ancestor",editorTypeName:"bullet",title:"checks the condition in all parents"},{id:"primary-category",name:"Primary Category",editorTypeName:"bullet"},{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"},{id:"primary-catalogue",name:"Primary Catalogue",editorTypeName:"bullet"}]),this.item.field!=="forces"&&["repeat","constraint"].includes(this.item.editorTypeName)&&(t=[{id:"parent",name:"Parent",editorTypeName:"bullet"},{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"},{id:"primary-catalogue",name:"Primary Catalogue",editorTypeName:"bullet"}]),t.concat(this.allSelections).concat(this.allCategories).concat(this.allForces)}},watch:{"item.field":{handler(){this.item.field=="forces"&&(this.item.scope="roster"),this.itemField=this.fieldTypes.find(t=>t.value==this.item.field)},immediate:!0}}};const te=t=>(N("data-v-af476643"),t=t(),P(),t),es=te(()=>l("legend",null,"Query",-1)),ts={class:"query"},ns=["src"],as=te(()=>l("span",null," in ",-1)),ls={style:{"white-space":"nowrap"}},os=["src"],is={class:"gray"},ss={key:1,class:"shared"},ds={key:2,class:"catalogueName"},us={class:"checks"},rs={key:0},cs=te(()=>l("label",{for:"shared"},"Shared",-1)),gs={key:1},ms=te(()=>l("label",{for:"childSelections"},"And all child Selections",-1)),hs={key:2},_s=te(()=>l("label",{for:"childForces"},"And all child Forces",-1));function Cs(t,e,a,u,d,n){const o=Re,i=Y;return s(),c("fieldset",null,[es,l("div",ts,[m(o,{modelValue:d.itemField,"onUpdate:modelValue":e[0]||(e[0]=r=>d.itemField=r),fetch:()=>n.fieldTypes,onChange:n.fieldChanged,class:"modType",disabled:n.instanceOf},{option:k(r=>[l("div",null,[l("img",{class:"mr-1 align-middle",src:`assets/bsicons/${r.option.type}.png`},null,8,ns),p(" "+C(r.option.name),1)])]),_:1},8,["modelValue","fetch","onChange","disabled"]),as,m(i,{modelValue:a.item.scope,"onUpdate:modelValue":e[1]||(e[1]=r=>a.item.scope=r),placeholder:"Search Scope...",options:n.allScopes,valueField:"id",filterField:"name",onChange:n.changed},{option:k(r=>[l("div",ls,[r.option.indent>=2&&!r.selected?(s(!0),c(b,{key:0},A(r.option.indent-1,g=>(s(),c("span",null,"Â Â Â "))),256)):y("",!0),l("img",{class:"mr-1 align-middle",src:`assets/bsicons/${r.option.editorTypeName}.png`},null,8,os),p(" "+C(r.option.name)+" ",1),l("span",is,C(n.getNameExtra(r.option,!1)),1),r.option.shared?(s(),c("span",ss," (shared)")):y("",!0),n.showCatalogue(r.option)?(s(),c("span",ds," ["+C(r.option.catalogue)+"]",1)):y("",!0)])]),_:1},8,["modelValue","placeholder","options","onChange"]),l("div",us,[a.shared?(s(),c("div",rs,[h(l("input",{onChange:e[2]||(e[2]=(...r)=>n.changed&&n.changed(...r)),id:"shared",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=r=>a.item.shared=r)},null,544),[[R,a.item.shared]]),cs])):y("",!0),a.childSelections?(s(),c("div",gs,[h(l("input",{onChange:e[4]||(e[4]=(...r)=>n.changed&&n.changed(...r)),id:"childSelections",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=r=>a.item.includeChildSelections=r)},null,544),[[R,a.item.includeChildSelections]]),ms])):y("",!0),a.childForces?(s(),c("div",hs,[h(l("input",{onChange:e[6]||(e[6]=(...r)=>n.changed&&n.changed(...r)),id:"childForces",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=r=>a.item.includeChildForces=r)},null,544),[[R,a.item.includeChildForces]]),_s])):y("",!0)])])])}const ye=_(Zi,[["render",Cs],["__scopeId","data-v-af476643"]]),ps={emits:["catalogueChanged"],setup(){return{store:$()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},computed:{type(){return this.item.editorTypeName},parent(){return this.item.parent}},methods:{changed(){this.$emit("catalogueChanged")},add(t,e,a){t==="id"&&(t=this.item.id);let u=this.item;this.type==="constraint"&&(u=this.parent),this.store.create_child("modifiers",u,{field:t,type:e,value:a})}}};const ne=t=>(N("data-v-39863412"),t=t(),P(),t),ys=ne(()=>l("legend",null,"Quick Modifiers",-1)),fs={class:"columns"},bs={class:"buttonList"},vs=ne(()=>l("img",{src:x},null,-1)),ks=ne(()=>l("img",{src:x},null,-1)),xs={class:"buttonList"},Ts=ne(()=>l("img",{src:x},null,-1)),Fs=ne(()=>l("img",{src:x},null,-1));function ws(t,e,a,u,d,n){return s(),c("fieldset",null,[ys,l("div",fs,[n.type==="constraint"?(s(),c(b,{key:0},[l("div",bs,[l("button",{class:"bouton",onClick:e[0]||(e[0]=o=>n.add("id","increment",1))},[vs,p("INCREMENT 1 ")]),l("button",{class:"bouton",onClick:e[1]||(e[1]=o=>n.add("id","set",1))},[ks,p("SET 1 ")])]),l("div",xs,[l("button",{class:"bouton",onClick:e[2]||(e[2]=o=>n.add("id","decrement",1))},[Ts,p("DECREMENT 1 ")]),l("button",{class:"bouton",onClick:e[3]||(e[3]=o=>n.add("id","set",0))},[Fs,p("SET 0 ")])])],64)):y("",!0)])])}const Ee=_(ps,[["render",ws],["__scopeId","data-v-39863412"]]),Is=[{id:"any",name:"Anything",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"unit",name:"Unit",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"model",name:"Model",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"upgrade",name:"Upgrade",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1}],Ns={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{getNameExtra:Q,changed(){this.$emit("catalogueChanged")},showCatalogue(t){var e;return!(!t.catalogue||t.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))},availableTargets(){return[...Is,...this.allCategories,...this.allEntries,...this.allForces,...this.allCatalogues]}},watch:{"item.scope"(){var t;this.child||(this.item.childId=((t=this.availableTargets()[0])==null?void 0:t.id)||void 0)}},computed:{childId:{get(){return this.item.childId},set(t){const e=this.item.childId;this.item.childId=t,this.catalogue.updateCondition(this.item,e)}},child(){if(!this.item.childId)return null;const t=this.availableTargets().find(e=>e.id===this.item.childId);return t||this.catalogue.findOptionById(this.item.childId)},instanceOf(){var t;return["instanceOf","notInstanceOf"].includes((t=this.item)==null?void 0:t.type)},allEntries(){return this.includeSelections?Ji(this.item,this.catalogue):[]},allCategories(){return this.includeCategories?Oe(this.catalogue):[]},allForces(){return this.includeForces?pe(this.catalogue,"forcesIterator"):[]},allCatalogues(){return this.includeCatalogues?Yi(this.catalogue):[]},includeSelections(){return!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.instanceOf&&this.item.scope==="primary-category")},includeCategories(){return!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.item.field==="forces")},includeForces(){return this.item.scope=="self"||this.item.scope=="parent"?!1:this.item.scope=="ancestor"?!0:!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.instanceOf&&this.item.scope==="primary-category"||Wi(this.item))},includeCatalogues(){return this.instanceOf&&this.item.scope==="primary-catalogue"}}};const ae=t=>(N("data-v-ee3e1c8d"),t=t(),P(),t),Ps=ae(()=>l("legend",null,"Filter By",-1)),Rs={class:"editorTable"},As=ae(()=>l("td",null,"Of:",-1)),Os={key:0},Es=["src"],Vs=ae(()=>l("td",null,"Child ID:",-1)),Ss=ae(()=>l("td",null,"Child:",-1)),Us={key:0,style:{"white-space":"nowrap"}},Ls=["src"],qs={class:"gray"},js={key:1,class:"shared"},Bs={key:2,class:"catalogueName"},$s=ae(()=>l("label",{for:"shared"},"Shared?",-1));function Ds(t,e,a,u,d,n){const o=Y;return s(),c("fieldset",null,[Ps,l("table",Rs,[l("tr",null,[As,l("td",null,[n.child?(s(),c("span",Os,[l("img",{class:"mr-1 align-middle",src:`assets/bsicons/${n.child.editorTypeName}.png`},null,8,Es),p(" "+C(n.child.name),1)])):y("",!0)])]),l("tr",null,[Vs,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>n.childId=i),onChange:e[1]||(e[1]=(...i)=>n.changed&&n.changed(...i))},null,544),[[v,n.childId]])])]),l("tr",null,[Ss,l("td",null,[m(o,{modelValue:n.childId,"onUpdate:modelValue":e[2]||(e[2]=i=>n.childId=i),placeholder:"Search Child...",options:n.availableTargets,valueField:"id",filterField:"name",onChange:n.changed,default:n.child,lazy:""},{option:k(i=>[i.option?(s(),c("div",Us,[i.option.indent>=1&&!i.selected?(s(!0),c(b,{key:0},A(i.option.indent,r=>(s(),c("span",null,"Â Â Â "))),256)):y("",!0),l("img",{class:"mr-1 align-middle",src:`assets/bsicons/${i.option.editorTypeName}.png`},null,8,Ls),p(" "+C(i.option.name)+" ",1),l("span",qs,C(n.getNameExtra(i.option,!1)),1),i.option.shared?(s(),c("span",js," (shared) ")):y("",!0),n.showCatalogue(i.option)?(s(),c("span",Bs," ["+C(i.option.catalogue)+"]",1)):y("",!0)])):y("",!0)]),_:1},8,["modelValue","placeholder","options","onChange","default"])])])]),h(l("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=i=>a.item.shared=i),id:"shared",onChange:e[4]||(e[4]=(...i)=>n.changed&&n.changed(...i))},null,544),[[R,a.item.shared]]),$s])}const re=_(Ns,[["render",Ds],["__scopeId","data-v-ee3e1c8d"]]),Gs={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{showFilterBy(){var e;return((e=W(this.item))==null?void 0:e.parentKey)==="associations"}},methods:{changed(){this.catalogue.updateCondition(this.item),this.$emit("catalogueChanged")}},components:{FilterBy:re,QuickModifiers:Ee}};function Ms(t,e,a,u,d,n){const o=w,i=Qi,r=ye,g=L("FilterBy"),F=Ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(r,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:n.changed,class:"section",childForces:"",childSelections:"",shared:""},null,8,["catalogue","item","onCatalogueChanged"]),n.showFilterBy?(s(),f(g,{key:0,class:"section",item:a.item,onCatalogueChanged:n.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"])):y("",!0),m(F,{item:a.item,onCatalogueChanged:n.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Qs=_(Gs,[["render",Ms]]),Hs={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Ks=l("legend",null,"Condition Group",-1),Ys={class:"editorTable"},zs=l("td",null,"Type",-1),Xs=l("option",{value:"or"},"Or",-1),Ws=l("option",{value:"and"},"And",-1),Js=[Xs,Ws];function Zs(t,e,a,u,d,n){const o=w;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),l("fieldset",null,[Ks,l("table",Ys,[l("tr",null,[zs,l("td",null,[h(l("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.type=i),onChange:e[1]||(e[1]=(...i)=>n.changed&&n.changed(...i))},Js,544),[[S,a.item.type]])])])])])],64)}const ed=_(Hs,[["render",Zs]]),td={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{ConditionGroup:ed}};function nd(t,e,a,u,d,n){const o=L("ConditionGroup");return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"])])}const ad=_(td,[["render",nd]]),ld={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{allowNonInstanceOf(){return["primary-category","ancestor"].includes(this.item.scope)==!1},instanceOf(){return this.item.type.includes("instance")}},components:{NumberInput:X},watch:{"item.scope"(){const t=["instanceOf","notInstanceOf"];!this.allowNonInstanceOf&&!t.includes(this.item.type)&&(this.item.type=t[0])}}};const fe=t=>(N("data-v-8e6b299b"),t=t(),P(),t),od=fe(()=>l("legend",null,"Condition",-1)),id={class:"condition"},sd=xe('<option value="lessThan" data-v-8e6b299b>Less Than</option><option value="greaterThan" data-v-8e6b299b>Greater Than</option><option value="equalTo" data-v-8e6b299b>Equal To</option><option value="notEqualTo" data-v-8e6b299b>Not Equal To</option><option value="atLeast" data-v-8e6b299b>At Least</option><option value="atMost" data-v-8e6b299b>At Most</option>',6),dd=fe(()=>l("option",{value:"instanceOf"},"Instance Of",-1)),ud=fe(()=>l("option",{value:"notInstanceOf"},"Not Instance Of",-1)),rd=["disabled"];function cd(t,e,a,u,d,n){const o=X;return s(),c("fieldset",null,[od,l("div",id,[h(l("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.type=i),onChange:e[1]||(e[1]=(...i)=>n.changed&&n.changed(...i))},[n.allowNonInstanceOf?(s(),c(b,{key:0},[sd],64)):y("",!0),dd,ud],544),[[S,a.item.type]]),m(o,{disabled:n.instanceOf,modelValue:a.item.value,"onUpdate:modelValue":e[2]||(e[2]=i=>a.item.value=i),onChange:n.changed},null,8,["disabled","modelValue","onChange"]),l("div",null,[h(l("input",{disabled:n.instanceOf,id:"percent",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=i=>a.item.percentValue=i),onChange:e[4]||(e[4]=(...i)=>n.changed&&n.changed(...i))},null,40,rd),[[R,a.item.percentValue]]),l("label",{class:U({disabled:n.instanceOf}),for:"percent"},"Percentage?",2)])])])}const gd=_(ld,[["render",cd],["__scopeId","data-v-8e6b299b"]]),md={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{Condition:gd,FilterBy:re}};function hd(t,e,a,u,d,n){const o=w,i=L("Condition"),r=ye,g=L("FilterBy");return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{class:"section",item:a.item,onCatalogueChanged:n.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),m(r,{class:"section",item:a.item,onCatalogueChanged:n.changed,catalogue:a.catalogue,childForces:"",childSelections:""},null,8,["item","onCatalogueChanged","catalogue"]),m(g,{class:"section",item:a.item,onCatalogueChanged:n.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"])])}const _d=_(md,[["render",hd]]),Cd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function pd(t,e,a,u,d,n){const o=w,i=Ae;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const yd=_(Cd,[["render",pd]]),fd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function bd(t,e,a,u,d,n){const o=w,i=O,r=q,g=H;return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Constraints ")]),_:1},8,["item","onCatalogueChanged"])])}const vd=_(fd,[["render",bd]]),kd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{getNameExtra:Q,changed(){this.$emit("catalogueChanged")}},computed:{children(){let t=[{name:"None",id:void 0,editorTypeName:"bullet"}];for(let e of this.item.entriesIterator())e.isGroup()||t.push(e);return t}}};const Ve=t=>(N("data-v-86874c18"),t=t(),P(),t),xd=Ve(()=>l("legend",null,"Selection Entry Group",-1)),Td={class:"editorTable"},Fd=Ve(()=>l("td",null,"Default Selection:",-1)),wd={style:{"white-space":"nowrap"}},Id=["src"],Nd={class:"gray"},Pd={key:1,class:"merror"};function Rd(t,e,a,u,d,n){const o=Y;return s(),c("fieldset",null,[xd,l("table",Td,[l("tr",null,[Fd,l("td",null,[n.children.length?(s(),f(o,{key:0,modelValue:a.item.defaultSelectionEntryId,"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.defaultSelectionEntryId=i),placeholder:"Search Children...",options:n.children,valueField:"id",filterField:"name",onChange:n.changed},{option:k(i=>[l("div",wd,[i.option.indent>=2&&!i.selected?(s(!0),c(b,{key:0},A(i.option.indent-1,r=>(s(),c("span",null,"Â Â Â "))),256)):y("",!0),l("img",{class:"mr-1 align-middle",src:`assets/bsicons/${i.option.editorTypeName}.png`},null,8,Id),p(" "+C(i.option.name)+" ",1),l("span",Nd,C(n.getNameExtra(i.option,!1)),1)])]),_:1},8,["modelValue","placeholder","options","onChange"])):(s(),c("span",Pd,"This group does not have any child Selection Entries"))])])])])}const Ad=_(kd,[["render",Rd],["__scopeId","data-v-86874c18"]]),Od={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ed(t,e,a,u,d,n){const o=w,i=O,r=q,g=Ad,F=_e,V=Ce,I=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(F,{item:a.item,onCatalogueChanged:n.changed,fields:[{field:"hidden",enabled:!0,name:"Hidden"},{field:"collective",enabled:!1,name:"Collective"},{field:"import",enabled:!0,name:"Import"}],class:"section"},{default:k(()=>[p(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(V,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(I,{item:a.item,onCatalogueChanged:n.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Vd=_(Od,[["render",Ed]]),Sd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Ud=l("legend",null,"Revision",-1),Ld={class:"editorTable"},qd=l("td",null,"Revision Number:",-1);function jd(t,e,a,u,d,n){return s(),c("fieldset",null,[Ud,l("table",Ld,[l("tr",null,[qd,l("td",null,[h(l("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.revision=o),onChange:e[1]||(e[1]=(...o)=>n.changed&&n.changed(...o))},null,544),[[v,a.item.revision]])])])])])}const Bd=_(Sd,[["render",jd]]),$d={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Dd=l("legend",null,"Catalogue",-1),Gd=l("label",{class:"hastooltip",for:"library",title:"indicates that this catalogue is used to store data, no forces may be created from it if true."},"Library",-1);function Md(t,e,a,u,d,n){return s(),c("fieldset",null,[Dd,h(l("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.library=o),onChange:e[1]||(e[1]=(...o)=>n.changed&&n.changed(...o)),id:"library"},null,544),[[R,a.item.library]]),Gd])}const Qd=_($d,[["render",Md]]),Hd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Kd=l("legend",null,"Information",-1),Yd={class:"editorTable"},zd=l("td",null,"Author Name:",-1),Xd=l("td",null,"Author Contact:",-1),Wd=l("td",null,"Author Website:",-1),Jd=l("td",null,"Readme:",-1);function Zd(t,e,a,u,d,n){const o=ie;return s(),c("fieldset",null,[Kd,l("table",Yd,[l("tr",null,[zd,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>a.item.authorName=i),onChange:e[1]||(e[1]=(...i)=>n.changed&&n.changed(...i))},null,544),[[v,a.item.authorName]])])]),l("tr",null,[Xd,l("td",null,[m(o,{modelValue:a.item.authorContact,"onUpdate:modelValue":e[2]||(e[2]=i=>a.item.authorContact=i)},null,8,["modelValue"])])]),l("tr",null,[Wd,l("td",null,[h(l("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=i=>a.item.authorUrl=i),onChange:e[4]||(e[4]=(...i)=>n.changed&&n.changed(...i))},null,544),[[v,a.item.authorUrl]])])]),l("tr",null,[Jd,l("td",null,[m(o,{type:"text",modelValue:a.item.readme,"onUpdate:modelValue":e[5]||(e[5]=i=>a.item.readme=i),onChange:n.changed},null,8,["modelValue","onChange"])])])])])}const eu=_(Hd,[["render",Zd]]),tu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function nu(t,e,a,u,d,n){const o=w,i=O,r=q,g=H,F=Bd,V=Qd,I=eu;return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:n.changed,class:"section"},{default:k(()=>[p(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(F,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(V,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(I,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"])])}const au=_(tu,[["render",nu]]),lu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{NumberInput:X}};const ce=t=>(N("data-v-c7d18dd2"),t=t(),P(),t),ou=ce(()=>l("legend",null,"Repeat",-1)),iu={class:"condition"},su=ce(()=>l("label",null,"times for every ",-1)),du={class:"bools"},uu=ce(()=>l("label",{for:"percent"},"Percentage?",-1)),ru=ce(()=>l("label",{for:"percent"},"Round up?",-1));function cu(t,e,a,u,d,n){const o=X;return s(),c("fieldset",null,[ou,l("div",iu,[m(o,{modelValue:a.item.repeats,"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.repeats=i),onChange:n.changed},null,8,["modelValue","onChange"]),su,m(o,{modelValue:a.item.value,"onUpdate:modelValue":e[1]||(e[1]=i=>a.item.value=i),onChange:n.changed},null,8,["modelValue","onChange"])]),l("div",du,[l("div",null,[h(l("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=i=>a.item.percentValue=i),onChange:e[3]||(e[3]=(...i)=>n.changed&&n.changed(...i))},null,544),[[R,a.item.percentValue]]),uu]),l("div",null,[h(l("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=i=>a.item.roundUp=i),onChange:e[5]||(e[5]=(...i)=>n.changed&&n.changed(...i))},null,544),[[R,a.item.roundUp]]),ru])])])}const gu=_(lu,[["render",cu],["__scopeId","data-v-c7d18dd2"]]),mu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function hu(t,e,a,u,d,n){const o=w,i=gu,r=ye,g=re;return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:n.changed},null,8,["catalogue","item","onCatalogueChanged"]),m(r,{class:"section",item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,childForces:"",childSelections:""},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{class:"section",item:a.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])])}const _u=_(mu,[["render",hu]]),Cu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{ids:{get(){var t;return((t=this.item.ids)==null?void 0:t.join(", "))||""},set(t){this.item.ids=t.split(",").map(e=>e.trim())}}},methods:{changed(){this.$emit("catalogueChanged")}},components:{FilterBy:re}},pu=l("p",{class:"info"},[p(" Associations are a New Recruit specific feature allowing you to associate an entry to another, such as a unit to a bataillon. "),l("br"),p(" Be aware that associations are currently in the beta phase and may undergo modifications. "),l("br"),p(" Feel free to offer feedback or ask questions on our "),l("a",{href:"https://discord.gg/cCtqGbugwb"},"Discord server"),p(". ")],-1),yu={class:"section"},fu=l("legend",null,"Temporary",-1),bu={class:"editorTable"},vu=l("td",null,"min: (may be moved to child constraints)",-1),ku=l("td",null,"max: (may be moved to child constraints)",-1),xu=l("td",null,"label: (will be moved to name)",-1),Tu=l("td",null,"labelMembers:",-1),Fu=l("td",null,"of: (may be moved to ChildID to reuse filterBy)",-1),wu=l("td",null,"type: (will be removed, only affects conditions)",-1),Iu=l("option",{value:"or"},"or",-1),Nu=l("option",{value:"and"},"and",-1),Pu=[Iu,Nu],Ru=l("td",null,"scope: ",-1),Au=l("td",{class:"underline",title:"Ids are a string[], used by associationConstraints on entries, eg: to have a maximum number of commanders in a bataillion"}," ids: ",-1);function Ou(t,e,a,u,d,n){const o=w,i=O,r=L("FilterBy");return s(),c("div",null,[pu,m(o,{item:a.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:n.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{class:"section",item:a.item,onCatalogueChanged:n.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),l("fieldset",yu,[fu,l("table",bu,[l("tr",null,[vu,l("td",null,[h(l("input",{onInput:e[0]||(e[0]=(...g)=>n.changed&&n.changed(...g)),"onUpdate:modelValue":e[1]||(e[1]=g=>a.item.min=g),type:"number"},null,544),[[v,a.item.min]])])]),l("tr",null,[ku,l("td",null,[h(l("input",{onInput:e[2]||(e[2]=(...g)=>n.changed&&n.changed(...g)),"onUpdate:modelValue":e[3]||(e[3]=g=>a.item.max=g),type:"number"},null,544),[[v,a.item.max]])])]),l("tr",null,[xu,l("td",null,[h(l("input",{onInput:e[4]||(e[4]=(...g)=>n.changed&&n.changed(...g)),"onUpdate:modelValue":e[5]||(e[5]=g=>a.item.label=g),type:"text"},null,544),[[v,a.item.label]])])]),l("tr",null,[Tu,l("td",null,[h(l("input",{onInput:e[6]||(e[6]=(...g)=>n.changed&&n.changed(...g)),"onUpdate:modelValue":e[7]||(e[7]=g=>a.item.labelMembers=g),type:"text"},null,544),[[v,a.item.labelMembers]])])]),l("tr",null,[Fu,l("td",null,[h(l("input",{onInput:e[8]||(e[8]=(...g)=>n.changed&&n.changed(...g)),"onUpdate:modelValue":e[9]||(e[9]=g=>a.item.of=g),type:"text"},null,544),[[v,a.item.of]])])]),l("tr",null,[wu,l("td",null,[h(l("select",{onChange:e[10]||(e[10]=(...g)=>n.changed&&n.changed(...g)),"onUpdate:modelValue":e[11]||(e[11]=g=>a.item.type=g)},Pu,544),[[S,a.item.type]])])]),l("tr",null,[Ru,l("td",null,[h(l("input",{onInput:e[12]||(e[12]=(...g)=>n.changed&&n.changed(...g)),"onUpdate:modelValue":e[13]||(e[13]=g=>a.item.scope=g),type:"text"},null,544),[[v,a.item.scope]])])]),l("tr",null,[Au,l("td",null,[h(l("input",{"onUpdate:modelValue":e[14]||(e[14]=g=>a.item.ids=g),onInput:e[15]||(e[15]=(...g)=>n.changed&&n.changed(...g)),type:"text"},null,544),[[v,a.item.ids]])])])])])])}const Eu=_(Cu,[["render",Ou]]),Vu={props:{item:{type:Object,required:!0}},setup(){return{store:$()}},methods:{gotoTarget(t){return t.isCategory()?t.parent:t},parentEntry(t){return nt(t,e=>e.getName())}},computed:{show_link_name(){return this.item instanceof at},links(){var t;return((t=this.item)==null?void 0:t.links)||[]},other_links(){var t;return((t=this.item)==null?void 0:t.other_links)||[]},label(){return Z(this.item)}}};const Su={class:"text-center"},Uu=l("span",{class:"gray"},"References to",-1),Lu={class:"mb-20px"},qu=l("tr",null,[l("th",null," Catalogue "),l("th",null," Name ")],-1),ju={class:"gray"},Bu=["onClick"],$u={key:0},Du=l("h3",null," From conditions/constraints/modifiers/repeats: ",-1),Gu={class:"mb-20px"},Mu=l("tr",null,[l("th",null," Catalogue "),l("th",null," Name "),l("th",null," Type "),l("th",null," Details ")],-1),Qu={class:"gray"},Hu=["onClick"];function Ku(t,e,a,u,d,n){return s(),c("div",null,[l("h2",Su,[Uu,p(" "+C(n.label),1)]),l("table",Lu,[qu,(s(!0),c(b,null,A(n.links,o=>{var i,r;return s(),c("tr",null,[l("td",ju,C(o.isCatalogue()?o.getName():(i=o.catalogue)==null?void 0:i.getName()),1),l("td",null,[n.show_link_name?(s(),c(b,{key:0},[p(C(o.getName()),1)],64)):(s(),c(b,{key:1},[p(C((r=o.parent)==null?void 0:r.getName()),1)],64))]),l("td",null,[l("button",{onClick:g=>u.store.goto(n.gotoTarget(o))},"Goto",8,Bu)])])}),256))]),n.other_links.length?(s(),c("div",$u,[Du,l("table",Gu,[Mu,(s(!0),c(b,null,A(n.other_links,o=>{var i,r;return s(),c("tr",null,[l("td",Qu,C(o.isCatalogue()?o.getName():(i=o.catalogue)==null?void 0:i.getName()),1),l("td",null,C(((r=n.parentEntry(o))==null?void 0:r.getName())||"No parent (likely a bug)"),1),l("td",null,C(o.editorTypeName),1),l("td",null,C(o.type)+" "+C(o.value),1),l("td",null,[l("button",{onClick:g=>u.store.goto(o)},"Goto",8,Hu)])])}),256))])])):y("",!0)])}const Yu=_(Vu,[["render",Ku]]),zu={setup(){return{store:$()}},emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0}},data(){return{links:["link","selectionEntryLink","selectionEntryGroupLink"],infoLinks:["infoLink","profileLink","ruleLink","infoGroupLink"]}},methods:{changed(){var t;this.store.set_catalogue_changed(((t=this.item)==null?void 0:t.catalogue)||this.catalogue)}},computed:{item(){return this.store.get_selected()},typeName(){var t;return(t=this.item)==null?void 0:t.editorTypeName}}};const Xu={key:0,class:"rightPanel h-full"},Wu=l("div",{class:"min-h-100px"},null,-1);function Ju(t,e,a,u,d,n){const o=$t,i=Jt,r=Cn,g=Qa,F=Ya,V=dl,I=_l,D=uo,B=Bo,Se=Ei,Ue=Qs,Le=ad,qe=_d,je=yd,Be=vd,$e=Vd,De=au,Ge=_u,Me=Eu,Qe=Yu;return n.item?(s(),c("div",Xu,[u.store.mode==="edit"?(s(),c(b,{key:0},[n.typeName=="publication"?(s(),f(o,{key:0,item:n.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"])):n.typeName=="costType"?(s(),f(i,{key:1,item:n.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"])):n.typeName=="profileType"?(s(),f(r,{key:2,item:n.item,onCatalogueChanged:n.changed},null,8,["item","onCatalogueChanged"])):n.typeName=="category"?(s(),f(g,{key:3,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="force"?(s(),f(F,{key:4,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="profile"?(s(),f(V,{key:5,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="rule"?(s(),f(I,{key:6,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="selectionEntry"?(s(),f(D,{key:7,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):d.links.includes(n.typeName)?(s(),f(B,{key:8,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,type:"entry"},null,8,["item","catalogue","onCatalogueChanged"])):d.infoLinks.includes(n.typeName)?(s(),f(B,{key:9,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,type:"info"},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="modifier"?(s(),f(Se,{key:10,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="constraint"?(s(),f(Ue,{key:11,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="conditionGroup"?(s(),f(Le,{key:12,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="condition"?(s(),f(qe,{key:13,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="categoryLink"?(s(),f(B,{key:14,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,type:"category"},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="modifierGroup"?(s(),f(je,{key:15,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="infoGroup"?(s(),f(Be,{key:16,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="selectionEntryGroup"?(s(),f($e,{key:17,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="catalogueLink"?(s(),f(B,{key:18,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="catalogue"||n.typeName=="gameSystem"?(s(),f(De,{key:19,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="repeat"?(s(),f(Ge,{key:20,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):n.typeName=="association"?(s(),f(Me,{key:21,item:n.item,catalogue:a.catalogue,onCatalogueChanged:n.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):y("",!0),Wu],64)):u.store.mode==="references"?(s(),f(Qe,{key:1,item:n.item,catalogue:a.catalogue},null,8,["item","catalogue"])):y("",!0)])):y("",!0)}const Zu=_(zu,[["render",Ju]]),er=oe({components:{LeftPanel:Zn},data(){return{error:null,item:null,systemFiles:null,loading:!1,loading_all:!1,loading_progress:0,loading_progress_max:0,loading_progress_msg:"",saving:!1,failed:!1,id:"",cat:null,defaults:{},key:1}},setup(){return{cataloguesStore:lt(),store:$(),uistate:ot()}},mounted(){this.store.init(this),globalThis.$catalogue=this.cat,window.addEventListener("beforeunload",this.beforeUnload),document.addEventListener("keydown",this.onKeydown,!0)},updated(){this.store.init(this),globalThis.$catalogue=this.cat},unmounted(){window.removeEventListener("beforeunload",this.beforeUnload),document.removeEventListener("keydown",this.onKeydown,!0)},activated(){window.addEventListener("beforeunload",this.beforeUnload)},deactivated(){window.removeEventListener("beforeunload",this.beforeUnload)},beforeRouteUpdate(){this.id&&this.store.save_state()},beforeRouteLeave(){this.id&&this.store.save_state()},computed:{changed(){var t;return this.cat&&((t=this.store.get_catalogue_state(this.cat))==null?void 0:t.changed)||!1},unsaved(){var t;return this.cat&&((t=this.store.get_catalogue_state(this.cat))==null?void 0:t.unsaved)||!1},query(){return{gameSystemId:this.$route.query.systemId,catalogueId:this.$route.query.id||this.$route.query.systemId}},route_is_catalogue(){return this.$route.name==="catalogue"}},watch:{query:{async handler(t){var u;if(!this.route_is_catalogue)return;const{gameSystemId:e,catalogueId:a}=t;this.id=a||e,this.store.unselect();try{await this.load(e,this.id),(u=this.systemFiles)==null||u.loadAll(),this.error=null,this.$nextTick(()=>{this.store.$nextTickResolve&&this.store.$nextTickResolve()})}catch(d){console.error(d),this.error=d}},immediate:!0}},methods:{async load_all(){if(this.systemFiles)try{this.loading_all=!0,await new Promise(t=>setTimeout(t,0)),await this.systemFiles.loadAll(async(t,e,a)=>{this.loading_progress=t,this.loading_progress_max=e,this.loading_progress_msg=a,await new Promise(u=>setTimeout(u,0))}),this.loading_progress=0,this.loading_progress_max=0,this.loading_progress_msg=""}catch(t){console.error(t)}finally{this.loading_all=!0}},async save_all(){var t;try{this.failed=await this.store.save_all((t=this.cat)==null?void 0:t.getSystemId())}finally{this.saving=!1}},async save(){try{await this.store.save_catalogue(this.systemFiles,this.cat)&&notify("Incremented 1 catalogue's revision"),this.failed=!1}catch{this.failed=!0}},async test(){var t;if(!((t=this.systemFiles)!=null&&t.github)){console.error("no github set");return}console.log("revision",await it(this.systemFiles.github,this.cat))},async beforeUnload(t){if(!globalThis._closeWindow&&(this.loading||this.store.save_state(),this.unsaved||this.store.unsavedCount)){const e="You have unsaved changes that will be lost";return t.returnValue=e,electron&&setTimeout(async()=>{await st({message:"You have unsaved changes that will be lost?",buttons:["Cancel","Leave"],defaultId:0,cancelId:0,type:"question"})===1&&(globalThis._closeWindow=!0,dt())}),!1}},onKeydown(t){t.ctrlKey&&t.key.toLowerCase()=="s"&&(t.preventDefault(),t.stopPropagation(),this.save())},load_state(t){this.defaults=t},async load(t,e){if(!e&&!t)throw new Error("couldn't load catalogue: no id");try{this.loading=!0;const a=await this.store.get_or_load_system(t);let u=a.getLoadedCatalogue({targetId:e||t});u||(u=await a.loadCatalogue({targetId:e||t})),u.processForEditor();for(const d of u.imports)d.processForEditor();if(this.systemFiles=a,this.cat=u,u){const d=this.uistate.get_data(u.id);this.load_state(d)}}finally{this.loading=!1}}}});const tr={class:"h-full"},nr={key:0},ar={class:"ml-10px"},lr={class:"text-slate-300"},or={key:1,class:"status mx-2 text-red"},ir={key:2,class:"status mx-2"},sr={key:0};function dr(t,e,a,u,d,n){const o=gt,i=mt,r=Xe,g=L("LeftPanel"),F=Zu,V=ut;return s(),c("div",tr,[m(i,null,{default:k(()=>[m(o,null,{default:k(()=>{var I;return[p(C(t.loading?"Loading...":[(I=t.cat)==null?void 0:I.getName(),"NR-Editor"].filter(D=>D).join(" - ")),1)]}),_:1})]),_:1}),t.error?(s(),c("span",nr,C(t.error),1)):t.loading?(s(),f(r,{key:1,progress:t.loading_progress,progress_max:t.loading_progress_max,progress_msg:t.loading_progress_msg},null,8,["progress","progress_max","progress_msg"])):t.cat?(s(),f(V,{key:2,class:"h-full",draggable:"",showMiddle:"",id:"catalogueView"},{left:k(()=>[(s(),f(g,{ref:"leftpanel",class:"h-full",catalogue:t.cat,defaults:t.defaults,key:t.key,keepalive:""},null,8,["catalogue","defaults"]))]),middle:k(()=>[t.store.selectedItem!=null?(s(),f(F,{key:0,class:"h-full overflow-y-auto",catalogue:t.cat},null,8,["catalogue"])):y("",!0)]),_:1})):y("",!0),t.cat&&t.route_is_catalogue?(s(),f(ze,{key:3,to:"#titlebar-content"},[l("span",ar,[p(" Editing "+C(t.cat.name)+" ",1),l("span",lr,"v"+C(t.cat.revision),1)]),t.store.unsavedCount?(s(),c("button",{key:0,class:"bouton save ml-10px",onClick:e[0]||(e[0]=(...I)=>t.save_all&&t.save_all(...I))}," Save All ")):t.failed?(s(),c("span",or,"failed to save")):(s(),c("span",ir,"saved")),t.systemFiles&&!t.systemFiles.allLoaded?(s(),c("button",{key:3,class:"bouton load ml-10px",onClick:e[1]||(e[1]=(...I)=>t.load_all&&t.load_all(...I))},[p("Load all "),t.loading_all?(s(),c("span",sr,"("+C(t.loading_progress)+" / "+C(t.loading_progress_max)+")",1)):y("",!0)])):y("",!0)])):y("",!0)])}const mr=_(er,[["render",dr],["__scopeId","data-v-b51f7edd"]]);export{mr as default};
//# sourceMappingURL=catalogue.ed09377a.js.map
