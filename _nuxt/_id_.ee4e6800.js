import{u as w,a as $,g as C,o as N}from"./editorStore.383ba575.js";import{e as M,s as _,a as b,C as P,b as i,i as e,w as g,v as F,U as I,F as f,m as y,t as h,q as m,k as T,L as k,o as r,c as B}from"./entry.592442ae.js";import{N as E}from"./NodePath.d3d7f66c.js";function L(s){return Math.round(s*100)/100}function S(s){let t="";s=_(s,a=>a.name);for(const a of s)if(a.value!=0){let p="";a.name.length!=0&&(p=" "+a.name),t=`${t}<span class='cost'>${L(a.value)}${p}</span>`}return t.length==0?t:`<span class="costList">${t}</span>`}const V=M({setup(){return{store:w()}},data(){return{filter:"",results:null,count:null,searching:!1,more:!1,page:0,max_display:30,max_results:1e3,showFullPath:!1}},computed:{async system(){return await this.store.get_or_load_system(this.$route.params.id)},data(){return{filter:this.filter}},from(){return this.count===null?0:Math.min(this.page*this.max_display,this.count)},to(){return this.count===null?0:Math.min(this.page*this.max_display+this.max_display,this.count)},last_page(){return this.count===null?0:Math.ceil(this.count/this.max_display)-1},displayed_results(){let s=0;const t=this.from,a=this.to,p={};for(const d in this.results){const u=this.results[d],o=u.length;let n=o;if(s+o>a){const c=s+o,l=Math.max(c-a,0);n=o-l}if(s+o>=t){const c=Math.max(t-s,0);o&&n>c&&(p[d]=u.slice(c,n))}if(s+=o,s>a)break}return p},displayed_count(){let s=0;for(const t in this.displayed_results)s+=this.displayed_results[t].length;return s}},methods:{getName:$,getNameExtra:C,path(s){const t=N(s);return t.pop(),t.shift(),t},async search(){try{this.searching=!0,await this.$nextTick(()=>this.$forceUpdate()),await new Promise(t=>setTimeout(t,5));const s=await this.store.system_search(await this.system,this.data,this.max_results);if(!s){this.results=null,this.count=null,this.more=!1;return}this.more=s.more,this.results=s.grouped,this.count=s.all.length}catch(s){console.error(s)}finally{this.page=0,this.searching=!1}},costs(s){var d;const t=[],a=s.getCatalogue(),p=s.getCosts();for(const u of p){const o=((d=a.findOptionById(u.typeId))==null?void 0:d.name)||u.name||u.typeId;o&&t.push({name:o,value:u.value,typeId:u.typeId})}return S(t)}},components:{NodePath:E}}),D={class:"ml-20px mt-10px h-full overflow-y-auto"},U={key:0},H=e("label",{for:"show-fullpath"},"Show Full Path",-1),K=e("div",null,null,-1),q={key:0,class:"pb-50px"},A={class:"bold"},O={class:"ml-8px"},j=["onClick"],x={class:"typeIcon-wrapper"},z=["src"],G={key:0,class:"gray"},J=["innerHTML"];function Q(s,t,a,p,d,u){const o=P("NodePath");return r(),i("div",D,[e("div",null,[g(e("input",{type:"search","onUpdate:modelValue":t[0]||(t[0]=n=>s.filter=n),onKeydown:t[1]||(t[1]=I((...n)=>s.search&&s.search(...n),["enter"]))},null,544),[[F,s.filter]]),e("button",{class:"inputstyle",onClick:t[2]||(t[2]=(...n)=>s.search&&s.search(...n))}," Search "),s.searching?(r(),i("span",U," Searching...")):s.count!==null?(r(),i(f,{key:1},[e("span",null,[y("Found "+h(s.count),1),s.more?(r(),i(f,{key:0},[y("+")],64)):m("",!0),y(" results")]),e("span",null,", Displaying "+h(s.displayed_count)+" results",1)],64)):m("",!0)]),e("button",{class:"inputstyle w-28px",onClick:t[3]||(t[3]=n=>s.page=Math.max(0,s.page-1))}," < "),e("button",{class:"inputstyle w-28px",onClick:t[4]||(t[4]=n=>s.page=Math.min(s.last_page,s.page+1))}," > "),y(" Page "+h(s.page+1)+" / "+h(s.last_page+1)+" ",1),g(e("input",{type:"checkbox",id:"show-fullpath","onUpdate:modelValue":t[5]||(t[5]=n=>s.showFullPath=n)},null,512),[[T,s.showFullPath]]),H,K,s.results?(r(),i("div",q,[(r(!0),i(f,null,k(s.displayed_results,(n,c)=>(r(),i("div",null,[e("span",A,h(c),1),e("div",O,[(r(!0),i(f,null,k(n,l=>(r(),i("div",{class:"hover-darken cursor-pointer",onClick:v=>s.store.goto(l)},[s.showFullPath&&s.path(l).length?(r(),B(o,{key:0,path:s.path(l),onClick:v=>s.store.goto(l),class:"inline hover-darken cursor-pointer p-1px","end-arrow":""},null,8,["path","onClick"])):m("",!0),e("span",null,[e("span",x,[e("img",{class:"typeIcon mr-4px",src:`/assets/bsicons/${l.editorTypeName}.png`},null,8,z)]),e("span",null,h(s.getName(l)),1),s.getNameExtra(l)?(r(),i("span",G,"Â "+h(s.getNameExtra(l)),1)):m("",!0),s.costs(l)?(r(),i("span",{key:1,class:"ml-10px",innerHTML:s.costs(l)},null,8,J)):m("",!0)])],8,j))),256))])]))),256))])):m("",!0)])}const Y=b(V,[["render",Q]]);export{Y as default,S as formatCosts};
//# sourceMappingURL=_id_.ee4e6800.js.map
