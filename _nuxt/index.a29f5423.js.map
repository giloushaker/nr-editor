{"version":3,"file":"index.a29f5423.js","sources":["../../../../components/UploadJson.vue","../../../../components/ImportFromGithub.vue","../../../../components/IconContainer.vue","../../../../components/my_catalogues/CataloguesDetail.vue","../../../../components/my_catalogues/CataloguesCreate.vue","../../../../pages/index.vue","../../../../assets/icons/search.png"],"sourcesContent":["<template>\n  <input\n    type=\"file\"\n    accept=\".gst, .gstz, .xml, .zip, .cat, .catz, .json\"\n    multiple\n    @change=\"onFileSelected\"\n    class=\"invisible\"\n    ref=\"fileinput\"\n  />\n  <button @click=\"popFileInput\" class=\"bouton\" :disabled=\"uploading\">\n    <template v-if=\"!uploading\"> Import Catalogues </template>\n    <template v-else> ... </template>\n  </button>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  convertToJson,\n  getExtension,\n  isAllowedExtension,\n  isZipExtension,\n} from \"~/assets/shared/battlescribe/bs_convert\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nconst fileinput = ref(null);\nconst uploading = ref(false);\nconst emit = defineEmits<{\n  (e: \"uploaded\", files: Object[]): void;\n}>();\n\nasync function onFileSelected(event: any) {\n  try {\n    uploading.value = true;\n    const input_files = [...((event.target?.files as FileList | null) || [])];\n    if (!input_files) {\n      uploading.value = false;\n      return;\n    }\n\n    const result_files = [] as Object[];\n    for (const file of input_files.filter((o) => isAllowedExtension(o.name))) {\n      const content = isZipExtension(file.name) ? await file.arrayBuffer() : await file.text();\n      const asJson = await convertToJson(content, getExtension(file.name));\n      getDataObject(asJson).fullFilePath = file.name;\n      result_files.push(asJson);\n    }\n    if (result_files.length) {\n      emit(\"uploaded\", result_files);\n    }\n    uploading.value = false;\n  } catch (e) {\n    console.error(e);\n    uploading.value = false;\n  }\n}\nasync function popFileInput() {\n  (fileinput.value as any).click();\n}\n</script>\n<style scoped lang=\"scss\">\n.invisible {\n  opacity: 0; /* make transparent */\n  z-index: -1; /* move under anything else */\n  position: absolute; /* don't let it take up space */\n}\n</style>\n","<script setup lang=\"ts\">\nimport { convertToJson, getExtension, isAllowedExtension, unzipFolder } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nimport { normalizeGithubRepoUrl } from \"~/assets/shared/battlescribe/github\";\nconst inputUrl = ref(\"\");\nconst busy = ref(false);\nconst emit = defineEmits<{\n  (e: \"uploaded\", files: Object[]): void;\n}>();\nasync function submit(url: string | null) {\n  if (!url || normalizeGithubRepoUrl(url) !== url) {\n    console.log(\"bad url\", url);\n    return;\n  }\n  try {\n    busy.value = true;\n    // Get the zip of the repo:\n    const repoPath = url.split(\"/\").slice(-2).join(\"/\"); // BSData/wh40k\n    const repoName = repoPath.split(\"/\")[1];\n    const apiUrl = `https://api.github.com/repos/${repoPath}`;\n    const defaultBranch = (await $fetch<any>(apiUrl)).default_branch; // master\n    const zipDlUrl = `https://codeload.github.com/${repoPath}/zip/refs/heads/${defaultBranch}`;\n\n    // Download the zip through a cors proxy\n    const zipFile = await $fetch<Blob>(`https://corsproxy.io/?${zipDlUrl}`);\n\n    // Extract the useful files\n    const folder = await unzipFolder(zipFile, `${repoName}-${defaultBranch}`);\n    const result_files = [] as Object[];\n    for (const [name, content] of Object.entries(folder)) {\n      const extension = getExtension(name);\n      if (isAllowedExtension(extension)) {\n        try {\n          const json = await convertToJson(content, extension);\n          getDataObject(json).fullFilePath = name;\n          result_files.push(json);\n        } catch (e) {\n          continue;\n        }\n      }\n    }\n    if (result_files.length) {\n      emit(\"uploaded\", result_files);\n    }\n    inputUrl.value = \"\";\n  } catch (e) {\n    console.error(e);\n  } finally {\n    busy.value = false;\n  }\n}\n</script>\n<template>\n  <input type=\"text\" class=\"bouton !font-normal\" v-model=\"inputUrl\" placeholder='repo eg: \"BSData/wh40k\"' />\n  <button\n    @click=\"submit(normalizeGithubRepoUrl(inputUrl))\"\n    class=\"bouton\"\n    :disabled=\"normalizeGithubRepoUrl(inputUrl) == null || busy\"\n  >\n    {{ busy ? \"...\" : \"Import from github\" }}\n  </button>\n</template>\n","<template>\n  <div class=\"items\">\n    <div\n      v-for=\"item of sortedItems\"\n      class=\"relative item unselectable\"\n      :class=\"{ highlight: opened(item), selected: item === modelValue }\"\n      @click=\"elementClicked(item)\"\n      @dblclick=\"elementDoubleClicked(item)\"\n      @click.middle=\"debug(item)\"\n    >\n      <img class=\"icon\" :src=\"getType(item).icon\" />\n      <div>{{ name(item) }}</div>\n      <div class=\"error flex flex-row\">\n        <span\n          class=\"my-auto\"\n          v-if=\"changed(item)\"\n          title=\"This file was changed by another program.\nYou may want to reload the system through the Systems tab\"\n        >\n          <img class=\"my-auto align-text-bottom\" src=\"/assets/icons/warning_sign.png\" />\n        </span>\n        <ErrorIcon :errors=\"errors(item)\" />\n      </div>\n    </div>\n    <div class=\"relative item add unselectable\" @click=\"add\">\n      <img class=\"w-40px h-40px\" src=\"/assets/icons/iconeplus.png\" />\n      <div class=\"bold text-blue\">New</div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { addOne, capitalize, sortByAscending } from \"~/assets/shared/battlescribe/bs_helpers\";\nimport { BSIData } from \"~/assets/shared/battlescribe/bs_types\";\nimport ErrorIcon, { IErrorMessage } from \"./ErrorIcon.vue\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\nexport default {\n  emits: [\"new\", \"itemClicked\", \"itemDoubleClicked\"],\n  setup() {\n    return { cataloguesStore: useCataloguesStore(), store: useEditorStore() };\n  },\n  props: {\n    items: {\n      type: Array as PropType<BSIData[]>,\n      required: true,\n    },\n    modelValue: {\n      required: true,\n    },\n  },\n  methods: {\n    debug(item) {\n      console.log(item);\n    },\n    getDataObject,\n    getType(item: BSIData) {\n      if (item.gameSystem) {\n        return { icon: \"assets/icons/system1.png\", order: 1 };\n      } else if (item.catalogue?.library) {\n        return { icon: \"assets/icons/library.png\", order: 2 };\n      } else {\n        return { icon: \"assets/icons/book.png\", order: 3 };\n      }\n    },\n    elementDoubleClicked(item: BSIData) {\n      this.$emit(\"itemDoubleClicked\", item);\n    },\n    elementClicked(item: BSIData) {\n      this.$emit(\"itemClicked\", item);\n    },\n    changed(data: BSIData) {\n      return this.store.get_catalogue_state(data).isChangedOnDisk;\n    },\n    errors(data: BSIData): IErrorMessage[] {\n      const result = [] as IErrorMessage[];\n      if (this.store.get_catalogue_state(data)?.unsaved) {\n        result.push({\n          severity: \"info\",\n          msg: \"Unsaved\",\n        });\n      }\n      const errors = (getDataObject(data) as any as { errors: IErrorMessage[] }).errors;\n\n      if (errors?.length) {\n        const counts = {} as Record<string, number>;\n\n        for (const error of errors) {\n          if (error.severity) {\n            addOne(counts, error.severity);\n          } else {\n            addOne(counts, \"error\");\n          }\n        }\n\n        let msgPieces = [];\n        for (const key in counts) {\n          msgPieces.push(`${counts[key]} ${capitalize(key)}${counts[key] === 1 ? \"\" : \"s\"}`);\n        }\n        if (errors.find((o) => o.severity === \"error\")) {\n          result.push({\n            severity: \"error\",\n            msg: `Has ${msgPieces.join(\", \")}`,\n          });\n        } else if (errors.find((o) => o.severity === \"warning\")) {\n          result.push({\n            severity: \"warning\",\n            msg: `Has ${msgPieces.join(\", \")}`,\n          });\n        }\n      }\n      return result;\n    },\n    opened(data: BSIData) {\n      return (getDataObject(data) as any).opened;\n    },\n    name(data: BSIData) {\n      return getDataObject(data).name;\n    },\n    add() {\n      this.$emit(\"new\");\n    },\n  },\n  computed: {\n    sortedItems() {\n      return sortByAscending(\n        sortByAscending(this.items, (o) => this.name(o)),\n        (o) => this.getType(o).order\n      );\n    },\n  },\n  components: { ErrorIcon },\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import \"@/shared_components/css/vars.scss\";\n\n.item {\n  display: grid;\n  grid-template-columns: \"max-content\";\n  align-items: center;\n  justify-items: center;\n  &:last-child {\n    margin-right: 0;\n  }\n  font-size: 12px;\n  border: 1px $box_border solid;\n  padding: 3px;\n  border-radius: 5px;\n  box-shadow: $box_shadow;\n  color: $fontColor;\n  cursor: pointer;\n  width: 100px;\n  text-align: center;\n}\n\n.items {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));\n  grid-gap: 5px 0px;\n  grid-auto-rows: 1fr;\n  align-items: stretch;\n}\n\n.error {\n  position: absolute;\n  right: 5px;\n  top: 5px;\n}\n\n.item:hover {\n  background-color: rgba($color: #000000, $alpha: 0.05);\n}\n.selected {\n  border: solid black 2px;\n  padding: 2px;\n}\n\n.highlight {\n  background-color: rgba(40, 120, 250, 0.15);\n}\n.add {\n  border: solid rgb(45, 190, 45) 2px;\n}\n</style>\n","<template>\n  <fieldset class=\"details\">\n    <div>\n      <legend>{{ cataloguedata.name }}</legend>\n      <div v-if=\"is_catalogue\">\n        <span class=\"grey hastooltip\"\n          title=\"indicates that this catalogue is used to store data, no forces may be created from it if true.\">\n          Library:\n        </span>\n        {{ (cataloguedata as BSICatalogue).library }}\n      </div>\n      <div><span class=\"grey\">Id:</span> {{ cataloguedata.id }}</div>\n      <div><span class=\"grey\">path:</span> <span style=\"word-break: break-all;\">{{ cataloguedata.fullFilePath }}</span>\n      </div>\n      <div v-if=\"electron\"> <span class=\"grey\">authorUrl:</span> {{ cataloguedata.authorUrl }} </div>\n      <div>\n        <span class=\"grey\">authorContact:</span>\n        {{ cataloguedata.authorContact }}\n      </div>\n      <div> <span class=\"grey\">authorName:</span> {{ cataloguedata.authorName }} </div>\n      <div v-if=\"(cataloguedata as BSICatalogue).catalogueLinks?.length\">\n        <span class=\"bold\">imports:</span>\n        <div class=\"ml-10px\">\n          <div v-for=\"link in (cataloguedata as BSICatalogue).catalogueLinks\">\n            <span :class=\"{ grey: !link.importRootEntries }\">\n              {{ link.name }}\n            </span>\n          </div>\n        </div>\n      </div>\n      <div v-if=\"refs.length && !isSystem\">\n        <span class=\"bold\">imported by:</span>\n        <div class=\"ml-10px\">\n          <div v-for=\"ref in refs\">\n            <span :class=\"{ grey: !ref.importRootEntries }\">\n              {{ ref.sourceName }}\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"section boutons\">\n      <button class=\"bouton\" @click=\"$emit('edit', catalogue)\">Edit</button>\n      <button class=\"bouton\" @click=\"deletePopup = true\">Delete</button>\n      <button class=\"bouton\" @click=\"download_file\">Download</button>\n      <button class=\"bouton\" v-if=\"isSystem\" @click=\"popup_change_format\">Change File Format</button>\n      <p class=\"info\"> To quickly edit a catalogue, you can double-click on it. </p>\n    </div>\n    <PopupDialog button=\"Confirm\" text=\"Cancel\" @button=\"$emit('delete', catalogue)\" v-model=\"deletePopup\"\n      v-if=\"deletePopup\">\n      <div>Are you sure you want to delete this {{ is_catalogue ? \"catalogue\" : \"Game System\" }}?</div>\n    </PopupDialog>\n    <PopupDialog button=\"Confirm\" text=\"Cancel\" @button=\"change_format(format, deleteExistingFiles)\"\n      v-model=\"changeFormatPopup\" v-if=\"changeFormatPopup\">\n      <div>\n\n        <label for=\"newFormat\">New Format:</label>\n        <select id=\"newFormat\" v-model=\"format\">\n          <option value=\"gstz\">.gstz/.catz (Zipped XML)</option>\n          <option value=\"gst\">.gst/.cat (XML)</option>\n          <option value=\"json\" v-if=\"!has_duplicate_filename\">.json (JSON)</option>\n        </select>\n      </div>\n      <div v-if=\"has_duplicate_filename\">\n        <span class=\"gray\">Note: Cannot convert to json because a catalogue has the same filename as the gst</span>\n      </div>\n      <div>\n        <label for=\"deleteExisting\">Delete existing files:</label>\n        <input type=\"checkbox\" id=\"deleteExisting\" v-model=\"deleteExistingFiles\" />\n      </div>\n    </PopupDialog>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { convertToXml, removeExtension } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { addOne } from \"~/assets/shared/battlescribe/bs_helpers\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport { BSIDataCatalogue, BSIDataSystem, BSICatalogue, BSIGameSystem } from \"~/assets/shared/battlescribe/bs_types\";\nimport { download } from \"~/assets/shared/util\";\nimport { deleteFile, filename } from \"~/electron/node_helpers\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\nexport default {\n  emits: [\"edit\", \"delete\"],\n  props: {\n    catalogue: {\n      type: Object as PropType<BSIDataCatalogue | BSIDataSystem>,\n      required: true,\n    },\n  },\n  setup() {\n    return { catalogueStore: useCataloguesStore(), store: useEditorStore() };\n  },\n  data() {\n    return {\n      deletePopup: false,\n      changeFormatPopup: false,\n      format: \"gst\" as \"gstz\" | \"gst\" | \"json\",\n      deleteExistingFiles: false,\n    };\n  },\n  methods: {\n    download_file() {\n      const data = getDataObject(this.catalogue);\n      const loaded = this.store.get_system(data.gameSystemId || data.id).getLoadedCatalogue({ targetId: data.id });\n      const xml = convertToXml(loaded || data);\n      const fileName = data.fullFilePath ? removeExtension(filename(data.fullFilePath)) : data.name;\n      const extension = data.gameSystemId ? `cat` : `gst`;\n      download(`${fileName}.${extension}`, \"application/xml\", xml);\n    },\n    popup_change_format() {\n      this.changeFormatPopup = true;\n    },\n\n    async change_format(format: \"gstz\" | \"gst\" | \"json\", deleteExistingFiles: boolean) {\n      const data = getDataObject(this.catalogue);\n      const sys = this.store.get_system(data.gameSystemId || data.id)\n      const files = sys.getAllCatalogueFiles()\n      for (const file of files) {\n        const file_data = getDataObject(file)\n        const path = file_data.fullFilePath\n        if (path) {\n          if (deleteExistingFiles) {\n            await deleteFile(path);\n          }\n          const isSystem = Boolean((file as BSIDataSystem).gameSystem)\n          let extension: string;\n          const fileName = removeExtension(path)\n          switch (format) {\n            case \"gstz\":\n              extension = isSystem ? \"gstz\" : \"catz\"\n              break;\n            case \"gst\":\n              extension = isSystem ? \"gst\" : \"cat\"\n              break;\n            case \"json\":\n              extension = \"json\"\n              break;\n          }\n          file_data.fullFilePath = `${fileName}.${extension}`;\n          console.log(file_data.fullFilePath)\n          this.store.saveCatalogue(file)\n        }\n      }\n    },\n  },\n  computed: {\n    has_duplicate_filename() {\n      const data = getDataObject(this.catalogue);\n      const sys = this.store.get_system(data.gameSystemId || data.id)\n      const files = sys.getAllCatalogueFiles()\n      const names = {} as Record<string, number>\n\n      for (const file of files) {\n        const file_data = getDataObject(file)\n        const path = file_data.fullFilePath\n        if (path) {\n          addOne(names, removeExtension(path))\n        }\n      }\n\n      return Object.values(names).find(o => o > 1)\n    },\n    is_catalogue() {\n      return Boolean((this.catalogue as BSIDataCatalogue).catalogue);\n    },\n    electron() {\n      return Boolean(globalThis.electron);\n    },\n    imports() {\n      return (this.cataloguedata as BSICatalogue).catalogueLinks || [];\n    },\n    refs() {\n      return this.catalogueStore.getDependents(getDataDbId(this.catalogue)) || [];\n    },\n    cataloguedata(): BSICatalogue | BSIGameSystem {\n      return getDataObject(this.catalogue);\n    },\n    isSystem() {\n      return !this.cataloguedata.gameSystemId;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.details {\n  h4 {\n    margin: 0;\n    font-size: 16px;\n    font-weight: bold;\n  }\n\n  overflow-y: auto;\n}\n</style>\n","<template>\n  <fieldset class=\"details\">\n    <legend>{{ cataloguedata.name }}</legend>\n    <table class=\"editorTable\">\n      <tr>\n        <td>\n          <label for=\"name\"> name: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"name\" v-model=\"cataloguedata.name\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorUrl\"> authorUrl: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"authorUrl\" v-model=\"cataloguedata.authorUrl\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorContact\"> authorContact: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"authorContact\" v-model=\"cataloguedata.authorContact\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorName\"> authorName: </label>\n        </td>\n\n        <td>\n          <input type=\"text\" id=\"authorName\" v-model=\"cataloguedata.authorName\" />\n        </td>\n      </tr>\n      <tr>\n        <td>id:</td>\n        <td>\n          <input type=\"text\" class=\"gray\" id=\"id\" v-model=\"cataloguedata.id\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label\n            for=\"library\"\n            class=\"hastooltip\"\n            title=\"indicates that this catalogue is used to store data, no forces may be created from it if true.\"\n          >\n            library:\n          </label>\n        </td>\n        <td>\n          <input type=\"checkbox\" id=\"library\" v-model=\"cataloguedata.library\" />\n        </td>\n      </tr>\n    </table>\n\n    <button class=\"bouton\" @click=\"$emit('create', catalogue)\"> Create Catalogue </button>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nimport { BSIDataCatalogue, BSIDataSystem, BSICatalogue, BSIGameSystem } from \"~/assets/shared/battlescribe/bs_types\";\n\nexport default {\n  emits: [\"create\"],\n  props: {\n    catalogue: {\n      type: Object as PropType<BSIDataCatalogue | BSIDataSystem>,\n      required: true,\n    },\n  },\n\n  computed: {\n    cataloguedata(): BSICatalogue {\n      return getDataObject(this.catalogue) as BSICatalogue;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.details {\n  h4 {\n    margin: 0;\n    font-size: 16px;\n    font-weight: bold;\n  }\n}\n.editorTable {\n  td {\n    border: none;\n    text-align: left;\n    &:first-child {\n      text-align: right;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"p-10px\" v-if=\"!electron\">\n    <div class=\"box\">\n      <h3>My Catalogues</h3>\n      <div class=\"boutons\">\n        <SelectFile v-if=\"electron\" @uploaded=\"filesUploaded\" />\n        <UploadJson @uploaded=\"filesUploaded\" />\n        <ImportFromGithub @uploaded=\"filesUploaded\" />\n        <CreateSystem />\n      </div>\n      <div v-if=\"electron\">\n        Note: if you modify an already imported file in another program, you will need to import it again\n      </div>\n    </div>\n  </div>\n  <p class=\"info\">\n    To return to this page, simply click on the 'New Recruit' icon located in the top-left corner of the screen.\n    <br />\n    Returning to this page will not cause you to lose your changes.\n  </p>\n  <div class=\"mx-10px box h-full pb-200px\">\n    <SplitView showMiddle showRight :rightWidth=\"400\" id=\"systemView\">\n      <template #middle>\n        <div class=\"scrollable\">\n          <fieldset v-for=\"gst in systems\">\n            <legend>\n              {{ gst.gameSystem?.gameSystem.name || \"Unknown GameSystem\" }}\n              <NuxtLink :to=\"`/search/${gst.getId()}`\" class=\"align-bottom imgBt inline-block\">\n                <img class=\"w-24px h-24px\" src=\"assets/icons/search.png\" title=\"Search\" />\n              </NuxtLink>\n              <a\n                v-if=\"gst.github?.githubUrl\"\n                :href=\"gst.github.githubUrl\"\n                target=\"_blank\"\n                class=\"ml-5px align-bottom imgBt inline-block\"\n              >\n                <img\n                  class=\"w-24px h-24px\"\n                  :src=\"settings.theme === 'dark' ? 'assets/icons/github-dark.png' : 'assets/icons/github-light.png'\"\n                  :title=\"githubHoverTitle(gst.github)\"\n                />\n              </a>\n              <NuxtLink :to=\"`/scripts/${gst.getId()}`\" class=\"align-bottom imgBt inline-block\">\n                <img class=\"w-24px h-24px\" src=\"assets/icons/right2.png\" title=\"Scripts\" />\n              </NuxtLink>\n            </legend>\n            <IconContainer\n              :items=\"systemAndCatalogues(gst)\"\n              @itemClicked=\"itemClicked\"\n              @itemDoubleClicked=\"itemDoubleClicked\"\n              @new=\"newCatalogue(gst)\"\n              v-model=\"selectedItem\"\n            />\n          </fieldset>\n        </div>\n      </template>\n      <template #right>\n        <div v-if=\"selectedItem\" class=\"scrollable\">\n          <template v-if=\"mode === 'create'\">\n            <CataloguesCreate @create=\"createCatalogue\" :catalogue=\"selectedItem\" />\n          </template>\n          <template v-else>\n            <CataloguesDetail @delete=\"deleteCatalogue\" @edit=\"editCatalogue\" :catalogue=\"selectedItem\" />\n          </template>\n        </div>\n      </template>\n    </SplitView>\n    <Teleport to=\"#titlebar-content\" v-if=\"has_unsaved_changes && $route.name == 'index'\">\n      <template v-if=\"has_unsaved_changes\">\n        <button class=\"bouton save ml-10px !w-100px\" @click=\"saveAll\">Save All</button>\n      </template>\n      <template v-else-if=\"failed\">\n        <span class=\"status mx-2 text-red\">failed to save</span>\n      </template>\n      <template v-else>\n        <span class=\"status mx-2\">saved</span>\n      </template>\n    </Teleport>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { BSIData, BSIDataCatalogue, BSIDataSystem } from \"~/assets/shared/battlescribe/bs_types\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport UploadJson from \"~/components/UploadJson.vue\";\nimport CataloguesDetail from \"~/components/my_catalogues/CataloguesDetail.vue\";\n\nimport CataloguesCreate from \"~/components/my_catalogues/CataloguesCreate.vue\";\nimport { generateBattlescribeId } from \"~/assets/shared/battlescribe/bs_helpers\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\nimport ImportFromGithub from \"~/components/ImportFromGithub.vue\";\nimport SelectFile from \"~/components/SelectFile.vue\";\nimport { closeWindow, dirname, showMessageBox } from \"~/electron/node_helpers\";\nimport IconContainer from \"~/components/IconContainer.vue\";\nimport SplitView from \"~/components/SplitView.vue\";\nimport { getExtension } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { useSettingsStore } from \"~/stores/settingsState\";\nimport { db } from \"~/assets/shared/battlescribe/cataloguesdexie\";\nimport { GameSystemFiles } from \"~/assets/shared/battlescribe/local_game_system\";\nimport { GithubIntegration } from \"~/assets/shared/battlescribe/github\";\n\nexport default defineComponent({\n  components: {\n    UploadJson,\n    CataloguesDetail,\n    ImportFromGithub,\n    CataloguesCreate,\n    SelectFile,\n    IconContainer,\n    SplitView,\n  },\n  head() {\n    return {\n      title: \"New Recruit - Editor\",\n    };\n  },\n  data() {\n    return {\n      msg: \"\",\n      selectedItem: null as BSIDataCatalogue | BSIDataSystem | null,\n      mode: \"edit\",\n      editingItem: null as BSIData | null,\n      failed: false,\n    };\n  },\n  setup() {\n    return { cataloguesStore: useCataloguesStore(), store: useEditorStore(), settings: useSettingsStore() };\n  },\n  created() {\n    this.store.init(this.$router);\n    if (!electron) {\n      this.store.load_systems_from_db();\n    }\n  },\n  activated() {\n    window.addEventListener(\"beforeunload\", this.beforeUnload);\n  },\n  deactivated() {\n    window.removeEventListener(\"beforeunload\", this.beforeUnload);\n  },\n  computed: {\n    has_unsaved_changes() {\n      const changes = this.store.unsavedChanges;\n      for (const key in changes) {\n        const val = changes[key];\n        if (val.unsaved) return true;\n      }\n      return false;\n    },\n    electron() {\n      return Boolean(globalThis.electron);\n    },\n    filter() {\n      const id = this.$route.query?.id;\n      if (!id) return undefined;\n      return (id as string).split(\",\");\n    },\n    systems(): Record<string, GameSystemFiles> {\n      if (this.filter) {\n        const result = {} as Record<string, GameSystemFiles>;\n        for (const id of this.filter) {\n          const found = this.store.gameSystems[id];\n          if (found) {\n            result[id] = found;\n          }\n        }\n        return result;\n      }\n\n      return this.store.gameSystems;\n    },\n  },\n  methods: {\n    githubHoverTitle(github: GithubIntegration) {\n      if (github.discovered) {\n        return `using discovered .git repo at ${github.githubUrl}\nuse a publication name=\"Github\", url=\"https://github.com/{owner}/{repo}\" in the gameSystem to overwrite.`;\n      }\n\n      return `using repo at ${github.githubUrl}`;\n    },\n    async saveAll() {\n      let failed = false;\n      try {\n        for (const sys of Object.values(this.systems)) {\n          const increment = await this.store.prompt_revision(sys);\n          for (const cat of sys.getAllLoadedCatalogues()) {\n            if (this.store.get_catalogue_state(cat)?.unsaved) {\n              this.store.save_catalogue(sys, cat, increment);\n            }\n          }\n        }\n      } catch (e) {\n        failed = true;\n      }\n      this.failed = failed;\n    },\n    async beforeUnload(event: BeforeUnloadEvent) {\n      if (globalThis._closeWindow) return;\n      if (this.store.unsavedCount) {\n        const message = \"You have unsaved changes that will be lost\";\n        event.returnValue = message;\n        if (electron) {\n          setTimeout(async () => {\n            const result = await showMessageBox({\n              message: \"You have unsaved changes that will be lost?\",\n              buttons: [\"Cancel\", \"Leave\"],\n              defaultId: 0,\n              cancelId: 0,\n              type: \"question\",\n            });\n            if (result === 1) {\n              globalThis._closeWindow = true;\n              closeWindow();\n            }\n          });\n        }\n      }\n      return false;\n    },\n    systemAndCatalogues(gst: GameSystemFiles) {\n      let res = [];\n      if (gst.gameSystem) {\n        res.push(gst.gameSystem);\n      }\n      if (gst.catalogueFiles) {\n        res.push(...Object.values(gst.catalogueFiles));\n      }\n      return res;\n    },\n\n    itemClicked(item: BSIDataCatalogue) {\n      this.selectedItem = item;\n      this.mode = \"edit\";\n    },\n\n    itemDoubleClicked(item: BSIDataCatalogue) {\n      const id = getDataObject(item).id;\n      const systemId = getDataObject(item).gameSystemId || id;\n      this.$router.push({\n        name: \"catalogue\",\n        query: { systemId, id },\n      });\n    },\n    newCatalogue(gst: GameSystemFiles) {\n      if (!gst.gameSystem) return;\n      const gameSystem = gst.gameSystem.gameSystem;\n      this.mode = \"create\";\n      this.selectedItem = {\n        catalogue: {\n          library: false,\n          id: generateBattlescribeId(),\n          name: \"New Catalogue\",\n          gameSystemId: gameSystem.id,\n          gameSystemRevision: gameSystem.revision,\n          revision: 1,\n        },\n      } as any;\n    },\n    getCatExtension(gstPath: string): string {\n      switch (getExtension(gstPath)) {\n        case \"json\":\n          return \"json\";\n        case \"gstz\":\n          return \"catz\";\n        default:\n        case \"gst\":\n          return \"cat\";\n      }\n    },\n    createCatalogue(data: BSIDataCatalogue) {\n      const system = this.store.get_system(data.catalogue.gameSystemId);\n      const copy = JSON.parse(JSON.stringify(data)) as BSIDataCatalogue;\n      copy.catalogue.battleScribeVersion = \"2.03\";\n      if (electron) {\n        if (!system.gameSystem) {\n          throw new Error(\"Cannot create catalogue: no game system\");\n        }\n        const systemPath = getDataObject(system.gameSystem).fullFilePath;\n        if (!systemPath) {\n          throw new Error(\"Cannot create catalogue: game system has no path set\");\n        }\n        const name = copy.catalogue.name;\n        if (!name) {\n          throw new Error(\"Cannot create catalogue: no name provided\");\n        }\n        const folder = dirname(systemPath);\n\n        getDataObject(copy).fullFilePath = `${folder}/${name}.${this.getCatExtension(systemPath)}`;\n      }\n      system.setCatalogue(copy);\n      this.cataloguesStore.setEdited(getDataDbId(copy), true);\n      this.store.set_catalogue_changed(copy, true);\n      this.store.get_catalogue_state(copy).incremented = true;\n      this.selectedItem = copy;\n      if (!electron) {\n        db.catalogues.put({\n          content: copy,\n          id: getDataDbId(data),\n        });\n      }\n      this.mode = \"edit\";\n    },\n    deleteCatalogue(data: BSIDataCatalogue | BSIDataSystem) {\n      console.log(\"Deleted catalogue\", data);\n      const obj = getDataObject(data);\n      const systemId = obj.gameSystemId || obj.id;\n      if ((data as BSIDataCatalogue).catalogue) {\n        this.store.get_system(systemId).removeCatalogue(data as BSIDataCatalogue);\n        if (!electron) {\n          db.catalogues.delete(getDataDbId(data));\n        }\n      } else if ((data as BSIDataSystem).gameSystem) {\n        const sys = this.store.get_system(systemId);\n        for (const catalogue of Object.values(sys.catalogueFiles)) {\n          const id = getDataDbId(catalogue);\n          db.catalogues.delete(id);\n        }\n        db.catalogues.delete(getDataDbId(sys.gameSystem!));\n        db.systems.delete(getDataDbId(sys.gameSystem!));\n        this.store.delete_system(systemId);\n      }\n      this.selectedItem = null;\n    },\n\n    filesUploaded(files: any[]) {\n      console.log(\"Uploaded\", files.length, \"files\", files);\n      const systems = files.filter((o) => o.gameSystem) as BSIDataSystem[];\n      for (const system of systems) {\n        const systemId = system.gameSystem.id;\n        const dbId = getDataDbId(system);\n        this.store.get_system(systemId).setSystem(system);\n        if (!electron) {\n          db.systems.put({ content: system, id: dbId });\n        }\n        this.cataloguesStore.updateCatalogue(system.gameSystem);\n        this.cataloguesStore.setEdited(dbId, false);\n      }\n\n      const catalogues = files.filter((o) => o.catalogue) as BSIDataCatalogue[];\n      for (const catalogue of catalogues) {\n        const systemId = catalogue.catalogue.gameSystemId;\n        this.store.get_system(systemId).setCatalogue(catalogue);\n        if (!electron) {\n          db.catalogues.put({ content: catalogue, id: getDataDbId(catalogue) });\n        }\n        this.cataloguesStore.updateCatalogue(catalogue.catalogue);\n        this.cataloguesStore.setEdited(getDataDbId(catalogue), false);\n      }\n      delete this.$route.query.id;\n    },\n    async editCatalogue(file: BSIData) {\n      const id = getDataObject(file).id;\n      const systemId = getDataObject(file).gameSystemId || id;\n      this.$router.push({\n        name: \"catalogue\",\n        query: { systemId, id },\n      });\n    },\n  },\n});\n</script>\n\n<style scope>\n.scrollable {\n  height: 100%;\n  overflow-y: auto;\n}\n\n.icon {\n  padding: 1px;\n}\n</style>\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAKa8AACmvAUYJFJkAAAJdSURBVFhHvddNiE1hHMfxy1yS8VYMm1mwklhYoBRqrLCgWCkvCysxXiIrS4tZmVkrCyWZTF6WSEo2SMhLFt6KsuAOMUNJ+P6cc29//55z7/Oce8evPp1zp3me+z/Pec5znltpkW7sxDk8xzh+ooY7GMRaTEJHMw3HMYrfER5gAzqSJXiK0Be1choqvnRW4BNCnce6Ad26qNh7twh3Me/vp3/zBJehkdE8WIDV2Io58LmEbVBBUZmM2/BX8xabUZSZGIAmpm+7F9HZDt/BI+hKY7IFP2Db60kJjU4wD+Eb9yIl+2D7kKNomWXwDfcjNZpP92D70ePZMgdgG33FdJTJLti+fmEuCqPJpxGw0WT8lp0m53p+rEejsjQ7DUcFzM9OG3mZH8vkPXzxTSeyCvDRsLUT377pe0IFfMxOG1mYH8tEi9iM7LSRD/kxGBWg1c1mDaZmp8lZnx9tnuXHwiyHnbmyG2VyE7Yff3GFUZW24Ts0fXwCCa2meqVHZQ9841vQWh8T3bYx2PZfEHqxBdOF+7AdyGOsRFGqOIjv8G2PISnaiHyG70iP1TXo7bYO2jNswgm8hv//urPQhSWlD34o26G9pEYpKavwBqEOyziP5CJm4SS0rIY69V7hlPubNYzkIpQeaJJdhVa0eofaAb3AGWgzUu/8COwXWxcwBW1FO97ZaHY1hxEqQEbQdhExOQQ9PaEiLuK/FKGNTlER2jWXfd8kpR9FRVxBNXmhSIx+Z2iDuxF+X7AYtYkuQFEReoK0evoi/F5kQqOl3N+OpB8vncgO6NeW3pRDlUql6w9PQiGMhlvIAAAAAABJRU5ErkJggg==\""],"names":["fileinput","ref","uploading","onFileSelected","event","input_files","_a","result_files","file","o","isAllowedExtension","content","isZipExtension","asJson","convertToJson","getExtension","getDataObject","emit","e","popFileInput","inputUrl","busy","submit","url","normalizeGithubRepoUrl","repoPath","repoName","apiUrl","defaultBranch","zipDlUrl","zipFile","folder","unzipFolder","name","extension","json","_sfc_main$3","useCataloguesStore","useEditorStore","item","data","result","errors","counts","error","addOne","msgPieces","key","capitalize","sortByAscending","ErrorIcon","_hoisted_5","_hoisted_6","_withScopeId","_createElementVNode","_hoisted_8","_hoisted_9","_hoisted_10","_component_ErrorIcon","__nuxt_component_0","_hoisted_1","_openBlock","_createElementBlock","_Fragment","_renderList","$options","_normalizeClass","$props","$event","_withModifiers","_hoisted_3","_toDisplayString","_hoisted_4","_hoisted_7","_createCommentVNode","_createVNode","_hoisted_2","_sfc_main$2","loaded","xml","convertToXml","fileName","removeExtension","filename","download","format","deleteExistingFiles","files","file_data","path","deleteFile","isSystem","names","getDataDbId","_hoisted_11","_hoisted_14","_hoisted_22","_hoisted_24","_component_PopupDialog","_createTextVNode","_hoisted_12","_hoisted_13","link","_hoisted_15","_hoisted_16","_hoisted_17","_cache","_ctx","$data","args","_hoisted_18","_createBlock","_withCtx","_hoisted_19","_hoisted_20","_hoisted_26","_sfc_main$1","n","_pushScopeId","_popScopeId","_sfc_render","$setup","_withDirectives","_sfc_main","UploadJson","CataloguesDetail","ImportFromGithub","CataloguesCreate","SelectFile","IconContainer","SplitView","useSettingsStore","changes","id","found","github","failed","sys","increment","cat","message","showMessageBox","closeWindow","gst","res","systemId","gameSystem","generateBattlescribeId","gstPath","system","copy","systemPath","dirname","db","obj","catalogue","systems","dbId","catalogues","_imports_0","_imports_1","_component_SelectFile","_component_UploadJson","_component_ImportFromGithub","_component_CreateSystem","_component_SplitView","_component_NuxtLink","_component_IconContainer","_component_CataloguesCreate","_component_CataloguesDetail","_Teleport"],"mappings":"srBAuBM,MAAAA,EAAYC,EAAI,IAAI,EACpBC,EAAYD,EAAI,EAAK,EAK3B,eAAeE,EAAeC,EAAY,OACpC,GAAA,CACFF,EAAU,MAAQ,GAClB,MAAMG,EAAc,CAAC,KAAKC,EAAAF,EAAM,SAAN,YAAAE,EAAc,QAA6B,CAAA,CAAG,EACxE,GAAI,CAACD,EAAa,CAChBH,EAAU,MAAQ,GAClB,OAGF,MAAMK,EAAe,CAAA,EACV,UAAAC,KAAQH,EAAY,OAAQI,GAAMC,GAAmBD,EAAE,IAAI,CAAC,EAAG,CAClE,MAAAE,EAAUC,GAAeJ,EAAK,IAAI,EAAI,MAAMA,EAAK,YAAY,EAAI,MAAMA,EAAK,KAAK,EACjFK,EAAS,MAAMC,GAAcH,EAASI,EAAaP,EAAK,IAAI,CAAC,EACrDQ,EAAAH,CAAM,EAAE,aAAeL,EAAK,KAC1CD,EAAa,KAAKM,CAAM,EAEtBN,EAAa,QACfU,EAAK,WAAYV,CAAY,EAE/BL,EAAU,MAAQ,SACXgB,GACP,QAAQ,MAAMA,CAAC,EACfhB,EAAU,MAAQ,EACpB,CACF,CACA,eAAeiB,GAAe,CAC3BnB,EAAU,MAAc,OAC3B,2dCpDM,MAAAoB,EAAWnB,EAAI,EAAE,EACjBoB,EAAOpB,EAAI,EAAK,EAItB,eAAeqB,EAAOC,EAAoB,CACxC,GAAI,CAACA,GAAOC,EAAuBD,CAAG,IAAMA,EAAK,CACvC,QAAA,IAAI,UAAWA,CAAG,EAC1B,OAEE,GAAA,CACFF,EAAK,MAAQ,GAEP,MAAAI,EAAWF,EAAI,MAAM,GAAG,EAAE,MAAM,EAAE,EAAE,KAAK,GAAG,EAC5CG,EAAWD,EAAS,MAAM,GAAG,EAAE,CAAC,EAChCE,EAAS,gCAAgCF,IACzCG,GAAiB,MAAM,OAAYD,CAAM,GAAG,eAC5CE,EAAW,+BAA+BJ,oBAA2BG,IAGrEE,EAAU,MAAM,OAAa,yBAAyBD,GAAU,EAGhEE,EAAS,MAAMC,GAAYF,EAAS,GAAGJ,KAAYE,GAAe,EAClErB,EAAe,CAAA,EACrB,SAAW,CAAC0B,EAAMtB,CAAO,IAAK,OAAO,QAAQoB,CAAM,EAAG,CAC9C,MAAAG,EAAYnB,EAAakB,CAAI,EAC/B,GAAAvB,GAAmBwB,CAAS,EAC1B,GAAA,CACF,MAAMC,EAAO,MAAMrB,GAAcH,EAASuB,CAAS,EACrClB,EAAAmB,CAAI,EAAE,aAAeF,EACnC1B,EAAa,KAAK4B,CAAI,QAEtB,QACF,EAGA5B,EAAa,QACfU,EAAK,WAAYV,CAAY,EAE/Ba,EAAS,MAAQ,SACVF,GACP,QAAQ,MAAMA,CAAC,CAAA,QACf,CACAG,EAAK,MAAQ,EACf,CACF,8VCXee,GAAA,CACb,MAAO,CAAC,MAAO,cAAe,mBAAmB,EACjD,OAAQ,CACN,MAAO,CAAE,gBAAiBC,EAAA,EAAsB,MAAOC,EAAiB,CAAA,CAC1E,EACA,MAAO,CACL,MAAO,CACL,KAAM,MACN,SAAU,EACZ,EACA,WAAY,CACV,SAAU,EACZ,CACF,EACA,QAAS,CACP,MAAMC,EAAM,CACV,QAAQ,IAAIA,CAAI,CAClB,EACA,cAAAvB,EACA,QAAQuB,EAAe,OACrB,OAAIA,EAAK,WACA,CAAE,KAAM,2BAA4B,MAAO,CAAE,GAC3CjC,EAAAiC,EAAK,YAAL,MAAAjC,EAAgB,QAClB,CAAE,KAAM,2BAA4B,MAAO,CAAE,EAE7C,CAAE,KAAM,wBAAyB,MAAO,CAAE,CAErD,EACA,qBAAqBiC,EAAe,CAC7B,KAAA,MAAM,oBAAqBA,CAAI,CACtC,EACA,eAAeA,EAAe,CACvB,KAAA,MAAM,cAAeA,CAAI,CAChC,EACA,QAAQC,EAAe,CACrB,OAAO,KAAK,MAAM,oBAAoBA,CAAI,EAAE,eAC9C,EACA,OAAOA,EAAgC,OACrC,MAAMC,EAAS,CAAA,GACXnC,EAAA,KAAK,MAAM,oBAAoBkC,CAAI,IAAnC,MAAAlC,EAAsC,SACxCmC,EAAO,KAAK,CACV,SAAU,OACV,IAAK,SAAA,CACN,EAEG,MAAAC,EAAU1B,EAAcwB,CAAI,EAAyC,OAE3E,GAAIE,GAAA,MAAAA,EAAQ,OAAQ,CAClB,MAAMC,EAAS,CAAA,EAEf,UAAWC,KAASF,EACdE,EAAM,SACDC,EAAAF,EAAQC,EAAM,QAAQ,EAE7BC,EAAOF,EAAQ,OAAO,EAI1B,IAAIG,EAAY,CAAA,EAChB,UAAWC,KAAOJ,EAChBG,EAAU,KAAK,GAAGH,EAAOI,CAAG,KAAKC,GAAWD,CAAG,IAAIJ,EAAOI,CAAG,IAAM,EAAI,GAAK,KAAK,EAE/EL,EAAO,KAAMjC,GAAMA,EAAE,WAAa,OAAO,EAC3CgC,EAAO,KAAK,CACV,SAAU,QACV,IAAK,OAAOK,EAAU,KAAK,IAAI,GAAA,CAChC,EACQJ,EAAO,KAAMjC,GAAMA,EAAE,WAAa,SAAS,GACpDgC,EAAO,KAAK,CACV,SAAU,UACV,IAAK,OAAOK,EAAU,KAAK,IAAI,GAAA,CAChC,EAGE,OAAAL,CACT,EACA,OAAOD,EAAe,CACZ,OAAAxB,EAAcwB,CAAI,EAAU,MACtC,EACA,KAAKA,EAAe,CACX,OAAAxB,EAAcwB,CAAI,EAAE,IAC7B,EACA,KAAM,CACJ,KAAK,MAAM,KAAK,CAClB,CACF,EACA,SAAU,CACR,aAAc,CACL,OAAAS,EACLA,EAAgB,KAAK,MAAQxC,GAAM,KAAK,KAAKA,CAAC,CAAC,EAC9CA,GAAM,KAAK,QAAQA,CAAC,EAAE,KAAA,CAE3B,CACF,EACA,WAAY,CAAEyC,UAAAA,EAAU,CAC1B,iFA1HiB,aAAqB,WAAA,8CAE5BC,GAAe,CAEf,IAAK,EAAA,MAAA;4DAGsEC,GAAAC,EAAA,IAAAC,EAAA,MAAA,CAAA,MAAA,oCAA3E,KAA8E,EAAA,CAAA,UAMtBC,GAAAF,EAAA,IAAAC,EAAA,MAAA,CAAA,MAAA,kCAA5DE,GAA+DH,EAAA,IAAAC,EAAA,MAAA,CAAA,MAAA,kBAAA,MAAA,EAAA,CAAA,EAC/DG,GAAqC,CAAAF,gCAzBzC,MAAAG,EAAAC,gBACE,MAqBMC,GAAA,EAAAC,EAnBC,EAAC,EAAAC,EAAAC,EAAA,KAA4BC,EACbC,EAAA,YAAW1B,IAC/BsB,EAAA,EAAOC,EAAe,MAAA,CACtB,MAAAI,EAAU,8BAAqB,CAAI,UAAAD,EAAA,OAAA1B,CAAA,EAAA,SAAAA,IAAA4B,EAAA,UAAA,CAAA,CAAA,EACrB,QAAAC,GAAAH,EAAA,eAAA1B,CAAA,EAAA,WAAA6B,GAAAH,EAAA,qBAAA1B,CAAA,EAEf,UAA8C8B,GAAAD,GAAAH,EAAA,MAAA1B,CAAA,EAAA,CAAA,QAAA,CAAA,CAAA,EAAA,GAAtB,MAAQ,CAAA,MAAA,OAChC,IAA2B0B,EAAA,QAAA1B,CAAA,EAAA,IAAA,EAWrB,KAAA,EAAA+B,EAAA,EAAAhB,EAPY,MAAI,KAAAiB,EAAAN,EAAA,KAAA1B,CAAA,CAAA,EAAA,CAAA,EAFpBe,EAAA,MAAAkB,GAAA,CAAAP,EAAA,QAAA1B,CAAA,GAQAsB,EAAoC,EAAAC,EAAA,OAAAX,GAAAsB,EAAA,GAAxBC,EAAQ,GAAO,EAAI,EAAAC,EAAAjB,EAAA,yCAGnC,EAAA,GAAAkB,EAAA,EAAA,EAAK,GAAK,GAAwCtB,EAAA,MAAA,CAAA,MAAA,uJC6DvCuB,GAAA,CACb,MAAO,CAAC,OAAQ,QAAQ,EACxB,MAAO,CACL,UAAW,CACT,KAAM,OACN,SAAU,EACZ,CACF,EACA,OAAQ,CACN,MAAO,CAAE,eAAgBxC,EAAA,EAAsB,MAAOC,EAAiB,CAAA,CACzE,EACA,MAAO,CACE,MAAA,CACL,YAAa,GACb,kBAAmB,GACnB,OAAQ,MACR,oBAAqB,EAAA,CAEzB,EACA,QAAS,CACP,eAAgB,CACR,MAAAE,EAAOxB,EAAc,KAAK,SAAS,EACnC8D,EAAS,KAAK,MAAM,WAAWtC,EAAK,cAAgBA,EAAK,EAAE,EAAE,mBAAmB,CAAE,SAAUA,EAAK,EAAI,CAAA,EACrGuC,EAAMC,GAAaF,GAAUtC,CAAI,EACjCyC,EAAWzC,EAAK,aAAe0C,EAAgBC,GAAS3C,EAAK,YAAY,CAAC,EAAIA,EAAK,KACnFN,EAAYM,EAAK,aAAe,MAAQ,MAC9C4C,GAAS,GAAGH,KAAY/C,IAAa,kBAAmB6C,CAAG,CAC7D,EACA,qBAAsB,CACpB,KAAK,kBAAoB,EAC3B,EAEA,MAAM,cAAcM,EAAiCC,EAA8B,CAC3E,MAAA9C,EAAOxB,EAAc,KAAK,SAAS,EAEnCuE,EADM,KAAK,MAAM,WAAW/C,EAAK,cAAgBA,EAAK,EAAE,EAC5C,uBAClB,UAAWhC,KAAQ+E,EAAO,CAClB,MAAAC,EAAYxE,EAAcR,CAAI,EAC9BiF,EAAOD,EAAU,aACvB,GAAIC,EAAM,CACJH,GACF,MAAMI,GAAWD,CAAI,EAEjB,MAAAE,EAAW,EAASnF,EAAuB,WAC7C,IAAA0B,EACE,MAAA+C,EAAWC,EAAgBO,CAAI,EACrC,OAAQJ,EAAQ,CACd,IAAK,OACHnD,EAAYyD,EAAW,OAAS,OAChC,MACF,IAAK,MACHzD,EAAYyD,EAAW,MAAQ,MAC/B,MACF,IAAK,OACSzD,EAAA,OACZ,KACJ,CACUsD,EAAA,aAAe,GAAGP,KAAY/C,IAChC,QAAA,IAAIsD,EAAU,YAAY,EAC7B,KAAA,MAAM,cAAchF,CAAI,GAGnC,CACF,EACA,SAAU,CACR,wBAAyB,CACjB,MAAAgC,EAAOxB,EAAc,KAAK,SAAS,EAEnCuE,EADM,KAAK,MAAM,WAAW/C,EAAK,cAAgBA,EAAK,EAAE,EAC5C,uBACZoD,EAAQ,CAAA,EAEd,UAAWpF,KAAQ+E,EAAO,CAExB,MAAME,EADYzE,EAAcR,CAAI,EACb,aACnBiF,GACK5C,EAAA+C,EAAOV,EAAgBO,CAAI,CAAC,EAIvC,OAAO,OAAO,OAAOG,CAAK,EAAE,KAAKnF,GAAKA,EAAI,CAAC,CAC7C,EACA,cAAe,CACN,MAAA,EAAS,KAAK,UAA+B,SACtD,EACA,UAAW,CACF,MAAA,EAAQ,WAAW,QAC5B,EACA,SAAU,CACA,OAAA,KAAK,cAA+B,gBAAkB,EAChE,EACA,MAAO,CACE,OAAA,KAAK,eAAe,cAAcoF,EAAY,KAAK,SAAS,CAAC,GAAK,EAC3E,EACA,eAA8C,CACrC,OAAA7E,EAAc,KAAK,SAAS,CACrC,EACA,UAAW,CACF,MAAA,CAAC,KAAK,cAAc,YAC7B,CACF,CACF,qEApLc4D,GAAM,CAAiB,IAAA,GAC3BN,GAAMjB,EAAA,IAAAC,EAAA,OAAA,CAAiG,MAAA,kBAAA,MAAA,uHAMlCD,EAAA,IAAAC,EAAA,OAAA,CAAA,MAAA,QAAA,MAAA,EAAA,CAAA,4GAOnE,OAAqC,CAAA,MAA1B,QAAmB,aAAA,EAAA,CAAA,yDAElCG,GAAAJ,EAAA,IAAAC,EAAkC,OAA5B,CAAA,MAAM,QAAO,cAAQ,EAAA,CAAA,EACtBwC,GAAA,CAAA,IAAK,yEAULC,GAAA,CAAA,IAAK,MAUc1C,EAAA,IAAAC,EAAA,OAAA,CAAA,MAAA,QAAA,eAAA,EAAA,CAAA,6DAiBgCA,EAAA,IAAA,CAAA,MAA9C,QAAqC,6DAAA,EAAA,CAAA,WACDA,EAAA,QAAA,CAAA,IAApC,aAA2B,cAAA,EAAA,CAAA,8HAC3B0C,GAAY,CAAA,IAAA,2BAItBC,GAA2G5C,EAAA,IAAAC,EAAA,OAAA,CAAA,MAAA,QAAA,oFAAA,EAAA,CAAA,iHAhEjH,MAAA4C,EAAAvC,GAEI,OAAAE,EAAA,EAAAC,EAAyC,WAA9BF,GAAA,CAAAN,EACA,MAAY,KAAA,CAAAA,EAAvB,SAMM,KAAAiB,EAAAN,EAAA,cAAA,IAAA,EAAA,CAAA,EAAAA,EALJ,oBAIA,MAAIW,GAAA,CAAAN,sCAEN,CAAA,GAAKI,EAA6B,GAAA,EAAA,EAACpB,EAAA,MAAA,KAAA,CAAAkB,GACnC2B,EACM,IAAA5B,EAAAN,EAAA,cAAA,EAAA,EAAA,CAAA,CAAA,CAAA,gBAD+Bd,GAAAgD,EAAA,EAE1B7C,EAAQ,OAAAF,GAAAmB,EAAAN,EAAA,cAAA,YAAA,EAAA,CAAA,CAAA,CAAA,EAAGA,EAAA,UAAAJ,EAAA,EAAAC,EAAqC,MAAGW,GAAA,CAAAlB,wCAC9D,CAAA,GACEmB,EAAwC,GAAA,EAAA,EACxCpB,EAAA,MAAA,KAAA,CAAAE,GAEF2C,EAAiF,IAAA5B,EAAAN,EAAA,cAAA,aAAA,EAAA,CAAA,CAAA,CAAA,IAAtC,MAAC,KAAA,CAAAR,GAChC0C,EAAA,IAAa5B,EAAkBN,EAAsB,cAAA,UAAA,EAAA,CAAA,CAAA,CAAA,GAC/D3D,EAAA2D,EAAA,cAAkC,iBAAlC,MAAA3D,cAOMwD,EAAA,MAAAgC,GAAA,CAAAM,GALJ9C,EAAA,MAAA+C,GAAA,EAAAxC,EACE,EAEO,EAAAC,EAAAC,EAAA,KAAAC,EAAAC,EAAA,cAAA,eAAAqC,IAFAzC,EAAqB,EAAAC,EAAA,MAAA,KAAA,CAAAR,EACvB,OAAK,CAAA,MAAAY,EAAA,CAAA,KAAA,CAAAoC,EAAA,iBAAA,CAAA,4BAKhB,GAAA5B,EAAA,GAAA,EAAA,EACET,EAAA,KAAA,QAAsC,iBAOhCH,EAAA,MAAAiC,GAAA,CAAAQ,GALJjD,EAAA,MAAAkD,GAAA,EAAA3C,EACE,EAEO,EAAAC,EAAAC,EAAA,KAAAC,EAAAC,EAAA,KAAAhE,IAFA4D,EAAoB,EAAAC,EAAA,MAAA,KAAA,CAAAR,EACtB,OAAI,CAAA,MAAAY,EAAA,CAAA,KAAA,CAAAjE,EAAA,iBAAA,CAAA,iCAOjB,CAAA,GAAAyE,EAMM,GANN,EAAA,CAAA,CAAA,EACwBpB,EAAA,MAAAmD,GAAA,CAAOnD,EAAA,SAAA,CAAgC,MAAA,SAC7D,QAAkEoD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAtC,GAAAuC,EAAA,MAAA,OAAAxC,EAAA,SAAA,EAAA,EAA1D,MAAM,EAAeb,EAAA,SAAA,CAAsB,MAAA,SACnD,QAA+DoD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAtC,GAAAwC,EAAA,YAAA,GAAA,EAAvD,QAAM,EAAetD,EAAA,SAAA,CAAiB,MAAA,SACjB,QAAQoD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,IAAAG,IAAA5C,EAAA,eAAAA,EAAA,cAAA,GAAA4C,CAAA,EAAA,EAAA,UAAA,kBAAf/C,EAAA,SAAA,CAAkB,IAAA,EAA4B,MAAA,SAAA,QAAA4C,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,IAAAG,IAAA5C,EAAA,qBAAAA,EAAA,oBAAA,GAAA4C,CAAA,EACU,EAAA,oBAAA,GAAAnC,EAAA,GAAA,EAAA,EAGxEoC,EAAA,CAAA,qBADqBC,EAAAb,EAAA,CAAC,IAAI,EAAW,OAAM,UAAA,KAAA,kDAAuC/B,EAAW,SAAA,GAAA,WAAAyC,EAAA,YAEF,sBAAAF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAtC,GAAAwC,EAAA,YAAAxC,EAAA,EAAA,6HAG/D,EAAA,EAAA,CAAA,YAAA,CAAiB,KADrD,GAkBc,EAAA,EAAAwC,EAAA,mBAAA/C,IAlBekD,EAAAb,EAAA,CAAC,IAAI,EAAW,OAAM,UAAA,KAAA,iDACxCU,EAAiB,OAAAA,EAAA,mBAAA,GAAA,WAAAA,EAAA,kBASpB,sBAAAF,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAtC,GAAAwC,EAAA,kBAAAxC,EAAA,EAAA,SANJ4C,EAA0C,IAAA,CAC1C1D,EAAA,MAAA,KAAA,CAAA2D,gCACE,sBAAsDP,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAtC,GAAAwC,EAAA,OAAAxC,EAAA,EACtD,CAAA8C,iCAF8B,GAAM,EAAA,qCAAA,EAAA,GAAA,EAAA,cAM7B,CAAA,CAAA,CAAA,EAGXjD,EAAA,wBAAAJ,EAAA,EAAAC,EAGM,cAFJY,EAA0D,GAAA,EAAA,EAC1DpB,EAAA,MAAA,KAAA,CAAA6D,KAA0B7D,EAAgB,QAAA,CAAA,KAAA,qDAAUoD,EAAmB,CAAA,IAAAA,EAAA,CAAA,EAAAtC,GAAAwC,EAAA,oBAAAxC,EAAA,EAAA,KAAA,GAAA,EAAA,oICDhEgD,GAAA,CACb,MAAO,CAAC,QAAQ,EAChB,MAAO,CACL,UAAW,CACT,KAAM,OACN,SAAU,EACZ,CACF,EAEA,SAAU,CACR,eAA8B,CACrB,OAAApG,EAAc,KAAK,SAAS,CACrC,CACF,CACF,EA/EW,MAAAqC,EAAAgE,IAAKC,EAAC,iBAAa,EAAAD,EAAAA,IAAAE,IAAAF,2BAGpB,CAAiC,MAAA,qCAOnC/D,EAAA,QAAA,CAAA,IAAA,MAAA,EAAA,SAAA,8BAQAA,EAAA,QAAA,CAAA,IAAA,WAAA,EAAA,cAAA,8DAUK,kBAAA,8BAOLA,EAAA,QAAA,CAAA,IAAA,YAAA,EAAA,eAAA,WAaUD,EAAA,IAAAC,EAAA,KAAA,KAAA,MAAA,EAAA,CAAA,EALNC,GAAaF,EAAA,IAAAC,EAAA,KAAA,KAAA,CACKA,EAAA,QAAA,CAClB,IAAK,UACN,MAAA,aAAA,MAAA,sHA/CP,SAAAkE,GAAAb,EAAyCD,EAA9BvC,EAAAsD,EAAAb,EAAA3C,EAAA,QACXJ,EAsDQ,EAAAC,EAAA,WAAAF,GAAA,CAAAN,EArDN,SAOK,KAAAiB,EAAAN,EAAA,cAAA,IAAA,EAAA,CAAA,EAJEX,EAAA,QAAAsB,GAAA,CAAAtB,EACL,KAEK,KAAA,CAAAgB,GADehB,EAAA,KAAA,KAAA,CAAUoE,EAAApE,EAAA,QAAA,CAAA,KAAA,iBAAU,sBAAAoD,EAAA,CAAA,IAAcA,EAAI,CAAA,EAAAtC,GAAAH,EAAA,cAAA,KAAAG,EAAA,EAAA,KAAA,GAAA,EAAA,2BAG5D,CAAA,CAAA,CAAA,IAIE,KAEK,KAAA,CAAAI,GADelB,EAAA,KAAA,KAAA,CAAAoE,EAAIpE,EAAW,QAAA,CAAA,KAAA,sBAAU,sBAAAoD,EAAA,CAAA,IAAcA,EAAS,CAAA,EAAAtC,GAAAH,EAAA,cAAA,UAAAG,EAAA,EAAA,KAAA,GAAA,EAAA,gCAGtE,CAAA,CAAA,CAAA,IAIE,KAEK,KAAA,CAAAjB,GADeG,EAAA,KAAA,KAAA,CAAAoE,EAAIpE,EAAe,QAAA,CAAA,KAAA,0BAAU,sBAAAoD,EAAA,CAAA,IAAcA,EAAa,CAAA,EAAAtC,GAAAH,EAAA,cAAA,cAAAG,EAAA,EAAA,KAAA,GAAA,EAAA,oCAG9E,CAAA,CAAA,CAAA,IAKE,KAEK,KAAA,CAAAhB,GADeE,EAAA,KAAA,KAAA,CAAAoE,EAAIpE,EAAY,QAAA,CAAA,KAAA,uBAAU,sBAAAoD,EAAA,CAAA,IAAcA,EAAU,CAAA,EAAAtC,GAAAH,EAAA,cAAA,WAAAG,EAAA,EAAA,KAAA,GAAA,EAAA,iCAGxE,CAAA,CAAA,CAAA,IAEE,KAEK,KAAA,CAAAK,GADenB,EAAA,KAAA,KAAA,CAAaoE,EAAApE,EAAA,QAAA,CAAC,KAAG,OAAA,MAAA,eAAc,sBAAAoD,EAAA,CAAA,IAAcA,EAAE,CAAA,EAAAtC,GAAAH,EAAA,cAAA,GAAAG,EAAA,EAAA,KAAA,GAAA,EAAA,yBAGrE,CAAA,CAAA,CAAA,IAUE,KAEK,KAAA,CAAAb,GADmBD,EAAA,KAAA,KAAA,CAAaoE,EAAApE,EAAA,QAAA,CAAA,KAAA,wBAAU,sBAAAoD,EAAA,CAAA,IAAAA,EAAc,CAAO,EAAAtC,GAAAH,EAAA,cAAA,QAAAG,EAAA,EAAA,KAAA,GAAA,EAAA,iCAKxE,CAAA,CAAA,CAAA,EAA6Bd,EAAA,SAAA,CAA8B,MAAA,SAAA,QAAAoD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAtC,GAAAuC,EAAA,MAAA,SAAAxC,EAAA,SAAA,2FC2ChDwD,KAAgB,CAC7B,WAAY,CAAA,WACVC,GACA,iBAAAC,GAAA,iBACAC,GACA,iBAAAC,GAAA,WACAC,EAAA,cACAC,GAAA,UACAC,EACF,EACA,MAAO,CACE,MAAA,CACL,MAAO,sBAAA,CAEX,EACA,MAAO,CACE,MAAA,CACL,IAAK,GACL,aAAc,KACd,KAAM,OACN,YAAa,KACb,OAAQ,EAAA,CAEZ,EACA,OAAQ,CACC,MAAA,CAAE,gBAAiB7F,IAAsB,MAAOC,IAAkB,SAAU6F,GAAA,EACrF,EACA,SAAU,CACH,KAAA,MAAM,KAAK,KAAK,OAAO,EACvB,UACH,KAAK,MAAM,sBAEf,EACA,WAAY,CACH,OAAA,iBAAiB,eAAgB,KAAK,YAAY,CAC3D,EACA,aAAc,CACL,OAAA,oBAAoB,eAAgB,KAAK,YAAY,CAC9D,EACA,SAAU,CACR,qBAAsB,CACd,MAAAC,EAAU,KAAK,MAAM,eAC3B,UAAWrF,KAAOqF,EAEhB,GADYA,EAAQrF,CAAG,EACf,QAAgB,MAAA,GAEnB,MAAA,EACT,EACA,UAAW,CACF,MAAA,EAAQ,WAAW,QAC5B,EACA,QAAS,OACD,MAAAsF,GAAK/H,EAAA,KAAK,OAAO,QAAZ,YAAAA,EAAmB,GAC9B,GAAK+H,EACG,OAAAA,EAAc,MAAM,GAAG,CACjC,EACA,SAA2C,CACzC,GAAI,KAAK,OAAQ,CACf,MAAM5F,EAAS,CAAA,EACJ,UAAA4F,KAAM,KAAK,OAAQ,CAC5B,MAAMC,EAAQ,KAAK,MAAM,YAAYD,CAAE,EACnCC,IACF7F,EAAO4F,CAAE,EAAIC,GAGV,OAAA7F,EAGT,OAAO,KAAK,MAAM,WACpB,CACF,EACA,QAAS,CACP,iBAAiB8F,EAA2B,CAC1C,OAAIA,EAAO,WACF,iCAAiCA,EAAO;AAAA,0GAI1C,iBAAiBA,EAAO,WACjC,EACA,MAAM,SAAU,OACd,IAAIC,EAAS,GACT,GAAA,CACF,UAAWC,KAAO,OAAO,OAAO,KAAK,OAAO,EAAG,CAC7C,MAAMC,EAAY,MAAM,KAAK,MAAM,gBAAgBD,CAAG,EAC3C,UAAAE,KAAOF,EAAI,0BAChBnI,EAAA,KAAK,MAAM,oBAAoBqI,CAAG,IAAlC,MAAArI,EAAqC,SACvC,KAAK,MAAM,eAAemI,EAAKE,EAAKD,CAAS,SAK1CF,EAAA,EACX,CACA,KAAK,OAASA,CAChB,EACA,MAAM,aAAapI,EAA0B,CAC3C,GAAI,YAAW,aACX,IAAA,KAAK,MAAM,aAAc,CAC3B,MAAMwI,EAAU,6CAChBxI,EAAM,YAAcwI,EAChB,UACF,WAAW,SAAY,CACN,MAAMC,GAAe,CAClC,QAAS,8CACT,QAAS,CAAC,SAAU,OAAO,EAC3B,UAAW,EACX,SAAU,EACV,KAAM,UAAA,CACP,IACc,IACb,WAAW,aAAe,GACdC,KACd,CACD,EAGE,MAAA,GACT,EACA,oBAAoBC,EAAsB,CACxC,IAAIC,EAAM,CAAA,EACV,OAAID,EAAI,YACFC,EAAA,KAAKD,EAAI,UAAU,EAErBA,EAAI,gBACNC,EAAI,KAAK,GAAG,OAAO,OAAOD,EAAI,cAAc,CAAC,EAExCC,CACT,EAEA,YAAYzG,EAAwB,CAClC,KAAK,aAAeA,EACpB,KAAK,KAAO,MACd,EAEA,kBAAkBA,EAAwB,CAClC,MAAA8F,EAAKrH,EAAcuB,CAAI,EAAE,GACzB0G,EAAWjI,EAAcuB,CAAI,EAAE,cAAgB8F,EACrD,KAAK,QAAQ,KAAK,CAChB,KAAM,YACN,MAAO,CAAE,SAAAY,EAAU,GAAAZ,CAAG,CAAA,CACvB,CACH,EACA,aAAaU,EAAsB,CACjC,GAAI,CAACA,EAAI,WAAY,OACf,MAAAG,EAAaH,EAAI,WAAW,WAClC,KAAK,KAAO,SACZ,KAAK,aAAe,CAClB,UAAW,CACT,QAAS,GACT,GAAII,GAAuB,EAC3B,KAAM,gBACN,aAAcD,EAAW,GACzB,mBAAoBA,EAAW,SAC/B,SAAU,CACZ,CAAA,CAEJ,EACA,gBAAgBE,EAAyB,CAC/B,OAAArI,EAAaqI,CAAO,EAAG,CAC7B,IAAK,OACI,MAAA,OACT,IAAK,OACI,MAAA,OACT,QACA,IAAK,MACI,MAAA,KACX,CACF,EACA,gBAAgB5G,EAAwB,CACtC,MAAM6G,EAAS,KAAK,MAAM,WAAW7G,EAAK,UAAU,YAAY,EAC1D8G,EAAO,KAAK,MAAM,KAAK,UAAU9G,CAAI,CAAC,EAE5C,GADA8G,EAAK,UAAU,oBAAsB,OACjC,SAAU,CACR,GAAA,CAACD,EAAO,WACJ,MAAA,IAAI,MAAM,yCAAyC,EAE3D,MAAME,EAAavI,EAAcqI,EAAO,UAAU,EAAE,aACpD,GAAI,CAACE,EACG,MAAA,IAAI,MAAM,sDAAsD,EAElE,MAAAtH,EAAOqH,EAAK,UAAU,KAC5B,GAAI,CAACrH,EACG,MAAA,IAAI,MAAM,2CAA2C,EAEvD,MAAAF,EAASyH,GAAQD,CAAU,EAEnBvI,EAAAsI,CAAI,EAAE,aAAe,GAAGvH,KAAUE,KAAQ,KAAK,gBAAgBsH,CAAU,IAEzFF,EAAO,aAAaC,CAAI,EACxB,KAAK,gBAAgB,UAAUzD,EAAYyD,CAAI,EAAG,EAAI,EACjD,KAAA,MAAM,sBAAsBA,EAAM,EAAI,EAC3C,KAAK,MAAM,oBAAoBA,CAAI,EAAE,YAAc,GACnD,KAAK,aAAeA,EACf,UACHG,EAAG,WAAW,IAAI,CAChB,QAASH,EACT,GAAIzD,EAAYrD,CAAI,CAAA,CACrB,EAEH,KAAK,KAAO,MACd,EACA,gBAAgBA,EAAwC,CAC9C,QAAA,IAAI,oBAAqBA,CAAI,EAC/B,MAAAkH,EAAM1I,EAAcwB,CAAI,EACxByG,EAAWS,EAAI,cAAgBA,EAAI,GACzC,GAAKlH,EAA0B,UAC7B,KAAK,MAAM,WAAWyG,CAAQ,EAAE,gBAAgBzG,CAAwB,EACnE,UACHiH,EAAG,WAAW,OAAO5D,EAAYrD,CAAI,CAAC,UAE9BA,EAAuB,WAAY,CAC7C,MAAMiG,EAAM,KAAK,MAAM,WAAWQ,CAAQ,EAC1C,UAAWU,KAAa,OAAO,OAAOlB,EAAI,cAAc,EAAG,CACnD,MAAAJ,EAAKxC,EAAY8D,CAAS,EAC7BF,EAAA,WAAW,OAAOpB,CAAE,EAEzBoB,EAAG,WAAW,OAAO5D,EAAY4C,EAAI,UAAW,CAAC,EACjDgB,EAAG,QAAQ,OAAO5D,EAAY4C,EAAI,UAAW,CAAC,EACzC,KAAA,MAAM,cAAcQ,CAAQ,EAEnC,KAAK,aAAe,IACtB,EAEA,cAAc1D,EAAc,CAC1B,QAAQ,IAAI,WAAYA,EAAM,OAAQ,QAASA,CAAK,EACpD,MAAMqE,EAAUrE,EAAM,OAAQ9E,GAAMA,EAAE,UAAU,EAChD,UAAW4I,KAAUO,EAAS,CACtB,MAAAX,EAAWI,EAAO,WAAW,GAC7BQ,EAAOhE,EAAYwD,CAAM,EAC/B,KAAK,MAAM,WAAWJ,CAAQ,EAAE,UAAUI,CAAM,EAC3C,UACHI,EAAG,QAAQ,IAAI,CAAE,QAASJ,EAAQ,GAAIQ,EAAM,EAEzC,KAAA,gBAAgB,gBAAgBR,EAAO,UAAU,EACjD,KAAA,gBAAgB,UAAUQ,EAAM,EAAK,EAG5C,MAAMC,EAAavE,EAAM,OAAQ9E,GAAMA,EAAE,SAAS,EAClD,UAAWkJ,KAAaG,EAAY,CAC5B,MAAAb,EAAWU,EAAU,UAAU,aACrC,KAAK,MAAM,WAAWV,CAAQ,EAAE,aAAaU,CAAS,EACjD,UACAF,EAAA,WAAW,IAAI,CAAE,QAASE,EAAW,GAAI9D,EAAY8D,CAAS,CAAA,CAAG,EAEjE,KAAA,gBAAgB,gBAAgBA,EAAU,SAAS,EACxD,KAAK,gBAAgB,UAAU9D,EAAY8D,CAAS,EAAG,EAAK,EAEvD,OAAA,KAAK,OAAO,MAAM,EAC3B,EACA,MAAM,cAAcnJ,EAAe,CAC3B,MAAA6H,EAAKrH,EAAcR,CAAI,EAAE,GACzByI,EAAWjI,EAAcR,CAAI,EAAE,cAAgB6H,EACrD,KAAK,QAAQ,KAAK,CAChB,KAAM,YACN,MAAO,CAAE,SAAAY,EAAU,GAAAZ,CAAG,CAAA,CACvB,CACH,CACF,CACF,CAAC,ECzWc0B,GAAA,u9BDCRnG,GAAc,CAAA,IAAA,sBAGV,MAAM,0CAWfY,GAAA,CAAA,MAAA,yBAEQlB,EAAA,IAAA,CAAA,MAAA,MAAA,EAAA,CAER6C,EAAA,gHAAA,EAAA7C,EAAA,IAAA,IACW,mEAA6B,OAQgDmB,GAAA,CAAA,MAAA,+BAArElB,GAAM,CAAe,MAAA,cAA8BC,GAAAF,EAAA,MAAA,CAAC,MAAM,gBAAA,IAAAyG,wCAe1DjE,GAAM,CAAe,MAAA,OAAA,EAA8BM,GAAA9C,EAAA,MAAA,CAAC,MAAM,gBAAA,IAAA0G,6BAc9C3D,GAAM,CAAA,IAAA,sBAezBN,GAAM,CAAA,IAAA,gCAGNQ,GAAM,CAAA,IAAA,wIA1ElB,OAAA1C,EAAA,EAAAC,EAaMC,EAbN,KAaM,CAAA4C,EAZJ,SAkBFjC,EA0DM,GA1DN,EAAA,KAjB0B,EAAAZ,EAAA,MAAAF,GAAA,CAAAN,EACtB,MAKMsB,GAAA,CAAAN,WAJJE,GAAwD,CAAAmC,EAAA,UAAA9C,IAAjBkD,EAAakD,EAAA,CAAA,IAAA,4BACpD,EAAA,KAAwC,mBACxCvF,EAA8C,GAAA,EAAA,EAC9CC,EAAgBuF,EAAA,CAAA,WAAAvD,EAAA,aAAA,EAAA,KAAA,EAAA,CAAA,YAAA,CAAA,EAAAhC,EAAAwF,EAAA,CAAA,WAAAxD,EAAA,aAAA,EAAA,KAAA,EAAA,CAAA,YAAA,CAAA,EAEPhC,EAAQyF,CAAA,CAAA,CAAA,+IAKvB,CAAA,GAKAhH,GACuBE,EAAA,MAAAmB,GAAA,CAAAE,EAAC0F,EAAS,CAAE,WAAY,GAAK,UAAG,GAAA,WAAA,IACxC,GAAA,YAAA,EAAA,CAEP,OAAArD,EAAA,IAAA,CAAA1D,EAAA,MAAAC,GAAA,EAAAM,EACE,EAoBS,EAAAC,EAAAC,EAAA,KAAAC,EAAA2C,EAAA,QAAAoC,GAAA,sBAnBA,WAAY,KAAA,CAGRzF,EAAA,SAAA,KAAA,CAAA6C,EAFe5B,IAASjE,EAAAyI,EAAA,aAAA,YAAAzI,EAAA,WAAA,OAAA,oBAAA,EAAA,IAAA,CAAA,EAAYqE,EAAA2F,EAAA,CAAA,GAAA,WAAAvB,EAAA,MAAA,kEAIvC,EAAI,CAAA,EAAA,KAAA,CAAA,IAAA,CAAA,uCACiBjF,EAAA,IAAA,CAC3B,IAAA,EACA,KAAKiF,EAAC,OAAA,UAAA,OAAA,SAEN,MAAA,wCAAA,EAAA,GAEgB,MAAM,CACnB,MAAO,gBAAA,IAAApC,EAAA,SAAA,QAAA,OAAA,+BAAA,8EAKD,EAAA,EAAAlD,EAAA,GAFEiB,EAAkB,GAAK,EAAA,EAAYC,EAAA2F,EAAA,CAAA,GAAA,YAAAvB,EAAA,MAAA,uEAUhD,KAAA,CAAA,IAAA,CAAA,CAAA,CAAA,IAJCwB,EAAwB,CACxB,MAAmB5D,EAAA,oBAAAoC,CAAA,EACnB,cAAGpC,EAAE,YACG,oBAAAA,EAAA,kBAAA,MAAAvC,GAAAuC,EAAA,aAAAoC,CAAA,0KAKN,CAAA,CAAA,CAAA,EACT,MAAA/B,EAAA,IAAA,CAE4EL,EAAA,cAAA9C,EAAA,EAAAC,EAAA,MAAAuC,GAAA,CAAAM,EAAA,OAAA,UAAA9C,EAAA,EAA9BkD,EAAAyD,EAAA,CAAG,IAAA,EAAA,SAAA7D,EAAA,gBAG7C,UAAAA,EAAA,YAAA,EAAA,KAAA,EAAA,CAAA,WAAA,WAAA,CAAA,IAAA9C,EAAA,EAA0CkD,EAAA0D,EAAA,CAAG,IAAA,EAAsB,SAAS9D,EAAE,gBAAA,OAAAA,EAAA,iGAK/C,EAAA,CAAA,CAAA,qDAAPI,EAAA2D,GAAA,CAAA,IAAA,EACd,GAAA,mBAAA,EAAA,4BAC8B5G,EAAA,SAAA,CAAE,IAAA,EAAgB,MAAA,+BAE3C,QAAM4C,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,IAAAG,IAAAF,EAAA,SAAAA,EAAA,QAAA,GAAAE,CAAA,EAAA,EAAA,UAAA,GAAAF,EAAA,QAAA9C,EAAA,EAAAC,EAAA,OAAAiC,GAAA,gBAAA,IAAAlC,IAAAC,EAAA,OAAAyC,GAAA,OAAA"}