{"version":3,"file":"index.38830eff.js","sources":["../../../../components/UploadJson.vue","../../../../components/ImportFromGithub.vue","../../../../components/IconContainer.vue","../../../../components/my_catalogues/CataloguesDetail.vue","../../../../components/my_catalogues/CataloguesCreate.vue","../../../../pages/index.vue","../../../../assets/icons/search.png","../../../../assets/icons/github-light.png"],"sourcesContent":["<template>\n  <input\n    type=\"file\"\n    accept=\".gst, .gstz, .xml, .zip, .cat, .catz, .json\"\n    multiple\n    @change=\"onFileSelected\"\n    class=\"invisible\"\n    ref=\"fileinput\"\n  />\n  <button @click=\"popFileInput\" class=\"bouton\" :disabled=\"uploading\">\n    <template v-if=\"!uploading\"> Import Catalogues </template>\n    <template v-else> ... </template>\n  </button>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  convertToJson,\n  getExtension,\n  isAllowedExtension,\n  isZipExtension,\n} from \"~/assets/shared/battlescribe/bs_convert\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nconst fileinput = ref(null);\nconst uploading = ref(false);\nconst emit = defineEmits<{\n  (e: \"uploaded\", files: Object[]): void;\n}>();\n\nasync function onFileSelected(event: any) {\n  try {\n    uploading.value = true;\n    const input_files = [...((event.target?.files as FileList | null) || [])];\n    if (!input_files) {\n      uploading.value = false;\n      return;\n    }\n\n    const result_files = [] as Object[];\n    for (const file of input_files.filter((o) => isAllowedExtension(o.name))) {\n      const content = isZipExtension(file.name) ? await file.arrayBuffer() : await file.text();\n      const asJson = await convertToJson(content, getExtension(file.name));\n      getDataObject(asJson).fullFilePath = file.name;\n      result_files.push(asJson);\n    }\n    if (result_files.length) {\n      emit(\"uploaded\", result_files);\n    }\n    uploading.value = false;\n  } catch (e) {\n    console.error(e);\n    uploading.value = false;\n  }\n}\nasync function popFileInput() {\n  (fileinput.value as any).click();\n}\n</script>\n<style scoped lang=\"scss\">\n.invisible {\n  opacity: 0; /* make transparent */\n  z-index: -1; /* move under anything else */\n  position: absolute; /* don't let it take up space */\n}\n</style>\n","<script setup lang=\"ts\">\nimport { convertToJson, getExtension, isAllowedExtension, unzipFolder } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nimport { normalizeGithubRepoUrl } from \"~/assets/shared/battlescribe/github\";\nconst inputUrl = ref(\"\");\nconst busy = ref(false);\nconst emit = defineEmits<{\n  (e: \"uploaded\", files: Object[]): void;\n}>();\nasync function submit(url: string | null) {\n  if (!url || normalizeGithubRepoUrl(url) !== url) {\n    console.log(\"bad url\", url);\n    return;\n  }\n  try {\n    busy.value = true;\n    // Get the zip of the repo:\n    const repoPath = url.split(\"/\").slice(-2).join(\"/\"); // BSData/wh40k\n    const repoName = repoPath.split(\"/\")[1];\n    const apiUrl = `https://api.github.com/repos/${repoPath}`;\n    const defaultBranch = (await $fetch<any>(apiUrl)).default_branch; // master\n    const zipDlUrl = `https://codeload.github.com/${repoPath}/zip/refs/heads/${defaultBranch}`;\n\n    // Download the zip through a cors proxy\n    const zipFile = await $fetch<Blob>(`https://www.newrecruit.eu/api/proxy?url=${zipDlUrl}`);\n\n    // Extract the useful files\n    const folder = await unzipFolder(zipFile, `${repoName}-${defaultBranch}`);\n    const result_files = [] as Object[];\n    for (const [name, content] of Object.entries(folder)) {\n      const extension = getExtension(name);\n      if (isAllowedExtension(extension)) {\n        try {\n          const json = await convertToJson(content, extension);\n          getDataObject(json).fullFilePath = name;\n          result_files.push(json);\n        } catch (e) {\n          continue;\n        }\n      }\n    }\n    if (result_files.length) {\n      emit(\"uploaded\", result_files);\n    }\n    inputUrl.value = \"\";\n  } catch (e) {\n    console.error(e);\n  } finally {\n    busy.value = false;\n  }\n}\n</script>\n<template>\n  <input type=\"text\" class=\"bouton !font-normal\" v-model=\"inputUrl\" placeholder='repo eg: \"BSData/wh40k\"' />\n  <button\n    @click=\"submit(normalizeGithubRepoUrl(inputUrl))\"\n    class=\"bouton\"\n    :disabled=\"normalizeGithubRepoUrl(inputUrl) == null || busy\"\n  >\n    {{ busy ? \"...\" : \"Import from github\" }}\n  </button>\n</template>\n","<template>\n  <div class=\"items\">\n    <div\n      v-for=\"item of sortedItems\"\n      class=\"relative item unselectable\"\n      :class=\"{ highlight: opened(item), selected: item === modelValue }\"\n      @click=\"elementClicked(item)\"\n      @dblclick=\"elementDoubleClicked(item)\"\n      @click.middle=\"debug(item)\"\n    >\n      <img class=\"icon\" :src=\"getType(item).icon\" />\n      <div>{{ name(item) }}</div>\n      <div class=\"error flex flex-row\">\n        <span\n          class=\"my-auto\"\n          v-if=\"changed(item)\"\n          title=\"This file was changed by another program.\nYou may want to reload the system through the Systems tab\"\n        >\n          <img class=\"my-auto align-text-bottom\" src=\"/assets/icons/warning_sign.png\" />\n        </span>\n        <ErrorIcon :errors=\"errors(item)\" />\n      </div>\n    </div>\n    <div class=\"relative item add unselectable\" @click=\"add\">\n      <img class=\"w-40px h-40px\" src=\"/assets/icons/iconeplus.png\" />\n      <div class=\"bold text-blue\">New</div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { addOne, capitalize, sortByAscending } from \"~/assets/shared/battlescribe/bs_helpers\";\nimport { BSIData } from \"~/assets/shared/battlescribe/bs_types\";\nimport ErrorIcon, { IErrorMessage } from \"./ErrorIcon.vue\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\nexport default {\n  emits: [\"new\", \"itemClicked\", \"itemDoubleClicked\"],\n  setup() {\n    return { cataloguesStore: useCataloguesStore(), store: useEditorStore() };\n  },\n  props: {\n    items: {\n      type: Array as PropType<BSIData[]>,\n      required: true,\n    },\n    modelValue: {\n      required: true,\n    },\n  },\n  methods: {\n    debug(item: any) {\n      console.log(item);\n    },\n    getDataObject,\n    getType(item: BSIData) {\n      if (item.gameSystem) {\n        return { icon: \"assets/icons/system1.png\", order: 1 };\n      } else if (item.catalogue?.library) {\n        return { icon: \"assets/icons/library.png\", order: 2 };\n      } else {\n        return { icon: \"assets/icons/book.png\", order: 3 };\n      }\n    },\n    elementDoubleClicked(item: BSIData) {\n      this.$emit(\"itemDoubleClicked\", item);\n    },\n    elementClicked(item: BSIData) {\n      this.$emit(\"itemClicked\", item);\n    },\n    changed(data: BSIData) {\n      return this.store.get_catalogue_state(data).isChangedOnDisk;\n    },\n    errors(data: BSIData): IErrorMessage[] {\n      const result = [] as IErrorMessage[];\n      if (this.store.get_catalogue_state(data)?.unsaved) {\n        result.push({\n          severity: \"info\",\n          msg: \"Unsaved\",\n        });\n      }\n      const errors = (getDataObject(data) as any as { errors: IErrorMessage[] }).errors;\n\n      if (errors?.length) {\n        const counts = {} as Record<string, number>;\n\n        for (const error of errors) {\n          if (error.severity) {\n            addOne(counts, error.severity);\n          } else {\n            addOne(counts, \"error\");\n          }\n        }\n\n        let msgPieces = [];\n        for (const key in counts) {\n          msgPieces.push(`${counts[key]} ${capitalize(key)}${counts[key] === 1 ? \"\" : \"s\"}`);\n        }\n        if (errors.find((o) => o.severity === \"error\")) {\n          result.push({\n            severity: \"error\",\n            msg: `Has ${msgPieces.join(\", \")}`,\n          });\n        } else if (errors.find((o) => o.severity === \"warning\")) {\n          result.push({\n            severity: \"warning\",\n            msg: `Has ${msgPieces.join(\", \")}`,\n          });\n        }\n      }\n      return result;\n    },\n    opened(data: BSIData) {\n      return (getDataObject(data) as any).opened;\n    },\n    name(data: BSIData) {\n      return getDataObject(data).name;\n    },\n    add() {\n      this.$emit(\"new\");\n    },\n  },\n  computed: {\n    sortedItems() {\n      return sortByAscending(\n        sortByAscending(this.items, (o) => this.name(o)),\n        (o) => this.getType(o).order\n      );\n    },\n  },\n  components: { ErrorIcon },\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import \"@/shared_components/css/vars.scss\";\n\n.item {\n  display: grid;\n  grid-template-columns: \"max-content\";\n  align-items: center;\n  justify-items: center;\n  &:last-child {\n    margin-right: 0;\n  }\n  font-size: 12px;\n  border: 1px $box_border solid;\n  padding: 3px;\n  border-radius: 5px;\n  box-shadow: $box_shadow;\n  color: $fontColor;\n  cursor: pointer;\n  width: 100px;\n  text-align: center;\n}\n\n.items {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));\n  grid-gap: 5px 0px;\n  grid-auto-rows: 1fr;\n  align-items: stretch;\n}\n\n.error {\n  position: absolute;\n  right: 5px;\n  top: 5px;\n}\n\n.item:hover {\n  background-color: rgba($color: #000000, $alpha: 0.05);\n}\n.selected {\n  border: solid black 2px;\n  padding: 2px;\n}\n\n.highlight {\n  background-color: rgba(40, 120, 250, 0.15);\n}\n.add {\n  border: solid rgb(45, 190, 45) 2px;\n}\n</style>\n","<template>\n  <fieldset class=\"details\">\n    <div>\n      <legend>{{ cataloguedata.name }}</legend>\n      <div v-if=\"is_catalogue\">\n        <span\n          class=\"grey hastooltip\"\n          title=\"indicates that this catalogue is used to store data, no forces may be created from it if true.\"\n        >\n          Library:\n        </span>\n        {{ (cataloguedata as BSICatalogue).library }}\n      </div>\n      <div><span class=\"grey\">Id:</span> {{ cataloguedata.id }}</div>\n      <div\n        ><span class=\"grey\">path:</span> <span style=\"word-break: break-all\">{{ cataloguedata.fullFilePath }}</span>\n      </div>\n      <div v-if=\"electron\"> <span class=\"grey\">authorUrl:</span> {{ cataloguedata.authorUrl }} </div>\n      <div>\n        <span class=\"grey\">authorContact:</span>\n        {{ cataloguedata.authorContact }}\n      </div>\n      <div> <span class=\"grey\">authorName:</span> {{ cataloguedata.authorName }} </div>\n      <div v-if=\"(cataloguedata as BSICatalogue).catalogueLinks?.length\">\n        <span class=\"bold\">imports:</span>\n        <div class=\"ml-10px\">\n          <div v-for=\"link in (cataloguedata as BSICatalogue).catalogueLinks\">\n            <span :class=\"{ grey: !link.importRootEntries }\">\n              {{ link.name }}\n            </span>\n          </div>\n        </div>\n      </div>\n      <div v-if=\"refs.length && !isSystem\">\n        <span class=\"bold\">imported by:</span>\n        <div class=\"ml-10px\">\n          <div v-for=\"ref in refs\">\n            <span :class=\"{ grey: !ref.importRootEntries }\">\n              {{ ref.sourceName }}\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"section boutons\">\n      <button class=\"bouton\" @click=\"$emit('edit', catalogue)\">Edit</button>\n      <button class=\"bouton\" @click=\"deletePopup = true\">Delete</button>\n      <button class=\"bouton\" @click=\"download_file\" v-if=\"!electron\">Download</button>\n      <button class=\"bouton\" v-if=\"isSystem && electron\" @click=\"popup_change_format\">Change File Format</button>\n      <button class=\"bouton\" v-if=\"isSystem && electron\" @click=\"popup_change_ids\">Change Ids</button>\n      <p class=\"info\"> To quickly edit a catalogue, you can double-click on it. </p>\n    </div>\n    <PopupDialog\n      button=\"Confirm\"\n      text=\"Cancel\"\n      @button=\"$emit('delete', catalogue)\"\n      v-model=\"deletePopup\"\n      v-if=\"deletePopup\"\n    >\n      <div>Are you sure you want to delete this {{ is_catalogue ? \"catalogue\" : \"Game System\" }}?</div>\n    </PopupDialog>\n    <PopupDialog\n      button=\"Confirm\"\n      text=\"Cancel\"\n      @button=\"change_format(format, deleteExistingFiles)\"\n      v-model=\"changeFormatPopup\"\n      v-if=\"changeFormatPopup\"\n    >\n      <div>\n        <label for=\"newFormat\">New Format:</label>\n        <select id=\"newFormat\" v-model=\"format\">\n          <option value=\"gstz\">.gstz/.catz (Zipped XML)</option>\n          <option value=\"gst\">.gst/.cat (XML)</option>\n          <option value=\"json\" v-if=\"!has_duplicate_filename\">.json (JSON)</option>\n        </select>\n      </div>\n      <div v-if=\"has_duplicate_filename\">\n        <span class=\"gray\">Note: Cannot convert to json because a catalogue has the same filename as the gst</span>\n      </div>\n      <div>\n        <label for=\"deleteExisting\">Delete existing files:</label>\n        <input type=\"checkbox\" id=\"deleteExisting\" v-model=\"deleteExistingFiles\" />\n      </div>\n    </PopupDialog>\n    <PopupDialog button=\"Confirm\" text=\"Cancel\" @button=\"change_ids()\" v-model=\"changeIdsPopup\" v-if=\"changeIdsPopup\">\n      <div>\n        Are you sure you want to change the ids of all the files in this system?<br />\n        This will cause new lists for this system to be completely separate from the original.<br />\n        only use for major versions or forks.\n      </div>\n    </PopupDialog>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { convertToXml, removeExtension } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { addOne, generateBattlescribeId } from \"~/assets/shared/battlescribe/bs_helpers\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport { BSIDataCatalogue, BSIDataSystem, BSICatalogue, BSIGameSystem } from \"~/assets/shared/battlescribe/bs_types\";\nimport { deleteFile, filename } from \"~/electron/node_helpers\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\n\nexport async function download(filename: string, mimeType: any, content: BlobPart) {\n  const a = document.createElement(\"a\");\n  const blob = new Blob([content], { type: mimeType });\n  const url = URL.createObjectURL(blob);\n  a.setAttribute(\"href\", url);\n  a.setAttribute(\"download\", filename);\n  a.setAttribute(\"target\", \"_blank\");\n  a.click(); // Start downloading\n}\n\n// from https://stackoverflow.com/questions/3665115/how-to-create-a-file-in-memory-for-user-to-download-but-not-through-server\nexport async function saveFilePickerOrDownload(filename: string, mimeType: any, content: BlobPart) {\n  //@ts-ignore\n  if (globalThis.showSaveFilePicker) {\n    //@ts-ignore\n    const handle = await showSaveFilePicker({ suggestedName: filename });\n    const writable = await handle.createWritable();\n    await writable.write(content);\n    writable.close();\n  } else {\n    download(filename, mimeType, content);\n  }\n}\n\nexport default {\n  emits: [\"edit\", \"delete\"],\n  props: {\n    catalogue: {\n      type: Object as PropType<BSIDataCatalogue | BSIDataSystem>,\n      required: true,\n    },\n  },\n  setup() {\n    return { catalogueStore: useCataloguesStore(), store: useEditorStore() };\n  },\n  data() {\n    return {\n      deletePopup: false,\n      changeFormatPopup: false,\n      changeIdsPopup: false,\n      format: \"gst\" as \"gstz\" | \"gst\" | \"json\",\n      deleteExistingFiles: false,\n    };\n  },\n  methods: {\n    download_file() {\n      const data = getDataObject(this.catalogue);\n      const loaded = this.store.get_system(data.gameSystemId || data.id).getLoadedCatalogue({ targetId: data.id });\n      const xml = convertToXml(loaded || data);\n      const fileName = data.fullFilePath ? removeExtension(filename(data.fullFilePath)) : data.name;\n      const extension = data.gameSystemId ? `cat` : `gst`;\n      saveFilePickerOrDownload(`${fileName}.${extension}`, \"application/xml\", xml);\n    },\n    popup_change_format() {\n      this.changeFormatPopup = true;\n    },\n    popup_change_ids() {\n      this.changeIdsPopup = true;\n    },\n\n    async change_ids() {\n      const data = getDataObject(this.catalogue);\n      const sys = this.store.get_system(data.gameSystemId || data.id);\n      const files = sys.getAllCatalogueFiles();\n      const ids = {} as Record<string, string>;\n      for (const file of files) {\n        const file_data = getDataObject(file);\n        ids[file_data.id] = generateBattlescribeId();\n      }\n      for (const file of files) {\n        const file_data = getDataObject(file);\n        file_data.id = ids[file_data.id];\n        if (file_data.gameSystemId) {\n          file_data.gameSystemId = ids[file_data.gameSystemId];\n        }\n        for (const cl of file_data.catalogueLinks || []) {\n          cl.targetId = ids[cl.targetId];\n        }\n      }\n      for (const file of files) {\n        this.store.saveCatalogue(file);\n      }\n    },\n    async change_format(format: \"gstz\" | \"gst\" | \"json\", deleteExistingFiles: boolean) {\n      const data = getDataObject(this.catalogue);\n      const sys = this.store.get_system(data.gameSystemId || data.id);\n      const files = sys.getAllCatalogueFiles();\n      for (const file of files) {\n        const file_data = getDataObject(file);\n        const path = file_data.fullFilePath;\n        if (path) {\n          if (deleteExistingFiles) {\n            await deleteFile(path);\n          }\n          const isSystem = Boolean((file as BSIDataSystem).gameSystem);\n          let extension: string;\n          const fileName = removeExtension(path);\n          switch (format) {\n            case \"gstz\":\n              extension = isSystem ? \"gstz\" : \"catz\";\n              break;\n            case \"gst\":\n              extension = isSystem ? \"gst\" : \"cat\";\n              break;\n            case \"json\":\n              extension = \"json\";\n              break;\n          }\n          file_data.fullFilePath = `${fileName}.${extension}`;\n          console.log(file_data.fullFilePath);\n          this.store.saveCatalogue(file);\n        }\n      }\n    },\n  },\n  computed: {\n    has_duplicate_filename() {\n      const data = getDataObject(this.catalogue);\n      const sys = this.store.get_system(data.gameSystemId || data.id);\n      const files = sys.getAllCatalogueFiles();\n      const names = {} as Record<string, number>;\n\n      for (const file of files) {\n        const file_data = getDataObject(file);\n        const path = file_data.fullFilePath;\n        if (path) {\n          addOne(names, removeExtension(path));\n        }\n      }\n\n      return Object.values(names).find((o) => o > 1);\n    },\n    is_catalogue() {\n      return Boolean((this.catalogue as BSIDataCatalogue).catalogue);\n    },\n    electron() {\n      return Boolean(globalThis.electron);\n    },\n    imports() {\n      return (this.cataloguedata as BSICatalogue).catalogueLinks || [];\n    },\n    refs() {\n      return this.catalogueStore.getDependents(getDataDbId(this.catalogue)) || [];\n    },\n    cataloguedata(): BSICatalogue | BSIGameSystem {\n      return getDataObject(this.catalogue);\n    },\n    isSystem() {\n      return !this.cataloguedata.gameSystemId;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.details {\n  h4 {\n    margin: 0;\n    font-size: 16px;\n    font-weight: bold;\n  }\n\n  overflow-y: auto;\n}\n</style>\n","<template>\n  <fieldset class=\"details\">\n    <legend>{{ cataloguedata.name }}</legend>\n    <table class=\"editorTable\">\n      <tr>\n        <td>\n          <label for=\"name\"> name: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"name\" v-model=\"cataloguedata.name\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorUrl\"> authorUrl: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"authorUrl\" v-model=\"cataloguedata.authorUrl\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorContact\"> authorContact: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"authorContact\" v-model=\"cataloguedata.authorContact\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorName\"> authorName: </label>\n        </td>\n\n        <td>\n          <input type=\"text\" id=\"authorName\" v-model=\"cataloguedata.authorName\" />\n        </td>\n      </tr>\n      <tr>\n        <td>id:</td>\n        <td>\n          <input type=\"text\" class=\"gray\" id=\"id\" v-model=\"cataloguedata.id\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label\n            for=\"library\"\n            class=\"hastooltip\"\n            title=\"indicates that this catalogue is used to store data, no forces may be created from it if true.\"\n          >\n            library:\n          </label>\n        </td>\n        <td>\n          <input type=\"checkbox\" id=\"library\" v-model=\"cataloguedata.library\" />\n        </td>\n      </tr>\n    </table>\n\n    <button class=\"bouton\" @click=\"$emit('create', catalogue)\"> Create Catalogue </button>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nimport { BSIDataCatalogue, BSIDataSystem, BSICatalogue, BSIGameSystem } from \"~/assets/shared/battlescribe/bs_types\";\n\nexport default {\n  emits: [\"create\"],\n  props: {\n    catalogue: {\n      type: Object as PropType<BSIDataCatalogue | BSIDataSystem>,\n      required: true,\n    },\n  },\n\n  computed: {\n    cataloguedata(): BSICatalogue {\n      return getDataObject(this.catalogue) as BSICatalogue;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.details {\n  h4 {\n    margin: 0;\n    font-size: 16px;\n    font-weight: bold;\n  }\n}\n.editorTable {\n  td {\n    border: none;\n    text-align: left;\n    &:first-child {\n      text-align: right;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"p-10px\" v-if=\"!electron\">\n    <div class=\"box\">\n      <h3>My Catalogues</h3>\n      <div class=\"boutons\">\n        <SelectFile v-if=\"electron\" @uploaded=\"filesUploaded\" />\n        <UploadJson @uploaded=\"filesUploaded\" />\n        <ImportFromGithub @uploaded=\"filesUploaded\" />\n        <CreateSystem />\n      </div>\n      <div v-if=\"electron\">\n        Note: if you modify an already imported file in another program, you will need to import it again\n      </div>\n    </div>\n  </div>\n  <p class=\"info\">\n    To return to this page, simply click on the 'New Recruit' icon located in the top-left corner of the screen.\n    <br />\n    Returning to this page will not cause you to lose your changes.\n  </p>\n  <div class=\"mx-10px box h-full pb-200px\">\n    <SplitView showMiddle showRight :rightWidth=\"400\" id=\"systemView\">\n      <template #middle>\n        <div class=\"scrollable\">\n          <fieldset v-for=\"gst in systems\" class=\"section\">\n            <legend class=\"systemLegend\">\n              <NuxtLink :to=\"`/search/${gst.getId()}`\" class=\"align-bottom imgBt inline-block\">\n                <img class=\"w-24px h-24px\" src=\"assets/icons/search.png\" title=\"Search\" />\n              </NuxtLink>\n              <a\n                v-if=\"gst.github?.githubUrl\"\n                :href=\"gst.github.githubUrl\"\n                target=\"_blank\"\n                class=\"ml-5px align-bottom imgBt inline-block\"\n              >\n                <img class=\"w-24px h-24px\" src=\"assets/icons/github-light.png\" :title=\"githubHoverTitle(gst.github)\" />\n              </a>\n              <NuxtLink :to=\"`/scripts/${gst.getId()}`\" class=\"align-bottom imgBt inline-block\">\n                <img class=\"w-24px h-24px\" src=\"assets/icons/right2.png\" title=\"Scripts\" />\n              </NuxtLink>\n              {{ gst.gameSystem?.gameSystem.name || \"Unknown GameSystem\" }}\n            </legend>\n            <IconContainer\n              :items=\"systemAndCatalogues(gst)\"\n              @itemClicked=\"itemClicked\"\n              @itemDoubleClicked=\"itemDoubleClicked\"\n              @new=\"newCatalogue(gst)\"\n              v-model=\"selectedItem\"\n            />\n          </fieldset>\n        </div>\n      </template>\n      <template #right>\n        <div v-if=\"selectedItem\" class=\"scrollable\">\n          <template v-if=\"mode === 'create'\">\n            <CataloguesCreate @create=\"createCatalogue\" :catalogue=\"selectedItem\" />\n          </template>\n          <template v-else>\n            <CataloguesDetail @delete=\"deleteCatalogue\" @edit=\"editCatalogue\" :catalogue=\"selectedItem\" />\n          </template>\n        </div>\n      </template>\n    </SplitView>\n    <Teleport to=\"#titlebar-content\" v-if=\"has_unsaved_changes && $route.name == 'index'\">\n      <template v-if=\"has_unsaved_changes\">\n        <button class=\"bouton save ml-10px !w-100px\" @click=\"saveAll\">Save All</button>\n      </template>\n      <template v-else-if=\"failed\">\n        <span class=\"status mx-2 text-red\">failed to save</span>\n      </template>\n      <template v-else>\n        <span class=\"status mx-2\">saved</span>\n      </template>\n    </Teleport>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { BSIData, BSIDataCatalogue, BSIDataSystem } from \"~/assets/shared/battlescribe/bs_types\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport UploadJson from \"~/components/UploadJson.vue\";\nimport CataloguesDetail from \"~/components/my_catalogues/CataloguesDetail.vue\";\n\nimport CataloguesCreate from \"~/components/my_catalogues/CataloguesCreate.vue\";\nimport { generateBattlescribeId } from \"~/assets/shared/battlescribe/bs_helpers\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\nimport ImportFromGithub from \"~/components/ImportFromGithub.vue\";\nimport SelectFile from \"~/components/SelectFile.vue\";\nimport { closeWindow, dirname, showMessageBox } from \"~/electron/node_helpers\";\nimport IconContainer from \"~/components/IconContainer.vue\";\nimport SplitView from \"~/components/SplitView.vue\";\nimport { getExtension } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { useSettingsStore } from \"~/stores/settingsState\";\nimport { db } from \"~/assets/shared/battlescribe/cataloguesdexie\";\nimport { GameSystemFiles } from \"~/assets/shared/battlescribe/local_game_system\";\nimport { GithubIntegration } from \"~/assets/shared/battlescribe/github\";\n\nexport default defineComponent({\n  components: {\n    UploadJson,\n    CataloguesDetail,\n    ImportFromGithub,\n    CataloguesCreate,\n    SelectFile,\n    IconContainer,\n    SplitView,\n  },\n  head() {\n    return {\n      title: \"New Recruit - Editor\",\n    };\n  },\n  data() {\n    return {\n      msg: \"\",\n      selectedItem: null as BSIDataCatalogue | BSIDataSystem | null,\n      mode: \"edit\",\n      editingItem: null as BSIData | null,\n      failed: false,\n    };\n  },\n  setup() {\n    return { cataloguesStore: useCataloguesStore(), store: useEditorStore(), settings: useSettingsStore() };\n  },\n  created() {\n    this.store.init(this.$router);\n    if (!electron) {\n      this.store.load_systems_from_db();\n    }\n  },\n  activated() {\n    window.addEventListener(\"beforeunload\", this.beforeUnload);\n  },\n  deactivated() {\n    window.removeEventListener(\"beforeunload\", this.beforeUnload);\n  },\n  computed: {\n    has_unsaved_changes() {\n      const changes = this.store.unsavedChanges;\n      for (const key in changes) {\n        const val = changes[key];\n        if (val.unsaved) return true;\n      }\n      return false;\n    },\n    electron() {\n      return Boolean(globalThis.electron);\n    },\n    filter() {\n      const id = this.$route.query?.id;\n      if (!id) return undefined;\n      return (id as string).split(\",\");\n    },\n    systems(): Record<string, GameSystemFiles> {\n      if (this.filter) {\n        const result = {} as Record<string, GameSystemFiles>;\n        for (const id of this.filter) {\n          const found = this.store.gameSystems[id];\n          if (found) {\n            result[id] = found;\n          }\n        }\n        return result;\n      }\n\n      return this.store.gameSystems;\n    },\n  },\n  methods: {\n    githubHoverTitle(github: GithubIntegration) {\n      if (github.discovered) {\n        return `using discovered .git repo at ${github.githubUrl}\nuse a publication name=\"Github\", url=\"https://github.com/{owner}/{repo}\" in the gameSystem to overwrite.`;\n      }\n\n      return `using repo at ${github.githubUrl}`;\n    },\n    async saveAll() {\n      let failed = false;\n      try {\n        for (const sys of Object.values(this.systems)) {\n          const increment = await this.store.prompt_revision(sys);\n          for (const cat of sys.getAllLoadedCatalogues()) {\n            if (this.store.get_catalogue_state(cat)?.unsaved) {\n              this.store.save_catalogue(sys, cat, increment);\n            }\n          }\n        }\n      } catch (e) {\n        failed = true;\n      }\n      this.failed = failed;\n    },\n    async beforeUnload(event: BeforeUnloadEvent) {\n      if (globalThis._closeWindow) return;\n      if (this.store.unsavedCount) {\n        const message = \"You have unsaved changes that will be lost\";\n        event.returnValue = message;\n        if (electron) {\n          setTimeout(async () => {\n            const result = await showMessageBox({\n              message: \"You have unsaved changes that will be lost?\",\n              buttons: [\"Cancel\", \"Leave\"],\n              defaultId: 0,\n              cancelId: 0,\n              type: \"question\",\n            });\n            if (result === 1) {\n              globalThis._closeWindow = true;\n              closeWindow();\n            }\n          });\n        }\n      }\n      return false;\n    },\n    systemAndCatalogues(gst: GameSystemFiles) {\n      let res = [];\n      if (gst.gameSystem) {\n        res.push(gst.gameSystem);\n      }\n      if (gst.catalogueFiles) {\n        res.push(...Object.values(gst.catalogueFiles));\n      }\n      return res;\n    },\n\n    itemClicked(item: BSIDataCatalogue) {\n      this.selectedItem = item;\n      this.mode = \"edit\";\n    },\n\n    itemDoubleClicked(item: BSIDataCatalogue) {\n      const id = getDataObject(item).id;\n      const systemId = getDataObject(item).gameSystemId || id;\n      this.$router.push({\n        name: \"catalogue\",\n        query: { systemId, id },\n      });\n    },\n    newCatalogue(gst: GameSystemFiles) {\n      if (!gst.gameSystem) return;\n      const gameSystem = gst.gameSystem.gameSystem;\n      this.mode = \"create\";\n      this.selectedItem = {\n        catalogue: {\n          library: false,\n          id: generateBattlescribeId(),\n          name: \"New Catalogue\",\n          gameSystemId: gameSystem.id,\n          gameSystemRevision: gameSystem.revision,\n          revision: 1,\n        },\n      } as any;\n    },\n    getCatExtension(gstPath: string): string {\n      switch (getExtension(gstPath)) {\n        case \"json\":\n          return \"json\";\n        case \"gstz\":\n          return \"catz\";\n        default:\n        case \"gst\":\n          return \"cat\";\n      }\n    },\n    createCatalogue(data: BSIDataCatalogue) {\n      const system = this.store.get_system(data.catalogue.gameSystemId);\n      const copy = JSON.parse(JSON.stringify(data)) as BSIDataCatalogue;\n      copy.catalogue.battleScribeVersion = \"2.03\";\n      if (electron) {\n        if (!system.gameSystem) {\n          throw new Error(\"Cannot create catalogue: no game system\");\n        }\n        const systemPath = getDataObject(system.gameSystem).fullFilePath;\n        if (!systemPath) {\n          throw new Error(\"Cannot create catalogue: game system has no path set\");\n        }\n        const name = copy.catalogue.name;\n        if (!name) {\n          throw new Error(\"Cannot create catalogue: no name provided\");\n        }\n        const folder = dirname(systemPath);\n\n        getDataObject(copy).fullFilePath = `${folder}/${name}.${this.getCatExtension(systemPath)}`;\n      }\n      system.setCatalogue(copy);\n      this.cataloguesStore.setEdited(getDataDbId(copy), true);\n      this.store.set_catalogue_changed(copy, true);\n      this.store.get_catalogue_state(copy).incremented = true;\n      this.selectedItem = copy;\n      if (!electron) {\n        db.catalogues.put({\n          content: copy,\n          id: getDataDbId(data),\n        });\n      }\n      this.mode = \"edit\";\n    },\n    deleteCatalogue(data: BSIDataCatalogue | BSIDataSystem) {\n      console.log(\"Deleted catalogue\", data);\n      const obj = getDataObject(data);\n      const systemId = obj.gameSystemId || obj.id;\n      if ((data as BSIDataCatalogue).catalogue) {\n        this.store.get_system(systemId).removeCatalogue(data as BSIDataCatalogue);\n        if (!electron) {\n          db.catalogues.delete(getDataDbId(data));\n        }\n      } else if ((data as BSIDataSystem).gameSystem) {\n        const sys = this.store.get_system(systemId);\n        for (const catalogue of Object.values(sys.catalogueFiles)) {\n          const id = getDataDbId(catalogue);\n          db.catalogues.delete(id);\n        }\n        db.catalogues.delete(getDataDbId(sys.gameSystem!));\n        db.systems.delete(getDataDbId(sys.gameSystem!));\n        this.store.delete_system(systemId);\n      }\n      this.selectedItem = null;\n    },\n\n    filesUploaded(files: any[]) {\n      console.log(\"Uploaded\", files.length, \"files\", files);\n      const systems = files.filter((o) => o.gameSystem) as BSIDataSystem[];\n      for (const system of systems) {\n        const systemId = system.gameSystem.id;\n        const dbId = getDataDbId(system);\n        this.store.get_system(systemId).setSystem(system);\n        if (!electron) {\n          db.systems.put({ content: system, id: dbId });\n        }\n        this.cataloguesStore.updateCatalogue(system.gameSystem);\n        this.cataloguesStore.setEdited(dbId, false);\n      }\n\n      const catalogues = files.filter((o) => o.catalogue) as BSIDataCatalogue[];\n      for (const catalogue of catalogues) {\n        const systemId = catalogue.catalogue.gameSystemId;\n        this.store.get_system(systemId).setCatalogue(catalogue);\n        if (!electron) {\n          db.catalogues.put({ content: catalogue, id: getDataDbId(catalogue) });\n        }\n        this.cataloguesStore.updateCatalogue(catalogue.catalogue);\n        this.cataloguesStore.setEdited(getDataDbId(catalogue), false);\n      }\n      delete this.$route.query.id;\n    },\n    async editCatalogue(file: BSIData) {\n      const id = getDataObject(file).id;\n      const systemId = getDataObject(file).gameSystemId || id;\n      this.$router.push({\n        name: \"catalogue\",\n        query: { systemId, id },\n      });\n    },\n  },\n});\n</script>\n\n<style scope>\n.scrollable {\n  height: 100%;\n  overflow-y: auto;\n}\n\n.icon {\n  padding: 1px;\n}\n\n.systemLegend {\n  img {\n    vertical-align: middle;\n  }\n}\n</style>\n","export default \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAAKa8AACmvAUYJFJkAAAJdSURBVFhHvddNiE1hHMfxy1yS8VYMm1mwklhYoBRqrLCgWCkvCysxXiIrS4tZmVkrCyWZTF6WSEo2SMhLFt6KsuAOMUNJ+P6cc29//55z7/Oce8evPp1zp3me+z/Pec5znltpkW7sxDk8xzh+ooY7GMRaTEJHMw3HMYrfER5gAzqSJXiK0Be1choqvnRW4BNCnce6Ad26qNh7twh3Me/vp3/zBJehkdE8WIDV2Io58LmEbVBBUZmM2/BX8xabUZSZGIAmpm+7F9HZDt/BI+hKY7IFP2Db60kJjU4wD+Eb9yIl+2D7kKNomWXwDfcjNZpP92D70ePZMgdgG33FdJTJLti+fmEuCqPJpxGw0WT8lp0m53p+rEejsjQ7DUcFzM9OG3mZH8vkPXzxTSeyCvDRsLUT377pe0IFfMxOG1mYH8tEi9iM7LSRD/kxGBWg1c1mDaZmp8lZnx9tnuXHwiyHnbmyG2VyE7Yff3GFUZW24Ts0fXwCCa2meqVHZQ9841vQWh8T3bYx2PZfEHqxBdOF+7AdyGOsRFGqOIjv8G2PISnaiHyG70iP1TXo7bYO2jNswgm8hv//urPQhSWlD34o26G9pEYpKavwBqEOyziP5CJm4SS0rIY69V7hlPubNYzkIpQeaJJdhVa0eofaAb3AGWgzUu/8COwXWxcwBW1FO97ZaHY1hxEqQEbQdhExOQQ9PaEiLuK/FKGNTlER2jWXfd8kpR9FRVxBNXmhSIx+Z2iDuxF+X7AYtYkuQFEReoK0evoi/F5kQqOl3N+OpB8vncgO6NeW3pRDlUql6w9PQiGMhlvIAAAAAABJRU5ErkJggg==\"","export default \"data:image/png;base64,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\""],"names":["fileinput","ref","uploading","onFileSelected","event","input_files","_a","result_files","file","o","isAllowedExtension","content","isZipExtension","asJson","convertToJson","getExtension","getDataObject","emit","e","popFileInput","inputUrl","busy","submit","url","normalizeGithubRepoUrl","repoPath","repoName","apiUrl","defaultBranch","zipDlUrl","zipFile","folder","unzipFolder","name","extension","json","_sfc_main$3","useCataloguesStore","useEditorStore","item","data","result","errors","counts","error","addOne","msgPieces","key","capitalize","sortByAscending","ErrorIcon","_hoisted_5","_hoisted_6","_withScopeId","_createElementVNode","_hoisted_8","_hoisted_9","_hoisted_10","_component_ErrorIcon","__nuxt_component_0","_hoisted_1","_openBlock","_createElementBlock","_Fragment","_renderList","$options","_normalizeClass","$props","$event","_withModifiers","_hoisted_3","_toDisplayString","_hoisted_4","_hoisted_7","_createCommentVNode","_createVNode","_hoisted_2","download","filename","mimeType","a","blob","saveFilePickerOrDownload","writable","_sfc_main$2","loaded","xml","convertToXml","fileName","removeExtension","files","ids","file_data","generateBattlescribeId","cl","format","deleteExistingFiles","path","deleteFile","isSystem","names","getDataDbId","_hoisted_11","_hoisted_14","_hoisted_22","_hoisted_24","_createTextVNode","_component_PopupDialog","_hoisted_12","_hoisted_13","link","_hoisted_15","_hoisted_16","_hoisted_17","_cache","_ctx","$data","args","_hoisted_18","_createBlock","_withCtx","_hoisted_19","_hoisted_20","_hoisted_26","_sfc_main$1","n","_pushScopeId","_popScopeId","_sfc_render","$setup","_withDirectives","_sfc_main","UploadJson","CataloguesDetail","ImportFromGithub","CataloguesCreate","SelectFile","IconContainer","SplitView","useSettingsStore","changes","id","found","github","failed","sys","increment","cat","message","showMessageBox","closeWindow","gst","res","systemId","gameSystem","gstPath","system","copy","systemPath","dirname","db","obj","catalogue","systems","dbId","catalogues","_imports_0","_imports_1","_imports_2","_component_SelectFile","_component_UploadJson","_component_ImportFromGithub","_component_CreateSystem","_component_SplitView","_component_NuxtLink","_b","_component_IconContainer","_component_CataloguesCreate","_component_CataloguesDetail","_Teleport"],"mappings":"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"}