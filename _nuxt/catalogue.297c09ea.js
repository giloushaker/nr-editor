var Nt=Object.defineProperty;var Rt=(e,t,n)=>t in e?Nt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var de=(e,t,n)=>(Rt(e,typeof t!="symbol"?t+"":t,n),n);import{e as j,f as Ft,a as A,o,b as u,h as p,i as s,r as F,c as _,u as Bt,j as Vt,k as De,w as b,v as x,l as g,F as v,m as O,p as q,q as w,s as h,x as H,y as ue,z as J,A as Pt,B as S,C as M,D as T,E as V,t as C,n as ce,g as fe,G as Ee,H as P,I as U,J as Q,K as Z,L as $,M as nt,N as He,O as at,P as we,Q as pe,R as Ie,T as st,S as Ut,U as Ke,V as Lt,W as Ot,X as ee,Y as Qt,Z as Gt,$ as qt,a0 as Dt,a1 as Je,a2 as Kt,a3 as Mt,a4 as qe,a5 as xe,a6 as it,a7 as jt,a8 as Zt,a9 as Wt,aa as $e,ab as Xt,ac as Yt,ad as zt,ae as Ht,af as Jt,ag as $t,ah as en,ai as tn,aj as nn,ak as an,al as sn,am as on}from"./entry.44324e72.js";import{_ as ln}from"./Loading.407504d9.js";import{E as me,_ as se,a as rn}from"./catalogue.4db188c3.js";import{_ as N,a as Te,b as dn,c as un}from"./warning_sign.5d6048fc.js";import{N as cn}from"./NodePath.dedca2cc.js";const gn=e=>Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0)),mn=(e,t)=>(n,i)=>(Ft(()=>e({...gn(n),...i.attrs},i)),()=>{var l,a;return t?(a=(l=i.slots).default)==null?void 0:a.call(l):null}),hn=j({name:"Title",inheritAttrs:!1,setup:mn((e,{slots:t})=>{var i,l,a;return{title:((a=(l=(i=t.default)==null?void 0:i.call(t))==null?void 0:l[0])==null?void 0:a.children)||null}})}),pn=j({name:"Head",inheritAttrs:!1,setup:(e,t)=>()=>{var n,i;return(i=(n=t.slots).default)==null?void 0:i.call(n)}}),fn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},computed:{comment:{get(){return(Array.isArray(this.item.comment)?this.item.comment[0]:this.item.comment)||""},set(e){this.item.comment=e||void 0}}},methods:{changed(){var e;(e=this.item.getCatalogue())==null||e.refreshErrors(this.item),this.$emit("catalogueChanged")}}},yn=s("legend",null,"Comment",-1);function Cn(e,t,n,i,l,a){const d=me;return o(),u("fieldset",null,[yn,p(d,{modelValue:a.comment,"onUpdate:modelValue":t[0]||(t[0]=r=>a.comment=r),onChange:a.changed},null,8,["modelValue","onChange"])])}const L=A(fn,[["render",Cn]]),_n=j({components:{EditableDiv:me},emits:["update:modelValue"],props:{modelValue:{type:Array}},data(){return{_value:""}},watch:{modelValue:{immediate:!0,handler(e){this._value=e?e.join(`
`):""}}},methods:{toValue(e){const t=e.split(`
`).filter(n=>n);if(t.length)return t}}});function An(e,t,n,i,l,a){const d=F("EditableDiv");return o(),_(d,{modelValue:e._value,"onUpdate:modelValue":t[0]||(t[0]=r=>e._value=r),onChange:t[1]||(t[1]=r=>e.$emit("update:modelValue",("toValue"in e?e.toValue:Bt(Vt))(e._value)))},null,8,["modelValue"])}const bn=A(_n,[["render",An]]),vn={components:{InputStringArray:bn},emits:["catalogueChanged","namechanged","idchanged","aliaschanged"],props:{item:{type:Object,required:!0},aliases:{type:Boolean,default:!1}},methods:{idchanged(){this.$emit("idchanged"),this.$emit("catalogueChanged")},namechanged(){this.$emit("namechanged"),this.$emit("catalogueChanged")},aliaschanged(){this.$emit("aliaschanged"),this.$emit("catalogueChanged")},refresh(){this.id=De(),this.idchanged()}},computed:{id:{get(){return this.item.id},set(e){const t=this.item,n=t.getCatalogue();n.removeFromIndex(t),t.id=e,n.addToIndex(t)}}}},kn=""+new URL("back.33e845c9.png",import.meta.url).href;const wn=s("legend",null,"Basics",-1),In={class:"editorTable"},En=s("td",null,"Unique ID:",-1),xn={class:"flex gap-2px"},Tn=s("span",null,[s("img",{class:"h-20px w-20px icon",src:kn,title:"Generate Id"})],-1),Sn=[Tn],Nn=s("td",null,"Name:",-1),Rn={key:0},Fn=s("td",null,"Child Forces Label:",-1),Bn=s("td",{class:"hastooltip",title:`Additional Aliases for in-text reference matching, case insensitive.
one per line`}," Aliases: ",-1),Vn=s("td",{class:"hastooltip",title:"Disable indexing the name of this node for in-text references."},"No Index",-1);function Pn(e,t,n,i,l,a){const d=F("InputStringArray");return o(),u("fieldset",null,[wn,s("table",In,[s("tr",null,[En,s("td",xn,[b(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>a.id=r),onChange:t[1]||(t[1]=(...r)=>a.idchanged&&a.idchanged(...r)),class:"flex flex-shrink"},null,544),[[x,a.id]]),s("button",{class:"btn !w-34px flex items-center mr-8px",onClick:t[2]||(t[2]=(...r)=>a.refresh&&a.refresh(...r))},Sn)])]),s("tr",null,[Nn,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=r=>n.item.name=r),onChange:t[4]||(t[4]=(...r)=>a.namechanged&&a.namechanged(...r))},null,544),[[x,n.item.name]])])]),n.item.editorTypeName==="force"?(o(),u("tr",Rn,[Fn,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=r=>n.item.childForcesLabel=r),onChange:t[6]||(t[6]=(...r)=>a.namechanged&&a.namechanged(...r)),placeholder:"Forces"},null,544),[[x,n.item.childForcesLabel]])])])):g("",!0),n.aliases?(o(),u(v,{key:1},[s("tr",null,[Bn,s("td",null,[p(d,{modelValue:n.item.alias,"onUpdate:modelValue":t[7]||(t[7]=r=>n.item.alias=r),onChange:a.aliaschanged},null,8,["modelValue","onChange"])])]),s("tr",null,[Vn,s("td",null,[b(s("input",{type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=r=>n.item.noindex=r),onChange:t[9]||(t[9]=(...r)=>a.namechanged&&a.namechanged(...r))},null,544),[[O,n.item.noindex]])])])],64)):g("",!0)])])}const D=A(vn,[["render",Pn]]),Un={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Ln=s("legend",null,"Publication",-1),On={class:"editorTable"},Qn=s("td",null,"Short Name",-1),Gn=s("td",null,"Publication:",-1),qn=s("td",null,"Publication Date:",-1),Dn=s("td",null,"Publication URL:",-1);function Kn(e,t,n,i,l,a){return o(),u("fieldset",null,[Ln,s("table",On,[s("tr",null,[Qn,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=d=>n.item.shortName=d),onChange:t[1]||(t[1]=(...d)=>a.changed&&a.changed(...d))},null,544),[[x,n.item.shortName]])])]),s("tr",null,[Gn,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=d=>n.item.publisher=d),onChange:t[3]||(t[3]=(...d)=>a.changed&&a.changed(...d))},null,544),[[x,n.item.publisher]])])]),s("tr",null,[qn,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=d=>n.item.publicationDate=d),onChange:t[5]||(t[5]=(...d)=>a.changed&&a.changed(...d))},null,544),[[x,n.item.publicationDate]])])]),s("tr",null,[Dn,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=d=>n.item.publisherUrl=d),onChange:t[7]||(t[7]=(...d)=>a.changed&&a.changed(...d))},null,544),[[x,n.item.publisherUrl]])])])])])}const Mn=A(Un,[["render",Kn]]),jn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Zn(e,t,n,i,l,a){const d=L,r=D,c=Mn;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{class:"section",item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])],64)}const Wn=A(jn,[["render",Zn]]),Xn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Yn=s("label",{for:"hidden"},"Hidden",-1);function zn(e,t,n,i,l,a){return o(),u("fieldset",null,[s("legend",null,[q(e.$slots,"default")]),b(s("input",{id:"hidden",type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=d=>n.item.hidden=d),onChange:t[1]||(t[1]=(...d)=>a.changed&&a.changed(...d))},null,544),[[O,n.item.hidden]]),Yn])}const oe=A(Xn,[["render",zn]]),Hn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Jn={class:"section"},$n=s("legend",null,"Limit",-1),ea={class:"editorTable"},ta=s("td",null,"Default Cost Limit: ",-1),na=s("span",{class:"gray ml-10px"},"-1 = No limit",-1);function aa(e,t,n,i,l,a){const d=L,r=D,c=oe;return o(),u("div",null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Cost Types ")]),_:1},8,["item","onCatalogueChanged"]),s("div",Jn,[s("fieldset",null,[$n,s("table",ea,[s("tr",null,[ta,s("td",null,[b(s("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=y=>n.item.defaultCostLimit=y),onChange:t[1]||(t[1]=(...y)=>a.changed&&a.changed(...y))},null,544),[[x,n.item.defaultCostLimit]]),na])])])])])])}const sa=A(Hn,[["render",aa]]);H([],e=>e);function ia(e){const t=e[0][0];return e.length>1||["type"].includes(t)}function oa(e){const t=e.split(`
`).map(i=>i.trim()).filter(i=>i),n=[];for(const i of t){const a=i.split("&").map(d=>d.trim()).filter(d=>d).map(d=>d.split(":").map(r=>r.trim()).map(r=>{const c=/^\/(.*?)\/([gimuy]*)$/.exec(r);return c?RegExp(c[1],c[2]):r}));n.push(a)}return n.reverse()}class et{constructor(t,n=a=>a.sortIndex,i=(a,d)=>a.sortIndex=d,l=a=>delete a.sortIndex){de(this,"set");de(this,"get");de(this,"del");de(this,"config");de(this,"parsed");this.set=i,this.get=n,this.del=l,this.config=t}fixup(t){let n=1;for(const i of t)this.get(i)!==void 0&&(this.set(i,n),n++)}setConfig(t){this.config=t,delete this.parsed}evalLine(t,n){let i=0;for(const l of n){switch(l[0]){case"type":const d=l[1];switch(d){case"group":i=t.isGroup()?0:1;break;case"entry":i=t.isEntry()?0:1;break;default:i=t.getType()===d?0:1}break;case"name":i=l[1].exec(t.getName())?0:1;break}if(i===1)return i}return i}doAutoSort(t,n){for(const a of n)if(ia(a))ue(t,d=>this.evalLine(d,a));else switch(a[0][0]){case"cost":const r=a[0][1].toLowerCase();ue(t,c=>{var y;return((y=c.getCosts().find(f=>f.name.toLowerCase()===r))==null?void 0:y.value)??0});break;case"name":ue(t,c=>c.getName());break}let i=1,l=0;for(const a of t)this.get(a)!==i&&(l+=1),this.set(a,i),i+=1;return l}autoSort(t){return this.parsed||(this.parsed=oa(this.config)),this.doAutoSort(t,this.parsed)}}const la=j({props:{items:{type:Array,required:!0},get:{type:Function,required:!0},set:{type:Function,required:!0},del:{type:Function,required:!0},autosort:{type:Boolean,default:!0},parent:{type:Object}},setup(){return{settings:J()}},data(){return{dragging:null,dropIndex:null,configure:!1,massSort:!1,massSortIn:"catalogue"}},computed:{sorted(){return H(this.items,e=>this.get(e)??1e4)},realDropIndex(){return this.dropIndex===null?null:Math.min(this.sorted.filter(e=>this.get(e)!==void 0).length,this.dropIndex)}},methods:{same(e){const t=this.sorted[e];return!(!this.get(t)||t!==this.dragging&&this.sorted[e-1]!==this.dragging)},same_below(e){const t=this.sorted[e-1];return!(!this.get(t)||t!==this.dragging&&this.sorted[e]!==this.dragging)},dragStart(e){this.dragging=e},dragEnter(e,t){const i=e.target.closest(".drop-item").getBoundingClientRect(),l=(i.top+i.bottom)/2;e.clientY>l&&(t+=1),this.dragging!==t?this.dropIndex=t:this.dropIndex=null},drop(e){if(e===null)return;const t=e+1;if(this.dropIndex=null,this.dragging!==null){const n=[];for(const i of this.sorted){const l=this.get(i);l!==void 0&&n.push({item:i,idx:l})}if(n.find(i=>i.idx===t))for(const{item:i,idx:l}of n)l>=t&&this.set(i,l+1);this.set(this.dragging,t),this.fixup(),this.dragging=null}},fixup(){let e=1;for(const t of this.sorted)this.get(t)!==void 0&&(this.set(t,e),e++)},autoSort(e){new et(this.settings.autosort.config,this.get,this.set,this.del).autoSort(e)},async autoSortAllIn(e){if(this.parent){const t=this.parent.catalogue,n=this.parent.catalogue.manager,i=new et(this.settings.autosort.config,this.get,this.set,this.del),l=new Set(["sharedSelectionEntries","sharedSelectionEntryGroups","selectionEntries","selectionEntryGroups"]),a=[];switch(e){case"catalogue&imports":a.push(...this.parent.catalogue.imports);case"catalogue":a.push(t);break;case"all":e==="all"&&(await n.loadAll(),a.push(...n.getAllLoadedCatalogues()))}let d=0;for(const r of a)r.forEachObjectWhitelist(c=>{const y=[...c.localSelectionsIterator()];y.length>1&&(d+=i.autoSort(y))},l);notify(`Affected ${d} entries.`)}}}});const he=e=>(P("data-v-63b3e91b"),e=e(),U(),e),ra={class:"scrollable max-h-60vh p-10px"},da={key:0,class:"mb-10px"},ua={class:"text-center",id:"auto-sort-all-in"},ca=he(()=>s("option",{value:"catalogue"},"Catalogue",-1)),ga=he(()=>s("option",{value:"catalogue&imports"},"Catalogue & Imports",-1)),ma=he(()=>s("option",{value:"all"},"All Catalogues",-1)),ha=[ca,ga,ma],pa=he(()=>s("div",null,[h(" Enter rules for sorting below: "),s("br"),h("Possible rules: ")],-1)),fa=he(()=>s("div",null,[s("span",{class:"cost"},"type:model"),s("span",{class:"cost"},"type:upgrade"),s("span",{class:"cost"},"type:unit"),s("span",{class:"cost"},"type:mount"),s("span",{class:"cost"},"type:crew"),s("span",{class:"cost"},"type:entry"),s("span",{class:"cost"},"type:group"),s("br"),s("span",{class:"cost"},"cost:{name}"),s("br"),s("span",{class:"cost"},"name"),s("span",{class:"cost"},"name:/{regex}/i"),s("br")],-1)),ya=he(()=>s("div",null,[h(" Multiple rules may be combined on the same line with "),s("span",{class:"cost"},"&"),h(" eg: "),s("span",{class:"cost"},"type:group & name:/options/i"),s("br"),h("Higher rules take priority. ")],-1)),Ca=["onDragstart","onDragenter","onDragover"],_a={key:1},Aa=["onClick"];function ba(e,t,n,i,l,a){const d=Ee,r=me;return o(),u("div",ra,[e.autosort?(o(),u("div",da,[s("button",{class:"bouton",id:"auto-sort",onClick:t[1]||(t[1]=c=>e.autoSort(e.items))},[h(" AutoSort "),s("img",{src:Pt,class:"cursor-pointer hover-darken right-icon",onClick:t[0]||(t[0]=S(c=>e.configure=!0,["stop","prevent"]))})]),e.massSort?(o(),_(d,{key:0,modelValue:e.massSort,"onUpdate:modelValue":t[3]||(t[3]=c=>e.massSort=c),button:"Sort",text:"Cancel",onButton:t[4]||(t[4]=c=>e.autoSortAllIn(e.massSortIn))},{default:w(()=>[s("div",ua,[h(" In "),b(s("select",{"onUpdate:modelValue":t[2]||(t[2]=c=>e.massSortIn=c)},ha,512),[[M,e.massSortIn]])])]),_:1},8,["modelValue"])):g("",!0),e.configure?(o(),_(d,{key:1,modelValue:e.configure,"onUpdate:modelValue":t[6]||(t[6]=c=>e.configure=c),button:"Mass Sort",onButton:t[7]||(t[7]=c=>e.massSort=!0)},{default:w(()=>[pa,fa,ya,p(r,{modelValue:e.settings.autosort.config,"onUpdate:modelValue":t[5]||(t[5]=c=>e.settings.autosort.config=c),style:{"font-family":"monospace"},spellcheck:"false"},null,8,["modelValue"])]),_:1},8,["modelValue"])):g("",!0)])):g("",!0),(o(!0),u(v,null,T(e.sorted,(c,y)=>(o(),u("div",{class:V(["p-4px border-solid -mt-1px border-1px hover-darken unselectable 0px drop-item",{"drop-target-is-above":e.realDropIndex===y&&!e.same(y),"drop-target-is-below":e.realDropIndex===y+1&&!e.same_below(y+1),dragging:c===e.dragging}]),draggable:"true",onDragstart:f=>e.dragStart(c),onDragover:[t[8]||(t[8]=S(()=>{},["prevent"])),f=>e.dragEnter(f,y)],onDrop:t[9]||(t[9]=f=>e.drop(e.realDropIndex)),onDragenter:f=>e.dragEnter(f,y)},[e.get(c)===void 0?(o(),u("span",{key:0,class:V({gray:e.get(c)===void 0}),title:"Will not be ordered specifically (but will be after anything with an index set)"}," [?] ",2)):(o(),u("span",_a," ["+C(e.get(c))+"] ",1)),q(e.$slots,"item",ce(fe({item:c})),void 0,!0),e.get(c)!==void 0?(o(),u("span",{key:2,class:"px-4px py-1px hover-brighten cursor-pointer unselectable float-right",onClick:S(f=>e.del(c),["stop"])},"x",8,Aa)):g("",!0)],42,Ca))),256))])}const ot=A(la,[["render",ba],["__scopeId","data-v-63b3e91b"]]),va={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},data(){return{selectedType:null,orderPopup:!1}},setup(){return{store:Q()}},computed:{selected:{set(e){this.selectedType=this.item.characteristicTypes.find(t=>t.id===e)||null},get(){var e;return((e=this.selectedType)==null?void 0:e.id)||null}}},methods:{get(e){return e.sortIndex},set(e,t){e.sortIndex=t,this.store.set_catalogue_changed(e.catalogue,!0)},del_sort(e){delete e.sortIndex,this.store.set_catalogue_changed(e.catalogue,!0)},get_profile_types(){const e=this.item.catalogue.manager.getAllLoadedCatalogues(),t=[];for(const n of e)for(const i of n.profileTypes||[])t.push(i);return t},async add(){const e=await this.store.create_node("characteristicTypes",this.item),t=this.item.refs||[];for(const n of t)n.isProfile()&&!n.isLink()&&n.typeId===this.item.id&&(n.characteristics||(n.characteristics=[]),n.characteristics.push({typeId:e.id,name:e.name,$text:""}));this.$emit("catalogueChanged")},del(){const e=this.selectedType;e&&this.store.del_node(e);const t=this.item.refs||[];for(const n of t)for(const i of n.profilesIterator())i.typeId===this.item.id&&i.characteristics&&(i.characteristics=i.characteristics.filter(l=>l.typeId!==e.id));this.$emit("catalogueChanged")},characteristicIdChanged(e){const t=this.item.refs||[];for(const n of t)if(n.typeId===this.item.id)for(const i of n.characteristics||[])i.name==e.name&&(i.typeId=e.id,this.store.set_catalogue_changed(n.catalogue));this.$emit("catalogueChanged")},characteristicNameChanged(e){const t=this.item.refs||[];for(const n of t)if(n.typeId===this.item.id)for(const i of n.characteristics||[])i.typeId==e.id&&(i.name=e.name,this.store.set_catalogue_changed(n.catalogue));this.$emit("catalogueChanged")},init(){var e;(e=this.item.characteristicTypes)!=null&&e.length&&(this.selectedType=this.item.characteristicTypes[0])}},created(){this.init()},watch:{item(){this.init()}},components:{SortOrder:ot}},ka="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV8/RCkVB4uIOASsTlZERRy1CkWoEGqFVh1MLv2CJg1Jiouj4Fpw8GOx6uDirKuDqyAIfoA4OjkpukiJ/0sKLWI8OO7Hu3uPu3eAv15mqhkcB1TNMlKJuJDJrgqdrwiiDyGMYUhipj4nikl4jq97+Ph6F+NZ3uf+HN1KzmSATyCeZbphEW8QT29aOud94ggrSgrxOfGoQRckfuS67PIb54LDfp4ZMdKpeeIIsVBoY7mNWdFQiaeIo4qqUb4/47LCeYuzWq6y5j35C8M5bWWZ6zQHkcAiliBCgIwqSijDQoxWjRQTKdqPe/gHHL9ILplcJTByLKACFZLjB/+D392a+ckJNykcBzpebPtjGOjcBRo12/4+tu3GCRB4Bq60lr9SB2Y+Sa+1tOgR0LMNXFy3NHkPuNwB+p90yZAcKUDTn88D72f0TVmg9xYIrbm9Nfdx+gCkqavkDXBwCIwUKHvd491d7b39e6bZ3w+TdnK04tslPQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB+YEFgsEBONvEkAAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAfklEQVQ4y+2VOw7AMAhDTdVj5nbknnTpkCIMapqt8YYELx9LRlDLXC34IAOgQ63BAelpvrmTucY4EoD6xEvayDOsk533jVZC6f9NzR6kwbupzm3vPipgK8zpgdMpcFobuIG/AGoSoixglQHFB2UhGeC0v9wZxc4JyW9z8cG4AK8CG5AjF625AAAAAElFTkSuQmCC";const te=e=>(P("data-v-26b0ac5c"),e=e(),U(),e),wa=te(()=>s("legend",null," Order ",-1)),Ia=te(()=>s("legend",null,"Profil Type",-1)),Ea=te(()=>s("h3",null,"Characteristic Types",-1)),xa=["value"],Ta={class:"section add"},Sa=te(()=>s("img",{src:N},null,-1)),Na=te(()=>s("img",{src:ka},null,-1)),Ra=te(()=>s("h3",{class:"section"},"Selected Characteristic Type",-1)),Fa={class:"editorTable"},Ba=te(()=>s("td",null,"Unique Id:",-1)),Va=te(()=>s("td",null,"Name:",-1)),Pa=te(()=>s("div",{class:"text-center"},"Drag & Drop to change profileTypes order",-1));function Ua(e,t,n,i,l,a){const d=F("SortOrder"),r=Ee;return o(),u("span",null,[s("fieldset",null,[wa,s("button",{class:"bouton inline",onClick:t[0]||(t[0]=c=>l.orderPopup=!0)},"Change")]),s("fieldset",null,[Ia,Ea,s("div",null,[b(s("select",{size:"2","onUpdate:modelValue":t[1]||(t[1]=c=>a.selected=c)},[(o(!0),u(v,null,T(n.item.characteristicTypes,c=>(o(),u("option",{value:c.id},C(c.name),9,xa))),256))],512),[[M,a.selected]]),s("div",Ta,[s("button",{class:"bouton",onClick:t[2]||(t[2]=(...c)=>a.add&&a.add(...c))},[Sa,h(" Add ")]),s("button",{class:"bouton",onClick:t[3]||(t[3]=(...c)=>a.del&&a.del(...c))},[Na,h(" Delete ")])]),l.selectedType?(o(),u(v,{key:0},[Ra,s("table",Fa,[s("tr",null,[Ba,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=c=>l.selectedType.id=c),onChange:t[5]||(t[5]=c=>a.characteristicIdChanged(l.selectedType))},null,544),[[x,l.selectedType.id]])])]),s("tr",null,[Va,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=c=>l.selectedType.name=c),onChange:t[7]||(t[7]=c=>a.characteristicNameChanged(l.selectedType))},null,544),[[x,l.selectedType.name]])])])])],64)):g("",!0)])]),l.orderPopup?(o(),_(r,{key:0,modelValue:l.orderPopup,"onUpdate:modelValue":t[8]||(t[8]=c=>l.orderPopup=c)},{default:w(()=>[Pa,p(d,{items:a.get_profile_types(),get:a.get,set:a.set,del:a.del_sort,autosort:!1},{item:w(({item:c})=>[h(C(c.name),1)]),_:1},8,["items","get","set","del"])]),_:1},8,["modelValue"])):g("",!0)])}const La=A(va,[["render",Ua],["__scopeId","data-v-26b0ac5c"]]),Oa={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},setup(){return{store:Q()}},methods:{changed(){this.$emit("catalogueChanged")},profileNameChanged(){const e=this.item.refs||[];for(const t of e)t.typeId===this.item.id&&(t.typeName=this.item.name,this.store.set_catalogue_changed(t.catalogue));this.$emit("catalogueChanged")},profileIdChanged(){const e=this.item.refs||[];for(const t of e)t.typeName===this.item.name&&(t.typeId=this.item.id,this.store.set_catalogue_changed(t.catalogue));this.$emit("catalogueChanged")}}};function Qa(e,t,n,i,l,a){const d=L,r=D,c=La;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section",onNamechanged:a.profileNameChanged,onIdchanged:a.profileIdChanged},null,8,["item","onCatalogueChanged","onNamechanged","onIdchanged"]),p(c,{class:"section",item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])],64)}const Ga=A(Oa,[["render",Qa]]),qa={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},computed:{publications(){return H([...this.catalogue.iteratePublications()],e=>(e==null?void 0:e.name)||"")}},methods:{getNameExtra:Z,getName:$,changed(){this.$emit("catalogueChanged")}}},Da="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TS0UrDhaU4pChOlkQFXHUKhShQqkVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6uKk6CIl/i8ptIjx4Lgf7+497t4BQqPCVLNrHFA1y0gn4mI2tyoGXxFAL4KIYFBipj6XSiXhOb7u4ePrXYxneZ/7c/QpeZMBPpF4lumGRbxBPL1p6Zz3icOsJCnE58RjBl2Q+JHrsstvnIsOCzwzbGTS88RhYrHYwXIHs5KhEk8RRxVVo3wh67LCeYuzWqmx1j35C0N5bWWZ6zSHkcAilpCCCBk1lFGBhRitGikm0rQf9/BHHH+KXDK5ymDkWEAVKiTHD/4Hv7s1C5MTblIoDgRebPtjBAjuAs26bX8f23bzBPA/A1da219tADOfpNfbWvQI6N8GLq7bmrwHXO4AQ0+6ZEiO5KcpFArA+xl9Uw4YuAV61tzeWvs4fQAy1FXyBjg4BEaLlL3u8e7uzt7+PdPq7wcllnKI7QJDVQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFCwgaM9maQ54AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAACEElEQVQ4y52RzWsTQRiHn9luvsBCFpomtISSBFRICAgeApUeipcWT176n/Tc/yPneggI3rwJfkCwhnoTP+LuyWw8JBnS2DXszoyHdbcJXtT3NHP4PfO8vxEAz1+8ND+Da/5mSuUKD+7fE8ndBrj+seD44SFaa4wxaK2JogilFEoptNYADIdDvvsj3gzemwRiARhj0mASMMaglCIMQ5bLJUEQsFgsePzomPHoG6/fXZrUQCuFZVn0+33y+TytVovBYEA2myWXyzGZTGi1WkynU87PzwHof3VvVtBaI4Sg0+mkNsk5sQjDkP39fbTWFAoFXvXfrgMAut0u5XKZdrvN2dkZhUKBer2O4zicnJzQ6/UolUo0m800YwMoFRscHR1hjKFara6FXdclk8lweBgXvbu7y4cv8QpWDFAIIfB9HyklQoi18Gg0YmNjg/F4jJQSy7JQSq0Y6Biws7MTUy2L09PTtI/kh6rVKkopbNtG6VVAFAHgeR7FYpG9vT0uLi7I5XIATKdTDg4O8DyPWq0WA35n7NUV6vU6QGqTvF4sFhFC0Gg0MMasrWABRFGEEAIpJb7vr/WxXC7TXjzPS8/RqkEYhgghcBwHx3HWDADy+fwfhmEY3gDm8zmu6yKlZDabpX1UKhWCICAIAgCklCl0Pp/HsCdPn5nPnz6yuLriX+bW5ia379zF3ipts1Xa5n/nF4VfO8AW+/8fAAAAAElFTkSuQmCC",Ka=s("legend",null,[s("img",{src:Da}),h(" Reference")],-1),Ma={class:"editorTable"},ja=s("td",null,"Publication:",-1),Za={class:"flex align-items flex-row"},Wa=["src"],Xa={class:"inline"},Ya={class:"grey"},za=["src"],Ha=s("span",{class:"inline"},"None",-1),Ja=s("td",null,"Page:",-1);function $a(e,t,n,i,l,a){const d=se;return o(),u("fieldset",null,[Ka,s("table",Ma,[s("tr",null,[ja,s("td",null,[p(d,{options:a.publications,filterField:r=>r.getName(),valueField:"id",modelValue:n.item.publicationId,"onUpdate:modelValue":t[0]||(t[0]=r=>n.item.publicationId=r),onChange:a.changed,nullable:""},{option:w(({option:r})=>[s("div",Za,[r?(o(),u(v,{key:0},[s("img",{class:"mr-1 my-auto",src:`assets/bsicons/${r.editorTypeName}.png`},null,8,Wa),s("span",Xa,[h(C(a.getName(r))+" ",1),s("span",Ya,C(a.getNameExtra(r)),1)])],64)):(o(),u(v,{key:1},[s("img",{class:"mr-1 my-auto",src:"assets/bsicons/bullet.png"},null,8,za),Ha],64))])]),_:1},8,["options","filterField","modelValue","onChange"])])]),s("tr",null,[Ja,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=r=>n.item.page=r),onChange:t[2]||(t[2]=(...r)=>a.changed&&a.changed(...r))},null,544),[[x,n.item.page]])])])])])}const ne=A(qa,[["render",$a]]),es={emits:["catalogueChanged"],setup(){return{store:Q()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},methods:{changed(){this.$emit("catalogueChanged")},add(e,t){this.store.create_child("constraints",this.item,{type:e,scope:t,value:1,select:!1,includeChildSelections:!!["roster"].includes(t)})}}},lt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAABg2lDQ1BJQ0MgUHJvZmlsZQAAKM+VkTlIA0EYhb9EJeKBhQFFLLZQKwOiIpYaBREUQlTwKtzdmChkN2E3wcZSsA1YeDRehY21tha2giB4gNjaWCnaiKz/bIQEIYIDw3y8mfeYeQPBg7RpudU9YNk5Jz4W1Wbn5rXQMzXUE6KNFt10s8Ox2AQVx8ctAbXeRFQW/xuNiWXXhIAmPGRmnZzwkvDAWi6reEc4bK7oCeFT4W5HLih8r3SjyC+KUz4HVWbYmY6PCIeFtVQZG2VsrjiWcL9wR8KyJT84W+SE4nXFVjpv/txTvbBh2Z6ZUrrMdsYYZ5IYGgZ5VkmTIyKrLYpLXPajFfxtvj8mLkNcq5jiGCWDhe77UX/wu1s32ddbTGqIQs2T5711QmgLvgqe93noeV9HUPUIF3bJnzmAwXfRCyWtYx+aNuDssqQZ23C+Ca0PWd3RfalKZjCZhNcT+aY5aL6GuoVibz/7HN/BtHQ1cQW7e9CVkuzFCu+uLe/tzzN+f0S/ASWWcoi7xtRwAAAACXBIWXMAAC4iAAAuIgGq4t2SAAAAzElEQVQ4T2NkwAIWLFiw6+hzX1col8FacvPuhIQENyiXMAAZENfw9D+IhgpRF6A4O7/r2n9DsVO7V5zSc40wu4RBn39l5jqxTAurV8FOhTKxAgx5ZAGjkO3/oUysAFkerE/Tez08UIi1GUSD9DEou67+D8IgQRiNCyCrA2Gm//8ZGWqjv+4GCcJoXABZHUgfilNV3DbhtRlZHsOLxPoZBpigNBisPsDhClKgH3gCHIjoNEgeqpSGAGSTbfwD0tM2SINj8sv/MIzdAAYGAB1Xk+VGE8P2AAAAAElFTkSuQmCC";const R=e=>(P("data-v-fa801091"),e=e(),U(),e),ts=R(()=>s("legend",null,[s("img",{src:lt}),h(" Quick Constraints")],-1)),ns={class:"columns"},as={class:"column"},ss=R(()=>s("img",{src:N},null,-1)),is=R(()=>s("span",{class:"text"},"MIN 1 IN PARENT",-1)),os=[ss,is],ls=R(()=>s("img",{src:N},null,-1)),rs=R(()=>s("span",{class:"text"},"MIN 1 IN CATEGORY",-1)),ds=[ls,rs],us=R(()=>s("img",{src:N},null,-1)),cs=R(()=>s("span",{class:"text"},"MIN 1 IN FORCE",-1)),gs=[us,cs],ms=R(()=>s("img",{src:N},null,-1)),hs=R(()=>s("span",{class:"text"},"MIN 1 IN ROSTER",-1)),ps=[ms,hs],fs={class:"column"},ys=R(()=>s("img",{src:N},null,-1)),Cs=R(()=>s("span",{class:"text"},"MAX 1 IN PARENT",-1)),_s=[ys,Cs],As=R(()=>s("img",{src:N},null,-1)),bs=R(()=>s("span",{class:"text"},"MAX 1 IN CATEGORY",-1)),vs=[As,bs],ks=R(()=>s("img",{src:N},null,-1)),ws=R(()=>s("span",{class:"text"},"MAX 1 IN FORCE",-1)),Is=[ks,ws],Es=R(()=>s("img",{src:N},null,-1)),xs=R(()=>s("span",{class:"text"},"MAX 1 IN ROSTER",-1)),Ts=[Es,xs],Ss={class:"column"},Ns=R(()=>s("img",{src:N},null,-1)),Rs=R(()=>s("span",{class:"text"},"EXACTLY 1 IN PARENT",-1)),Fs=[Ns,Rs],Bs=R(()=>s("img",{src:N},null,-1)),Vs=R(()=>s("span",{class:"text"},"EXACTLY 1 IN CATEGORY",-1)),Ps=[Bs,Vs],Us=R(()=>s("img",{src:N},null,-1)),Ls=R(()=>s("span",{class:"text"},"EXACTLY 1 IN FORCE",-1)),Os=[Us,Ls],Qs=R(()=>s("img",{src:N},null,-1)),Gs=R(()=>s("span",{class:"text"},"EXACTLY 1 IN ROSTER",-1)),qs=[Qs,Gs];function Ds(e,t,n,i,l,a){return o(),u("fieldset",null,[ts,s("div",ns,[s("div",as,[s("button",{class:"bouton",onClick:t[0]||(t[0]=d=>a.add("min","parent"))},os),n.withCategory?(o(),u("button",{key:0,class:"bouton",onClick:t[1]||(t[1]=d=>a.add("min","parent"))},ds)):g("",!0),s("button",{class:"bouton",onClick:t[2]||(t[2]=d=>a.add("min","force"))},gs),s("button",{class:"bouton",onClick:t[3]||(t[3]=d=>a.add("min","roster"))},ps)]),s("div",fs,[s("button",{class:"bouton",onClick:t[4]||(t[4]=d=>a.add("max","parent"))},_s),n.withCategory?(o(),u("button",{key:0,class:"bouton",onClick:t[5]||(t[5]=d=>a.add("max","parent"))},vs)):g("",!0),s("button",{class:"bouton",onClick:t[6]||(t[6]=d=>a.add("max","force"))},Is),s("button",{class:"bouton",onClick:t[7]||(t[7]=d=>a.add("max","roster"))},Ts)]),s("div",Ss,[s("button",{class:"bouton",onClick:t[8]||(t[8]=d=>a.add("exactly","parent"))},Fs),n.withCategory?(o(),u("button",{key:0,class:"bouton",onClick:t[9]||(t[9]=d=>a.add("exactly","parent"))},Ps)):g("",!0),s("button",{class:"bouton",onClick:t[10]||(t[10]=d=>a.add("exactly","force"))},Os),s("button",{class:"bouton",onClick:t[11]||(t[11]=d=>a.add("exactly","roster"))},qs)])])])}const Ce=A(es,[["render",Ds],["__scopeId","data-v-fa801091"]]),Ks={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ms(e,t,n,i,l,a){const d=L,r=D,c=ne,y=oe,f=Ce;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(y,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),p(f,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const js=A(Ks,[["render",Ms]]),Zs={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ws(e,t,n,i,l,a){const d=L,r=D,c=ne,y=oe,f=Ce;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(y,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),p(f,{item:n.item,onCatalogueChanged:a.changed,withCategory:!0,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Xs=A(Zs,[["render",Ws]]),Ys={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0},link:{type:Boolean}},setup(){return{settings:J(),store:Q()}},methods:{getName:$,getNameExtra:Z,changedType(e,t){this.item.getCatalogue().refreshErrors(this.item),t&&this.catalogue.removeRef(this.item,t),e&&this.catalogue.addRef(this.item,e),this.item.characteristics=this.characteristics,this.$emit("catalogueChanged")},changed(){const e=this.characteristics;this.store.edit_node(this.item,{characteristics:e}),this.$emit("catalogueChanged")},fixEndlines(e){return console.log("Fixing"),e=e.replace(/([^.:])\n/g,"$1 "),e=e.replace(/([.:]\n)/g,`$1
`),e=e.replace(/([^\n])•(?=[^\n])/g,`$1
• `),e=e.replace(/\n\n\n*/g,`

`),e.replace(/ +/g," ")}},computed:{profileTypes(){return[...this.catalogue.iterateProfileTypes()]},characteristics(){var i;const e={};for(const l of this.item.characteristics||[])e[l.name]=l.$text;if(!this.item.typeId)return[];const t=this.catalogue.findOptionById(this.item.typeId);return this.item.isLink()||(this.item.typeName=t==null?void 0:t.name),(i=t==null?void 0:t.characteristicTypes)==null?void 0:i.map(l=>({name:l.name,typeId:l.id,$text:e[l.name]||""}))}}},zs={key:0,class:"gray"},Hs={class:"editorTable"},Js=s("td",null,"Profile Type: ",-1),$s={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},ei=["src"],ti={class:"inline"},ni={class:"grey"},ai={class:"editorTable"};function si(e,t,n,i,l,a){const d=se,r=me;return o(),u("fieldset",null,[s("legend",null,[h("Characteristics"),n.link?(o(),u("span",zs," (from target)")):g("",!0)]),s("table",Hs,[s("tr",null,[Js,s("td",null,[p(d,{options:a.profileTypes,filterField:c=>c.getName(),valueField:"id",modelValue:n.item.typeId,"onUpdate:modelValue":t[0]||(t[0]=c=>n.item.typeId=c),onChange:a.changedType},{option:w(({option:c})=>[s("div",$s,[s("img",{class:"mr-1 my-auto",src:`assets/bsicons/${c.editorTypeName}.png`},null,8,ei),s("span",ti,[h(C(a.getName(c))+" ",1),s("span",ni,C(a.getNameExtra(c)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])])])]),s("table",ai,[(o(!0),u(v,null,T(a.characteristics,c=>(o(),u("tr",null,[s("td",null,C(c.name)+": ",1),s("td",null,[p(r,{modelValue:c.$text,"onUpdate:modelValue":y=>c.$text=y,onChange:a.changed,beforePaste:i.settings.autoFormatCharacteristics?a.fixEndlines:void 0},null,8,["modelValue","onUpdate:modelValue","onChange","beforePaste"])])]))),256))])])}const rt=A(Ys,[["render",si]]),ii={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function oi(e,t,n,i,l,a){const d=L,r=D,c=ne,y=oe,f=rt;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section",aliases:""},null,8,["item","onCatalogueChanged"]),p(c,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(y,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),p(f,{class:"section",item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const li=A(ii,[["render",oi]]),ri={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},di=s("legend",null,"Description",-1);function ui(e,t,n,i,l,a){const d=me;return o(),u("fieldset",null,[di,p(d,{modelValue:n.item.description,"onUpdate:modelValue":t[0]||(t[0]=r=>n.item.description=r),onChange:a.changed},null,8,["modelValue","onChange"])])}const ci=A(ri,[["render",ui]]),gi={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function mi(e,t,n,i,l,a){const d=L,r=D,c=ne,y=oe,f=ci;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section",aliases:""},null,8,["item","onCatalogueChanged"]),p(c,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(y,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),p(f,{class:"section",item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const hi=A(gi,[["render",mi]]),pi={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{type:{get(){return this.item.subType??this.item.type},set(e){switch(e){case"model":case"upgrade":case"unit":this.item.type=e,delete this.item.subType;break;default:case"unit-group":this.item.type="unit",this.item.subType=e;break;case"mount":case"crew":this.item.type="model",this.item.subType=e;break}}}}},fi={class:"editorTable"},yi=s("td",null,"Type:",-1),Ci=nt('<option value="model">Model</option><option value="upgrade">Upgrade</option><option value="unit">Unit</option><option value="unit-group">Unit Group</option><option value="mount">Mount</option><option value="crew">Crew</option>',6),_i=[Ci];function Ai(e,t,n,i,l,a){return o(),u("fieldset",null,[s("legend",null,[q(e.$slots,"default")]),s("table",fi,[s("tr",null,[yi,s("td",null,[b(s("select",{"onUpdate:modelValue":t[0]||(t[0]=d=>a.type=d),onChange:t[1]||(t[1]=(...d)=>a.changed&&a.changed(...d))},_i,544),[[M,a.type]])])])])])}const bi=A(pi,[["render",Ai]]),vi={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{placeholder(){return`${this.item.isLink()&&this.item.getDefaultAmount()||"unset"}`}}};const dt=e=>(P("data-v-febe37e0"),e=e(),U(),e),ki=dt(()=>s("legend",null,"Creation",-1)),wi={class:"editorTable"},Ii=dt(()=>s("td",null,[h("Default Amount (split by "),s("code",{style:{"background-color":"#aaaaaa40","border-radius":"3px"}},","),h(" for multiple stacks): ")],-1)),Ei=["placeholder"];function xi(e,t,n,i,l,a){return o(),u("fieldset",null,[ki,s("table",wi,[s("tr",null,[Ii,s("td",null,[b(s("input",{class:"input",type:"text","onUpdate:modelValue":t[0]||(t[0]=d=>n.item.defaultAmount=d),onChange:t[1]||(t[1]=(...d)=>a.changed&&a.changed(...d)),placeholder:a.placeholder,pattern:"[0-9,]*"},null,40,Ei),[[x,n.item.defaultAmount]])])])])])}const ut=A(vi,[["render",xi],["__scopeId","data-v-febe37e0"]]),Ti={props:{modelValue:{type:[Number,String]},required:{type:Boolean,required:!1},min:{type:Number,required:!1},max:{type:Number,required:!1}},data(){return{stringValue:null,intValue:0}},watch:{modelValue(){this.refresh()}},created(){this.refresh()},methods:{refresh(){this.intValue=this.modelValue||0,this.stringValue=""+this.modelValue},update(){this.stringValue!=null&&(this.intValue=parseFloat(this.stringValue),this.$emit("update:modelValue",this.intValue),this.$emit("change"))}}},Si=["required","min","max"];function Ni(e,t,n,i,l,a){return b((o(),u("input",{"onUpdate:modelValue":t[0]||(t[0]=d=>l.stringValue=d),type:"number",onChange:t[1]||(t[1]=(...d)=>a.update&&a.update(...d)),required:n.required,min:n.min,max:n.max,step:"any"},null,40,Si)),[[x,l.stringValue]])}const le=A(Ti,[["render",Ni]]),Ri={emits:["catalogueChanged"],data(){return{selectedCosts:{}}},created(){this.update()},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{costTypes(){let e=[];for(let t of this.catalogue.iterateCostTypes())e.push(t);return e}},methods:{changed(){this.item.costs=Object.values(this.selectedCosts).filter(e=>isFinite(e.value)),this.$emit("catalogueChanged")},update(){this.selectedCosts={};const e=this.item.isLink()?void 0:0;for(let t of Object.values(this.costTypes))this.selectedCosts[t.id]={name:t.name,typeId:t.id,value:e};if(this.item.costs)for(let t of this.item.costs)this.selectedCosts[t.typeId]={name:t.name,typeId:t.typeId,value:t.value}}},watch:{item(){this.update()}}},Fi="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9bi1IqIu0g4pChumhBVMRRq1CECqFWaNXB5NIvaNKQpLg4Cq4FBz8Wqw4uzro6uAqC4AeIq4uToouU+L+k0CLGg+N+vLv3uHsH+BsVpppd44CqWUY6mRCyuVWh+xVBhNCPUUQkZupzopiC5/i6h4+vd3Ge5X3uz9Gr5E0G+ATiWaYbFvEG8fSmpXPeJ46ykqQQnxOPGXRB4keuyy6/cS467OeZUSOTnieOEgvFDpY7mJUMlXiKOKaoGuX7sy4rnLc4q5Uaa92TvzCc11aWuU5zCEksYgkiBMiooYwKLMRp1Ugxkab9hId/0PGL5JLJVQYjxwKqUCE5fvA/+N2tWZiccJPCCSD4Ytsfw0D3LtCs2/b3sW03T4DAM3Cltf3VBjDzSXq9rcWOgL5t4OK6rcl7wOUOMPCkS4bkSAGa/kIBeD+jb8oBkVsgtOb21trH6QOQoa5SN8DBITBSpOx1j3f3dPb275lWfz9cmHKeGGO3IgAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFChEuDQiaUlgAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAACRElEQVQoz52Sz0tUURiGn3vvuTqNdU3noiiYZYQgSgYGhiFCRAYWUYFGf0GL/A9atwnaVBtrmWZllouSJAlqEVmLcuGi0JiZmh+W5jRzdeacc2+LscGplX1wFud7z/vwfh/HePpkLNjI/OB/KuREEOs/lzlzbgjty22ZLdPm8cQ9hO8HSJVnavzutgCnBy/i+wHC9zVaKVpaWqipqys9WE6liC4t4TgO+1tbMS2rpK2m02il8H2NqbVCaYXWGqe2tnRezs4ipSQcDjMzPV2maa03PQpTa42SEqUU6WSSZ48mSSeTmIZJc3MzpmmS/ZUt05RSKCnRWiOULCaQUrKrupq+k/3FJdkCz/OIRqNkc9kybTkeR2mFkgqhtUKpIm05kSjN2dvXR3J+lAP1Idr21vJ1fhxUhgojQ/67gVIH0Voh/sRfXFykauE+DU0u2tiBl8tTyMQ4OjhMIZcjGVvADgq47k6mJj6WxhCe52GaBscGBoi/jdPTf6JkyK34zM/Nkc8XSCdiVAqIuA772nswTQPP8xAFM8zIjVsAVHifqNzdhNY+2TWPencPHYc7ikC3EjtYwXUFd26/IPVqjXCkEdF76gKpxDeklHx+fp2u7rbNBBvElqK8e2OVgJZhE0/bhBqPcKjjPPUNjRhbf9fNa1eCiBXFDoURlk3sS5xLw2e37KCYYGR0lctXJw0AsRXQdXyITGaNICje88mHPBibwQ5VISyB2jCQ6ymMmk5gEqA8wd/1+v2HwMvl/uk7jkN3Z7sB8BurPj/243CaIgAAAABJRU5ErkJggg==";const Bi=e=>(P("data-v-e81b0337"),e=e(),U(),e),Vi=Bi(()=>s("legend",null,[s("img",{src:Fi}),h(" Costs")],-1)),Pi={class:"costs"};function Ui(e,t,n,i,l,a){const d=le;return o(),u("fieldset",null,[Vi,s("div",Pi,[(o(!0),u(v,null,T(a.costTypes,r=>(o(),u("div",null,[s("label",null,C(r.name)+": ",1),l.selectedCosts[r.id]!=null?(o(),_(d,{key:0,modelValue:l.selectedCosts[r.id].value,"onUpdate:modelValue":c=>l.selectedCosts[r.id].value=c,class:"input",onChange:a.changed,placeholder:"unset"},null,8,["modelValue","onUpdate:modelValue","onChange"])):g("",!0)]))),256))])])}const ct=A(Ri,[["render",Ui],["__scopeId","data-v-e81b0337"]]),Li={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{fields(){return[{name:"Hidden",status:this.hidden,field:"hidden"},{name:"Collective",status:this.collective,field:"collective",title:"indicates that multiple instances of this entry may be combined into one entry with an amount"},{name:"Import",status:this.eimport,field:"import",title:"Indicates that this entry may be imported by other catalogues"},{name:"Flatten",status:this.flatten,field:"flatten",title:"If this is checked, the group box for this entry/group will not be visible in the New Recruit UI."},{name:"Collapsible",status:this.collapsible,field:"collapsible",title:"If this is checked, the group box for this entry/group will show as a collapsible box even if it has less than 5 items."}]},hidden(){return!0},flatten(){return this.item.editorTypeName==="selectionEntry"||this.item.editorTypeName==="selectionEntryLink"||this.item.editorTypeName==="selectionEntryGroup"||this.item.editorTypeName==="selectionEntryGroupLink"?1:-1},collapsible(){return this.item.editorTypeName==="selectionEntry"||this.item.editorTypeName==="selectionEntryLink"||this.item.editorTypeName==="selectionEntryGroup"||this.item.editorTypeName==="selectionEntryGroupLink"?1:-1},collective(){var e;if((e=this.item.parent)!=null&&e.isCatalogue()){const t=this.item.parentKey;if(t==="selectionEntries"||t==="entryLinks")return 0}switch(this.item.editorTypeName){case"selectionEntryLink":return 1;case"selectionEntryGroupLink":return 1;case"selectionEntry":return 1;case"selectionEntryGroup":return 1;case"categoryLink":return-1;case"infoLink":return-1;case"profileLink":return-1;case"ruleLink":return-1;case"infoGroupLink":return-1}return 1},eimport(){var e;if((e=this.item.parent)!=null&&e.isCatalogue())return 1;switch(this.item.editorTypeName){case"selectionEntryLink":return 0;case"selectionEntryGroupLink":return 0;case"selectionEntry":return 0;case"selectionEntryGroup":return 0;case"categoryLink":return-1;case"infoLink":return-1;case"profileLink":return-1;case"ruleLink":return-1;case"infoGroupLink":return-1}return 0}}},_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9Tix9UOlhBikOG6mRBVMRRq1CECqFWaNXB5PoJTRqSFBdHwbXg4Mdi1cHFWVcHV0EQ/ABxdXFSdJES/5cUWsR4cNyPd/ced+8AoVFhqtk1DqiaZaQScTGTXRW7XxHAIHoRQkRmpj4nSUl4jq97+Ph6F+NZ3uf+HP25vMkAn0g8y3TDIt4gnt60dM77xGFWknPE58RjBl2Q+JHristvnIsOCzwzbKRT88RhYrHYwUoHs5KhEk8RR3OqRvlCxuUc5y3OaqXGWvfkLwzmtZVlrtMcRgKLWIIEEQpqKKMCCzFaNVJMpGg/7uGPOH6JXAq5ymDkWEAVKmTHD/4Hv7s1C5MTblIwDgRebPtjBOjeBZp12/4+tu3mCeB/Bq60tr/aAGY+Sa+3tegRENoGLq7bmrIHXO4AQ0+6bMiO5KcpFArA+xl9UxYYuAX61tzeWvs4fQDS1FXyBjg4BEaLlL3u8e6ezt7+PdPq7wcvuHKMRIsU1QAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFFQkWEGZMN3sAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAABVElEQVQoz93Ry0oCARjF8f/kpC0mZYoupJZWWhSouUopy0fQxxF9kagXKNpEtLZVQajdFl28kVp2mRFGiS4zTLsiqkXLOtvf4nx8B/58BID84bHZaNTRX/V3ELtFnE4XAD9ZOBQQhINcwaxUyng9Y/TJMlarFcMweFAUcvkCAOG50BcrV6p4veMI6xubptvt5PjoiPOLS3TDYGR4CFmWP53aarW4bt4iWixM+X0EgkFqtQZdWltDkiQUVSWVzgAQjUZYXFwgkUiQTCaJx+PEYjEAUukMiqoiSRJaW0NYWV0zPaPj1Os17pU7NE1Df3n+9mGi1YbdbmegfxCXy031qoywtb1j7u/tMTsTwuPx4XDIPD52KJXOODnNA/xo85EIwmW5au5ms1ycn/H0/NHcY7MxMTkJQKlY/GL+qWmWlpcR6jdNs9PuoBv6r/YXLSJSr8Q/yBspXJbfdFchHAAAAABJRU5ErkJggg==";const Oi={class:"booleans"},Qi=["title"],Gi=["id","onUpdate:modelValue","disabled"],qi=["for","title"];function Di(e,t,n,i,l,a){return o(),u("fieldset",null,[s("legend",null,[q(e.$slots,"default",{},void 0,!0)]),s("div",Oi,[(o(!0),u(v,null,T(a.fields.filter(d=>d.status!=-1),d=>(o(),u("div",null,[!n.item[d.field]&&n.item.target&&n.item.target[d.field]?(o(),u("img",{key:0,title:`${String(d.field)} is true on target`,style:{"vertical-align":"text-top","margin-left":"4px","margin-top":"1px"},class:"typeIcon",src:_e},null,8,Qi)):g("",!0),b(s("input",{class:V({"cursor-pointer":d.status!==0}),id:d.field,type:"checkbox","onUpdate:modelValue":r=>n.item[d.field]=r,onChange:t[0]||(t[0]=(...r)=>a.changed&&a.changed(...r)),disabled:d.status==0},null,42,Gi),[[O,n.item[d.field]]]),s("label",{class:V({"cursor-pointer":d.status!==0,gray:d.status==0,hastooltip:!!d.title}),for:d.field,title:d.title},C(d.name),11,qi)]))),256))])])}const Me=A(Li,[["render",Di],["__scopeId","data-v-9aa85940"]]),Ki={},Mi={"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",class:"octicon octicon-tag"},ji=s("path",{d:"M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"},null,-1),Zi=[ji];function Wi(e,t){return o(),u("svg",Mi,Zi)}const gt=A(Ki,[["render",Wi]]),Xi={props:{modelValue:String,placeholder:{type:String,default:"Search..."},min:{type:Number,default:0},max:{type:Number,default:1e3},options:{type:[Array,Function],required:!0},filterField:{type:[String,Function],default:""},lazy:{type:Boolean,default:!1},focus:{type:Boolean,default:!1},nullable:{type:Boolean,default:!1},always:{type:Boolean,default:!1}},created(){this.lazy||this.reset()},data(){return{searchPattern:"",selected:0,lastSearch:null,editing:!1,sleeping:this.lazy,bounce:!1}},computed:{boundedSelected(){return He(this.selected,0,this.always?this.foundOptions.length:this.foundOptions.length-1)},computedOptions(){return Array.isArray(this.options)?this.options:this.sleeping?[]:this.options()},foundOptions(){const e=this.textSearchRegex(this.searchPattern),t=[];this.nullable&&t.push({option:void 0});const n=this.computedOptions,i=this.max||n.length;for(let l=0;l<n.length;l++){const a=n[l];let d=this.getField(a);if(d&&d.match&&d.match(e)&&(t.push({option:a}),t.length>=i-1))break}return t}},methods:{fix(e){return He(e,0,this.always?this.foundOptions.length:this.foundOptions.length-1)},blur(){this.editing=!1,this.$emit("blur")},onUp(){this.selected=this.fix(this.selected-1),this.$nextTick(()=>{const e=this.$refs.suggestions.getElementsByClassName("selected")[0];e==null||e.scrollIntoView({block:"nearest",inline:"nearest"})})},onDown(){this.selected=this.fix(this.selected+1),this.$nextTick(()=>{const e=this.$refs.suggestions.getElementsByClassName("selected")[0];e==null||e.scrollIntoView({block:"nearest",inline:"nearest"})})},onEnter(){this.bounce||(this.bounce=!0,this.always&&this.selected===this.foundOptions.length?this.$emit("always",this.searchPattern):this.targetSelected(this.foundOptions[this.boundedSelected]),this.reset())},onEnterUp(){this.bounce=!1},getField(e){return this.filterField?this.filterField instanceof Function?this.filterField(e):e[this.filterField]:e},escapeRegex(e){return e.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},textSearchRegex(e){const n=`^(?=.*\\b${this.escapeRegex(e).split(" ").join(".*)(?=.*\\b")}).*$`;return new RegExp(n,"i")},targetSelected(e){console.log("selected",e),this.$emit("add",e.option)},targetSelectedRightClick(e,t){e.preventDefault(),e.stopPropagation(),console.log("selected (right click)",t),this.$emit("add-special",t.option)},reset(){this.searchPattern=""},onClickOutside(){this.blur()},suggest(){this.searchPattern.length<this.min?this.editing=!1:this.startEditing()},maySuggest(){this.sleeping=!1,this.searchPattern="",this.min==0&&this.suggest()},startEditing(){this.editing||(this.sleeping=!1,this.editing=!0,this.searchPattern="")}},mounted(){this.focus&&setTimeout(()=>{var e;(e=this.$refs.edit)==null||e.focus(),this.startEditing()},0)},watch:{options(){this.lazy||this.reset()},searchPattern(e,t){(e??"")!==(t??"")&&(this.selected=0,this.$emit("update:modelValue",e),this.$emit("change"))},modelValue:{immediate:!0,handler(e){this.searchPattern=e??""}},async editing(){this.editing&&(await this.$nextTick(),this.$refs.edit&&this.$refs.edit.focus())}}};const Yi=e=>(P("data-v-cc1c0b53"),e=e(),U(),e),zi=["placeholder"],Hi={class:"gray"},Ji=Yi(()=>s("span",{class:"float-right bold"},"+",-1)),$i=["onClickCapture","onContextmenuCapture"],eo=["onClick","onContextmenu"];function to(e,t,n,i,l,a){const d=at("click-outside");return o(),u("div",{class:"autocomplete relative",onKeydown:[t[7]||(t[7]=pe(S((...r)=>a.onDown&&a.onDown(...r),["prevent"]),["down"])),t[8]||(t[8]=pe(S((...r)=>a.onUp&&a.onUp(...r),["prevent"]),["up"])),t[9]||(t[9]=pe(S((...r)=>a.onEnter&&a.onEnter(...r),["prevent"]),["enter"])),t[11]||(t[11]=pe(r=>a.blur(),["escape"]))],onKeyup:t[10]||(t[10]=pe(S((...r)=>a.onEnterUp&&a.onEnterUp(...r),["prevent"]),["enter"]))},[l.editing?b((o(),u("input",{key:0,class:"input autocomplete-input",type:"text",ref:"edit",autofocus:"",onInput:t[0]||(t[0]=(...r)=>a.suggest&&a.suggest(...r)),onClick:t[1]||(t[1]=(...r)=>a.maySuggest&&a.maySuggest(...r)),onFocus:t[2]||(t[2]=(...r)=>a.startEditing&&a.startEditing(...r)),"onUpdate:modelValue":t[3]||(t[3]=r=>l.searchPattern=r),placeholder:n.placeholder},null,40,zi)),[[x,l.searchPattern],[d,a.onClickOutside]]):(o(),u("div",{key:1,onClick:t[4]||(t[4]=(...r)=>a.startEditing&&a.startEditing(...r)),class:"autocomplete-input"},[s("span",Hi,C(n.placeholder),1),Ji])),b(s("div",{class:V(["suggestions",{hidden:!l.editing}]),ref:"suggestions"},[(o(!0),u(v,null,T(a.foundOptions,(r,c)=>(o(),u(v,null,[c===a.boundedSelected?(o(),u("div",{key:0,class:"suggestion selected",onClickCapture:S(y=>a.targetSelected(r),["stop"]),onContextmenuCapture:y=>a.targetSelectedRightClick(y,r)},[q(e.$slots,"option",ce(fe({...r,selected:!0})),void 0,!0)],40,$i)):(o(),u("div",{key:1,class:"suggestion",onClick:S(y=>a.targetSelected(r),["stop"]),onContextmenu:S(y=>a.targetSelectedRightClick(y,r),["prevent"])},[q(e.$slots,"option",ce(fe(r)),void 0,!0)],40,eo))],64))),256)),n.always?(o(),u("div",{key:0,class:V(["suggestion",{selected:l.selected===a.foundOptions.length}]),onClick:t[5]||(t[5]=r=>e.$emit("always",l.searchPattern)),onContextmenu:t[6]||(t[6]=S(r=>e.$emit("always-special",l.searchPattern),["prevent"]))},[q(e.$slots,"always",ce(fe({input:l.searchPattern})),void 0,!0)],34)):g("",!0)],2),[[we,l.editing]])],32)}const no=A(Xi,[["render",to],["__scopeId","data-v-cc1c0b53"]]),ao={name:"ContextMenu",data(){return{left:100,top:100,bottom:100,right:100,width:200,height:200,visible:!1,isDown:!1,isRight:!1,payload:void 0}},props:{modelValue:{type:Boolean,default:!0}},methods:{do_update(e){var n,i;if(this.width=((n=this.el)==null?void 0:n.clientWidth)||this.width,this.height=((i=this.el)==null?void 0:i.clientHeight)||this.height,this.top=e.clientY,this.left=e.clientX,this.avoid){const l=this.avoid,a=l.offsetLeft;this.left=a+l.offsetWidth;var t=e.target.getBoundingClientRect();this.top=t.top-1}this.left=Math.min(this.left,window.innerWidth-this.width)+2,this.top=Math.min(this.top,window.innerHeight-7-this.height),this.bottom=window.innerHeight-this.top,this.right=window.innerWidth-this.left},update(e){e.preventDefault(),this.do_update(e),this.$nextTick(()=>{this.do_update(e)})},show(e,t){this.payload=t,this.visible=!0,this.update(e),this.$emit("update:modelValue",!0)},close(){this.visible=!1,this.$emit("update:modelValue",!1)}},mounted(){addEventListener("click",this.close,{capture:!0}),addEventListener("contextmenu",this.close,{capture:!0}),addEventListener("scroll",this.close,{capture:!0})},unmounted(){addEventListener("click",this.close,{capture:!0}),removeEventListener("contextmenu",this.close,{capture:!0}),removeEventListener("scroll",this.close,{capture:!0})},computed:{el(){return this.$refs["context-menu"]},style(){const e={};return e.top=`${this.top}px`,e.left=`${this.left}px`,e},avoid(){var e;return(e=this.$el.parentElement)==null?void 0:e.closest(".context-menu")}}};function so(e,t,n,i,l,a){return b((o(),_(st,{to:"#dialogs"},[b(s("li",{ref:"context-menu",class:"context-menu",style:Ie(a.style)},[q(e.$slots,"default",{payload:l.payload})],4),[[we,l.visible]])],512)),[[we,l.visible]])}const Se=A(ao,[["render",so]]),io=j({components:{AutocompleteTags:no,Tag:gt,ContextMenu:Se},props:{item:{type:Object,required:!0}},data(){return{input:"",adding:!1,contextmenuopen:!1,selectedCategory:null,selectedCategoryParent:null}},setup(){return{store:Q(),settings:J()}},computed:{catalogue(){return this.item.catalogue},targetCategories(){var e;return(((e=this.item.target)==null?void 0:e.categoryLinks)||[]).filter(t=>!t.primary)},ownCategories(){return(this.item.categoryLinks||[]).filter(e=>!e.primary)},targetPrimaryCategories(){var e;return(((e=this.item.target)==null?void 0:e.categoryLinks)||[]).filter(t=>t.primary)},ownPrimaryCategories(){return(this.item.categoryLinks||[]).filter(e=>e.primary)}},methods:{getNameExtra:Z,makePrimary(e,t){var n;(n=t.categoryLinks)==null||n.forEach(i=>i.primary=!1),e.primary=!0},makeSecondary(e){e.primary=!1},context(e,t){this.contextmenuopen=!0,this.selectedCategory=t,this.selectedCategoryParent=this.item,this.$nextTick(()=>{var n;(n=this.$refs.contextmenu)==null||n.show(e)})},linked_context(e,t){if(!this.item.target){console.error("Cant open context menu for a category on the target: Couldn't find target");return}this.contextmenuopen=!0,this.selectedCategory=t,this.selectedCategoryParent=this.item.target,this.$nextTick(()=>{var n;(n=this.$refs.contextmenu)==null||n.show(e)})},refreshCategories(e,t,n){e.categoryLinks||(e.categoryLinks=[]);const i=e.categoryLinks;if(n&&i.forEach(l=>l.primary=!1),t){const l=i.find(a=>a.targetId===(t==null?void 0:t.id));l&&n?l.primary=!0:l?this.removeLink(this.item,l):this.addLink(this.item,t,n)}},removeLink(e,t){this.store.del_node(t)},addLink(e,t,n=!1){if(!t.isCategory())throw Error("Invalid argument, target must be a category");return this.store.add_node("categoryLinks",e,{targetId:t.id,id:this.item.catalogue.generateNonConflictingId(),primary:n,name:t.name})},allCategories(){const e=new Set;for(const n of this.item.categoryLinks||[])e.add(n.getId());const t=[];for(const n of this.item.catalogue.iterateCategoryEntries())e.has(n.getId())||t.push(n);return t},addCategory(e){this.item.categoryLinks||(this.item.categoryLinks=[]);const n=this.item.categoryLinks.find(i=>i.targetId===e.getId());return n||this.addLink(this.item,e,!1)},addCategoryAndMakePrimary(e){const t=this.addCategory(e);this.makePrimary(t,this.item)},removeCategory(e,t){const i=(e.categoryLinks||[]).find(l=>l.targetId===t.getId());if(i)return this.removeLink(this.item,i)},async createCategory(e,t=!1){var d;const n=this.item.catalogue,i="categoryEntries",l={...this.store.get_initial_object(i,n),name:e,id:De()};await this.store.add(l,i,n);const a=(d=this.item.catalogue.categoryEntries)==null?void 0:d.find(r=>r.name===e);if(a)return t?this.addCategoryAndMakePrimary(a):this.addCategory(a)},async createPrimaryCategory(e){await this.createCategory(e,!0)},gotoCategory(e){const t=this.catalogue.findOptionById(e.targetId??e.id);t&&this.store.goto(t)}}});const Ne=e=>(P("data-v-f326fda6"),e=e(),U(),e),oo=["onContextmenu"],lo=Ne(()=>s("span",{class:"primary bold"}," Primary ",-1)),ro={class:"name"},uo=["onClick"],co=["onContextmenu"],go={class:"name"},mo=["onClick"],ho={key:1,class:"gray"},po={class:"py-1px rounded-8px bg-lime-400"},fo={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},yo={class:"gray"},Co={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},_o=Ne(()=>s("span",null,"Create: ",-1)),Ao={key:0,class:"align-top mt-4px"},bo=Ne(()=>s("img",{src:_e},null,-1)),vo=["onContextmenu"],ko=Ne(()=>s("span",{class:"primary bold"}," Primary ",-1)),wo={class:"name"},Io=["onClick"],Eo=["onContextmenu"],xo={class:"name"},To=["onClick"],So={class:"gray"};function No(e,t,n,i,l,a){var y,f;const d=F("Tag"),r=F("AutocompleteTags"),c=F("ContextMenu");return o(),u("div",{class:V({dark:e.settings.isDarkTheme})},[s("div",null,[(y=e.ownCategories)!=null&&y.length||(f=e.ownPrimaryCategories)!=null&&f.length?(o(),u(v,{key:0},[(o(!0),u(v,null,T(e.ownPrimaryCategories,k=>(o(),u("div",{class:"label hover-brighten",onContextmenu:S(m=>e.context(m,k),["stop"])},[lo,s("span",ro,C(k.getName()),1),s("span",{class:"cursor-pointer hover-darken px-5px rounded-8px",onClick:m=>e.removeCategory(e.item,k)},"×",8,uo)],40,oo))),256)),(o(!0),u(v,null,T(e.ownCategories,k=>(o(),u("div",{class:"label",onContextmenu:S(m=>e.context(m,k),["stop"])},[s("span",go,C(k.getName()),1),s("span",{class:"cursor-pointer hover-darken px-5px rounded-8px",onClick:m=>e.removeCategory(e.item,k)},"×",8,mo)],40,co))),256))],64)):(o(),u("span",ho," None ")),s("span",po,[e.adding?g("",!0):(o(),u("span",{key:0,class:"px-5px py-1px rounded-8px cursor-pointer hover-darken",onClick:t[0]||(t[0]=k=>e.adding=!0),style:Ie({color:e.settings.isDarkTheme?"black":"white"})},"+",4))]),e.adding?(o(),_(r,{key:2,modelValue:e.input,"onUpdate:modelValue":t[1]||(t[1]=k=>e.input=k),onBlur:t[2]||(t[2]=k=>e.adding=!1),focus:"",class:"inline-block",lazy:"",always:!!e.input.trim()&&!e.allCategories().find(k=>k.name===e.input),options:e.allCategories,dark:e.settings.isDarkTheme,placeholder:"Search... (Right click = Primary)",filterField:k=>k.getName(),onAdd:e.addCategory,onAddSpecial:e.addCategoryAndMakePrimary,onAlways:e.createCategory,onAlwaysSpecial:e.createPrimaryCategory},{option:w(({option:k,selected:m})=>[s("div",fo,[k!=null&&k.name?(o(),u(v,{key:0},[p(d,{class:"icon"}),s("span",null,[h(" "+C(k.name),1),s("span",yo," ["+C(k.catalogue.name)+"]",1)])],64)):g("",!0)])]),always:w(({input:k})=>[s("div",Co,[_o,h("  "),p(d,{class:"icon"}),s("span",null," "+C(k),1)])]),_:1},8,["modelValue","always","options","dark","filterField","onAdd","onAddSpecial","onAlways","onAlwaysSpecial"])):g("",!0)]),e.targetCategories.length||e.targetPrimaryCategories.length?(o(),u("div",Ao,[bo,h(" From Target: "),(o(!0),u(v,null,T(e.targetPrimaryCategories,k=>(o(),u("span",{class:"label",onContextmenu:S(m=>e.linked_context(m,k),["stop"])},[ko,s("span",wo,C(k.getName()),1),h(" "),s("span",{class:"cursor-pointer hover-darken px-3px rounded-2px",onClick:m=>e.removeCategory(e.item.target,k)},"×",8,Io)],40,vo))),256)),(o(!0),u(v,null,T(e.targetCategories,k=>(o(),u("span",{class:"label",onContextmenu:S(m=>e.linked_context(m,k),["stop"])},[s("span",xo,C(k.getName()),1),h(" "),s("span",{class:"cursor-pointer hover-darken px-3px rounded-2px",onClick:m=>e.removeCategory(e.item.target,k)},"×",8,To)],40,Eo))),256))])):g("",!0),e.contextmenuopen&&e.selectedCategory&&e.selectedCategoryParent?(o(),_(c,{key:1,modelValue:e.contextmenuopen,"onUpdate:modelValue":t[7]||(t[7]=k=>e.contextmenuopen=k),ref:"contextmenu"},{default:w(()=>{var k;return[e.selectedCategory.primary?g("",!0):(o(),u("div",{key:0,onClick:t[3]||(t[3]=m=>e.makePrimary(e.selectedCategory,e.selectedCategoryParent))}," Make Primary: "+C(e.selectedCategory.getName()),1)),e.selectedCategory.primary?(o(),u("div",{key:1,onClick:t[4]||(t[4]=m=>e.makeSecondary(e.selectedCategory))}," Make Secondary: "+C(e.selectedCategory.getName()),1)):g("",!0),s("div",{onClick:t[5]||(t[5]=m=>e.gotoCategory(e.selectedCategory))},[h(" Goto "+C(e.selectedCategory.getName())+" ",1),s("span",So,"  ("+C((k=e.selectedCategory.catalogue)==null?void 0:k.getName())+") ",1)]),s("div",{onClick:t[6]||(t[6]=m=>e.store.copy(m,e.selectedCategory))}," Copy "+C(e.selectedCategory.getName()),1)]}),_:1},8,["modelValue"])):g("",!0)],2)}const Ro=A(io,[["render",No],["__scopeId","data-v-f326fda6"]]),Fo=j({props:{category:{required:!0,type:Object},item:{type:Object,required:!0}},setup(){return{store:Q()}},data(){return{contextmenuopen:!1}},methods:{menu(e){return{show:(t,n)=>{this.contextmenuopen=!0,this.$nextTick(()=>{var i;(i=this.$refs[e])==null||i.show(t,n)})},close:(t,n)=>{var i;(i=this.$refs[e])==null||i.close(t,n),this.contextmenuopen=!1}}},hasCategory(e){var n;let t=(n=this.item.categoryLinks)==null?void 0:n.find(i=>{var l;return((l=i.target)==null?void 0:l.id)===e.id});return t?t.primary?2:1:0}},computed:{contextmenu(){return this.menu("contextmenu")}},components:{ContextMenu:Se}});const Bo=["checked"],Vo=["id","checked"],Po=["for"],Uo={class:"gray"},Lo={class:"gray"};function Oo(e,t,n,i,l,a){const d=F("ContextMenu");return o(),u("div",{class:"category",onContextmenu:t[4]||(t[4]=S((...r)=>e.contextmenu.show&&e.contextmenu.show(...r),["stop"]))},[s("div",null,[s("input",{name:"primary",type:"radio",checked:e.hasCategory(e.category)==2,onChange:t[0]||(t[0]=r=>e.$emit("primaryChanged",e.category))},null,40,Bo),h(" Primary? ")]),s("div",null,[s("input",{id:`category-${e.category.id}`,type:"checkbox",checked:e.hasCategory(e.category)!=0,onChange:t[1]||(t[1]=r=>e.$emit("secondaryChanged",e.category))},null,40,Vo),s("label",{for:`category-${e.category.id}`},[h(C(e.category.name),1),s("span",Uo," ["+C(e.category.catalogue.name)+"]",1)],8,Po)]),e.contextmenuopen?(o(),_(d,{key:0,modelValue:e.contextmenuopen,"onUpdate:modelValue":t[3]||(t[3]=r=>e.contextmenuopen=r),ref:"contextmenu"},{default:w(()=>{var r;return[s("div",{onClick:t[2]||(t[2]=c=>e.store.goto(e.category))},[h(" Goto "+C(e.category.getName())+" ",1),s("span",Lo,"  ("+C((r=e.category.catalogue)==null?void 0:r.getName())+") ",1)])]}),_:1},8,["modelValue"])):g("",!0)],32)}const Qo=A(Fo,[["render",Oo]]),Go={components:{Category:Qo,Tag:gt},emits:["catalogueChanged"],data(){return{filter:"",primaries:new Set,secondaries:new Set}},setup(){return{settings:J()}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{hasCategory(e){var n;let t=(n=this.item.categoryLinks)==null?void 0:n.find(i=>{var l;return((l=i.target)==null?void 0:l.id)===e.id});return t?t.primary?2:1:0},primaryChanged(e){this.refreshCategories(this.item,e,!0)},secondaryChanged(e){this.refreshCategories(this.item,e,!1)},refreshCategories(e,t,n){e.categoryLinks||(e.categoryLinks=[]);const i=e.categoryLinks;if(n&&i.forEach(l=>l.primary=!1),t){const l=i.find(a=>a.targetId===(t==null?void 0:t.id));l&&n?l.primary=!0:l?this.removeLink(i,l):this.addLink(i,t,n)}this.changed()},removeLink(e,t){const n=e.findIndex(i=>i===t);if(n!==-1){const[i]=e.splice(n,1);this.catalogue.removeFromIndex(i);const l=i.target.refs;if(l){const a=l==null?void 0:l.findIndex(d=>d===i);a!==-1&&(l==null||l.splice(a,1))}}},addLink(e,t,n=!1){var a;if(!t.isCategory())throw Error("Invalid argument, target must be a category");const i=Ut({targetId:t.id,target:t,id:this.catalogue.generateNonConflictingId(),primary:n,catalogue:this.catalogue,name:t.name},"categoryLinks");e.push(i),this.catalogue.addToIndex(i);const l=t;return l.refs||(l.refs=[]),(a=l.refs)==null||a.push(i),i},changed(){this.$emit("catalogueChanged")},noPrimary(){let e=!0;if(this.item.categoryLinks){for(let t of this.item.categoryLinks)if(t.primary)return!1}return e}},computed:{badLinks(){const e=[],t=new Set;for(const n of this.catalogue.iterateCategoryEntries())t.add(n.id);for(const n of this.item.categoryLinks||[])t.has(n.targetId)||e.push(n);return e},count(){var e;return((e=this.item.categoryLinks)==null?void 0:e.length)||0},categories(){let e=[];for(let t of this.catalogue.iterateCategoryEntries())this.settings.showOnlyEnabledCategories&&this.hasCategory(t)==0||t.getName().toLowerCase().includes(this.filter.toLowerCase())&&e.push(t);return e}}};const qo=e=>(P("data-v-00cb0b37"),e=e(),U(),e),Do={class:"inline"},Ko={class:"section inline"},Mo=qo(()=>s("label",{for:"onlyEnabled"},"Only show selected categories",-1)),jo={class:"section categoryList"},Zo=["checked"],Wo=["checked","onChange"],Xo=["id","onChange"],Yo=["for"];function zo(e,t,n,i,l,a){const d=F("Tag"),r=Ro,c=F("Category"),y=Te;return o(),u("fieldset",null,[s("legend",null,[s("div",Do,[p(d,{class:"icon"})]),h(" Categories ("+C(a.count)+") ",1)]),i.settings.useNewCategoriesUI?(o(),_(r,{key:0,item:n.item},null,8,["item"])):(o(),u(v,{key:1},[b(s("input",{class:"section",type:"text","onUpdate:modelValue":t[0]||(t[0]=f=>l.filter=f),placeholder:"Filter categories..."},null,512),[[x,l.filter]]),s("div",Ko,[b(s("input",{type:"checkbox",id:"onlyEnabled","onUpdate:modelValue":t[1]||(t[1]=f=>i.settings.showOnlyEnabledCategories=f)},null,512),[[O,i.settings.showOnlyEnabledCategories]]),Mo]),s("div",jo,[s("div",null,[s("input",{name:"primary",type:"radio",checked:a.noPrimary,onChange:t[2]||(t[2]=f=>a.primaryChanged(null))},null,40,Zo),h(" No Primary ")]),(o(!0),u(v,null,T(a.categories,f=>(o(),_(c,{category:f,item:n.item,key:f.id,onPrimaryChanged:a.primaryChanged,onSecondaryChanged:a.secondaryChanged},null,8,["category","item","onPrimaryChanged","onSecondaryChanged"]))),128)),(o(!0),u(v,null,T(a.badLinks,f=>(o(),u("div",{class:"category",key:f.id},[s("div",null,[s("input",{name:"primary",type:"radio",checked:a.hasCategory(f)==2,onChange:k=>a.primaryChanged(f)},null,40,Wo),h(" Primary? ")]),s("div",null,[s("input",{id:`bad${f.id}`,type:"checkbox",checked:!0,onChange:k=>a.removeLink(n.item.categoryLinks,f)},null,40,Xo),s("label",{for:`bad${f.id}`},C(f.name),9,Yo),p(y,{class:"ml-5px inline",errors:[{msg:`Couldn't find category with id: ${f.targetId}`,severity:"error"}]},null,8,["errors"])])]))),128))])],64))])}const je=A(Go,[["render",zo],["__scopeId","data-v-00cb0b37"]]);function Ho(e){return Math.round(e*100)/100}function Jo(e){let t="";e=Ke(e,n=>n.name);for(const n of e)if(n.value!=0){let i="";n.name.length!=0&&(i=" "+n.name),t=`${t}<span class='cost'>${Ho(n.value)}${i}</span>`}return t.length==0?t:`<span class="costList">${t}</span>`}const $o=j({props:{item:{type:Object,required:!0},noSortIndex:Boolean,imported:Boolean,highlight:Boolean,grouped:Boolean},setup(){return{settings:J()}},methods:{getNameExtra:Z,getName:$},computed:{costs(){var i;const e=[],t=this.item.getCatalogue(),n=this.item.getCosts();for(const l of n){const a=((i=t.findOptionById(l.typeId))==null?void 0:i.name)||l.name||l.typeId;a&&e.push({name:a,value:l.value,typeId:l.typeId})}return Jo(e)}}});const el={class:"typeIcon-wrapper"},tl=["src"],nl={key:0,class:"primary"},al={key:1,class:"gray"},sl={key:2,class:"gray"},il=["innerHTML"];function ol(e,t,n,i,l,a){var r,c,y;const d=Te;return o(),u("span",{class:V({highlight:e.highlight})},[s("span",el,[s("img",{class:"typeIcon",src:`assets/bsicons/${e.item.editorTypeName}.png`},null,8,tl)]),p(d,{errors:e.item.errors},null,8,["errors"]),e.settings.display.primaryCategory&&((r=e.item.parent)!=null&&r.isCatalogue())&&["selectionEntries","entryLinks"].includes(e.item.parentKey)?(o(),u("span",nl,"["+C(((y=(c=e.item.getPrimaryCategoryLink())==null?void 0:c.target)==null?void 0:y.name)??"Uncategorized")+"] ",1)):g("",!0),e.item.sortIndex&&!e.noSortIndex&&e.settings.display.sortIndex?(o(),u("span",al," ["+C(e.item.sortIndex)+"] ",1)):g("",!0),s("span",{class:V({imported:e.imported,filtered:e.item.highlight})},C(e.getName(e.item)),3),e.getNameExtra(e.item,e.settings.display.references,!(e.grouped&&e.item.parentKey==="sharedProfiles"))?(o(),u("span",sl,"  "+C(e.getNameExtra(e.item,e.settings.display.references,!(e.grouped&&e.item.parentKey==="sharedProfiles"))),1)):g("",!0),e.costs&&e.settings.display.costs?(o(),u("span",{key:3,class:"ml-10px",innerHTML:e.costs},null,8,il)):g("",!0)],2)}const mt=A($o,[["render",ol],["__scopeId","data-v-9e4169de"]]),ll=j({emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},setup(){return{store:Q()}},computed:{get_sort_items(){return H([...this.item.iterateSelectionEntries()],e=>e.getName())}},methods:{changed(){this.$emit("catalogueChanged")},get(e){return e.sortIndex},set(e,t){e.sortIndex=t,this.store.set_catalogue_changed(e.catalogue,!0)},del(e){delete e.sortIndex,this.store.set_catalogue_changed(e.catalogue,!0)}},components:{SortOrder:ot,Entry:mt}}),rl={key:0,class:"mt-10px"},dl=s("legend",null,"Childs Order",-1);function ul(e,t,n,i,l,a){const d=F("Entry"),r=F("SortOrder");return e.get_sort_items.length>1?(o(),u("fieldset",rl,[dl,p(r,{items:e.get_sort_items,get:e.get,set:e.set,del:e.del,parent:e.item},{item:w(({item:c})=>{var y;return[p(d,{item:c,noSortIndex:""},null,8,["item"]),((y=c.refs)==null?void 0:y.length)>1?(o(),u(v,{key:0},[h(">1 refs")],64)):g("",!0)]}),_:1},8,["items","get","set","del","parent"])])):g("",!0)}const Ze=A(ll,[["render",ul]]),cl={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function gl(e,t,n,i,l,a){const d=L,r=D,c=ne,y=bi,f=ut,k=ct,m=Me,B=je,G=Ce,X=Ze;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(y,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Selection Entry ")]),_:1},8,["item","onCatalogueChanged"]),p(f,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(k,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(m,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),p(B,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(G,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"]),p(X,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const ml=A(cl,[["render",gl],["__scopeId","data-v-7c8d5ed1"]]),hl={setup(){return{store:Q()}},emits:["catalogueChanged","targetChanged"],data(){return{filter:"",val:null}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},type:{type:String,required:!0}},computed:{allowEntries(){return!0},allowGroups(){var e;return!((e=this.item.parent)!=null&&e.isCatalogue()&&this.item.parentKey==="entryLinks")}},methods:{getNameExtra:Z,availableTargets(){if(this.type==="catalogue"){const t=this.catalogue.gameSystemId||this.catalogue.id;return Object.values(this.store.get_system(t).catalogueFiles).map(l=>({id:l.catalogue.id,name:l.catalogue.name,editorTypeName:"catalogueLink"})).filter(l=>l.id!==this.catalogue.id)}const e=[];for(const t of this.catalogue.iterateAllImported())this.targetIsValid(t)&&(t.isLink()||e.push(t));return H(e,t=>t.name)},typeChanged(){},targetIdChanged(){this.updateLink(),this.changed()},async updateLink(){if(this.type==="catalogue"&&this.item.targetId){const e=this.item.target;e&&this.catalogue.removeRef(this.catalogue,e);const t=this.catalogue.gameSystemId||this.catalogue.id;await this.catalogue.reload(this.store.get_system(t));const n=this.item.target;n?(this.catalogue.addRef(this.catalogue,n),this.item.name=n.name,this.item.type=n.editorTypeName):this.item.name="Unknown"}else{this.catalogue.updateLink(this.item);const e=this.item.target;this.item.name=(e==null?void 0:e.name)||"Unknown",this.item.type=(e==null?void 0:e.editorTypeName)||this.item.type}this.$emit("targetChanged")},changedImportRootEntries(){this.changed()},changed(){this.$emit("catalogueChanged")},getType(e){return e.target?e.target.editorTypeName:"bullet"},itemName(e){return e.name},itemValue(e){return e.name},targetIsValid(e){return this.item.type==null||this.item.type==="category"?e.editorTypeName=="category":e.editorTypeName==this.item.type},showCatalogue(e){var t;return!(!e.catalogue||e.catalogue===((t=this.item.catalogue)==null?void 0:t.getName()))}}},ht="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAFKSURBVDhPpZLBSgJRFIbvuTtHXyBaWEG0TRxFCAJd9B6B4CLoXaKVLVr4FK3GTRGEMwvXYYPQI1TQ4D2d/3gVnEFh7IPBc37mHD2/P5kcH63WuVssBmxMT9pjaESUOmPGhnl4miQJtBXrBfNOp/KbZXdS9kUsLAaylGXJY4Xo9jCOv6Hpi374SZpL9CuOosgYa03a7cqojHsc80tAdIUlFgK+OT8MbK2mTx5LdPHDfK81bpbPPppSEF2/NxqhhWHbbt6FzhANrHd7L2RJDx7oX7UndTXxP4ihlPq6NHL+3Drnxr4vMGu3zSwMNzKQI7Li5FATVh5eED1YzbbE04sbnEwm+mxhdBbHb2oiss3Mzyp7bLXqq2Uic7wGWXaDYh2gz2Yz0HhKwnYEC6eOMHwwnX5BKLyIeCJhCIm0dWjqthiWyc342dCWGPMHCdh2fZxOhd0AAAAASUVORK5CYII=";const K=e=>(P("data-v-d89b454f"),e=e(),U(),e),pl=K(()=>s("legend",null,[s("img",{src:_e}),h(" Link")],-1)),fl={class:"editorTable"},yl={key:0},Cl=K(()=>s("td",null,"Link Type:",-1)),_l={key:0,value:"selectionEntry"},Al={key:1,value:"selectionEntryGroup"},bl={key:1},vl=K(()=>s("td",null,"Link Type:",-1)),kl=K(()=>s("option",{value:"profile"},"Profile",-1)),wl=K(()=>s("option",{value:"rule"}," Rule ",-1)),Il=K(()=>s("option",{value:"infoGroup"}," Info Group ",-1)),El=[kl,wl,Il],xl=K(()=>s("td",null,"Link To:",-1)),Tl=["src"],Sl=K(()=>s("img",{class:"errIcon",src:ht},null,-1)),Nl=K(()=>s("td",null,"Target ID:",-1)),Rl=K(()=>s("td",null,"Target:",-1)),Fl={style:{"white-space":"nowrap"}},Bl=["src"],Vl={class:"gray"},Pl={key:0,class:"shared"},Ul={key:1,class:"catalogueName"},Ll={key:2},Ol=K(()=>s("td",null,null,-1)),Ql=K(()=>s("label",{for:"importRoot"},"Import Root Entries",-1));function Gl(e,t,n,i,l,a){const d=se;return o(),u("fieldset",null,[pl,s("table",fl,[n.type=="entry"?(o(),u("tr",yl,[Cl,s("td",null,[b(s("select",{onChange:t[0]||(t[0]=(...r)=>a.typeChanged&&a.typeChanged(...r)),"onUpdate:modelValue":t[1]||(t[1]=r=>n.item.type=r)},[a.allowEntries?(o(),u("option",_l,"Selection Entry")):g("",!0),a.allowGroups?(o(),u("option",Al," Selection Entry Group ")):g("",!0)],544),[[M,n.item.type]])])])):g("",!0),n.type=="info"?(o(),u("tr",bl,[vl,s("td",null,[b(s("select",{onChange:t[2]||(t[2]=(...r)=>a.typeChanged&&a.typeChanged(...r)),"onUpdate:modelValue":t[3]||(t[3]=r=>n.item.type=r)},El,544),[[M,n.item.type]])])])):g("",!0),s("tr",null,[xl,s("td",null,[n.item.target?(o(),u(v,{key:0},[n.item.type?(o(),u("img",{key:0,class:"linkIcon",src:`assets/bsicons/${a.getType(n.item)}.png`},null,8,Tl)):g("",!0),h(" "+C(n.item.target.name),1)],64)):(o(),u(v,{key:1},[Sl,h(" No target selected ")],64))])]),s("tr",null,[Nl,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=r=>n.item.targetId=r),onChange:t[5]||(t[5]=(...r)=>a.targetIdChanged&&a.targetIdChanged(...r))},null,544),[[x,n.item.targetId]])])]),s("tr",null,[Rl,s("td",null,[p(d,{modelValue:n.item.targetId,"onUpdate:modelValue":t[6]||(t[6]=r=>n.item.targetId=r),placeholder:"Search Target...",options:a.availableTargets,valueField:"id",filterField:"name",onChange:a.targetIdChanged},{option:w(r=>[s("div",Fl,[s("img",{class:"mr-1 align-middle",src:`assets/bsicons/${r.option.editorTypeName}.png`},null,8,Bl),h(" "+C(r.option.name)+" ",1),s("span",Vl,C(a.getNameExtra(r.option,!1)),1),r.option.shared?(o(),u("span",Pl," (shared)")):g("",!0),a.showCatalogue(r.option)?(o(),u("span",Ul," ["+C(r.option.catalogue.name)+"]",1)):g("",!0)])]),_:1},8,["modelValue","placeholder","options","onChange"])])]),n.type==="catalogue"?(o(),u("tr",Ll,[Ol,s("td",null,[b(s("input",{onChange:t[7]||(t[7]=(...r)=>a.changedImportRootEntries&&a.changedImportRootEntries(...r)),id:"importRoot",type:"checkbox","onUpdate:modelValue":t[8]||(t[8]=r=>n.item.importRootEntries=r)},null,544),[[O,n.item.importRootEntries]]),Ql])])):g("",!0)])])}const ql=A(hl,[["render",Gl],["__scopeId","data-v-d89b454f"]]),Dl={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},type:{type:String,required:!0}},setup(){return{settings:J()}},methods:{linkChanged(){this.settings.autoRenameInfoLinkParent&&this.item.parent&&(this.item.parent.name=this.item.name),this.changed()},changed(){this.$emit("catalogueChanged")}},computed:{isEntryOrGroup(){return this.item.editorTypeName=="selectionEntryLink"||this.item.editorTypeName=="selectionEntryGroupLink"},isGroup(){return this.item.editorTypeName=="selectionEntryGroupLink"},isEntry(){return this.item.editorTypeName=="selectionEntryLink"}}};function Kl(e,t,n,i,l,a){var ie;const d=L,r=D,c=ne,y=ql,f=ct,k=ut,m=Me,B=je,G=rt,X=Ce,Y=Ze;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),n.type!="catalogue"?(o(),_(c,{key:0,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):g("",!0),p(y,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.linkChanged,class:"section",type:n.type},null,8,["item","catalogue","onCatalogueChanged","type"]),a.isEntry?(o(),_(f,{key:1,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):g("",!0),a.isEntry?(o(),_(k,{key:2,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):g("",!0),n.type!="catalogue"?(o(),_(m,{key:3,item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"])):g("",!0),a.isEntryOrGroup?(o(),_(B,{key:4,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):g("",!0),(ie=n.item.target)!=null&&ie.isProfile()?(o(),_(G,{key:5,class:"mt-10px",item:n.item.target,catalogue:n.item.target.catalogue,link:""},null,8,["item","catalogue"])):g("",!0),n.type=="entry"||n.type=="category"?(o(),_(X,{key:6,item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])):g("",!0),a.isEntryOrGroup?(o(),_(Y,{key:7,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):g("",!0)],64)}const Ml=A(Dl,[["render",Kl]]),jl={props:{modelValue:{type:Object},placeholder:{type:String,default:"Search..."},fetch:{type:Function,required:!0},disabled:{type:Boolean,default:!1}},created(){this.reset()},data(){return{searchPattern:"",lastSearch:null,editing:!1,selectedOption:null,availableOptions:[]}},watch:{modelValue(){this.reset()}},methods:{async foundOptions(){return(await this.fetch()).map(t=>({option:t}))},targetSelected(e){let t=e.option;this.selectedOption={option:e.option,selected:!0},this.$emit("update:modelValue",t),this.$emit("change",e.option),this.editing=!1},reset(){this.searchPattern="",this.selectedOption=null,this.modelValue&&(this.selectedOption={option:this.modelValue,selected:!0})},onClickOutside(){this.editing=!1},async startEditing(){this.disabled||(this.editing=!0,this.availableOptions=await this.foundOptions())},clicked(){this.editing=!1}}};const Zl={key:0,class:"gray"},Wl=["onClick"];function Xl(e,t,n,i,l,a){const d=at("click-outside");return o(),u("div",{class:V(["container",{disabled:n.disabled}])},[b((o(),u("div",{onClick:t[0]||(t[0]=(...r)=>a.startEditing&&a.startEditing(...r)),class:"iconselect-input"},[l.selectedOption?q(e.$slots,"option",ce(Lt({key:1},l.selectedOption)),void 0,!0):(o(),u("span",Zl,C(n.placeholder),1))])),[[d,a.onClickOutside]]),s("div",{class:V(["suggestions",{hidden:!l.editing}])},[(o(!0),u(v,null,T(l.availableOptions,r=>(o(),u("div",{onClick:c=>a.targetSelected(r)},[q(e.$slots,"option",ce(fe(r)),void 0,!0)],8,Wl))),256))],2)],2)}const pt=A(jl,[["render",Xl],["__scopeId","data-v-0ce04898"]]),Yl={selectionEntry:["costs","name","annotation","page","hidden","category","constraints","defaultAmount"],selectionEntryLink:["costs","name","annotation","page","hidden","category","constraints","defaultAmount"],selectionEntryGroup:["name","annotation","page","hidden","category","constraints","defaultSelectionEntryId"],selectionEntryGroupLink:["name","annotation","page","hidden","category","constraints","defaultSelectionEntryId"],anyProfile:["name","annotation","page","hidden"],anyEntry:["name","annotation","page","hidden"],profile:["characteristics","name","annotation","page","hidden"],profileLink:["characteristics","name","annotation","description","page","hidden"],rule:["name","annotation","description","page","hidden"],ruleLink:["name","annotation","description","page","hidden"],infoLink:["name","annotation","page","hidden"],infoGroup:["name","annotation","page","hidden"],infoGroupLink:["name","annotation","page","hidden"],force:["name","annotation","page","hidden","constraints"],category:["name","page","hidden","constraints"],categoryLink:["name","page","hidden","constraints"],costType:["hidden"]},zl={costs:"number",name:"string",annotation:"string",page:"string",hidden:"boolean",description:"string",category:"category",defaultSelectionEntryId:"defaultSelectionEntryId",defaultAmount:"defaultAmount",constraints:"number"},Hl={number:[{id:"set",name:"Set",word:"to"},{id:"increment",name:"Increment",word:"by"},{id:"decrement",name:"Decrement",word:"by"}],string:[{id:"set",name:"Set",word:"to"},{id:"append",name:"Append",word:"with"},{id:"prepend",name:"Prepend",word:"with"},{id:"replace",name:"Replace",word:"with"}],"string-or-number":[{id:"set",name:"Set",word:"to"},{id:"append",name:"Append",word:"with"},{id:"prepend",name:"Prepend",word:"with"},{id:"replace",name:"Replace",word:"with"},{id:"increment",name:"Increment",word:"by"},{id:"decrement",name:"Decrement",word:"by"}],boolean:[{id:"set",name:"Set",word:"to"}],defaultSelectionEntryId:[{id:"set",name:"Set",word:""}],category:[{id:"add",name:"Add",word:""},{id:"remove",name:"Remove",word:""},{id:"set-primary",name:"Set Primary",word:"to"},{id:"unset-primary",name:"Unset Primary",word:"to"}],defaultAmount:[{id:"set",name:"Set",word:"to"}],error:[{id:"add",name:"Add",word:"message:"}]},Jl={components:{ErrorIcon:Te},emits:["catalogueChanged"],data(){return{value:"",selectedField:null,selectedOperation:null,selectedValue:null}},created(){this.update()},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{getName:$,getNameExtra:Z,changed(){this.selectedField&&(this.item.field=this.selectedField.id),this.selectedOperation&&(this.item.type=this.selectedOperation.id),this.$emit("catalogueChanged")},getDefaultFieldValue(e,t,n){var i;switch(e){case"number":return typeof n=="number"?n:0;case"category":return this.allCategories[0].id;case"string":let l;if(t==="name"){const a=this.item;l=a.getName&&a.getName()||""}else l="";return typeof n=="string"?n:l;case"string-or-number":return["string","number"].includes(typeof n)?n:"";case"boolean":return typeof n=="boolean"?n:!1;case"defaultSelectionEntryId":return(i=Ot(this.allGroupEntries))==null?void 0:i.id;case"defaultAmount":return"0";case"error":return"{this} is not allowed";default:throw Error(`fieldType "${e}" has no default value set"`)}},fieldChanged(){this.selectedOperation=this.operations[0],this.selectedField&&(this.item.value=this.getDefaultFieldValue(this.selectedField.type,this.selectedField.name,this.item.value)),this.changed()},update(){this.selectedField=this.fieldData.find(e=>e.id===this.item.field)||null,this.selectedOperation=this.operations.find(e=>e.id===this.item.type)||null,this.selectedField||(this.selectedField=this.fieldData[0]),this.selectedOperation||(this.selectedOperation=this.operations[0]||null)}},watch:{item(){this.update()}},computed:{join:{get(){return this.item.join??" "},set(e){e===" "&&delete this.item.join,this.item.join=e}},inputType(){var e,t;return this.selectedField?this.selectedField.type==="category"?"category":this.selectedField.type==="defaultSelectionEntryId"?"defaultSelectionEntryId":this.selectedField.type==="number"?"number":this.selectedField.type==="boolean"?"boolean":((e=this.selectedOperation)==null?void 0:e.id)==="increment"||((t=this.selectedOperation)==null?void 0:t.id)==="decrement"?"number":"string":""},parent(){return ee(this.item)},allCategories(){let e=[];for(let t of this.catalogue.iterateCategoryEntries())e.push(t);return e},allGroupEntries(){var e;return[...((e=this.parent)==null?void 0:e.selectionsIterator())||[]]},operations(){return this.selectedField?Hl[this.selectedField.type]:[]},errors(){return[]},costs(){const e=[];for(const t of this.catalogue.iterateCostTypes())e.push({id:t.id,name:t.name,type:"number",modifierType:"cost"});return e},constraints(){const e=[];if(!this.parent)return[];for(const t of this.parent.constraintsIterator())e.push({id:t.id,name:$(t),type:"number",modifierType:"constraint"});return e},type(){var e;if(this.item.affects&&this.item.affects!=="self"){const t=this.item.affects.split("."),n=t.indexOf("profiles");if(n!==-1){const i=t[n+1];if(i===void 0||i==="all")return{type:"anyProfile"};if(this.parent){for(const l of this.parent.getCatalogue().iterateProfileTypes())if(l.getName().toLowerCase()===i.toLowerCase())return{type:"profile",value:l}}return{type:"invalid"}}return{type:"anyEntry"}}else if(this.item.scope){const t=(e=this.parent)==null?void 0:e.getCatalogue().findOptionById(this.item.scope);if(t&&t.editorTypeName)return{type:t.editorTypeName}}},fieldData(){var n,i,l;if(!this.parent)return[];let e=Yl[((n=this.type)==null?void 0:n.type)||this.parent.editorTypeName];const t=[];if(!e)return[];if(e.includes("costs")&&t.push(...this.costs),e.includes("constraints")&&t.push(...this.constraints),e.includes("characteristics")){let a=(i=this.type)==null?void 0:i.value;!a&&this.parent.isProfile()&&(a=this.parent.isLink()?this.parent.target:this.parent),a&&(a!=null&&a.characteristics&&t.push(...a.characteristics.map(d=>({id:d.typeId,name:d.name,type:"string-or-number",modifierType:"characteristic",value:d.$text}))),a!=null&&a.characteristicTypes&&t.push(...a.characteristicTypes.map(d=>({id:d.id,name:d.name,type:"string-or-number",modifierType:"characteristic"}))))}return((l=this.type)==null?void 0:l.type)==="profile"&&this.type.value&&this.type.value.characteristicTypes&&t.push(...this.type.value.characteristicTypes.map(a=>({id:a.id,name:a.name,type:"string-or-number",modifierType:"characteristic"}))),e.includes("category")&&t.push({id:"category",name:"Category",type:"category",modifierType:"category"}),t.push({id:"error",name:"Error",type:"error",modifierType:"error"}),e=e.filter(a=>!["costs","constraints","category","characteristics"].includes(a)),e.map(a=>({id:a,name:a,type:zl[a],modifierType:"bullet"})).concat(t)}}};const Re=e=>(P("data-v-180d478b"),e=e(),U(),e),$l=Re(()=>s("legend",null,"Modifier",-1)),er={class:"modifier"},tr=["value"],nr={class:"flex align-items flex-row"},ar=["src"],sr={class:"inline"},ir={key:1},or={key:0,class:"mx-5px whitespace-nowrap"},lr={class:"mx-5px"},rr={key:0,class:"cost !m-0 whitespace-pre"},dr={key:1},ur={key:0},cr=Re(()=>s("option",{value:!0},"True",-1)),gr=Re(()=>s("option",{value:!1},"False",-1)),mr=[cr,gr],hr={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},pr=["src"],fr={class:"inline"},yr={class:"grey"},Cr={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},_r=["src"],Ar={class:"inline"},br={class:"grey"},vr={class:"mt-8px flex items-center"},kr=Re(()=>s("img",{src:ht},null,-1)),wr={class:"ml-10px"};function Ir(e,t,n,i,l,a){var y,f,k;const d=pt,r=le,c=se;return o(),u("fieldset",null,[$l,s("div",er,[l.selectedOperation?b((o(),u("select",{key:0,"onUpdate:modelValue":t[0]||(t[0]=m=>l.selectedOperation=m),onChange:t[1]||(t[1]=(...m)=>a.changed&&a.changed(...m))},[(o(!0),u(v,null,T(a.operations,m=>(o(),u("option",{value:m},C(m.name),9,tr))),256))],544)),[[M,l.selectedOperation]]):g("",!0),p(d,{modelValue:l.selectedField,"onUpdate:modelValue":t[2]||(t[2]=m=>l.selectedField=m),fetch:()=>a.fieldData,onChange:a.fieldChanged,class:"modType !max-w-200px"},{option:w(m=>[s("div",nr,[s("img",{class:"mr-1 my-auto",src:`assets/bsicons/${m.option.modifierType}.png`},null,8,ar),s("span",sr,C(m.option.name),1)])]),_:1},8,["modelValue","fetch","onChange"]),((y=l.selectedOperation)==null?void 0:y.id)=="replace"?(o(),u("div",ir,[b(s("input",{onChange:t[3]||(t[3]=(...m)=>a.changed&&a.changed(...m)),type:"text","onUpdate:modelValue":t[4]||(t[4]=m=>n.item.arg=m),placeholder:"text to replace"},null,544),[[x,n.item.arg]]),l.selectedOperation?(o(),u("span",or,[h(C(l.selectedOperation.word)+" ",1),b(s("input",{onChange:t[5]||(t[5]=(...m)=>a.changed&&a.changed(...m)),type:"text","onUpdate:modelValue":t[6]||(t[6]=m=>n.item.value=m)},null,544),[[x,n.item.value]])])):g("",!0)])):((f=l.selectedOperation)==null?void 0:f.id)==="append"||((k=l.selectedOperation)==null?void 0:k.id)==="prepend"?(o(),u(v,{key:2},[s("div",lr,[h(C(l.selectedOperation.word)+" ",1),b(s("input",{onChange:t[7]||(t[7]=(...m)=>a.changed&&a.changed(...m)),type:"text","onUpdate:modelValue":t[8]||(t[8]=m=>n.item.value=m)},null,544),[[x,n.item.value]])]),s("div",null,[h(" separate by: "),b(s("input",{onChange:t[9]||(t[9]=(...m)=>a.changed&&a.changed(...m)),type:"text","onUpdate:modelValue":t[10]||(t[10]=m=>a.join=m)},null,544),[[x,a.join]]),h(" ("),a.join.length?(o(),u("span",rr,C(a.join),1)):(o(),u("span",dr,"nothing")),h(") ")])],64)):(o(),u(v,{key:3},[l.selectedOperation?(o(),u("span",ur,C(l.selectedOperation.word),1)):g("",!0),a.inputType==="number"?(o(),_(r,{key:1,onChange:a.changed,modelValue:n.item.value,"onUpdate:modelValue":t[11]||(t[11]=m=>n.item.value=m)},null,8,["onChange","modelValue"])):g("",!0),a.inputType=="boolean"?b((o(),u("select",{key:2,onChange:t[12]||(t[12]=(...m)=>a.changed&&a.changed(...m)),"onUpdate:modelValue":t[13]||(t[13]=m=>n.item.value=m)},mr,544)),[[M,n.item.value]]):g("",!0),a.inputType.includes("string")?b((o(),u("input",{key:3,onChange:t[14]||(t[14]=(...m)=>a.changed&&a.changed(...m)),type:"text","onUpdate:modelValue":t[15]||(t[15]=m=>n.item.value=m)},null,544)),[[x,n.item.value]]):g("",!0),a.inputType=="category"?(o(),_(c,{key:4,class:"!max-w-350px",options:a.allCategories,filterField:m=>m.getName(),valueField:"id",modelValue:n.item.value,"onUpdate:modelValue":t[16]||(t[16]=m=>n.item.value=m),onChange:a.changed},{option:w(({option:m})=>[s("div",hr,[s("img",{class:"mr-1 my-auto",src:`assets/bsicons/${m.editorTypeName}.png`},null,8,pr),s("span",fr,[h(C(a.getName(m))+" ",1),s("span",yr,C(a.getNameExtra(m)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])):g("",!0),a.inputType=="defaultSelectionEntryId"?(o(),_(c,{key:5,class:"!max-w-350px",options:a.allGroupEntries,filterField:m=>m.getName(),valueField:"id",modelValue:n.item.value,"onUpdate:modelValue":t[17]||(t[17]=m=>n.item.value=m),onChange:a.changed},{option:w(({option:m})=>[s("div",Cr,[s("img",{class:"mr-1 my-auto",src:`assets/bsicons/${m.editorTypeName}.png`},null,8,_r),s("span",Ar,[h(C(a.getName(m))+" ",1),s("span",br,C(a.getNameExtra(m)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])):g("",!0)],64))]),(o(!0),u(v,null,T(a.errors,m=>(o(),u("div",vr,[kr,s("span",wr,C(m.msg),1)]))),256))])}const Er=A(Jl,[["render",Ir],["__scopeId","data-v-180d478b"]]);function Ae(e){var t;return((t=e.catalogue)==null?void 0:t.getName())??null}function Fe(e){if(e!=null&&e.parent){for(;e!=null&&e.parent&&!e.parent.isCatalogue();)e=e.parent;return e}}function xr(e){let t=0;if(!(e!=null&&e.parent))return t;for(;e!=null&&e.parent&&!e.parent.isCatalogue();)e=e.parent,t++;return t}function ge(e,t,n,i=0){var l,a;for(const d of e[t]())n.push({name:d.name,editorTypeName:d.editorTypeName,id:d.id,indent:i,catalogue:Ae(d),rootId:(l=Fe(d))==null?void 0:l.id,shared:((a=d.parentKey)==null?void 0:a.includes("shared"))||!1}),ge(d,t,n,i+1)}function Tr(e,t,n,i,l=0){var a,d;for(const r of e[t]())i.push({name:r.name,editorTypeName:r.editorTypeName,id:r.id,indent:l,rootId:(a=Fe(r))==null?void 0:a.id,catalogue:Ae(r),shared:((d=r.parentKey)==null?void 0:d.includes("shared"))||!1}),ge(r,t,i,l+1)}function Be(e,t){let n=[];for(const i of e.imports||[])ge(i,t,n);return ge(e,t,n),n}function ft(e){var i;const t=[],n=Gt(ee(e),l=>!l.isInfoGroup()&&!l.isProfile()&&!l.isRule());if(!n)return t;for(const l of qt(n)){const a=Fe(l);t.push({name:l.name,editorTypeName:l.editorTypeName,id:l.id,indent:xr(l),catalogue:Ae(l),rootId:a==null?void 0:a.id,shared:((i=l.parentKey)==null?void 0:i.includes("shared"))||!1})}return t}function Qe(e,t){const n=[],i=t?"iterateSelectionEntriesWithRoot":"iterateSelectionEntries";for(const l of e.imports||[])ge(l,i,n);return ge(e,i,n),n}function Sr(e,t){const n=[],i=e.getPrimaryCategory();return Tr(t,"iterateAllRootEntries",l=>ye(l).getPrimaryCategory()===i,n),n}function We(e){var n,i;const t=[];for(let l of e.iterateCategoryEntries()){const a=l;a.isCatalogue()||t.push({name:a.name,editorTypeName:a.editorTypeName,id:a.id,indent:0,catalogue:Ae(a),shared:((i=(n=ye(a))==null?void 0:n.parentKey)==null?void 0:i.includes("shared"))||!1})}return t}function Nr(e){const t=[];for(const n of Object.values(e.manager.getAllCatalogueFiles())){if(!n.catalogue)continue;const i=Qt(n);t.push({name:i.name,editorTypeName:"catalogue",id:i.id,indent:0,catalogue:null,shared:!1})}return t}function Rr(e){let t=0,n=ee(e);for(;n;)t++,n=n.parent;return t}function yt(e){var a,d,r;let t=[],n=e,i=0;const l=Rr(e)-1;for(n=ee(e);n!=null&&!n.isCatalogue();)n.editorTypeName==="selectionEntry"&&(t.push({name:n.name,id:n.id,editorTypeName:n.editorTypeName,indent:i,rootId:(a=Fe(n))==null?void 0:a.id,catalogue:Ae(n),shared:((r=(d=ye(n))==null?void 0:d.parentKey)==null?void 0:r.includes("shared"))||!1}),i++),n=n.parent;return t=t.reverse(),t.forEach((c,y)=>{c.indent=y+l}),t}function Ge(e){const t=Be(e,"iterateRootEntries");return t.splice(0,1),t}function Fr(e){return["self","parent","ancestor","primary-category","primary-catalogue","force","roster"].includes(e.scope)==!1}function ye(e){let t=e;for(;t.parent!=null&&t.parent.editorTypeName!="gameSystem"&&t.parent.editorTypeName!="catalogue";)t=t.parent;return t}function Br(e,t){if(["primary-catalogue","roster","force","ancestor"].includes(e.scope))return Qe(t,!0);const i=Qe(t,!1);if(e.scope=="self"){const a=ee(e);return a?i.concat(Ge(a)):i}if(e.scope=="parent"){if(ye(e))return Qe(t,!0);const a=ee(e);return a!=null&&a.parent?i.concat(Ge(a.parent)):i}if(e.scope=="primary-category")return Sr(ye(e),t);const l=t.findOptionById(e.scope);return l?i.concat(Ge(l)):i}const z={self:{value:"self",name:"Self"},parent:{value:"parent",name:"Parent"},roster:{value:"roster",name:"Roster"},force:{value:"force",name:"Force"},category:{value:"category",name:"Category"},ancestor:{value:"ancestor",name:"Ancestor"},parents:{value:"ancestor",name:"All Parents"},primaryCategory:{value:"primary-category",name:"Primary Category"},primaryCatalogue:{value:"primary-catalogue",name:"Primary Catalogue"},rootEntry:{value:"root-entry",name:"Root Entry"},unit:{value:"unit",name:"Type: Unit"},model:{value:"model",name:"Type: Model"},upgrade:{value:"upgrade",name:"Type: Upgrade"},modelOrUnit:{value:"model-or-unit",name:"Type: Model or Unit"}},Vr=j({components:{PopupDialog:Ee},emits:["catalogueChanged"],props:{obj:{type:Object,required:!0}},data:()=>({affectsPopup:!1}),methods:{getNameExtra:Z,showCatalogue(e){var t;return!(!e.catalogue||e.catalogue===((t=this.obj.catalogue)==null?void 0:t.getName()))}},computed:{scope:{get(){return this.obj.scope??"self"},set(e){e==="self"?delete this.obj.scope:this.obj.scope=e}},catalogue(){return this.obj.getCatalogue()},type(){return this.obj.editorTypeName},costTypes(){let e=[];for(let t of this.catalogue.iterateCostTypes())e.push(t);return e},allSelections(){return yt(this.obj)},allCategories(){return We(this.catalogue)},allForces(){return Be(this.catalogue,"forcesIterator")},allParents(){return ft(this.obj)},allScopes(){const e=[z.self,z.parent,z.force,z.roster,z.primaryCatalogue];return this.type!=="force"&&e.push(z.rootEntry,z.unit,z.model,z.upgrade,z.modelOrUnit),e.push(...this.allParents),this.type!=="force"&&e.push(...this.allCategories),e.push(...this.allForces),e}}}),Pr="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABmJLR0QAAAAAAAD5Q7t/AAAACXBIWXMAAC4jAAAuIwF4pT92AAAAB3RJTUUH5AIaDCEafIICUgAAABl0RVh0Q29tbWVudABDcmVhdGVkIHdpdGggR0lNUFeBDhcAAAG+SURBVDjLfZNPbxJRFMV/7zGOpRSt0qRpKFVs/BMssab7tgttAibzAfwURA0rv4Bu2sS46KoL15pIUuiiJi5c6MoKuhotNaZNDaABIVMi8Fz0VYeB8Szvfee8e2/OEXhwuVAKAneAW0Bcl8vANrBpp5KO+734S8yXQGABay6iF3tABnov7dQNACTAbKEIgnvACy95KWSynpgiYRoAF4HnIO9f2Sr9E5AIC3gMBLxf3r0QYXkmws3w6ZNSAHikFBaA0Dt/8ht7MWSycDbIk4M6nf5WGdR1Qx9sgGwKyMbOsxQd591hw0vmmCPShr52H8JS8HQuSuzMCNGxET5Wmz435bYc9nv8VICNLxXef2+ggDeVX34CcTmsWmx3eN1qMzcxRqPdYat+5CeA1CYZwDXTYDoc5PPPJi2l/Pi7UjtsACuREIYUfKi2+A+2JYrNYVMkzo2igJ2Gw4PpcSKBgW3LQF7a6aRzbE+67u5k0EQAD+dnqB51qHV77nYXyNippGPoSORAZd1uLHz7wX6rzbOvNd46v73krFS9XF+YruaL9ISwgFXgks/OZT1tzk4l+9PoiXNaG+xEaBd4NSzOfwAVZ4RYtS6UJgAAAABJRU5ErkJggg==",Ur=s("legend",null,"Query",-1),Lr={class:"editorTable"},Or=s("td",null,"Scope:",-1),Qr={style:{"white-space":"nowrap"}},Gr=["src"],qr={class:"gray"},Dr={key:1,class:"shared"},Kr={key:2,class:"catalogueName"},Mr={class:"imgBt"},jr=s("code",{class:"cost"},".",-1),Zr=s("h5",null,"selectors on nodes:",-1),Wr=s("ul",{class:"m-0"},[s("li",null,[s("span",{class:"cost"},"all")]),s("li",null,[s("span",{class:"cost"},"childs")]),s("li",null,[s("span",{class:"cost"},"forces")]),s("li",null,[s("span",{class:"cost"},"categories")]),s("li",null,[s("span",{class:"cost"},"units")]),s("li",null,[s("span",{class:"cost"},"profiles"),h(": May be followed by a typeName e.g "),s("span",{class:"cost"},"profiles.Weapon"),h(". ")]),s("li",null,[s("span",{class:"cost"},"{id}"),h(": Used to filter the nodes, e.g "),s("span",{class:"cost"},"childs.recursive.model"),h(". ")])],-1),Xr=s("h5",null,"Additional Selectors:",-1),Yr=s("ul",{class:"m-0"},[s("li",null,[s("span",{class:"cost"},".recursive"),h(" Recursively applies the previous selector.")])],-1),zr=s("p",{class:"mt-20px"},[s("strong",null,"Notes:"),h(" This feature is a work in progress (WIP) and may undergo syntax changes, which could require you to re-input them. "),s("br"),h("There may be peformance issues if many modifiers affect a roster or force. If you experience some let me know so i can fix it. "),s("br"),h("Added Modifiers are (currently) evaluated last, in the order they were added by the user, so don't expect a specific order if using multiple relative modifiers "),s("br"),h("Feel free to provide feedback on Discord. ")],-1);function Hr(e,t,n,i,l,a){const d=se,r=Ee;return o(),u("fieldset",null,[Ur,s("table",Lr,[s("tr",null,[Or,s("td",null,[p(d,{modelValue:e.scope,"onUpdate:modelValue":t[0]||(t[0]=c=>e.scope=c),placeholder:"Search Scope...",options:e.allScopes,valueField:"value",filterField:"name",default:e.allScopes[0],onChange:t[1]||(t[1]=()=>{})},{option:w(c=>[s("div",Qr,[c.option.indent>=2&&!c.selected?(o(!0),u(v,{key:0},T(c.option.indent-1,y=>(o(),u("span",null,"   "))),256)):g("",!0),s("img",{class:"mr-1 align-middle",src:`assets/bsicons/${c.option.editorTypeName||"bullet"}.png`},null,8,Gr),h(" "+C(c.option.name)+" ",1),s("span",qr,C(e.getNameExtra(c.option,!1)),1),c.option.shared?(o(),u("span",Dr," (shared)")):g("",!0),e.showCatalogue(c.option)?(o(),u("span",Kr," ["+C(c.option.catalogue)+"]",1)):g("",!0)])]),_:1},8,["modelValue","placeholder","options","default"])])]),s("tr",null,[s("td",null,[h("Affects: "),s("span",Mr,[s("img",{src:Pr,class:"align-text-bottom",onClick:t[2]||(t[2]=c=>e.affectsPopup=!0)})])]),s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=c=>e.obj.affects=c),placeholder:"self"},null,512),[[x,e.obj.affects]])])])]),e.affectsPopup?(o(),_(r,{key:0,modelValue:e.affectsPopup,"onUpdate:modelValue":t[4]||(t[4]=c=>e.affectsPopup=c)},{default:w(()=>[h(" for ease of parsing this field only accepts selectors separated by a "),jr,Zr,Wr,Xr,Yr,zr]),_:1},8,["modelValue"])):g("",!0)])}const Jr=A(Vr,[["render",Hr]]),$r={emits:["catalogueChanged"],setup(){return{store:Q()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},computed:{type(){return this.item.editorTypeName},parent(){return this.item.parent}},methods:{changed(){this.$emit("catalogueChanged")},add(e,t,n,i){t==="id"&&(t=this.item.id);let l=this.item;this.store.create_child("conditions",l,{scope:e,field:t,type:n,value:i,childId:"any",includeChildSelections:!!["roster"].includes(e)})}}},Ct="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAPCAYAAADUFP50AAABgmlDQ1BJQ0MgUHJvZmlsZQAAKM+VkU0oRFEcxX9miDSizEKyeAusTIRkyVCToqZBGSy898YMNe+Z3hvZWCrbKQsfG18LG2u2FrZKKR8lWxsrYiM9//tGzaRGuXW7v86953TvuRA4yJqWW90Dlp13ErGoNpOc1WqfqSFEE90EddPNDcfj41QcH7dUqfUmorL432hILbomVGnCQ2bOyQsvCA+s5XOKd4TD5pKeEj4V7nLkgsL3SjeK/KI443NAZYadqcSIcFhYy5SxUcbmkmMJ9wu3pyxb8gMzRU4pXldsZVfNn3uqF4YW7elJpctsI8YYE8TRMFhlmSx5IrLaorgkZD9awd/q++PiMsS1jCmOUVaw0H0/6g9+d+um+3qLSaEo1Dx53lsH1G7BV8HzPg897+sIgo9wYZf8Kwcw+C56oaS170PjBpxdljRjG843oeUhpzu6LwVlBtJpeD2Rb0pC8zXUzxV7+9nn+A6mpKvxK9jdg86MZM9XeHddeW9/nvH7I/oNQUlyk6fcG6sAAAAJcEhZcwAALiIAAC4iAari3ZIAAAH9SURBVDhPnZJPaBNBFMa//ZPNpgHT0HartRD/IKJSRIoFLd5VPEmPBgQtXgqCnooIohRE8CBe9CZCTx48evGioKlKpCGiFUWxNmnS3eomNNnN7mafM2NZXNKTD37L8L3ve7MzjIQt6vrDdbIaJNaDGQm3Lg30+GLC5bsrdPRgGsfG0hgZUoVWNQMUyi28+9jCvaujvRtN31yirz/bFAQB+b4fg2u8xz2b9r81deUNff7eJNd1yXEcmsy/iLGwWBc97uFenpH5Z+JQGqOGAjYdbDryZ3YIThzZhmaziYXSmuhxDz8KL+Xk9DO6OLUPmbQEIhLsz2nIGSF+VBoolH4hNxxie38btt3AQDaFmnzqhrxccbFrpA9hGMLzPJimhWq1huevV/HgSRUTYwYunN0NWVbZUGA4q4BnZFXtA5jgOB1Ylo1OJ4CiJHDnsQ1JSmFuZg9c14OqagJip+MZeW9uEF+W22i1PBbQkEjogsL8cYHndSONs2oBPCM/vT8uvSz60PUUNC0ZcXqmIvhXSybZwDLAM+JWi0syzAYPpqLJup4RxHZbT6L8TRO3GlV+9je9/+BQve5QrebQxkYg4GuuvS216RzzbNrjT443xg9omDycwE6D/QyzrZhdvFr0UfzkY/52NvL3vj1W56+ZtGYrYm30d/FobmhL338U8AdLygpqJt/tXAAAAABJRU5ErkJggg==";const ae=e=>(P("data-v-58010d7b"),e=e(),U(),e),ed=ae(()=>s("legend",null,[s("img",{src:Ct}),h(" Quick Conditions")],-1)),td={class:"columns"},nd={class:"buttonList"},ad=ae(()=>s("img",{src:N},null,-1)),sd=ae(()=>s("img",{src:N},null,-1)),id=ae(()=>s("img",{src:N},null,-1)),od=ae(()=>s("img",{src:N},null,-1)),ld={class:"buttonList"},rd=ae(()=>s("img",{src:N},null,-1)),dd=ae(()=>s("img",{src:N},null,-1)),ud=ae(()=>s("img",{src:N},null,-1)),cd=ae(()=>s("img",{src:N},null,-1));function gd(e,t,n,i,l,a){return o(),u("fieldset",null,[ed,s("div",td,[s("div",nd,[s("button",{class:"bouton",onClick:t[0]||(t[0]=d=>a.add("parent","selections","atLeast",1))},[ad,h("PARENT ATLEAST 1 ")]),s("button",{class:"bouton",onClick:t[1]||(t[1]=d=>a.add("force","selections","atLeast",1))},[sd,h("FORCE ATLEAST 1 ")]),s("button",{class:"bouton",onClick:t[2]||(t[2]=d=>a.add("roster","selections","atLeast",1))},[id,h("ROSTER ATLEAST 1 ")]),s("button",{class:"bouton",onClick:t[3]||(t[3]=d=>a.add("ancestor","selections","instanceOf",1))},[od,h("ANCESTOR INSTANCE OF ")])]),s("div",ld,[s("button",{class:"bouton",onClick:t[4]||(t[4]=d=>a.add("parent","selections","lessThan",1))},[rd,h("PARENT LESS THAN 1 ")]),s("button",{class:"bouton",onClick:t[5]||(t[5]=d=>a.add("force","selections","lessThan",1))},[dd,h("FORCE LESS THAN 1 ")]),s("button",{class:"bouton",onClick:t[6]||(t[6]=d=>a.add("roster","selections","lessThan",1))},[ud,h("ROSTER LESS THAN 1 ")]),s("button",{class:"bouton",onClick:t[7]||(t[7]=d=>a.add("ancestor","selections","notInstanceOf",1))},[cd,h("ANCESTOR NOT INSTANCE OF ")])])])])}const _t=A($r,[["render",gd],["__scopeId","data-v-58010d7b"]]),md={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function hd(e,t,n,i,l,a){const d=L,r=Er,c=Jr,y=_t;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),p(c,{obj:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["obj","onCatalogueChanged"]),p(y,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const pd=A(md,[["render",hd]]),fd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};const re=e=>(P("data-v-0f2786e9"),e=e(),U(),e),yd=re(()=>s("legend",null,"Constraint",-1)),Cd={class:"editorTable"},_d=re(()=>s("td",null,"Unique ID:",-1)),Ad={class:"constraint"},bd=re(()=>s("option",{value:"min"},"Minimum",-1)),vd=re(()=>s("option",{value:"max"},"Maximum",-1)),kd=re(()=>s("option",{value:"exactly"},"Exactly",-1)),wd=[bd,vd,kd],Id=re(()=>s("label",{for:"percent"},"Percentage?",-1)),Ed=re(()=>s("label",{for:"negative"},"Negative?",-1));function xd(e,t,n,i,l,a){const d=le;return o(),u("fieldset",null,[yd,s("table",Cd,[s("tr",null,[_d,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>n.item.id=r),onChange:t[1]||(t[1]=(...r)=>a.changed&&a.changed(...r))},null,544),[[x,n.item.id]])])])]),s("div",Ad,[b(s("select",{"onUpdate:modelValue":t[2]||(t[2]=r=>n.item.type=r),onChange:t[3]||(t[3]=(...r)=>a.changed&&a.changed(...r))},wd,544),[[M,n.item.type]]),p(d,{modelValue:n.item.value,"onUpdate:modelValue":t[4]||(t[4]=r=>n.item.value=r),onChange:a.changed},null,8,["modelValue","onChange"]),s("div",null,[b(s("input",{id:"percent",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=r=>n.item.percentValue=r),onChange:t[6]||(t[6]=(...r)=>a.changed&&a.changed(...r))},null,544),[[O,n.item.percentValue]]),Id,b(s("input",{id:"negative",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=r=>n.item.negative=r),onChange:t[8]||(t[8]=(...r)=>a.changed&&a.changed(...r))},null,544),[[O,n.item.negative]]),Ed])])])}const Td=A(fd,[["render",xd],["__scopeId","data-v-0f2786e9"]]),Sd={emits:["catalogueChanged"],data(){return{itemField:null}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},childForces:{type:Boolean,default:!1},childSelections:{type:Boolean,default:!1},shared:{type:Boolean,default:!1}},methods:{getNameExtra:Z,changed(){this.$emit("catalogueChanged")},scopeChanged(){this.item.catalogue.updateCondition(this.item),this.changed()},fieldChanged(){this.item.field=this.itemField.value,this.item.field.startsWith("limit::")&&this.item.editorTypeName!=="constraint"&&(this.item.childId="any"),this.changed()},showCatalogue(e){var t;return!(!e.catalogue||e.catalogue===((t=this.item.catalogue)==null?void 0:t.getName()))}},computed:{association(){return this.item.editorTypeName=="association"},sharedTooltip(){return this.item.editorTypeName!=="constraint"?`Its recommended to keep shared checked on ${this.item.editorTypeName}s`:`Indicates that constraints on links should be evaluated as if they are on their target, usually only relevant if the scope is above "parent"

eg: a unit has a Leader and a Model which have a link to the same entry, with a max 1 constraint on the links scoped to the unit.
assuming both have selected 1 of that entry:
- a shared constraint would error as its evaluating the target of the links
- a non-shared constraint would not error as it would be evaluating the amount of the links themselves

note: shared=false on BS will also limit the constraint to it's parent rootSelectionEntry ID
`},instanceOf(){var e;return["instanceOf","notInstanceOf"].includes((e=this.item)==null?void 0:e.type)},parent(){return ee(this.item)},costType(){var e;return((e=this.parent)==null?void 0:e.editorTypeName)==="costType"},fieldTypes(){const e=[];this.instanceOf&&e.push({name:"",value:void 0,type:null}),e.push({name:"Selections",value:"selections",type:"bullet"}),e.push({name:"Forces",value:"forces",type:"bullet"});for(const t of this.costTypes)e.push({name:t.name,value:t.id,type:"cost"}),this.item.scope==="roster"&&e.push({name:`${t.name} Limit`,value:`limit::${t.id}`,type:"cost"});return e},includeCategories(){return this.item.field!=="forces"},includeForces(){return!0},includeSelections(){return this.item.field!="forces"},costTypes(){let e=[];for(let t of this.catalogue.iterateCostTypes())e.push(t);return e},allSelections(){return this.includeSelections?yt(this.item):[]},allCategories(){return this.includeCategories?We(this.catalogue):[]},allForces(){return this.includeForces?Be(this.catalogue,"forcesIterator"):[]},allParents(){return ft(this.item)},allScopes(){if(this.costType)return[{id:"self",name:"Self",editorTypeName:"bullet"},{id:"parent",name:"Parent",editorTypeName:"bullet"}];const e=[{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"},{id:"primary-catalogue",name:"Primary Catalogue",editorTypeName:"bullet"},{id:"root-entry",name:"Root Entry",editorTypeName:"bullet"},{id:"unit",name:"Type: Unit",editorTypeName:"bullet"},{id:"model",name:"Type: Model",editorTypeName:"bullet"},{id:"upgrade",name:"Type: Upgrade",editorTypeName:"bullet"},{id:"model-or-unit",name:"Type: Model or Unit",editorTypeName:"bullet"}];let t=[{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"},...e];return this.item.field!="forces"&&["condition","association"].includes(this.item.editorTypeName)&&(t=[{id:"self",name:"Self",editorTypeName:"bullet"},{id:"parent",name:"Parent",editorTypeName:"bullet"},{id:"ancestor",name:"Ancestor",editorTypeName:"bullet",title:"checks the condition in all parents"},{id:"primary-category",name:"Primary Category",editorTypeName:"bullet"},...e]),this.item.field!=="forces"&&["repeat","constraint"].includes(this.item.editorTypeName)&&(t=[{id:"self",name:"Self",editorTypeName:"bullet"},{id:"parent",name:"Parent",editorTypeName:"bullet"},...e]),t.concat(this.allParents).concat(this.allSelections).concat(this.allCategories).concat(this.allForces)}},watch:{"item.field":{handler(){this.item.field=="forces"&&(this.item.scope="roster"),this.itemField=this.fieldTypes.find(e=>e.value==this.item.field)},immediate:!0}}};const Ve=e=>(P("data-v-4727c144"),e=e(),U(),e),Nd=Ve(()=>s("legend",null,"Query",-1)),Rd={class:"query"},Fd=["src"],Bd=Ve(()=>s("span",null," in ",-1)),Vd={style:{"white-space":"nowrap"}},Pd=["src"],Ud={class:"gray"},Ld={key:1,class:"shared"},Od={key:2,class:"catalogueName"},Qd={key:0,class:"checks"},Gd={key:0},qd=["title"],Dd={key:1},Kd=Ve(()=>s("label",{for:"childSelections"},"And all child Selections",-1)),Md={key:2},jd=Ve(()=>s("label",{for:"childForces"},"And all child Forces",-1));function Zd(e,t,n,i,l,a){var c,y;const d=pt,r=se;return o(),u("fieldset",null,[Nd,s("div",Rd,[p(d,{modelValue:l.itemField,"onUpdate:modelValue":t[0]||(t[0]=f=>l.itemField=f),fetch:()=>a.fieldTypes,onChange:a.fieldChanged,class:"modType",disabled:a.instanceOf||a.association},{option:w(f=>[s("div",null,[s("img",{class:"mr-1 align-middle",src:`assets/bsicons/${f.option.type}.png`},null,8,Fd),h(" "+C(f.option.name),1)])]),_:1},8,["modelValue","fetch","onChange","disabled"]),Bd,p(r,{modelValue:n.item.scope,"onUpdate:modelValue":t[1]||(t[1]=f=>n.item.scope=f),placeholder:"Search Scope...",options:a.allScopes,valueField:"id",filterField:"name",onChange:a.scopeChanged,disabled:(y=(c=l.itemField)==null?void 0:c.value)==null?void 0:y.startsWith("limit::")},{option:w(f=>[s("div",Vd,[f.option.indent>=2&&!f.selected?(o(!0),u(v,{key:0},T(f.option.indent-1,k=>(o(),u("span",null,"   "))),256)):g("",!0),s("img",{class:"mr-1 align-middle",src:`assets/bsicons/${f.option.editorTypeName}.png`},null,8,Pd),h(" "+C(f.option.name)+" ",1),s("span",Ud,C(a.getNameExtra(f.option,!1)),1),f.option.shared?(o(),u("span",Ld," (shared)")):g("",!0),a.showCatalogue(f.option)?(o(),u("span",Od," ["+C(f.option.catalogue)+"]",1)):g("",!0)])]),_:1},8,["modelValue","placeholder","options","onChange","disabled"]),a.costType?g("",!0):(o(),u("div",Qd,[n.shared?(o(),u("div",Gd,[b(s("input",{onChange:t[2]||(t[2]=(...f)=>a.changed&&a.changed(...f)),id:"shared",type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=f=>n.item.shared=f)},null,544),[[O,n.item.shared]]),s("label",{for:"shared",class:"hastooltip",title:a.sharedTooltip},"Shared",8,qd)])):g("",!0),n.childSelections?(o(),u("div",Dd,[b(s("input",{onChange:t[4]||(t[4]=(...f)=>a.changed&&a.changed(...f)),id:"childSelections",type:"checkbox","onUpdate:modelValue":t[5]||(t[5]=f=>n.item.includeChildSelections=f)},null,544),[[O,n.item.includeChildSelections]]),Kd])):g("",!0),n.childForces?(o(),u("div",Md,[b(s("input",{onChange:t[6]||(t[6]=(...f)=>a.changed&&a.changed(...f)),id:"childForces",type:"checkbox","onUpdate:modelValue":t[7]||(t[7]=f=>n.item.includeChildForces=f)},null,544),[[O,n.item.includeChildForces]]),jd])):g("",!0)]))])])}const Pe=A(Sd,[["render",Zd],["__scopeId","data-v-4727c144"]]),Wd={emits:["catalogueChanged"],setup(){return{store:Q()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},computed:{type(){return this.item.editorTypeName},parent(){return this.item.parent}},methods:{changed(){this.$emit("catalogueChanged")},add(e,t,n){e==="id"&&(e=this.item.id);let i=this.item;this.type==="constraint"&&(i=this.parent),this.store.create_child("modifiers",i,{field:e,type:t,value:n})}}},Xe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAQCAYAAADwMZRfAAABg2lDQ1BJQ0MgUHJvZmlsZQAAKM+VkTlIA0EYhb9EJeKBhQFFLLZQKwOiIpYaBREUQlTwKtzdmChkN2E3wcZSsA1YeDRehY21tha2giB4gNjaWCnaiKz/bIQEIYIDw3y8mfeYeQPBg7RpudU9YNk5Jz4W1Wbn5rXQMzXUE6KNFt10s8Ox2AQVx8ctAbXeRFQW/xuNiWXXhIAmPGRmnZzwkvDAWi6reEc4bK7oCeFT4W5HLih8r3SjyC+KUz4HVWbYmY6PCIeFtVQZG2VsrjiWcL9wR8KyJT84W+SE4nXFVjpv/txTvbBh2Z6ZUrrMdsYYZ5IYGgZ5VkmTIyKrLYpLXPajFfxtvj8mLkNcq5jiGCWDhe77UX/wu1s32ddbTGqIQs2T5711QmgLvgqe93noeV9HUPUIF3bJnzmAwXfRCyWtYx+aNuDssqQZ23C+Ca0PWd3RfalKZjCZhNcT+aY5aL6GuoVibz/7HN/BtHQ1cQW7e9CVkuzFCu+uLe/tzzN+f0S/ASWWcoi7xtRwAAAACXBIWXMAAC4iAAAuIgGq4t2SAAAB+UlEQVQ4T5WTz2sTQRTHv7M/6iH4m7aXTTZnqY1E1JBSsChW1KJSYijiwZN4Lo1/giZetHhWiaHaH9aoNbEHtb8sCagtChWTNNAt9eaWellpDs+ZaSwGbZJ+4PFm38z77O7sDkOdTM68p59ra3LcdfZMRZ9SzlUZe5WmHboG/yEfrCWrXN0GbycmaWp6inK5bxSNxahcrqDmk9g/bOzetROp9DhuRCKbr/F4cIhGk8+ltKbE+eVgfb2EtmAAN29FZVP8UYLa24JwHEeuqSkplUoyVldtnDzRgTt3+ylw7AgWFr5ifm5Orqn6dVKvx+n7ygpMjwGXy4WGBp1XGZasZWQyWdyORWX/lpKxVJosy0JrywFMz8zCtu3yzAZ/BIL/SpIvXtKyEBxswfznL/B6vTjfdW7LG/6zJyOjz6hYLMLX6sOHj59gGEZVgaBCMjj8lIqLiwgcDWI2k4Hh9qD74oWqAsGmZODJEBUKeXQcP413E29gmibCoe6aAoGUxBMDlM/l+ZkI8Z8qCQ8X9IRDdQkEysN4ggr5AsKXrmJ4JAGTb+KVyz11CwSst6+Prl+L4P6De2hubsSpzk4oigLGQ+S/Q1V5nW2MGWMyN+7bw5g4A9lsFm63G37/YSiqCk3joWo8a1B56PwEy2tdlzUxrygql6po2r+X/QZc4Kt8vjU1QAAAAABJRU5ErkJggg==";const be=e=>(P("data-v-eaa13e99"),e=e(),U(),e),Xd=be(()=>s("legend",null,[s("img",{src:Xe}),h(" Quick Modifiers")],-1)),Yd={class:"columns"},zd={class:"buttonList"},Hd=be(()=>s("img",{src:N},null,-1)),Jd=be(()=>s("img",{src:N},null,-1)),$d={class:"buttonList"},eu=be(()=>s("img",{src:N},null,-1)),tu=be(()=>s("img",{src:N},null,-1));function nu(e,t,n,i,l,a){return o(),u("fieldset",null,[Xd,s("div",Yd,[a.type==="constraint"?(o(),u(v,{key:0},[s("div",zd,[s("button",{class:"bouton",onClick:t[0]||(t[0]=d=>a.add("id","increment",1))},[Hd,h("INCREMENT 1 ")]),s("button",{class:"bouton",onClick:t[1]||(t[1]=d=>a.add("id","set",1))},[Jd,h("SET 1 ")])]),s("div",$d,[s("button",{class:"bouton",onClick:t[2]||(t[2]=d=>a.add("id","decrement",1))},[eu,h("DECREMENT 1 ")]),s("button",{class:"bouton",onClick:t[3]||(t[3]=d=>a.add("id","set",0))},[tu,h("SET 0 ")])])],64)):g("",!0)])])}const At=A(Wd,[["render",nu],["__scopeId","data-v-eaa13e99"]]),au=[{id:"any",name:"Anything",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"unit",name:"Unit",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"model",name:"Model",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"upgrade",name:"Upgrade",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"mount",name:"Mount",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"crew",name:"Crew",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"entry",name:"Entry",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"group",name:"Group",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"force",name:"Force",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"category",name:"Category",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"roster",name:"Roster",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1}],su={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},hideshared:{type:Boolean,default:!1},noshared:{type:Boolean,default:!1}},methods:{getNameExtra:Z,changed(){this.$emit("catalogueChanged")},showCatalogue(e){var t;return!(!e.catalogue||e.catalogue===((t=this.item.catalogue)==null?void 0:t.getName()))},availableTargets(){return[...au,...this.allCategories,...this.allEntries,...this.allForces,...this.allCatalogues]}},watch:{"item.scope"(){var e;this.child||(this.item.childId=((e=this.availableTargets()[0])==null?void 0:e.id)||void 0)}},computed:{childId:{get(){return this.item.childId},set(e){const t=this.item.childId;this.item.childId=e,this.catalogue.updateCondition(this.item,t)}},child(){if(!this.item.childId)return null;const e=this.availableTargets().find(t=>t.id===this.item.childId);return e||this.catalogue.findOptionById(this.item.childId)},instanceOf(){var e;return["instanceOf","notInstanceOf"].includes((e=this.item)==null?void 0:e.type)},allEntries(){return this.includeSelections?Br(this.item,this.catalogue):[]},rootId(){let e=this.item;if(e!=null&&e.parent){for(;e!=null&&e.parent&&!e.parent.isCatalogue();)e=e.parent;return e.id}},allCategories(){return this.includeCategories?We(this.catalogue):[]},allForces(){return this.includeForces?Be(this.catalogue,"forcesIterator"):[]},allCatalogues(){return this.includeCatalogues?Nr(this.catalogue):[]},includeSelections(){return!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.instanceOf&&this.item.scope==="primary-category")},includeCategories(){return!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.item.field==="forces")},includeForces(){return this.item.scope=="self"||this.item.scope=="parent"?!1:this.item.scope=="ancestor"?!0:!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.instanceOf&&this.item.scope==="primary-category"||Fr(this.item))},includeCatalogues(){return this.instanceOf&&this.item.scope==="primary-catalogue"}}};const Ue=e=>(P("data-v-6adbe092"),e=e(),U(),e),iu=Ue(()=>s("legend",null,"Filter By",-1)),ou={class:"editorTable"},lu=Ue(()=>s("td",null,"Of:",-1)),ru={key:0},du=["src"],uu=Ue(()=>s("td",null,"Child ID:",-1)),cu=Ue(()=>s("td",null,"Child:",-1)),gu={key:0,style:{"white-space":"nowrap"}},mu=["src"],hu={class:"gray"},pu={key:1,class:"shared"},fu={key:2,class:"gray"},yu={key:3,class:"catalogueName"},Cu={key:0},_u=["disabled"],Au=["title"];function bu(e,t,n,i,l,a){const d=se;return o(),u("fieldset",null,[iu,s("table",ou,[s("tr",null,[lu,s("td",null,[a.child?(o(),u("span",ru,[s("img",{class:"mr-1 align-middle",src:`assets/bsicons/${a.child.editorTypeName}.png`},null,8,du),h(" "+C(a.child.name),1)])):g("",!0)])]),s("tr",null,[uu,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>a.childId=r),onChange:t[1]||(t[1]=(...r)=>a.changed&&a.changed(...r))},null,544),[[x,a.childId]])])]),s("tr",null,[cu,s("td",null,[p(d,{modelValue:a.childId,"onUpdate:modelValue":t[2]||(t[2]=r=>a.childId=r),placeholder:"Search Child...",options:a.availableTargets,valueField:"id",filterField:"name",onChange:a.changed,default:a.child,lazy:""},{option:w(r=>[r.option?(o(),u("div",gu,[r.option.indent>=1&&!r.selected?(o(!0),u(v,{key:0},T(r.option.indent,c=>(o(),u("span",null,"   "))),256)):g("",!0),s("img",{class:"mr-1 align-middle",src:`assets/bsicons/${r.option.editorTypeName}.png`},null,8,mu),h(" "+C(r.option.name)+" ",1),s("span",hu,C(a.getNameExtra(r.option,!1)),1),r.option.shared?(o(),u("span",pu," (shared) ")):g("",!0),r.option.rootId===a.rootId?(o(),u("span",fu," (same ancestor)")):g("",!0),a.showCatalogue(r.option)?(o(),u("span",yu," ["+C(r.option.catalogue)+"]",1)):g("",!0)])):g("",!0)]),_:1},8,["modelValue","placeholder","options","onChange","default"])])])]),n.hideshared?g("",!0):(o(),u("span",Cu,[b(s("input",{disabled:n.noshared&&n.item.shared,type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=r=>n.item.shared=r),id:"shared",onChange:t[4]||(t[4]=(...r)=>a.changed&&a.changed(...r))},null,40,_u),[[O,n.item.shared]]),s("label",{class:V([{gray:n.noshared&&n.item.shared},"hastooltip"]),title:`Its recommended to keep shared checked on ${n.item.editorTypeName}s`,for:"shared"},"Shared?",10,Au)]))])}const Le=A(su,[["render",bu],["__scopeId","data-v-6adbe092"]]),vu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{showFilterBy(){var t;return((t=ee(this.item))==null?void 0:t.parentKey)==="associations"}},methods:{changed(){this.catalogue.updateCondition(this.item),this.$emit("catalogueChanged")}},components:{FilterBy:Le,QuickModifiers:At}};function ku(e,t,n,i,l,a){const d=L,r=Td,c=Pe,y=F("FilterBy"),f=At;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),p(c,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed,class:"section",childForces:"",childSelections:"",shared:""},null,8,["catalogue","item","onCatalogueChanged"]),a.showFilterBy?(o(),_(y,{key:0,class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"])):g("",!0),p(f,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const wu=A(vu,[["render",ku]]),Iu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Eu=s("legend",null,"Condition Group",-1),xu={class:"editorTable"},Tu=s("td",null,"Type",-1),Su=s("option",{value:"or"},"Or",-1),Nu=s("option",{value:"and"},"And",-1),Ru=[Su,Nu];function Fu(e,t,n,i,l,a){const d=L;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),s("fieldset",null,[Eu,s("table",xu,[s("tr",null,[Tu,s("td",null,[b(s("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>n.item.type=r),onChange:t[1]||(t[1]=(...r)=>a.changed&&a.changed(...r))},Ru,544),[[M,n.item.type]])])])])])],64)}const Bu=A(Iu,[["render",Fu]]),Vu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{ConditionGroup:Bu}};function Pu(e,t,n,i,l,a){const d=F("ConditionGroup");return o(),u("div",null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])])}const Uu=A(Vu,[["render",Pu]]),Lu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{allowNonInstanceOf(){var e;return!(((e=this.parent)==null?void 0:e.editorTypeName)==="costType"||this.item.scope==="ancestor")},instanceOf(){return this.item.type.includes("instance")},parent(){return ee(this.item)}},components:{NumberInput:le},watch:{"item.scope"(){const e=["instanceOf","notInstanceOf"];!this.allowNonInstanceOf&&!e.includes(this.item.type)&&(this.item.type=e[0])}}};const Ye=e=>(P("data-v-2108e44d"),e=e(),U(),e),Ou=Ye(()=>s("legend",null,"Condition",-1)),Qu={class:"condition"},Gu=nt('<option value="lessThan" data-v-2108e44d>Less Than</option><option value="greaterThan" data-v-2108e44d>Greater Than</option><option value="equalTo" data-v-2108e44d>Equal To</option><option value="notEqualTo" data-v-2108e44d>Not Equal To</option><option value="atLeast" data-v-2108e44d>At Least</option><option value="atMost" data-v-2108e44d>At Most</option>',6),qu=Ye(()=>s("option",{value:"instanceOf"},"Instance Of",-1)),Du=Ye(()=>s("option",{value:"notInstanceOf"},"Not Instance Of",-1)),Ku=["disabled"];function Mu(e,t,n,i,l,a){const d=le;return o(),u("fieldset",null,[Ou,s("div",Qu,[b(s("select",{"onUpdate:modelValue":t[0]||(t[0]=r=>n.item.type=r),onChange:t[1]||(t[1]=(...r)=>a.changed&&a.changed(...r))},[a.allowNonInstanceOf?(o(),u(v,{key:0},[Gu],64)):g("",!0),qu,Du],544),[[M,n.item.type]]),p(d,{disabled:a.instanceOf,modelValue:n.item.value,"onUpdate:modelValue":t[2]||(t[2]=r=>n.item.value=r),onChange:a.changed},null,8,["disabled","modelValue","onChange"]),s("div",null,[b(s("input",{disabled:a.instanceOf,id:"percent",type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=r=>n.item.percentValue=r),onChange:t[4]||(t[4]=(...r)=>a.changed&&a.changed(...r))},null,40,Ku),[[O,n.item.percentValue]]),s("label",{class:V({disabled:a.instanceOf}),for:"percent"},"Percentage?",2)])])])}const ju=A(Lu,[["render",Mu],["__scopeId","data-v-2108e44d"]]),Zu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{Condition:ju,FilterBy:Le}};function Wu(e,t,n,i,l,a){var f;const d=L,r=F("Condition"),c=Pe,y=F("FilterBy");return o(),u("div",null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),p(c,{class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue,childForces:"",childSelections:""},null,8,["item","onCatalogueChanged","catalogue"]),((f=n.item.field)==null?void 0:f.startsWith("limit::"))==!1?(o(),_(y,{key:0,noshared:"",class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"])):g("",!0)])}const Xu=A(Zu,[["render",Wu]]),Yu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function zu(e,t,n,i,l,a){const d=L,r=_t;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Hu=A(Yu,[["render",zu]]),Ju={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function $u(e,t,n,i,l,a){const d=L,r=D,c=ne,y=oe;return o(),u("div",null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),p(y,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Constraints ")]),_:1},8,["item","onCatalogueChanged"])])}const ec=A(Ju,[["render",$u]]),tc={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{getNameExtra:Z,changed(){this.$emit("catalogueChanged")}},computed:{children(){let e=[{name:"None",id:void 0,editorTypeName:"bullet"}];for(let t of this.item.entriesIterator())t.isGroup()||e.push(t);return e}}};const bt=e=>(P("data-v-86874c18"),e=e(),U(),e),nc=bt(()=>s("legend",null,"Selection Entry Group",-1)),ac={class:"editorTable"},sc=bt(()=>s("td",null,"Default Selection:",-1)),ic={style:{"white-space":"nowrap"}},oc=["src"],lc={class:"gray"},rc={key:1,class:"merror"};function dc(e,t,n,i,l,a){const d=se;return o(),u("fieldset",null,[nc,s("table",ac,[s("tr",null,[sc,s("td",null,[a.children.length?(o(),_(d,{key:0,modelValue:n.item.defaultSelectionEntryId,"onUpdate:modelValue":t[0]||(t[0]=r=>n.item.defaultSelectionEntryId=r),placeholder:"Search Children...",options:a.children,valueField:"id",filterField:"name",onChange:a.changed},{option:w(r=>[s("div",ic,[r.option.indent>=2&&!r.selected?(o(!0),u(v,{key:0},T(r.option.indent-1,c=>(o(),u("span",null,"   "))),256)):g("",!0),s("img",{class:"mr-1 align-middle",src:`assets/bsicons/${r.option.editorTypeName}.png`},null,8,oc),h(" "+C(r.option.name)+" ",1),s("span",lc,C(a.getNameExtra(r.option,!1)),1)])]),_:1},8,["modelValue","placeholder","options","onChange"])):(o(),u("span",rc,"This group does not have any child Selection Entries"))])])])])}const uc=A(tc,[["render",dc],["__scopeId","data-v-86874c18"]]),cc={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function gc(e,t,n,i,l,a){const d=L,r=D,c=ne,y=uc,f=Me,k=je,m=Ce,B=Ze;return o(),u(v,null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(y,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(f,{item:n.item,onCatalogueChanged:a.changed,fields:[{field:"hidden",enabled:!0,name:"Hidden"},{field:"collective",enabled:!1,name:"Collective"},{field:"import",enabled:!0,name:"Import"}],class:"section"},{default:w(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),p(k,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),p(m,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"]),p(B,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const mc=A(cc,[["render",gc]]),hc={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},pc=s("legend",null,"Revision",-1),fc={class:"editorTable"},yc=s("td",null,"Revision Number:",-1);function Cc(e,t,n,i,l,a){return o(),u("fieldset",null,[pc,s("table",fc,[s("tr",null,[yc,s("td",null,[b(s("input",{type:"number","onUpdate:modelValue":t[0]||(t[0]=d=>n.item.revision=d),onChange:t[1]||(t[1]=(...d)=>a.changed&&a.changed(...d))},null,544),[[x,n.item.revision]])])])])])}const _c=A(hc,[["render",Cc]]),Ac={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},bc=s("legend",null,"Catalogue",-1),vc=s("label",{class:"hastooltip",for:"library",title:"indicates that this catalogue is used to store data, no forces may be created from it if true."},"Library",-1);function kc(e,t,n,i,l,a){return o(),u("fieldset",null,[bc,b(s("input",{type:"checkbox","onUpdate:modelValue":t[0]||(t[0]=d=>n.item.library=d),onChange:t[1]||(t[1]=(...d)=>a.changed&&a.changed(...d)),id:"library"},null,544),[[O,n.item.library]]),vc])}const wc=A(Ac,[["render",kc]]),Ic={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Ec=s("legend",null,"Information",-1),xc={class:"editorTable"},Tc=s("td",null,"Author Name:",-1),Sc=s("td",null,"Author Contact:",-1),Nc=s("td",null,"Author Website:",-1),Rc=s("td",null,"Readme:",-1);function Fc(e,t,n,i,l,a){const d=me;return o(),u("fieldset",null,[Ec,s("table",xc,[s("tr",null,[Tc,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=r=>n.item.authorName=r),onChange:t[1]||(t[1]=(...r)=>a.changed&&a.changed(...r))},null,544),[[x,n.item.authorName]])])]),s("tr",null,[Sc,s("td",null,[p(d,{modelValue:n.item.authorContact,"onUpdate:modelValue":t[2]||(t[2]=r=>n.item.authorContact=r)},null,8,["modelValue"])])]),s("tr",null,[Nc,s("td",null,[b(s("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=r=>n.item.authorUrl=r),onChange:t[4]||(t[4]=(...r)=>a.changed&&a.changed(...r))},null,544),[[x,n.item.authorUrl]])])]),s("tr",null,[Rc,s("td",null,[p(d,{type:"text",modelValue:n.item.readme,"onUpdate:modelValue":t[5]||(t[5]=r=>n.item.readme=r),onChange:a.changed},null,8,["modelValue","onChange"])])])])])}const Bc=A(Ic,[["render",Fc]]),Vc={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Pc(e,t,n,i,l,a){const d=L,r=D,c=ne,y=oe,f=_c,k=wc,m=Bc;return o(),u("div",null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),p(y,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:w(()=>[h(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),p(f,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(k,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(m,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"])])}const Uc=A(Vc,[["render",Pc]]),Lc={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{NumberInput:le}};const Oe=e=>(P("data-v-c7d18dd2"),e=e(),U(),e),Oc=Oe(()=>s("legend",null,"Repeat",-1)),Qc={class:"condition"},Gc=Oe(()=>s("label",null,"times for every ",-1)),qc={class:"bools"},Dc=Oe(()=>s("label",{for:"percent"},"Percentage?",-1)),Kc=Oe(()=>s("label",{for:"percent"},"Round up?",-1));function Mc(e,t,n,i,l,a){const d=le;return o(),u("fieldset",null,[Oc,s("div",Qc,[p(d,{modelValue:n.item.repeats,"onUpdate:modelValue":t[0]||(t[0]=r=>n.item.repeats=r),onChange:a.changed},null,8,["modelValue","onChange"]),Gc,p(d,{modelValue:n.item.value,"onUpdate:modelValue":t[1]||(t[1]=r=>n.item.value=r),onChange:a.changed},null,8,["modelValue","onChange"])]),s("div",qc,[s("div",null,[b(s("input",{id:"percent",type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=r=>n.item.percentValue=r),onChange:t[3]||(t[3]=(...r)=>a.changed&&a.changed(...r))},null,544),[[O,n.item.percentValue]]),Dc]),s("div",null,[b(s("input",{id:"percent",type:"checkbox","onUpdate:modelValue":t[4]||(t[4]=r=>n.item.roundUp=r),onChange:t[5]||(t[5]=(...r)=>a.changed&&a.changed(...r))},null,544),[[O,n.item.roundUp]]),Kc])])])}const jc=A(Lc,[["render",Mc],["__scopeId","data-v-c7d18dd2"]]),Zc={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Wc(e,t,n,i,l,a){const d=L,r=jc,c=Pe,y=Le;return o(),u("div",null,[p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed},null,8,["catalogue","item","onCatalogueChanged"]),p(c,{class:"section",item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,childForces:"",childSelections:""},null,8,["item","catalogue","onCatalogueChanged"]),p(y,{class:"section",item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])])}const Xc=A(Zc,[["render",Wc]]),Yc={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{ids:{get(){var e;return((e=this.item.ids)==null?void 0:e.join(", "))||""},set(e){this.item.ids=e.split(",").map(t=>t.trim())}}},methods:{changed(){this.$emit("catalogueChanged")}},components:{FilterBy:Le}},zc=s("p",{class:"info"},[h(" Associations are a New Recruit specific feature allowing you to associate an entry to another, such as a unit to a bataillon. "),s("br"),h(" Feel free to offer feedback or ask questions on our "),s("a",{href:"https://discord.gg/cCtqGbugwb"},"Discord server"),h(". ")],-1),Hc={class:"section"},Jc=s("legend",null,"Constraints",-1),$c={class:"editorTable"},eg=s("td",null,"Min",-1),tg=s("td",null,"Max",-1);function ng(e,t,n,i,l,a){const d=L,r=D,c=Pe,y=F("FilterBy");return o(),u("div",null,[zc,p(d,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),p(r,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),p(c,{catalogue:n.catalogue,childSelctions:"",item:n.item,onCatalogueChanged:a.changed,class:"section",childSelections:""},null,8,["catalogue","item","onCatalogueChanged"]),p(y,{class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue,hideshared:""},null,8,["item","onCatalogueChanged","catalogue"]),s("fieldset",Hc,[Jc,s("table",$c,[s("tr",null,[eg,s("td",null,[b(s("input",{onInput:t[0]||(t[0]=(...f)=>a.changed&&a.changed(...f)),"onUpdate:modelValue":t[1]||(t[1]=f=>n.item.min=f),type:"number"},null,544),[[x,n.item.min]])])]),s("tr",null,[tg,s("td",null,[b(s("input",{onInput:t[2]||(t[2]=(...f)=>a.changed&&a.changed(...f)),"onUpdate:modelValue":t[3]||(t[3]=f=>n.item.max=f),type:"number"},null,544),[[x,n.item.max]])])])])])])}const ag=A(Yc,[["render",ng]]),sg={props:{item:{type:Object,required:!0}},setup(){return{store:Q()}},methods:{gotoTarget(e){return e.isCategory()?e.parent:e},parentEntry(e){return Dt(e,t=>t.getName())},path(e){const t=Je(e);return this.item.editorTypeName!=="profileType"&&t.pop(),t},other_path(e){return Je(e)}},computed:{show_link_name(){return this.item instanceof Kt},links(){var e;return H(((e=this.item)==null?void 0:e.refs)||[],t=>{var n;return(n=t.catalogue)==null?void 0:n.name})},other_links(){var e;return H(((e=this.item)==null?void 0:e.other_refs)||[],t=>{var n;return(n=t.catalogue)==null?void 0:n.name})},label(){return $(this.item)}},components:{NodePath:cn}};const ig={class:"mb-50px"},og={class:"text-center"},lg=s("span",{class:"gray"},"References to",-1),rg={class:"gray"},dg={key:0,class:"mr-60px"},ug={key:1,class:"mr-60px"},cg=s("h3",null," From conditions/constraints/modifiers/repeats: ",-1);function gg(e,t,n,i,l,a){const d=F("NodePath");return o(),u("div",ig,[s("h2",og,[lg,h(" "+C(a.label)+" ",1),s("span",rg,"("+C(n.item.editorTypeName)+")",1)]),a.links.length?(o(),u("div",dg,[s("div",null,[(o(!0),u(v,null,T(a.links,r=>(o(),u("div",null,[p(d,{path:a.path(r),onClick:c=>i.store.goto(r),class:"hover-darken cursor-pointer p-1px"},null,8,["path","onClick"])]))),256))])])):g("",!0),a.other_links.length?(o(),u("div",ug,[cg,s("div",null,[(o(!0),u(v,null,T(a.other_links,r=>(o(),u("div",null,[p(d,{path:a.other_path(r),onClick:c=>i.store.goto(r),class:"hover-darken cursor-pointer p-1px mb-3px"},null,8,["path","onClick"])]))),256))])])):g("",!0)])}const mg=A(sg,[["render",gg]]),hg={setup(){return{store:Q()}},emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0}},data(){return{links:["link","selectionEntryLink","selectionEntryGroupLink"],infoLinks:["infoLink","profileLink","ruleLink","infoGroupLink"],key:0}},methods:{changed(){this.store.changed(this.item||this.catalogue)}},computed:{item(){return this.store.get_selected()},typeName(){var e;return(e=this.item)==null?void 0:e.editorTypeName}},watch:{item(){this.key++}}};const pg=s("div",{class:"min-h-100px"},null,-1);function fg(e,t,n,i,l,a){const d=Wn,r=sa,c=Ga,y=js,f=Xs,k=li,m=hi,B=ml,G=Ml,X=pd,Y=wu,ie=Uu,ve=Xu,ke=Hu,I=ec,ze=mc,Et=Uc,xt=Xc,Tt=ag,St=mg;return a.item?(o(),u("div",{class:"rightPanel",key:l.key},[i.store.mode==="edit"?(o(),u(v,{key:0},[a.typeName=="publication"?(o(),_(d,{key:0,item:a.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])):a.typeName=="costType"?(o(),_(r,{key:1,item:a.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])):a.typeName=="profileType"?(o(),_(c,{key:2,item:a.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])):a.typeName=="category"?(o(),_(y,{key:3,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="force"?(o(),_(f,{key:4,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="profile"?(o(),_(k,{key:5,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="rule"?(o(),_(m,{key:6,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="selectionEntry"?(o(),_(B,{key:7,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):l.links.includes(a.typeName)?(o(),_(G,{key:8,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"entry"},null,8,["item","catalogue","onCatalogueChanged"])):l.infoLinks.includes(a.typeName)?(o(),_(G,{key:9,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"info"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="modifier"?(o(),_(X,{key:10,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="constraint"?(o(),_(Y,{key:11,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="conditionGroup"?(o(),_(ie,{key:12,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="condition"?(o(),_(ve,{key:13,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="categoryLink"?(o(),_(G,{key:14,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"category"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="modifierGroup"?(o(),_(ke,{key:15,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="infoGroup"?(o(),_(I,{key:16,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="selectionEntryGroup"?(o(),_(ze,{key:17,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="catalogueLink"?(o(),_(G,{key:18,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="catalogue"||a.typeName=="gameSystem"?(o(),_(Et,{key:19,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="repeat"?(o(),_(xt,{key:20,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="association"?(o(),_(Tt,{key:21,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):g("",!0),pg],64)):i.store.mode==="references"?(o(),_(St,{key:1,item:a.item,catalogue:n.catalogue},null,8,["item","catalogue"])):g("",!0)])):g("",!0)}const yg=A(hg,[["render",fg]]);const Cg={},_g={style:{width:"100%",height:"0px","text-align":"left",margin:"0",padding:"0"}};function Ag(e,t){return o(),u("hr",_g)}const vt=A(Cg,[["render",Ag],["__scopeId","data-v-43dd2251"]]),bg={name:"EditorCollapsibleBox",props:{payload:{},collapsible:{type:Boolean,default:!0},nobox:{type:Boolean,default:!1},defcollapsed:{type:Boolean,default:!0},notitle:{type:Boolean,default:!1},title:{type:String,required:!1,default:"titreCategory"},titleCollapse:{type:Boolean,default:!0},modelValue:{default:!0},altclickable:{default:!1},vshow:{default:!1,type:Boolean},depth:{default:0,type:Number}},data(){return{collapsed:!0,initiated:this.vshow,selected:!1,alt:!1,sticky:!1}},created(){this.defcollapsed==!1&&this.collapseSwitch()},setup(){return{store:Q(),settings:J()}},mounted(){addEventListener("keydown",this.handleKeyDown),addEventListener("keyup",this.handleKeyUp),this.$el.vnode=this,this.init(this.payload)},updated(){this.$el.vnode=this},unmounted(){removeEventListener("keydown",this.handleKeyDown),removeEventListener("keyup",this.handleKeyUp)},watch:{payload(e){this.init(e)},collapsed(e){e!==this.modelValue&&this.$emit("update:modelValue",e)},modelValue(e){e!=this.collapsed&&(this.collapsed=e)}},computed:{dropdownSrc(){let e=2,t=[`assets/icons/right${e}.png`,`assets/icons/down${e}.png`],n=this.collapsed?0:1;return t[n]},hide(){return!this.collapsible},nocollapse(){return!this.collapsible},box(){return!this.nobox},opened(){return this.collapsible&&!this.collapsed},indent(){return`${this.depth*20}px`}},methods:{cut(){console.log("cut")},copy(){console.log("copy")},paste(){console.log("paste")},init(e){var t;if((e==null?void 0:e.select)!==void 0){if(e.select){const n=(t=this.$parent)==null?void 0:t.$parent;n.open&&n.open(),this.store.do_select(null,this),this.store.scrollto(Mt(this))}e==null||delete e.select}},select(){this.selected=!0,this.store.select(this,()=>this.unselect(),this.payload)},unselect(){this.selected=!1},open(){this.initiated=!0,this.collapsed&&(this.collapsed=!1,this.$emit("open"))},async open_recursive(){var t;this.open(),await this.$nextTick();const e=this.$el;if(e)for(const n of e.getElementsByClassName("collapsible-box"))await((t=qe(n))==null?void 0:t.open_recursive())},close(){this.initiated=!0,this.collapsed||(this.collapsed=!0,this.$emit("close"))},async close_recursive(){var t;const e=this.$el;if(e)for(const n of e.getElementsByClassName("collapsible-box"))(t=qe(n))==null||t.close_recursive();await this.$nextTick(),this.close()},do_select(e){this.store.do_select(e,this),this.$el.focus()},do_rightcllick_select(e){this.store.do_rightclick_select(e,this)},async collapseSwitch(e){this.collapsed=!this.collapsed,this.initiated=!0,this.collapsed==!1?e?await this.open_recursive():this.open():e?await this.close_recursive():this.close()},handleKeyDown(e){e.key==="Alt"&&(this.alt=!0,e.preventDefault())},handleKeyUp(e){e.key==="Alt"&&(this.alt=!1,e.preventDefault())}}};const vg=["src"],kg={key:1,class:"content"};function wg(e,t,n,i,l,a){return o(),u("div",{class:V([{box:a.box,nobox:n.nobox,nocollapse:a.nocollapse,collapsed:l.collapsed,opened:a.opened},"collapsible-box"]),onContextmenu:t[8]||(t[8]=(...d)=>a.do_rightcllick_select&&a.do_rightcllick_select(...d))},[n.notitle?g("",!0):(o(),u("h3",{key:0,ref:"title",class:V(["title",{selected:l.selected,arrowTitle:n.collapsible,normalTitle:!n.collapsible,collapsed:n.collapsible&&l.collapsed,alt:l.alt&&n.altclickable}]),onClick:[t[1]||(t[1]=S((...d)=>a.do_select&&a.do_select(...d),["stop"])),t[2]||(t[2]=S(d=>e.$emit("ctrlclick"),["ctrl","stop"])),t[3]||(t[3]=S(d=>e.$emit("altclick"),["alt","stop"]))],onDblclick:t[4]||(t[4]=d=>a.collapseSwitch(d.shiftKey)),onPaste:t[5]||(t[5]=(...d)=>a.paste&&a.paste(...d)),onCopy:t[6]||(t[6]=(...d)=>a.paste&&a.paste(...d)),onCut:t[7]||(t[7]=(...d)=>a.paste&&a.paste(...d)),style:Ie({"padding-left":a.indent,"z-index":`${100-n.depth}`,...i.settings.stickyScroll?{top:`${n.depth*20}px`,left:"0px",position:"sticky"}:{}})},[n.depth>0?(o(),u("span",{key:0,class:"title-before",style:Ie({width:a.indent})},null,4)):g("",!0),s("div",{class:"arrow-wrap",onClick:t[0]||(t[0]=S(d=>a.collapseSwitch(d.shiftKey),["stop"]))},[s("img",{class:V([{hide:a.hide},"arrow icon"]),src:a.dropdownSrc},null,10,vg)]),q(e.$slots,"title",{},void 0,!0)],38)),l.initiated?b((o(),u("div",kg,[q(e.$slots,"content",{},void 0,!0)],512)),[[we,!l.collapsed||!n.collapsible]]):g("",!0)],34)}const kt=A(bg,[["render",wg],["__scopeId","data-v-dca22165"]]),Ig={name:"CatalogueEntry",components:{ContextMenu:Se,EditorCollapsibleBox:kt},setup(){return{store:Q(),state:xe(),settings:J()}},props:{depth:{type:Number,default:0},label:{type:String,required:!0},catalogue:{type:Object,required:!0},path:{type:Array},typeItem:{type:Object}},data(){return{groups:{},contextmenuopen:!1,open:!1,open_categories:void 0,name:""}},mounted(){this.catalogue&&this.catalogue.processForEditor()},methods:{menu(e){return{show:(t,n)=>{this.contextmenuopen=!0,this.$nextTick(()=>{var i;(i=this.$refs[e])==null||i.show(t,n)})},close:(t,n)=>{var i;(i=this.$refs[e])==null||i.close(t,n),this.contextmenuopen=!1}}},should_be_open(){const e=[...this.path||[],{key:`label-${this.label}`,index:0}];this.open=this.state.get(this.catalogue.id,e)},debug(){var e,t;console.log((e=this.typeItem)==null?void 0:e.name,(t=this.typeItem)==null?void 0:t.editorTypeName,it(this.typeItem)),globalThis.$debugOption=this.typeItem,globalThis.$debugElement=this}},computed:{contextmenu(){return this.menu("contextmenu")},nestedcontextmenu(){return this.menu("nestedcontextmenu")}}},Eg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABg2lDQ1BJQ0MgUHJvZmlsZQAAKM+VkTlIA0EYhT8TRRFFJClELLZQGw2IilhqFESIEKKCV+HuxsRAdg27ERtLwVaw8Gi8ChtrbS1sBUHwALG1sVK0kbD+sxEShAgODPPxZt5j5g0EDrOm5Vb3gGXnncRYVJuZndNqX6ihnma6COmmmxuOx2NUHJ93VKn1NqKy+N9oTC65JlRpwkNmzskLLwoPrOVzineFw+aynhQ+E+525ILCD0o3ivyqOO1zQGWGnanEiHBYWEuXsVHG5rJjCfcLtyctW/IDM0VOKl5XbGVXzZ97qhc2LNnTk0qX2cYY40wQR8NglQxZ8kRktUVxSch+tIK/1ffHxWWIK4MpjlFWsNB9P+oPfnfrpvp6i0kNUah59rz3DqjdhsKW530deV7hGIJPcGmX/CuHMPgh+lZJaz+Apg04vyppxg5cbELLY053dF8KygykUvB2Kt80C6EbqJ8v9vazz8k9TElXsWvY24fOtGQvVHh3XXlvf57x+yP6DVyYcp4hKAl2AAAA5FBMVEVVWVszNTY1NzdKSktaWlpJTE5HSEhTU1NVVVVUVFRSUlIpKitRUVFNTU1PT08kJSY9PT1HR0fu7u7ExMRGRkZNUFI8PD1JSUlzc3N0dHSurq7q6uptbW02OTpMTEygoKDS0tJcXFw0NDV5eXnf399wcHAzMzQcHh5WVlbc3Ny3t7caGxxHS0wdHh/n5+fFxcUjJCUsLS1KSkrDw8OxsbE7OztBQUFQUFBDQ0M8PDzH0NMKCgpeXl5dXV1ZWVlCQkKnrrJSVlcBAQEICAkSExMcHR0bHBwREhLL1Nizu7+vt7oAAABxoPDUAAAATHRSTlP///////////////////////////////////////////////////////////////////////////////////////////////////8Ano3kzAAAAAlwSFlzAAAuIgAALiIBquLdkgAAALlJREFUKFNNyGkXgUAAheGhiJqpRLLvlCXGUJItspT+//9xmuS4H+55zwMiOpDJpEU/y7Ask6VJIZfnCkU+n/uBAJEoIiikIMklRVHKFVn6glrVavVGs1VVvxC1OxB2e/123BSiARyOxhOaCejGdFbQaSYwNzrImNOMYWFyaLlCvLlIAK8JQZst0sgax4AtyyY7xxE1e2/hCLgH2yEcezydeeJcDi7wrjf//pAEAT9f/u3qgSB8/y0MPiLnM6aRQB6+AAAAAElFTkSuQmCC",wt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAMAAAAoLQ9TAAABg2lDQ1BJQ0MgUHJvZmlsZQAAKM+VkUsoRFEcxn8ziBhJZiFZ3AVKUUKyZCgpahqjxmPh3jtmqLl3pntHNpbKVll4bLwWNtZsLWyVUh4lWxsrYiNd/3NHzaRGOXU6v75zvq9zvgPBg4xpuZU9YNl5JzYW0RIzs1r1M1XU0Ugtnbrp5oaj0QnKjo9bAmq96VZZ/G/UJxddEwKa8JCZc/LCC8IDq/mc4h3hsLmkJ4VPhbscuaDwvdKNAr8oTvscVJlhJx4bEQ4La+kSNkrYXHIs4X7htqRlS34wUeCk4jXFVmbF/LmnemFo0Z6eUrrMVsYYZ5IoGgYrLJMhT7estiguMdmPlPG3+P6ouAxxLWOKY5QsFrrvR/3B727dVF9vISkUgaonz3trh+ot+Nr0vM9Dz/s6gopHuLCL/uwBDL6LvlnU2vahYR3OLouasQ3nG9D8kNMd3ZcqZAZTKXg9kW+agaZrqJ0r9Pazz/EdxKWriSvY3YOOtGTPl3l3TWlvf57x+yPyDUN6cpTX8RfMAAAAmVBMVEVAQUE9PT1YWFg9Pj5VVVVUVFQrKytZWVkpKSpERERRUVFQUFBDQ0NYWVo+Pz9TU1NSUlI4OTlXV1cgISFdXV04ODk4ODhRUlMhIiInJycuLi5KSkpJSUkoKCk7OztBQUE8PDzj5ugLCwtaWlpeXl5CQkK/wcNdX18BAQEJCQkUFRUfICAuLy8fHx8TFBTn6uzNz9HIyswAAABWGAQaAAAAM3RSTlP//////////////////////////////////////////////////////////////////wBxnr2OAAAACXBIWXMAAC4hAAAuIQEHW/z/AAAAmUlEQVQoU03MyRKCMBBF0RDSBBUICMgQAUFlUBTM/3+clbRF+TZ96yyaKBzZAo9FqYWFYDMGYJtEcDgD6pg04O72DA6eu4GP4G+gAsEgDEwiqOgIEdYP4gRiLITU4nBKTWrIcqGfhnmGUJRSajjLstBQ1XWD0FzqSpG2azwprreEh9K7dy3ph3F6PN15rl7vaRx6sqyfv63LF52MIsEsSTP4AAAAAElFTkSuQmCC";const It=e=>(P("data-v-eaf31bdf"),e=e(),U(),e),xg=It(()=>s("img",{src:Eg},null,-1)),Tg={class:"gray"},Sg=It(()=>s("img",{class:"pr-4px",src:wt},null,-1)),Ng={class:"gray"},Rg={key:1};function Fg(e,t,n,i,l,a){const d=F("EditorCollapsibleBox"),r=vt,c=F("ContextMenu");return o(),u("div",{class:"item unselectable",onMouseup:t[3]||(t[3]=S((...y)=>a.debug&&a.debug(...y),["middle","stop"])),onContextmenu:t[4]||(t[4]=S((...y)=>a.contextmenu.show&&a.contextmenu.show(...y),["stop"]))},[p(d,{nobox:"",group:[],depth:n.depth,collapsible:!0,class:V([`depth-${n.depth}`,`label-${n.label}`]),vshow:""},{title:w(()=>[xg,s("span",Tg,C(n.label),1)]),content:w(()=>[q(e.$slots,"default",{},void 0,!0)]),_:3},8,["depth","class"]),l.contextmenuopen?(o(),_(c,{key:0,modelValue:l.contextmenuopen,"onUpdate:modelValue":t[2]||(t[2]=y=>l.contextmenuopen=y),ref:"contextmenu"},{default:w(({payload:y})=>{var f;return[n.typeItem?(o(),u(v,{key:0},[n.typeItem?(o(),u("div",{key:0,onClick:t[0]||(t[0]=k=>i.store.goto(n.typeItem))}," Goto ("+C(n.typeItem.getName()),1)):g("",!0),p(r),s("div",{onClick:t[1]||(t[1]=k=>{var m,B;return i.store.create_child("sharedProfiles",n.catalogue,{typeName:(m=n.typeItem)==null?void 0:m.getName(),typeId:(B=n.typeItem)==null?void 0:B.getId()})})},[Sg,h(" Profile "),s("span",Ng," ("+C((f=n.typeItem)==null?void 0:f.getName())+")",1)])],64)):(o(),u("div",Rg," Nothing "))]}),_:1},8,["modelValue"])):g("",!0)],32)}const Bg=A(Ig,[["render",Fg],["__scopeId","data-v-eaf31bdf"]]);function Vg(e){return Math.round(e*100)/100}function Pg(e){let t="";e=Ke(e,n=>n.name);for(const n of e)if(n.value!=0){let i="";n.name.length!=0&&(i=" "+n.name),t=`${t}<span class='cost'>${Vg(n.value)}${i}</span>`}return t.length==0?t:`<span class="costList">${t}</span>`}const tt={link:1,selectionEntry:1,entryLink:1,selectionEntryGroup:2,entryGroupLink:2,constraint:3,forceEntry:4,profile:5,rule:6,infoGroup:7,infoLink:8,modifier:9,modifierGroup:10,categoryLink:11,association:12},Ug=new Set(["modifierGroups","conditionGroups"]),Lg=new Set(["characteristicTypes","characteristics","costs"]),Og={name:"CatalogueEntry",components:{ContextMenu:Se,EditorCollapsibleBox:kt,CatalogueLabel:Bg},setup(){return{store:Q(),state:xe(),settings:J()}},props:{item:{type:Object,required:!0},forceShowRecursive:{type:Boolean,default:!1},showImported:{type:Boolean},imported:{type:Boolean},depth:{type:Number,default:0},noType:{type:Boolean,default:!1},grouped:{type:Boolean,default:!1}},data(){return{contextmenuopen:!1,open:!1,open_categories:void 0,name:""}},created(){if(this.catalogue&&(this.catalogue.processForEditor(),!this.imported&&(this.open=this.should_be_open(),this.item.isCatalogue()))){const e=new Set;for(const t of this.categories)this.state.get_root(this.catalogue.id,t.type)&&e.add(t.type);this.open_categories=e}},watch:{"scope.name"(e){this.name=$(this.item)},_name:{immediate:!0,handler(e){this.name=e}}},methods:{escapeXml:jt,getTypeName:Zt,getTypeLabel:Wt,getName:$,getNameExtra:Z,key(e){return e.id?e.id:(e.$id||(e.$id=`temp-${De()}`),e.$id)},should_be_grouped(e){return e==="sharedProfiles"},display_groups(e,t){const n=[];for(const[i,l]of Object.entries($e(t,a=>a.item.typeId??"Untyped"))){const a=l[0].item.catalogue.findOptionById(i),d=(a==null?void 0:a.name)??i;n.push({type:a,label:d,items:l})}return n},should_be_open(e){return e?this.open_categories!==void 0&&this.open_categories.has(e):Ug.has(this.item.parentKey)||this.state.get(this.catalogue.id,Xt(this.item))},sortable(e){return this.settings.sort==="none"?!1:e?e.editorTypeName!=="force":!0},ref_count(e){var t;switch(e.editorTypeName){case"category":default:return(t=e.refs)==null?void 0:t.length}},async onctrlclick(){this.store.can_follow(this.item)?await this.store.follow(this.item):this.imported?await this.store.goto(this.item):(this.item.refs||this.item.other_refs)&&(this.store.mode="references")},debug(){console.log(this.item.name,this.item.editorTypeName,it(this.item)),globalThis.$debugOption=this.item,globalThis.$debugElement=this,globalThis.$debugGroup=this.$parent},hasRootLink(e,t){var n;return(n=e.entryLinks)==null?void 0:n.find(i=>i.targetId===t.id)},getTypedArray(e,t,n){if(!t)return;const i=t,l=e[i];if(l&&Array.isArray(l))for(const a of l)this.filter_child(a)&&n.push({item:a,type:t});if(this.showImported){const d=["selectionEntries","selectionEntryLinks","rules"].includes(t)?e.importsWithEntries:e.imports;for(const r of d){const c=r[i],y=r.isGameSystem();if(c&&Array.isArray(c))for(const f of c)this.filter_child(f)&&(!y&&f.import===!1||n.push({item:f,type:t,imported:!0}))}}},allowed(e){if(Array.isArray(e)){for(const t of e)if(this.allowedChildren.has(t))return!0;return!1}return this.allowedChildren.has(e)},filter_child(e){return!(!this.forceShow&&this.store.filter&&e.showInEditor!==!0)},sorted(e){if(!this.sortable(this.item))return e;switch(this.settings.sort){default:case"asc":return H(e,l=>l.item.getName()||"");case"desc":return Ke(e,l=>l.item.getName()||"");case"type":const i=H(e,l=>l.item.getName()||"");return ue(i,l=>(l.item.isProfile()?l.item.getTypeName():l.item.getType())||""),this.settings.display.primaryCategory&&ue(i,l=>{var d,r,c;const a=l.item;return(d=a.parent)!=null&&d.isCatalogue()&&["selectionEntries","entryLinks"].includes(a.parentKey)&&((c=(r=l.item.getPrimaryCategoryLink())==null?void 0:r.target)==null?void 0:c.name)||""}),i}},grouped_items(e){const t=H(this.sorted(e),n=>{var i,l;return tt[((l=(i=n.item)==null?void 0:i.target)==null?void 0:l.editorTypeName)??n.item.editorTypeName]??1e3});return this.settings.display.sortIndex&&ue(t,n=>n.item.sortIndex??1e4),t},groupBy:$e,menu(e){return{show:(t,n)=>{this.contextmenuopen=!0,this.$nextTick(()=>{var i;(i=this.$refs[e])==null||i.show(t,n)})},close:(t,n)=>{var i;(i=this.$refs[e])==null||i.close(t,n),this.contextmenuopen=!1}}},get_field(e){return this.item[e]},get_target_field(e){if(this.item.target)return this.item.target[e]},hideType(e){if(e==="categoryLinks"&&!this.item.isForce()||Lg.has(e))return!0}},computed:{order(){return tt},_name(){return $(this.item)},scope(){const e=this.item;if(e.scope){const t=Yt(e,e.scope);if(t)return zt(t)}},costs(){var i;const e=[],t=this.item.getCatalogue(),n=this.item.getCosts();for(const l of n){const a=((i=t.findOptionById(l.typeId))==null?void 0:i.name)||l.name||l.typeId;a&&e.push({name:a,value:l.value,typeId:l.typeId})}return Pg(e)},childId(){return this.item.childId},child(){if(this.childId)return this.item.getCatalogue().findOptionById(this.childId)},link(){return this.item},iscollapsible(){return this.mixedChildren.length>0},contextmenu(){return this.menu("contextmenu")},nestedcontextmenu(){return this.menu("nestedcontextmenu")},catalogue(){return this.item.getCatalogue()},catalogues(){return this.catalogue.imports},allowedChildren(){return Ht(this.item,this.item.parentKey)},forceShow(){return this.item.showChildsInEditor||this.forceShowRecursive},mixedChildren(){const e=[];for(const t of this.allowedChildren){if(this.hideType(t))continue;const n=this.get_field(t);if(n!=null&&n.length)for(const i of n)this.filter_child(i)&&e.push({type:t,item:i})}if(this.item.isLink()&&this.item.target){const t=[];for(const n of this.allowedChildren){if(this.hideType(n))continue;const i=this.get_target_field(n);if(i!=null&&i.length)for(const l of i)this.filter_child(l)&&t.push({type:n,item:l,imported:!0})}return[...this.grouped_items(t),...this.grouped_items(e)]}return this.grouped_items(e)},categories(){return this.item.isCatalogue()?this.item.isGameSystem()?Jt:$t:[]},groupedCategories(){return this.categories.map(e=>{const t=[];return e.type&&this.getTypedArray(this.item,e.type,t),e.links&&this.getTypedArray(this.item,e.links,t),{...e,items:this.grouped_items(t)}})}}},Qg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAQCAYAAAAiYZ4HAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9bi1IqIu0g4pChumhBVMRRq1CECqFWaNXB5NIvaNKQpLg4Cq4FBz8Wqw4uzro6uAqC4AeIq4uToouU+L+k0CLGg+N+vLv3uHsH+BsVpppd44CqWUY6mRCyuVWh+xVBhNCPUUQkZupzopiC5/i6h4+vd3Ge5X3uz9Gr5E0G+ATiWaYbFvEG8fSmpXPeJ46ykqQQnxOPGXRB4keuyy6/cS467OeZUSOTnieOEgvFDpY7mJUMlXiKOKaoGuX7sy4rnLc4q5Uaa92TvzCc11aWuU5zCEksYgkiBMiooYwKLMRp1Ugxkab9hId/0PGL5JLJVQYjxwKqUCE5fvA/+N2tWZiccJPCCSD4Ytsfw0D3LtCs2/b3sW03T4DAM3Cltf3VBjDzSXq9rcWOgL5t4OK6rcl7wOUOMPCkS4bkSAGa/kIBeD+jb8oBkVsgtOb21trH6QOQoa5SN8DBITBSpOx1j3f3dPb275lWfz9cmHKeGGO3IgAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFChE0NOeyIIsAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAB2klEQVQoz43SP2gUURDH8e+83WVFOa5USKF1QMiZaGfAExH/9dYKIlZ2gkGtDATstBEEqzT2kkJDRNBCJVxOzUEakzvRkCLNbS532Z0Zi1tP04gDw6vefH4MIy8W33jW3+VfdezwEepTNQGIu70drl44z54quSq5GeqOuwPQaDT49vMHix+X/ezJExLcHTND8xzNc/b6fXZ3dsiyjG63S5ZlXLt8cfQpNjMECCIkUfQnR1FQmLG9vc2T+XkAltbXic2cIMK5l8d5dekzH1ZWqFarHB0bg6KgXq/j7lQqFRZeLxGrGyLC0pWvmDunJycxd3LVfRKAuhF7Galx9w4Ts3N8arVI05Rer0eappgZaZpSqVRwM2JTJYgwNfcIM+PU+DjmPupclX6eE4lgqoRCh8Lt5wkhBN43m7TabVobG3zf3CSJIg4kCUkUUWgpiAiPryvuwnSthpntU5IoIgphKJgpAtyfmUFEeNdsstrpsLy2NpKCyDCSKbGWwsPZWRyYnpjAf0//SxJAVQmqQ+HWs4AAbxsNvrTbrHY6dLa2CCKjVlXiwWAAwNMb4C6cqdVwwMp7MncoVz8YDIizLBtdg5ST3B0p3wBYCEgIZFlGnDjcvPeA/6nqwUP8AtTWMEb6wHGvAAAAAElFTkSuQmCC",Gg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9bS0UqIlYQ6ZChOlkQFXHUKhShQqgVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6uKk6CIl/i8ptIjx4Lgf7+497t4B/kaFqWbXOKBqlpFOJoRsblUIvSKIMPoRxaDETH1OFFPwHF/38PH1Ls6zvM/9OXqVvMkAn0A8y3TDIt4gnt60dM77xBFWkhTic+Ixgy5I/Mh12eU3zkWH/TwzYmTS88QRYqHYwXIHs5KhEk8RxxRVo3x/1mWF8xZntVJjrXvyF4bz2soy12lGkcQiliBCgIwayqjAQpxWjRQTadpPePiHHb9ILplcZTByLKAKFZLjB/+D392ahckJNymcAIIvtv0xAoR2gWbdtr+Pbbt5AgSegSut7a82gJlP0uttLXYE9G0DF9dtTd4DLneAoSddMiRHCtD0FwrA+xl9Uw4YuAV61tzeWvs4fQAy1FXqBjg4BEaLlL3u8e7uzt7+PdPq7wdBJ3KT7BaVSwAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFDBEdBk5IsTwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAACx0lEQVQ4y42O309TBxiGn3N6qKZGNLqwhUSIFhDMUFwXb2pxJoyIAv7elmXJdsHlZvA/8G7ZrpbMu91oYtAbo0QzhSYGGtivokB7Ss85LS1VxFFKtRBSjrbn88rGxbjwJe/N9+R58yps8OLpjJhPnvznt22LZ2PyTGpObo2ExBGpRETk1khIXBuR448z9B5pZ2xigsFgkJelEnW1tcQzGdT/k2OzaYnNpek90k65XGapUOCbk6dZKhQAcBzn/QV6MiV6OsXJo59h2zaOCC1eLw8tg30NDZWC98oDw0FZF5H5+XkJDQ7Ks4UFKb56JXapJCURGRgOip5MyTsLoolZmUomOP15BwuZDLGxMYrFIpFQiHK5jOpycWNomNbde/i4YY+ivS1HrKRMWiZnj3fxOJlEHx2tMF9HB+5Nm7j++z3aGptobfQqAJWCaSshE0acL3q6SZsmU8FgRT7U1cVH9fVcu3MXX3Mz+5salDdMBZg0LQnHYpzr6WY2HufR0BCO4+A4Dr7OTnZ5vVy7Pcgne/dyoKlReXu1MmmYEtZ1vjx7hjnDID4yUoH1Ph+pTIbR8T/w1tUR8PuJRiLYtk11dTWHAwFcbYH2S1+dP0c2myUVCuF2u3G73TQHAkzrOtUeD2e6T2AZJuPj43g2b6a35wTlUonpqWl4OBOXywM35IWIRE1THty8KbFEQlZE5Ou+PjGMhFzovyiRqCX5fFEiUUsu9F8Uw0jIjz/9LErueUHST+cZDYfp++5bstksH9bU8NuVqzydmeF45ym2bt3C/ft3yb/IsWP7Bxw71s3q6hp//vUAZTGXl7W1NXTD4JFp0P/D9/zy62Uaa2sprqwS/udvFEXB4/HQdvAg0UiE4vo6iqLg9/tRnmVzsri4SH55mX9zS0xaFp+2tLBz23bslzaqqlKlVaFpGlXuKjSXhqZpuDQNVVV5DQyKeoiSxZAyAAAAAElFTkSuQmCC",qg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TS0UrDhaU4pChOlkQFXHUKhShQqkVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6uKk6CIl/i8ptIjx4Lgf7+497t4BQqPCVLNrHFA1y0gn4mI2tyoGXxFAL4KIYFBipj6XSiXhOb7u4ePrXYxneZ/7c/QpeZMBPpF4lumGRbxBPL1p6Zz3icOsJCnE58RjBl2Q+JHrsstvnIsOCzwzbGTS88RhYrHYwXIHs5KhEk8RRxVVo3wh67LCeYuzWqmx1j35C0N5bWWZ6zSHkcAilpCCCBk1lFGBhRitGikm0rQf9/BHHH+KXDK5ymDkWEAVKiTHD/4Hv7s1C5MTblIoDgRebPtjBAjuAs26bX8f23bzBPA/A1da219tADOfpNfbWvQI6N8GLq7bmrwHXO4AQ0+6ZEiO5KcpFArA+xl9Uw4YuAV61tzeWvs4fQAy1FXyBjg4BEaLlL3u8e7uzt7+PdPq7wcllnKI7QJDVQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFCwgjN9BzCj0AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAABnElEQVQoz42SsWoiURSGv5m5OIVplsQBky67ICisi6QQ3GreQRBsrHwEn8GHEMTCQiufIFVIsQRcd8Bml7XJFuvsIJoE1Lkzs8XEYSaaxB9ucbn3+8899/wKwM3d92Dh2Pi+j+/7vCVVVVFVlQ+nGb5efVEEgGP/5ar4GSNzxjGa2/+4m/wIDQGklEfDAEbmDCllzMB1o0NN0xBC7C3P8wDodDrEGQFEfSuKEl2Ma7vdkkql6Pf7zOdz4kzCIAgCgISJlBJd1xkMBiwWC8rlcsJADYFw0263GY1GaJrGZrNhvV6j6zrD4ZDlckk+n8c0TeKMiFcsFAqMx2Nc16VarQLQ7XZxHIdSqUSlUoletmNCAz/cmKaJ4zhMp1N6vR6r1QrbthOVI4NnJmzheSTpdJpGo0E2m8WyLGazGblcjlqttvexXnyML9PXbDYxDINisUi9Xj+YhcQUdr8fV6vVejNMO0YFCICJZR2dxIllsSupXN9+C37/+smf+3s8T0YRfU1CCDRNkL045/LjJ5TbsRU8PT5woIt3lT454T+zOsZSlUjWPwAAAABJRU5ErkJggg==",Dg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TS0UrDhaU4pChOlkQFXHUKhShQqkVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6uKk6CIl/i8ptIjx4Lgf7+497t4BQqPCVLNrHFA1y0gn4mI2tyoGXxFAL4KIYFBipj6XSiXhOb7u4ePrXYxneZ/7c/QpeZMBPpF4lumGRbxBPL1p6Zz3icOsJCnE58RjBl2Q+JHrsstvnIsOCzwzbGTS88RhYrHYwXIHs5KhEk8RRxVVo3wh67LCeYuzWqmx1j35C0N5bWWZ6zSHkcAilpCCCBk1lFGBhRitGikm0rQf9/BHHH+KXDK5ymDkWEAVKiTHD/4Hv7s1C5MTblIoDgRebPtjBAjuAs26bX8f23bzBPA/A1da219tADOfpNfbWvQI6N8GLq7bmrwHXO4AQ0+6ZEiO5KcpFArA+xl9Uw4YuAV61tzeWvs4fQAy1FXyBjg4BEaLlL3u8e7uzt7+PdPq7wcllnKI7QJDVQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFCwgiC+YHR/sAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAABwUlEQVQoz42TT4vaQBjGfzHBSw6rt+2lhLL04lFY+h1aevPup/CqIH4D2YJ4Fbsbqv1Da6nXYi+ibL3YdruoZHXXSzaVVMgkmR7SFcU27A/eyzDPM8+8844CcDmZyevrBUEQEAYhcSTUBKqqcnj4gEfGQ0UDmM+veHx0RDqd4j7Y9i3fLy4iQwAhxL3FAOl0CiHErsEdqqqiadpeBUEAQL1eZ1ujAYRhdG9FUTYbt/E8j2QySaPRYLlcsq3ZMZBSAmxMbNvGsizCMKTf77NarTAMg8FgwGI+53IyiwTv3n+QQghZLpelaZpSCCEdx5G9Xk/G8bn3RWrbJ2YyGYbDIUIIcrkcQRDQ7XY5OXlBu92iWq2iaRphGJLNZlmv1ygAr9qv5fNnT3FdF9M0mU6nGIaBZVkUi8X/vsbHT92oB77vA6DrOvl8nlqtxmg0wvO82ASbhjdPz6QQYqcqlYoslUqxPWi/eRv14F8UCgU6nU5sgs38NE/P5Pn5170UrVYrNkGj+VIq3378lOPxmOl0gu/7+H9dXdflZnmDc+vsTGoiEX2mg9QBx8dPUGZXC7la/doM0R3r32tc191b30bXdf4AswSDFyrGAhMAAAAASUVORK5CYII=",Kg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAMCAYAAABSgIzaAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TS0UrDhaU4pChOlkQFXHUKhShQqkVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6uKk6CIl/i8ptIjx4Lgf7+497t4BQqPCVLNrHFA1y0gn4mI2tyoGXxFAL4KIYFBipj6XSiXhOb7u4ePrXYxneZ/7c/QpeZMBPpF4lumGRbxBPL1p6Zz3icOsJCnE58RjBl2Q+JHrsstvnIsOCzwzbGTS88RhYrHYwXIHs5KhEk8RRxVVo3wh67LCeYuzWqmx1j35C0N5bWWZ6zSHkcAilpCCCBk1lFGBhRitGikm0rQf9/BHHH+KXDK5ymDkWEAVKiTHD/4Hv7s1C5MTblIoDgRebPtjBAjuAs26bX8f23bzBPA/A1da219tADOfpNfbWvQI6N8GLq7bmrwHXO4AQ0+6ZEiO5KcpFArA+xl9Uw4YuAV61tzeWvs4fQAy1FXyBjg4BEaLlL3u8e7uzt7+PdPq7wcllnKI7QJDVQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFCwgeFvbyUt0AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAABKElEQVQoz6XPMUtCcRSG8eeCqR8ktKEaJYMw/QYtFUQQFFREUIM4GEEYRAkN0dQSQQWFIBQ4lSlKBA1SLQ2B9BlsuH/v9ZwGtYQIC9/5HH48VuX1TQGMbbORiLO9m8bn9wOwvrKEiqIoIoKK0B8IshZPYLUfy8UCL89PDA4NMzYepds8ba2YvyW5lSK1mSQ0Esbn97O6uICKoKqIKiqCiHB0ctoUS4U7spnL1hFMTE4Rica6i4X8DdMzs4TCozzcl8ldXxGJxlien/tSRAWVZuvx+cV343/nAZot7YaOlk5FWq2NRoOzTLZH8beWtiIiOI5D3RiMMeTyxR7Ej1qN/b0d3qvVH4rruhjbxhhDvV7HdR0CwQHSB4dYpceKGmMj8jfYsqDP6+UTS3LlTs6Kx84AAAAASUVORK5CYII=",Mg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABg2lDQ1BJQ0MgUHJvZmlsZQAAKM+VkTlIA0EYhb9EJeKBhQFFLLZQKwOiIpYaBREUQlTwKtzdmChkN2E3wcZSsA1YeDRehY21tha2giB4gNjaWCnaiKz/bIQEIYIDw3y8mfeYeQPBg7RpudU9YNk5Jz4W1Wbn5rXQMzXUE6KNFt10s8Ox2AQVx8ctAbXeRFQW/xuNiWXXhIAmPGRmnZzwkvDAWi6reEc4bK7oCeFT4W5HLih8r3SjyC+KUz4HVWbYmY6PCIeFtVQZG2VsrjiWcL9wR8KyJT84W+SE4nXFVjpv/txTvbBh2Z6ZUrrMdsYYZ5IYGgZ5VkmTIyKrLYpLXPajFfxtvj8mLkNcq5jiGCWDhe77UX/wu1s32ddbTGqIQs2T5711QmgLvgqe93noeV9HUPUIF3bJnzmAwXfRCyWtYx+aNuDssqQZ23C+Ca0PWd3RfalKZjCZhNcT+aY5aL6GuoVibz/7HN/BtHQ1cQW7e9CVkuzFCu+uLe/tzzN+f0S/ASWWcoi7xtRwAAAACXBIWXMAAC4iAAAuIgGq4t2SAAABuElEQVQ4T32Tu04CQRSGf9gLEKQgYmQN2qACNhpNCBSAPoKXRHoqtcWeh6A0EtGChMZoY7QwitGEgpcwoBJvhSD3cWcYUbKjXzKZ//xz2TNnZ/AfyysrhDYeCjHz3kAkEiHu8XHQRjW3DZh4P0QkGmWLKYT01z5VqyhcXxvmCzN4fXmBLMs8AtPUE2HYIBCYI5qmodFocAdMu91uNsatAYYN5hcWuDIiGhPWIBqLkTGXCxaLBTabjXm1Wh1b2ztMfzM5NcWVgFA4TBKJhF7Dv7m5vSMSn29AVpTUzPQ0rFYrksldxOObSKfTKJVKKBaL6PV6qNU/xUcIhcJEUWR4vV5kMhnuGjk7v8BQBqtr66TZbKZ8s7Ps7JIkweFw/JNB/ScDn89HaNE8Hg+LqVZVFblcjsUijk9O+xn4/QHico2yRXptoCgKuzxUO53OPzN4e3+H6b7ySPwzXgSDQZjN5sGvo32r1UI+n2dfE3GQPYTp8qpA9vf3cJTNsorbR0Zgt9uhKiq7Jb1uF+1OB512m21IW0ePF5eWsLa+AdND9ZlUymW09Qm/odf3o/ZBXxN3hpH0I2raBL4ARzrLEHEzjREAAAAASUVORK5CYII=",jg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TtSIVQTuIOESoThZERRy1CkWoEGqFVh1MLv0QmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6uKk6CIl/i8ptIjx4Lgf7+497t4BQq3ENKttDNB020wl4mImuyKGXtGBEHoxhJjMLGNWkpLwHV/3CPD1Lsaz/M/9ObrVnMWAgEg8wwzTJl4nntq0Dc77xBFWlFXic+JRky5I/Mh1xeM3zgWXBZ4ZMdOpOeIIsVhoYaWFWdHUiCeJo6qmU76Q8VjlvMVZK1VY4578heGcvrzEdZqDSGABi5AgQkEFGyjBRoxWnRQLKdqP+/gHXL9ELoVcG2DkmEcZGmTXD/4Hv7u18hPjXlI4DrS/OM7HMBDaBepVx/k+dpz6CRB8Bq70pr9cA6Y/Sa82tegR0LMNXFw3NWUPuNwB+p8M2ZRdKUhTyOeB9zP6pizQdwt0rXq9NfZx+gCkqavkDXBwCIwUKHvN592drb39e6bR3w+B0XKtPX19MwAAAAZiS0dEAOgAAAAA4ec3YQAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+cGBxInIsUFyBwAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAACEElEQVQoz42STWhTURCFz9ybvOaH1NtYF2JVpPBqUAwiGNSt4sZSdFkUBX/AVa0pdm1RKVGLjydoFVHciW6kS10UBLEbUREKFsSVAdukLWnz8967d1xIYiwh5uxm5mPOYRja7OwVGvomgIv4o5cArq6MzFfQJOWm40zVSdJiGAATy6dCeuMhDb4D4Z1HkJgEhEZodRSQAHC5eQFpnYMMThFHJ5hYsqxc10ZWoVw7r5zUSB3cdH/grHLtWt/Wk+KfBI69qpw9Z+p1z719WeWkfgkYCA77lb9OXAS0oF7TWLDtBQQEYuQn/AZnIovEiJNy7OcQyJC2LrGvqhQuPGOpd5O2npCXGDddtQhx5QZL7xyMXKAgeRrwo2yVHrAJfRUmWc7C4AfLyiwi+Q9MukjausDkHTddhQWItW8svSMwkWFALrG1OMfWyiyMXOIYjVE9UnLq4C4OuruXr739DADJu5m4Ca29h/B/yiA2WBj9FABAT+5ommSpVMzOfcf/lJzaP6Pc/ul2jGg3ZKEtGBlvx1BL59yhPhMtvAJ0BgBgrI/E4RPLV77kO0pgooXbgI5SbcsB4fWmIbRk8qfRqZTbX1KuPdT0NIPKsYPUsSHq8AayDIidjURWeTuA9fk3r3kjGWp5GG09ZvJuKceOADIM7Y0B8lFLq1bNHZx5tz5QEGCMQPBh0uGHJuZP1GaK/kb2N5UT1K1lBpuKAAAAAElFTkSuQmCC",Zg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAYAAAA71pVKAAABgmlDQ1BJQ0MgUHJvZmlsZQAAKM+VkU0oRFEcxX9miDSizEKyeAusTIRkyVCToqZBGSy898YMNe+Z3hvZWCrbKQsfG18LG2u2FrZKKR8lWxsrYiM9//tGzaRGuXW7v86953TvuRA4yJqWW90Dlp13ErGoNpOc1WqfqSFEE90EddPNDcfj41QcH7dUqfUmorL432hILbomVGnCQ2bOyQsvCA+s5XOKd4TD5pKeEj4V7nLkgsL3SjeK/KI443NAZYadqcSIcFhYy5SxUcbmkmMJ9wu3pyxb8gMzRU4pXldsZVfNn3uqF4YW7elJpctsI8YYE8TRMFhlmSx5IrLaorgkZD9awd/q++PiMsS1jCmOUVaw0H0/6g9+d+um+3qLSaEo1Dx53lsH1G7BV8HzPg897+sIgo9wYZf8Kwcw+C56oaS170PjBpxdljRjG843oeUhpzu6LwVlBtJpeD2Rb0pC8zXUzxV7+9nn+A6mpKvxK9jdg86MZM9XeHddeW9/nvH7I/oNQUlyk6fcG6sAAAAJcEhZcwAALiIAAC4iAari3ZIAAAIwSURBVDhPdVNLaBNRFD3jTJs0iQnWtqC2uLEWUlxIUBBxWQjqRigoaNxoEQSRKiIuKqILQRA/hIiCCwviDxoURLGCiJLGT6AhUGvTJjYfpTGdNGknE83n+uZlNASTA3eYuee8e+57746ABhi5vUjpLPH3DpuAS8fWNtTVJU9eTdA2uxk7tpixvlPiue8/S5gIKfg0peDG6e6GRTB0cZpm43kqlUpULBbrQstpnKbR5TUMnvpAX6M5KhQKpKoq7XS9rQv/5ALnNI2m1ZdhlfbY3m9Gd5cI5gLmAtfedTx2bbUil8vBH0xxTtNo27p8Z5IXEJ1DL+joYC9sZgFExKNvYyva27KIz89BTi/AZpCh5uKIRqMwSSvwB+bgfXTzAuy7vbSYWSFZlimVSlE4PEvBYIiue56wOs3x3jdBkiSZANaEqv5CNruMSqUCUWzB83dLsG8ah8dzC17vGNxuN5iY8w6Hg+lVCPtOBOjskR60m1Te8l9EIjNwOgf0r//x8tV49Z6v3E3SgYEWlMtlTmg4fv4Nhl0dTZ3TcqYq3H/mBwVCy5RMLlEikeGx5/Dj6uaawPv0Gf2bGNe5DA0fNGJDJzsC1r3P9xoWi6GpcyyR1FfqOMQKXBtV6GPwN90bHdM9GuP+g4c159DUF4p8S+PztBEzcQti82EUlRiMrQrWtMno6SrBZjVitdUKSRTRu7mv9mNEYwk2mnnelppXoShK3ekLggCD0QCTycyuUhtM4A+OzZgJPZUHrgAAAABJRU5ErkJggg==",Wg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAoAAAALCAYAAABGbhwYAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TS1WqInYQcchQnSyIijhqFYpQIdQKrTqYXPoFTRqSFBdHwbXg4Mdi1cHFWVcHV0EQ/ABxdXFSdJES/9cUWsR4cNyPd/ced+8AoVZimtUxDmi6bSbjMTGdWRWDrwigF13oR0hmljEnSQl4jq97+Ph6F+VZ3uf+HD1q1mKATySeZYZpE28QT2/aBud94jAryCrxOfGYSRckfuS64vIb53yDBZ4ZNlPJeeIwsZhvY6WNWcHUiKeII6qmU76QdlnlvMVZK1VY8578haGsvrLMdZrDiGMRS5AgQkEFRZRgI0qrToqFJO3HPPxDDb9ELoVcRTByLKAMDXLDD/4Hv7u1cpMTblIoBgReHOdjBAjuAvWq43wfO079BPA/A1d6y1+uATOfpFdbWuQI6NsGLq5bmrIHXO4Ag0+GbMoNyU9TyOWA9zP6pgwwcAt0r7m9Nfdx+gCkqKvEDXBwCIzmKXvd492d7b39e6bZ3w8AS3J5R6xfBwAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFDgkROnWuuPQAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAABPUlEQVQY023OzUsCQQBA8TcqfpSwa7uQYKXmpbAuJVT7j0fBnvtgK0LFArVod2mDNF0EYWZgupR06Hd6xyf4MXp9M9PJJ8vlEoBSqcSG49Jq7AgAAdDtD8x89kVrt4njOABMJhNG4xcsu8Jhe1+I4fjVxFFI5/iIfD7PX1JKgrt7alvb5JLknUa9TjabZTgcEgQBAJ1Oh2azSaNeJ4xjMuk8xbYtpJT4vk8YhoRhiO/7SCmxbYt0npLTWqO1BmA6nTKbzQDQWqOUWnWmUCySJB8opfA8b/XneR5KKZLkg0KxiOgPnk2/1+Xs9AQhBMYYgFVfXd/QPjgks1mt4rgu5xeXRFGMMWAMRFHM+cUljuuyWa2ScyuWuHt4NI7jchsELBYLAMrlMrXaFmvr67gVS4jfp97gyfCPg/09AfANwseSxMxvrXsAAAAASUVORK5CYII=",Xg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABg2lDQ1BJQ0MgUHJvZmlsZQAAKM+VkUsoRFEcxn8zyKORhVGSxV0MK0pIlgwlRU1j1AwW7r1jhpp7TfeObCyVrbLw2HgtbKzZWtgqpTxKtjZWxEa6/ueOmkmNcup0fn3nfF/nfAeCBznTcqt7wLILTnwsqiVTM1rtMzW0UE8Tbbrp5odjsQkqjo9bAmq96VZZ/G80phdcEwKa8JCZdwrC88IDq4W84h3hsLmop4VPhbscuaDwvdKNIr8ozvocVJlhJxEfEQ4La9kyNsrYXHQs4X7hSNqyJT+YLHJa8ZpiK7di/txTvTC0YE9PKV1mO2OMM0kMDYMVlshRoFtWWxSXuOxHK/jbfH9MXIa4ljDFMcoyFrrvR/3B727dTF9vMSkUhZonz3vrgNot+Nr0vM9Dz/s6gqpHuLBL/uUDGHwXfbOkRfahaR3OLkuasQ3nG9D6kNcd3ZeqZAYzGXg9kW9KQfM1NMwWe/vZ5/gOEtLVxBXs7kFnVrLnKry7rry3P8/4/RH9Bi+4coweluJpAAAACXBIWXMAAC4iAAAuIgGq4t2SAAAB7klEQVQ4T5WSS0xTQRSG/zu33fFYGdJF17BS08tGE3YGFuICmgrojkCIC8FECjtIWAnIrilNMGgAeRRtCyVo7A6Npg12oeHVEjHlsS4p5XVJjzPDhZRAbuo3i3PmzPyTf+aMggJxd3WTkWJwoP9Sx4xoihA7nfV40dFuVP4DIV76ukSJxAblu7jAYkRTSkuKMfJm9Ir1i8MKusLpqY7HLuelSMSO9udyrSAHuq7j4CAjD+FQa0szVlfX5JppFwKhOcpm9mX+6/eKjPk0PXlqZDewsPiJXg8NkRnfvv+gGx2E5sO0nUqhpLgINpsNXu8wgsEAPB4PLBYLcrkcNE1DJnt4/QofAkFKcXGlQ0N4IYyB/lfGynU+f4lANXLJzOxH+rv1B/fvVWFuPmRUCZ2dbjQ2NkgH8XgcsVhMusge5jmYnPbTFhdXP6iFf3YcDq0S8Z/Lpg74Vc//wdjEJCUTSTx66JLi23fuoqnBJQ+PRCKoq6sXqXTg8/n4m3gRjUZle/FubIJ6evtofX1PflUxl7s5Ym7G+6lpUl663fSsrQujbz0oK7uF6poaMMaQTqexuZnE7s4Ojk9OoCiKrIsohqC8ogLK1IyfhB273Q4Hf3mmqrxVKs70MxwdH0FlKqxWK68zGcVc5a1U+T7GGP4BgBQJdqV6GiMAAAAASUVORK5CYII=",Yg="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAABhWlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV/TSkWqDhYp4hCwOlkQFXHUKhShQqgVWnUwufRDaNKQtLg4Cq4FBz8Wqw4uzro6uAqC4AeIo5OToouU+L+k0CLGg+N+vLv3uHsHCPUS06zAGKDpFTOViIuZ7IoYfEUAEfSgH0Mys4xZSUrCc3zdw8fXuxjP8j735+hWcxYDfCLxDDPMCvE68dRmxeC8TxxmRVklPiceNemCxI9cV1x+41xwWOCZYTOdmiMOE4uFNlbamBVNjXiSOKpqOuULGZdVzluctVKVNe/JXxjK6ctLXKc5iAQWsAgJIhRUsYESKojRqpNiIUX7cQ//gOOXyKWQawOMHPMoQ4Ps+MH/4He3Vn5i3E0KxYGOF9v+GAaCu0CjZtvfx7bdOAH8z8CV3vKX68D0J+m1lhY9Anq3gYvrlqbsAZc7QOTJkE3Zkfw0hXweeD+jb8oCfbdA16rbW3Mfpw9AmrpK3gAHh8BIgbLXPN7d2d7bv2ea/f0AZphyovX12KAAAAAGYktHRAD/AP8A/6C9p5MAAAAJcEhZcwAALiMAAC4jAXilP3YAAAAHdElNRQfmBBgOKgbgcs+YAAAAGXRFWHRDb21tZW50AENyZWF0ZWQgd2l0aCBHSU1QV4EOFwAAAzFJREFUOMuVlWtMFGcUht8Ztt1lZmFwZlmWXXZZkF0tEW1TI02s2kvU/miJicaUeMFoURtquDRYTdqGhhAjRkNL0ia9gReIrRVawRQjmqz+MsbourUlbUkI7sLOfLNovKS2Ro+/WGbKboBJ5s98532+c857cgZEhBv7D9rivuA+vXKNSESYyxtp2WFVg4FGdV25nYiA29uarJri7mQQY0xReu9vXGWfLexiS5NVz8n9RocYZRbpl/tvrsiG6vSsZxBuMwhRBiGqyfKZeytfE2aC/bl/3/MJr+u7SR2DEE14Cutw7dtfOSbP22s80CSpj214PSsd7LeP662ay9Vh1MRF5xeRtnYLiAgNoS2cruR+qBsCmJTdx8pXTCv/yieNNt1b0KkZYlV3YfuNjs4MIkIyEKFD0HIdDcZb9eyc/sSqsmSmQ427bczpOmqMUeX8tqHWpowkx3h79NjbmHDk1Zqgotz/6K2XskZ2VlrVIv8JU5kF8z+/2laXYWRM68/aB+dxx6Hs0Q1GMUk6q3r93UbYmE0+3Nt9iv+/PmXTK4+v5nRBqTH2VIc4lVm+70i4d4BPpU07FruadnFqib/OZBSEaNzhODxyqJ9Pp+OR5ql5LGdydx++QgBn/P6c/m+pZeADKZ0uJfCPvR+JzpOnjkJ/+CoAIgAcOA4AnuJJWWaIdccWlsmptBwRmWH1taLSdfL7DPZgOQEgAOSe18U/fTSM+D+fTsZZeD7yX6m4yRmJT5gAxvqHq6oEtaj4tMnN0iWtPw528USEiSLvexqEWNIoi3ROe7lYTmnK37U1dtVd8JMRNu4qaPk6HE4agOvt0Is91cwAZYI0OFoWVEzAa9XvZ2l5bhNsbOGiAz9Ebk5z82LPu5zqd29nEKcyzcwZHF0WyCUi4NZnrXZVVnpMo1Hob/750vW0o9HXcZNTS/K3GzPVefuFkaWL8hAv9lUktwyE6FjJC80N2h1+xn0IAgt4qiZ7qkGIxRYE6rF56BYSLs8ODUJ0fPGLzV9duszPemP/fpxjQe9WDWJszOc7WD16jAcR4Z3QAW68fEn5l3+p/Fx/AYGWIEbeWLa8gsIcEeEZsTM0Y8K17+YAAAAASUVORK5CYII=";const E=e=>(P("data-v-375da207"),e=e(),U(),e),zg={class:"head"},Hg=E(()=>s("img",{src:rn},null,-1)),Jg={key:0,class:"gray"},$g={class:"typeIcon-wrapper"},em=["src"],tm={key:0,class:"gray"},nm=E(()=>s("span",{class:"gray right"},"Alt+Click",-1)),am={class:"gray"},sm=E(()=>s("span",{class:"gray right"},"Alt+Click",-1)),im={class:"gray"},om=E(()=>s("span",{class:"gray right"},"Alt+Click",-1)),lm={key:0,class:"gray"},rm=E(()=>s("span",{class:"gray right"},"Alt+Click",-1)),dm=E(()=>s("span",{class:"gray right"},"Space",-1)),um=["onClick"],cm=["src"],gm=["src"],mm=["src"],hm=E(()=>s("img",{class:"pr-4px",src:Qg},null,-1)),pm=E(()=>s("img",{class:"pr-4px",src:Gg},null,-1)),fm=E(()=>s("img",{class:"pr-4px",src:qg},null,-1)),ym=E(()=>s("img",{class:"pr-4px",src:Dg},null,-1)),Cm=E(()=>s("img",{class:"pr-4px",src:_e},null,-1)),_m=E(()=>s("img",{class:"pr-4px",src:wt},null,-1)),Am=E(()=>s("img",{class:"pr-4px",src:Kg},null,-1)),bm=E(()=>s("img",{class:"pr-4px",src:Mg},null,-1)),vm=E(()=>s("img",{class:"pr-4px",src:_e},null,-1)),km=E(()=>s("img",{class:"pr-4px",src:jg},null,-1)),wm=E(()=>s("img",{class:"pr-4px",src:Ct},null,-1)),Im=E(()=>s("img",{class:"pr-4px",src:Zg},null,-1)),Em=E(()=>s("img",{class:"pr-4px",src:Wg},null,-1)),xm=E(()=>s("img",{class:"pr-4px",src:lt},null,-1)),Tm=E(()=>s("img",{class:"pr-4px",src:Xe},null,-1)),Sm=E(()=>s("img",{class:"pr-4px",src:Xe},null,-1)),Nm=E(()=>s("img",{class:"pr-4px",src:Xg},null,-1)),Rm=E(()=>s("span",{class:"gray right"},"Ctrl+X",-1)),Fm=E(()=>s("span",{class:"gray right"},"Ctrl+C",-1)),Bm=E(()=>s("span",{class:"gray right"},"Ctrl+V",-1)),Vm=E(()=>s("span",{class:"gray right"},"Ctrl+D",-1)),Pm=E(()=>s("span",null," Move Up ",-1)),Um=E(()=>s("span",{class:"gray right"},"Alt+⭡",-1)),Lm=[Pm,Um],Om=E(()=>s("span",null," Move Down ",-1)),Qm=E(()=>s("span",{class:"gray right"},"Alt+⭣",-1)),Gm=[Om,Qm],qm=E(()=>s("span",null," Move To ",-1)),Dm=E(()=>s("span",{class:"right"},"❯",-1)),Km=[qm,Dm],Mm=["onClick"],jm={key:0,class:"gray"},Zm=E(()=>s("img",{class:"w-12px pr-4px",src:Yg},null,-1)),Wm=E(()=>s("span",{class:"gray right"},"Del",-1));function Xm(e,t,n,i,l,a){const d=F("EditorCollapsibleBox"),r=F("CatalogueEntry",!0),c=F("CatalogueLabel"),y=mt,f=vt,k=F("ContextMenu");return o(),u("div",{class:"item unselectable",onMouseup:t[35]||(t[35]=S((...m)=>a.debug&&a.debug(...m),["middle","stop"])),onContextmenu:t[36]||(t[36]=S((...m)=>a.contextmenu.show&&a.contextmenu.show(...m),["stop"]))},[n.item.editorTypeName==="catalogue"||n.item.editorTypeName==="gameSystem"?(o(),u(v,{key:0},[s("div",zg,[p(d,{depth:0,payload:a.catalogue,nobox:"",collapsible:!1},{title:w(()=>[Hg,h(" "+C(a.catalogue.name)+" ",1),a.getNameExtra(a.catalogue)?(o(),u("span",Jg," "+C(a.getNameExtra(a.catalogue)),1)):g("",!0)]),content:w(()=>[]),_:1},8,["payload"])]),(o(!0),u(v,null,T(a.groupedCategories,m=>(o(),_(d,{key:m.type,depth:n.depth,altclickable:i.store.can_follow(n.item)||n.imported,onAltclick:a.onctrlclick,collapsible:m.items.length>0,payload:m.type,onContextmenu:S(B=>a.contextmenu.show(B,m.type),["stop"]),class:V([m.type,m.links,`depth-${n.depth}`]),nobox:"",defcollapsed:!a.should_be_open(m.type),path:[{key:m.type,index:0}]},{title:w(()=>[s("span",null,[s("span",$g,[s("img",{class:"typeIcon",src:`assets/bsicons/${m.icon}`},null,8,em)]),h(" "+C(m.name),1)])]),content:w(()=>[a.should_be_grouped(m.type)?(o(!0),u(v,{key:0},T(a.display_groups(m.type,m.items),({label:B,type:G,items:X})=>(o(),_(c,{label:B,depth:n.depth+1,catalogue:a.catalogue,typeItem:G},{default:w(()=>[(o(!0),u(v,null,T(X,Y=>(o(),_(r,{key:a.key(Y.item),item:Y.item,forceShowRecursive:a.forceShow,imported:Y.imported,depth:n.depth+2,noType:"",grouped:""},null,8,["item","forceShowRecursive","imported","depth"]))),128))]),_:2},1032,["label","depth","catalogue","typeItem"]))),256)):(o(!0),u(v,{key:1},T(m.items,B=>(o(),_(r,{key:a.key(B.item),item:B.item,forceShowRecursive:a.forceShow,imported:B.imported,depth:n.depth+1},null,8,["item","forceShowRecursive","imported","depth"]))),128))]),_:2},1032,["depth","altclickable","onAltclick","collapsible","payload","onContextmenu","class","defcollapsed","path"]))),128))],64)):(o(),_(d,{key:1,depth:n.depth,altclickable:i.store.can_follow(n.item)||n.imported,onAltclick:a.onctrlclick,collapsible:a.mixedChildren&&a.mixedChildren.length>0,empty:!a.mixedChildren||a.mixedChildren.length==0,payload:n.item,class:V([n.item.parentKey,`depth-${n.depth}`]),defcollapsed:!l.open,nobox:""},{title:w(()=>[p(y,{item:n.item,imported:n.imported,highlight:n.item.highlight,grouped:n.grouped},null,8,["item","imported","highlight","grouped"])]),content:w(()=>[(o(!0),u(v,null,T(a.mixedChildren,m=>(o(),_(r,{key:a.key(m.item),item:m.item,forceShowRecursive:a.forceShow,imported:n.imported||m.imported,depth:n.depth+1},null,8,["item","forceShowRecursive","imported","depth"]))),128))]),_:1},8,["depth","altclickable","onAltclick","collapsible","empty","payload","class","defcollapsed"])),l.contextmenuopen?(o(),_(k,{key:2,modelValue:l.contextmenuopen,"onUpdate:modelValue":t[34]||(t[34]=m=>l.contextmenuopen=m),ref:"contextmenu"},{default:w(({payload:m})=>{var B,G,X,Y,ie,ve,ke;return[!m&&n.item?(o(),u(v,{key:0},[i.store.can_follow(n.item)?(o(),u("div",{key:0,onClick:t[0]||(t[0]=I=>i.store.follow(a.link))},[h(" Follow "),a.link.target.getCatalogue()!==n.item.getCatalogue()?(o(),u("span",tm,"  ["+C(((B=a.link.target.getCatalogue())==null?void 0:B.getName())||a.link.target.getName())+"] ",1)):g("",!0),nm])):g("",!0),n.imported?(o(),u("div",{key:1,onClick:t[1]||(t[1]=I=>i.store.goto(n.item))},[h(" Goto "),s("span",am,"  ("+C((G=n.item.getCatalogue())==null?void 0:G.getName())+") ",1),sm])):g("",!0),n.item.isProfile()&&n.item.typeId&&n.item.getCatalogue().findOptionById(n.item.typeId)?(o(),u("div",{key:2,onClick:t[2]||(t[2]=I=>i.store.goto(n.item.getCatalogue().findOptionById(n.item.typeId)))},[h(" Goto "+C(n.item.typeName)+" ",1),s("span",im,"  ["+C(n.item.getCatalogue().findOptionById(n.item.typeId).getCatalogue().getName())+"] ",1),om])):g("",!0),a.child&&i.store.can_goto(a.child)?(o(),u("div",{key:3,onClick:t[3]||(t[3]=I=>i.store.goto(a.child))},[h(" Goto "+C(a.child.getName())+" ",1),n.item.getCatalogue()!==a.child.getCatalogue()?(o(),u("span",lm,"  ["+C(a.child.getCatalogue().getName())+"] ",1)):g("",!0),rm])):g("",!0),(((X=n.item.refs)==null?void 0:X.length)??0)+(((Y=n.item.other_refs)==null?void 0:Y.length)??0)?(o(),u("div",{key:4,onClick:t[4]||(t[4]=I=>i.store.mode="references")}," References ("+C((((ie=n.item.refs)==null?void 0:ie.length)??0)+(((ve=n.item.other_refs)==null?void 0:ve.length)??0))+") ",1)):g("",!0),i.store.filter&&!n.item.showChildsInEditor?(o(),u("div",{key:5,onClick:t[5]||(t[5]=(...I)=>i.store.toggle_selections&&i.store.toggle_selections(...I))},[h(" Show All Childs"),dm])):g("",!0),n.item.isLink()||n.item.refs||n.imported?(o(),_(f,{key:6})):g("",!0)],64)):g("",!0),m?(o(),u(v,{key:1},[s("div",{onClick:I=>i.store.create(m)},[s("img",{class:"pr-4px",src:`assets/bsicons/${a.getTypeName(m)}.png`},null,8,cm),h(" "+C(a.getTypeLabel(a.getTypeName(m))),1)],8,um),m==="selectionEntries"?(o(),u("div",{key:0,onClick:t[6]||(t[6]=I=>i.store.create("entryLinks",{type:"selectionEntry"}))},[s("img",{class:"pr-4px",src:"assets/bsicons/link.png"},null,8,gm),h(" Link ")])):g("",!0),m==="rules"?(o(),u("div",{key:1,onClick:t[7]||(t[7]=I=>i.store.create("infoLinks",{type:"profile"}))},[s("img",{class:"pr-4px",src:"assets/bsicons/link.png"},null,8,mm),h(" Link ")])):g("",!0),p(f)],64)):(o(),u(v,{key:2},[a.allowed("forceEntries")?(o(),u("div",{key:0,onClick:t[8]||(t[8]=I=>i.store.create("forceEntries"))},[hm,h(" Force ")])):g("",!0),a.allowed("categoryLinks")&&n.item.isForce()?(o(),u("div",{key:1,onClick:t[9]||(t[9]=I=>i.store.create("categoryLinks"))},[pm,h(" Category ")])):g("",!0),a.allowed(["forces","categoryLinks"])?(o(),_(f,{key:2})):g("",!0),a.allowed("selectionEntries")?(o(),u("div",{key:3,onClick:t[10]||(t[10]=I=>i.store.create("selectionEntries"))},[fm,h(" Entry ")])):g("",!0),a.allowed("selectionEntryGroups")?(o(),u("div",{key:4,onClick:t[11]||(t[11]=I=>i.store.create("selectionEntryGroups"))},[ym,h(" Group ")])):g("",!0),a.allowed("entryLinks")?(o(),u("div",{key:5,onClick:t[12]||(t[12]=I=>i.store.create("entryLinks",{type:"selectionEntry"}))},[Cm,h(" Link ")])):g("",!0),a.allowed(["selectionEntries","selectionEntryGroups","entryLinks"])?(o(),_(f,{key:6})):g("",!0),a.allowed("profiles")?(o(),u("div",{key:7,onClick:t[13]||(t[13]=I=>i.store.create_child("profiles",n.item))},[_m,h(" Profile ")])):g("",!0),a.allowed("rules")?(o(),u("div",{key:8,onClick:t[14]||(t[14]=I=>i.store.create("rules"))},[Am,h(" Rule ")])):g("",!0),a.allowed("infoGroups")?(o(),u("div",{key:9,onClick:t[15]||(t[15]=I=>i.store.create("infoGroups"))},[bm,h(" Info Group ")])):g("",!0),a.allowed("infoLinks")?(o(),u("div",{key:10,onClick:t[16]||(t[16]=I=>i.store.create("infoLinks",{type:"profile"}))},[vm,h(" Info Link ")])):g("",!0),a.allowed("associations")?(o(),u("div",{key:11,onClick:t[17]||(t[17]=I=>i.store.create("associations"))},[km,h(" Association ")])):g("",!0),a.allowed(["profiles","rules","infoGroups","infoLinks"])?(o(),_(f,{key:12})):g("",!0),a.allowed("conditions")?(o(),u("div",{key:13,onClick:t[18]||(t[18]=I=>i.store.create("conditions"))},[wm,h(" Condition ")])):g("",!0),a.allowed("conditionGroups")?(o(),u("div",{key:14,onClick:t[19]||(t[19]=I=>i.store.create("conditionGroups"))},[Im,h(" Condition Group ")])):g("",!0),a.allowed("repeats")?(o(),u("div",{key:15,onClick:t[20]||(t[20]=I=>i.store.create("repeats"))},[Em,h(" Repeat ")])):g("",!0),a.allowed(["conditions","conditionGroups","repeats"])?(o(),_(f,{key:16})):g("",!0),a.allowed("constraints")?(o(),u("div",{key:17,onClick:t[21]||(t[21]=I=>i.store.create_child("constraints",n.item))},[xm,h(" Constraint ")])):g("",!0),a.allowed("modifiers")?(o(),u("div",{key:18,onClick:t[22]||(t[22]=I=>i.store.create("modifiers"))},[Tm,h(" Modifier ")])):g("",!0),n.item.editorTypeName==="constraint"&&n.item.parent?(o(),u("div",{key:19,onClick:t[23]||(t[23]=I=>i.store.create_child("modifiers",n.item.parent,{field:n.item.id,value:0}))},[Sm,h(" Modifier ")])):g("",!0),a.allowed("modifierGroups")?(o(),u("div",{key:20,onClick:t[24]||(t[24]=I=>i.store.create("modifierGroups"))},[Nm,h(" Modifier Group ")])):g("",!0),a.allowed(["constraints","modifiers","modifierGroups"])||n.item.editorTypeName==="constraint"?(o(),_(f,{key:21})):g("",!0)],64)),m?g("",!0):(o(),u("div",{key:3,onClick:t[25]||(t[25]=(...I)=>i.store.cut&&i.store.cut(...I))},[h("Cut"),Rm])),m?g("",!0):(o(),u("div",{key:4,onClick:t[26]||(t[26]=(...I)=>i.store.copy&&i.store.copy(...I))},[h("Copy"),Fm])),s("div",{onClick:t[27]||(t[27]=(...I)=>i.store.paste&&i.store.paste(...I))},[h("Paste"),Bm]),m?g("",!0):(o(),u("div",{key:5,onClick:t[28]||(t[28]=(...I)=>i.store.duplicate&&i.store.duplicate(...I))},[h("Duplicate"),Vm])),a.sortable(n.item.parent)?g("",!0):(o(),u("div",{key:6,onClick:t[29]||(t[29]=I=>i.store.move_up(n.item))},Lm)),a.sortable(n.item.parent)?g("",!0):(o(),u("div",{key:7,onClick:t[30]||(t[30]=I=>i.store.move_down(n.item))},Gm)),!m&&((ke=i.store.get_move_targets(n.item))!=null&&ke.length)?(o(),u(v,{key:8},[s("div",{onMouseover:t[31]||(t[31]=(...I)=>a.nestedcontextmenu.show&&a.nestedcontextmenu.show(...I))},Km,32),p(k,{ref:"nestedcontextmenu"},{default:w(()=>[(o(!0),u(v,null,T(i.store.get_move_targets(n.item),I=>(o(),u("div",{onClick:ze=>i.store.move(n.item,a.catalogue,I.target,I.type)},C(I.target.name)+" - "+C(I.type),9,Mm))),256))]),_:1},512)],64)):g("",!0),n.item.parentKey==="sharedSelectionEntries"?(o(),u("div",{key:9,onClick:t[32]||(t[32]=I=>i.store.create_child("entryLinks",a.catalogue,{targetId:n.item.id,type:"selectionEntry",name:n.item.getName()}))},[h(" Add Root Link"),a.hasRootLink(a.catalogue,n.item)?(o(),u("span",jm," (already has one)")):g("",!0)])):g("",!0),m?g("",!0):(o(),_(f,{key:10})),m?g("",!0):(o(),u("div",{key:11,onClick:t[33]||(t[33]=I=>i.store.remove())},[Zm,h("Remove"),Wm]))]}),_:1},8,["modelValue"])):g("",!0)],32)}const Ym=A(Og,[["render",Xm],["__scopeId","data-v-375da207"]]),zm=j({emits:["scrolltop"],setup(){return{store:Q(),uistate:xe(),settings:J()}},data(){return{...en,...this.defaults,shouldScrollTo:void 0,shouldScrollToElement:void 0}},async mounted(){this.load(),addEventListener("keydown",this.keydown),addEventListener("copy",this.copy),addEventListener("paste",this.paste),addEventListener("cut",this.cut)},unmounted(){removeEventListener("keydown",this.keydown),removeEventListener("copy",this.copy),removeEventListener("paste",this.paste),removeEventListener("cut",this.cut)},props:{catalogue:{type:Object,required:!0},defaults:{type:Object,default:{}}},methods:{onscroll(e){this.scroll=e.target.scrollTop},load(){this.$nextTick(async()=>{if(this.shouldScrollTo=this.scroll,this.selection)try{let e=tn(this.catalogue,this.selection);const t=this.selection[this.selection.length-1];if(!e&&t.id&&(e=this.catalogue.findOptionById(t.id)),e){const n=await this.store.open(e);n&&(await qe(n).do_select(),this.store.mode=this.defaults.mode,this.shouldScrollToElement=n)}}catch(e){console.error(e)}})},async set_scroll(e){const t=this.$refs.scrollable;t&&(t.scrollTop=e,t.scrollLeft=0),this.$nextTick(async()=>{const n=this.$refs.scrollable;n&&(n.scrollTop=e,n.scrollLeft=0)})},async scroll_to(e){this.store.scroll_to_el(e),this.$nextTick(async()=>{this.store.scroll_to_el(e)})},should_capture_copy(e){var t,n;return!((t=document==null?void 0:document.activeElement)!=null&&t.isContentEditable||document.getElementsByClassName("veil").length||(n=getSelection())!=null&&n.toString())},should_capture_paste(e){var i,l,a,d;if(document.getElementsByClassName("veil").length)return!1;const t=(((i=e.target)==null?void 0:i.tagName)||"").toLowerCase();if(["input"].includes(t))return!1;const n=(((l=document==null?void 0:document.activeElement)==null?void 0:l.tagName)||"").toLowerCase();return!(["input"].includes(n)||(a=e.target)!=null&&a.isContentEditable||(d=document==null?void 0:document.activeElement)!=null&&d.isContentEditable||this.$route.name!=="catalogue")},async cut(e){this.should_capture_copy(e)&&(e.preventDefault(),await this.store.cut(e))},async copy(e){this.should_capture_copy(e)&&(e.preventDefault(),await this.store.copy(e))},async paste(e){this.should_capture_paste(e)&&(e.preventDefault(),await this.store.paste(e))},async keydown(e){var i,l;if(this.$route.name!=="catalogue"||!e.target)return;const t=(l=(i=e.target)==null?void 0:i.tagName)==null?void 0:l.toLowerCase(),n=e.key.toLowerCase();e.ctrlKey&&n==="f"&&(e.preventDefault(),this.$refs["editor-searchbox"].focus()),n==="escape"&&(this.$refs["editor-searchbox"].blur(),this.store.filter="",this.store.update_catalogue_search(this.catalogue,this.filterData)),t==="body"&&(n===" "&&(e.preventDefault(),this.store.toggle_selections()),e.ctrlKey&&n==="z"&&(e.preventDefault(),await this.store.undo()),e.ctrlKey&&n==="y"&&(e.preventDefault(),await this.store.redo()),e.ctrlKey&&n==="d"&&(e.preventDefault(),await this.store.duplicate()),e.ctrlKey&&n==="l"&&(e.preventDefault(),await this.store.pasteLink()),e.altKey&&n==="arrowdown"&&(e.preventDefault(),this.store.get_sorted_selections().reverse().filter(a=>!this.store.sortable(a)).forEach(a=>this.store.move_down(a))),e.altKey&&n==="arrowup"&&(e.preventDefault(),this.store.get_sorted_selections().filter(a=>!this.store.sortable(a)).forEach(a=>this.store.move_up(a))),n==="delete"&&(e.preventDefault(),await this.store.remove()))},async update(e){return this.store.update_catalogue_search(this.catalogue,e)}},computed:{filterData(){return{filter:this.filter.trim(),ignoreProfilesRules:this.ignoreProfilesRules}}},watch:{filterData:{handler(e){this.update(e)},immediate:!0},showImported:{immediate:!0,handler(e){e&&this.catalogue.imports.map(t=>t.processForEditor())}},shouldScrollTo(e){e!==void 0&&this.$nextTick(()=>{delete this.shouldScrollTo,this.set_scroll(e)})},shouldScrollToElement(e){e!==void 0&&this.$nextTick(()=>{delete this.shouldScrollTo,this.scroll_to(e)})}}}),Hm=""+globalThis.__publicAssetsURL("assets/icons/undo.svg"),Jm=""+globalThis.__publicAssetsURL("assets/icons/redo.svg"),$m=""+globalThis.__publicAssetsURL("assets/icons/vertical-alignment-24.png"),eh=""+new URL("collapse-all.40557dca.svg",import.meta.url).href;const W=e=>(P("data-v-51bcab25"),e=e(),U(),e),th={class:"leftPanel"},nh={class:"static sticky flex items-center h-28px z-1000"},ah=W(()=>s("img",{title:"Undo",class:"max-w-24px max-h-28px align-bottom",src:Hm},null,-1)),sh=[ah],ih=W(()=>s("img",{title:"Redo",class:"max-w-24px max-h-28px align-bottom",src:Jm},null,-1)),oh=[ih],lh={class:"absolute right-60px"},rh=W(()=>s("option",{value:"none"},"No Sorting ",-1)),dh=W(()=>s("option",{value:"asc"},"Ascending ",-1)),uh=W(()=>s("option",{value:"desc"},"Descending ",-1)),ch=W(()=>s("option",{value:"type"},"Type",-1)),gh=[rh,dh,uh,ch],mh=W(()=>s("img",{title:"Goto Selected",src:$m},null,-1)),hh=[mh],ph=W(()=>s("img",{title:"Collapse All",src:eh},null,-1)),fh=[ph],yh={class:"bottom static"},Ch={key:0},_h=W(()=>s("label",{class:"unselectable cursor-pointer",for:"showimport"},"Show Imported",-1)),Ah=W(()=>s("span",null,"  ",-1)),bh={class:"absolute right-5px"},vh=W(()=>s("label",{class:"unselectable cursor-pointer",for:"ignoreProfilesRules"},"Ignore Profiles/Rules",-1));function kh(e,t,n,i,l,a){const d=Te,r=Ym;return o(),u("div",th,[s("div",nh,[s("span",{class:V([{grey:!e.store.can_back(),"cursor-pointer":e.store.can_back(),"hover-darken":e.store.can_back()},"bold p-4px unselectable icon"]),onClick:t[0]||(t[0]=(...c)=>e.store.back&&e.store.back(...c)),title:"Back"}," 🡰 ",2),s("span",{class:V([{grey:!e.store.can_forward(),"cursor-pointer":e.store.can_forward(),"hover-darken":e.store.can_forward()},"bold p-4px unselectable ml-4px icon"]),onClick:t[1]||(t[1]=(...c)=>e.store.forward&&e.store.forward(...c)),title:"Forward"}," 🡲 ",2),s("span",{class:V([{grey:!e.store.can_undo(),"cursor-pointer":e.store.can_undo(),"hover-darken":e.store.can_undo()},"bold unselectable ml-5px imgBt"]),onClick:t[2]||(t[2]=(...c)=>e.store.undo&&e.store.undo(...c))},sh,2),s("span",{class:V([{grey:!e.store.can_redo(),"cursor-pointer":e.store.can_redo(),"hover-darken":e.store.can_redo()},"bold unselectable ml-4px imgBt"]),onClick:t[3]||(t[3]=(...c)=>e.store.redo&&e.store.redo(...c))},oh,2),s("div",lh,[h(" Sort "),b(s("select",{class:"h-24px p-2px !text-sm","onUpdate:modelValue":t[4]||(t[4]=c=>e.settings.sort=c)},gh,512),[[M,e.settings.sort]])]),s("span",{onClick:t[5]||(t[5]=c=>e.store.goto(e.store.get_selected())),class:"align-middle absolute h-20px p-2px hover-darken cursor-pointer imgBt right-30px"},hh),s("span",{onClick:t[6]||(t[6]=(...c)=>e.uistate.collapse_all&&e.uistate.collapse_all(...c)),class:"align-middle absolute right-0 p-2px hover-darken cursor-pointer imgBt"},fh),p(d,{errors:e.catalogue.errors,showNumber:"",clickable:"",class:"z-1"},null,8,["errors"])]),s("div",{class:"top rightborder scrollable",ref:"scrollable",onScroll:t[7]||(t[7]=(...c)=>e.onscroll&&e.onscroll(...c)),onKeydownCapture:t[8]||(t[8]=(...c)=>e.keydown&&e.keydown(...c))},[p(r,{class:"mb-40px w-full",item:e.catalogue,grouped:"",id:"editor-entries",showImported:e.showImported},null,8,["item","showImported"])],544),s("div",yh,[e.catalogue.isGameSystem()?g("",!0):(o(),u("span",Ch,[b(s("input",{class:"cursor-pointer","onUpdate:modelValue":t[9]||(t[9]=c=>e.showImported=c),type:"checkbox",id:"showimport"},null,512),[[O,e.showImported]]),_h])),Ah,s("span",bh,[b(s("input",{class:"cursor-pointer","onUpdate:modelValue":t[10]||(t[10]=c=>e.ignoreProfilesRules=c),type:"checkbox",id:"ignoreProfilesRules"},null,512),[[O,e.ignoreProfilesRules]]),vh]),b(s("input",{"onUpdate:modelValue":t[11]||(t[11]=c=>e.filter=c),ref:"editor-searchbox",type:"search",placeholder:"search... ctrl+f",class:"w-full"},null,512),[[x,e.filter]])])])}const wh=A(zm,[["render",kh],["__scopeId","data-v-51bcab25"]]),Ih=j({components:{LeftPanel:wh},data(){return{error:null,item:null,systemFiles:null,loading:!1,loading_all:!1,loading_progress:0,loading_progress_max:0,loading_progress_msg:"",initial:!0,saving:!1,failed:!1,id:"",cat:null,defaults:{},key:1,route:null}},setup(){return{cataloguesStore:nn(),store:Q(),uistate:xe()}},mounted(){this.store.init(this),globalThis.$catalogue=this.cat,window.addEventListener("beforeunload",this.beforeUnload),document.addEventListener("keydown",this.onKeydown,!0)},updated(){this.store.init(this),globalThis.$catalogue=this.cat},unmounted(){window.removeEventListener("beforeunload",this.beforeUnload),document.removeEventListener("keydown",this.onKeydown,!0)},activated(){window.addEventListener("beforeunload",this.beforeUnload)},deactivated(){window.removeEventListener("beforeunload",this.beforeUnload)},beforeRouteUpdate(){this.id&&this.store.save_state()},beforeRouteLeave(){this.id&&this.store.save_state()},beforeRouteEnter(){},computed:{has_unsaved_changes(){var t;const e=this.store.unsavedChanges;for(const n in e){const i=e[n];if(!(this.cat&&!n.includes((t=this.cat)==null?void 0:t.getSystemId()))&&i.unsaved)return!0}return!1},self_or_imports_changed(){var e,t;return this.file_changed(this.cat)||((t=(e=this.cat)==null?void 0:e.imports)==null?void 0:t.find(n=>this.file_changed(n)))},changed(){var e;return this.cat&&((e=this.store.get_catalogue_state(this.cat))==null?void 0:e.changed)||!1},unsaved(){var e;return this.cat&&((e=this.store.get_catalogue_state(this.cat))==null?void 0:e.unsaved)||!1},query(){return{gameSystemId:this.$route.query.systemId,catalogueId:this.$route.query.id||this.$route.query.systemId}},route_is_catalogue(){return this.$route.name==="catalogue"}},watch:{query:{async handler(e){var i;if(!this.route_is_catalogue)return;JSON.stringify(e)===JSON.stringify(this.route)&&this.$nextTick(()=>{this.store.$nextTickResolve&&this.store.$nextTickResolve()}),this.route=e;const{gameSystemId:t,catalogueId:n}=e;this.id=n||t,this.store.unselect();try{await this.load(t,this.id),(i=this.systemFiles)==null||i.loadAll(),this.error=null,this.$nextTick(()=>{this.store.$nextTickResolve&&this.store.$nextTickResolve()})}catch(l){console.error(l),this.error=l}},immediate:!0}},methods:{file_changed(e){return this.store.get_catalogue_state(e).isChangedOnDisk},async load_all(){if(this.systemFiles)try{this.loading_all=!0,await new Promise(e=>setTimeout(e,0)),await this.systemFiles.loadAll(async(e,t,n)=>{this.loading_progress=e,this.loading_progress_max=t,this.loading_progress_msg=n??"",await new Promise(i=>setTimeout(i,0))}),this.loading_progress=0,this.loading_progress_max=0,this.loading_progress_msg=""}catch(e){console.error(e)}finally{this.loading_all=!0}},async save_all(){var e;try{this.failed=await this.store.save_all((e=this.cat)==null?void 0:e.getSystemId())}finally{this.saving=!1}},async save(){try{const e=await this.store.prompt_revision(this.cat);await this.store.save_catalogue(this.systemFiles,this.cat,e)&&notify("Incremented 1 catalogue's revision"),this.failed=!1}catch{this.failed=!0}},async test(){var e;if(!((e=this.systemFiles)!=null&&e.github)){console.error("no github set");return}console.log("revision",await an(this.systemFiles.github,this.cat))},async beforeUnload(e){if(!globalThis._closeWindow&&(this.loading||this.store.save_state(),this.unsaved||this.store.unsavedCount)){const t="You have unsaved changes that will be lost";return e.returnValue=t,electron&&setTimeout(async()=>{await sn({message:"You have unsaved changes that will be lost?",buttons:["Cancel","Leave"],defaultId:0,cancelId:0,type:"question"})===1&&(globalThis._closeWindow=!0,on())}),!1}},onKeydown(e){e.ctrlKey&&e.key.toLowerCase()=="s"&&(e.preventDefault(),e.stopPropagation(),this.save())},load_state(e){this.defaults=e},async load(e,t){if(!t&&!e)throw new Error("couldn't load catalogue: no id");try{this.loading=!0,this.initial&&(await new Promise(l=>setTimeout(l,10)),this.initial=!1);const{system:n,catalogue:i}=await this.store.open_catalogue(e,t);if(this.systemFiles=n,this.cat=i,i){i.opened=!0;const l=this.uistate.get_data(i.id);this.load_state(l)}}finally{this.loading=!1}}}});const Eh={class:"h-full"},xh={key:0},Th={class:"ml-10px"},Sh={key:0,class:"inline",style:{"vertical-align":"-2px"},title:`This file or one of it's dependencies was changed by another program. 
You may want to reload the system through the Systems tab`,src:dn},Nh={class:"text-slate-300"},Rh={key:1,class:"status mx-2 text-red"},Fh={key:2,class:"status mx-2"},Bh={key:0};function Vh(e,t,n,i,l,a){const d=hn,r=pn,c=ln,y=F("LeftPanel"),f=yg,k=un;return o(),u("div",Eh,[p(r,null,{default:w(()=>[p(d,null,{default:w(()=>{var m;return[h(C(e.loading?"Loading...":[(m=e.cat)==null?void 0:m.getName(),"NR-Editor"].filter(B=>B).join(" - ")),1)]}),_:1})]),_:1}),e.error?(o(),u("span",xh,C(e.error),1)):e.loading?(o(),_(c,{key:1,progress:e.loading_progress,progress_max:e.loading_progress_max,progress_msg:e.loading_progress_msg},null,8,["progress","progress_max","progress_msg"])):e.cat?(o(),_(k,{key:2,class:"h-full",draggable:"",showMiddle:"",id:"catalogueView"},{left:w(()=>[(o(),_(y,{ref:"leftpanel",class:"h-full",catalogue:e.cat,defaults:e.defaults,key:e.key,keepalive:""},null,8,["catalogue","defaults"]))]),middle:w(()=>[e.store.selectedItem!=null?(o(),_(f,{key:0,catalogue:e.cat},null,8,["catalogue"])):g("",!0)]),_:1})):g("",!0),e.cat&&e.route_is_catalogue?(o(),_(st,{key:3,to:"#titlebar-content"},[s("span",Th,[h(" Editing "),e.self_or_imports_changed?(o(),u("img",Sh)):g("",!0),h(" "+C(e.cat.name)+" ",1),s("span",Nh,"v"+C(e.cat.revision),1)]),e.has_unsaved_changes?(o(),u("button",{key:0,class:"bouton save ml-10px",onClick:t[0]||(t[0]=(...m)=>e.save_all&&e.save_all(...m))}," Save All ")):e.failed?(o(),u("span",Rh,"failed to save")):(o(),u("span",Fh,"saved")),e.systemFiles&&!e.systemFiles.allLoaded?(o(),u("button",{key:3,class:"bouton load ml-10px",onClick:t[1]||(t[1]=(...m)=>e.load_all&&e.load_all(...m))},[h("Load all "),e.loading_all?(o(),u("span",Bh,"("+C(e.loading_progress)+" / "+C(e.loading_progress_max)+")",1)):g("",!0)])):g("",!0)])):g("",!0)])}const qh=A(Ih,[["render",Vh],["__scopeId","data-v-c4811983"]]);export{qh as default};
//# sourceMappingURL=catalogue.297c09ea.js.map
