import{u as w,a as $,g as C,d as N}from"./editorStore.81b5f509.js";import{e as M,P,a as _,H as b,b as i,i as e,w as g,v as F,N as I,F as f,m as y,t as h,A as c,k as B,B as k,o as l,c as T}from"./entry.5567fa53.js";import{N as E}from"./NodePath.697431ab.js";function S(s){return Math.round(s*100)/100}function V(s){let t="";s=P(s,n=>n.name);for(const n of s)if(n.value!=0){let p="";n.name.length!=0&&(p=" "+n.name),t=`${t}<span class='cost'>${S(n.value)}${p}</span>`}return t.length==0?t:`<span class="costList">${t}</span>`}const D=M({setup(){return{store:w()}},data(){return{filter:"",results:null,count:null,searching:!1,more:!1,page:0,max_display:30,max_results:1e3,showFullPath:!1}},computed:{async system(){return await this.store.get_or_load_system(this.$route.params.id)},data(){return{filter:this.filter}},from(){return this.count===null?0:Math.min(this.page*this.max_display,this.count)},to(){return this.count===null?0:Math.min(this.page*this.max_display+this.max_display,this.count)},last_page(){return this.count===null?0:Math.ceil(this.count/this.max_display)-1},displayed_results(){let s=0;const t=this.from,n=this.to,p={};for(const m in this.results){const u=this.results[m],o=u.length;let a=o;if(s+o>n){const d=s+o,r=Math.max(d-n,0);a=o-r}if(s+o>=t){const d=Math.max(t-s,0);o&&a>d&&(p[m]=u.slice(d,a))}if(s+=o,s>n)break}return p},displayed_count(){let s=0;for(const t in this.displayed_results)s+=this.displayed_results[t].length;return s}},methods:{getName:$,getNameExtra:C,path(s){const t=N(s);return t.pop(),t.shift(),t},async search(){try{this.searching=!0,await this.$nextTick(()=>this.$forceUpdate()),await new Promise(t=>setTimeout(t,5));const s=await this.store.system_search(await this.system,this.data,this.max_results);if(!s){this.results=null,this.count=null,this.more=!1;return}this.more=s.more,this.results=s.grouped,this.count=s.all.length}catch(s){console.error(s)}finally{this.page=0,this.searching=!1}},costs(s){var t;try{const n=[],p=s.getCatalogue(),m=s.getCosts();for(const u of m){const o=((t=p.findOptionById(u.typeId))==null?void 0:t.name)||u.name||u.typeId;o&&n.push({name:o,value:u.value,typeId:u.typeId})}return V(n)}catch{return""}}},components:{NodePath:E}}),L={class:"ml-20px mt-10px h-full overflow-y-auto"},H={key:0},U=e("label",{for:"show-fullpath"},"Show Full Path",-1),A=e("div",null,null,-1),K={key:0,class:"pb-50px"},O={class:"bold"},j={class:"ml-8px"},q=["onClick"],x={class:"typeIcon-wrapper"},z=["src"],G={key:0,class:"gray"},J=["innerHTML"];function Q(s,t,n,p,m,u){const o=b("NodePath");return l(),i("div",L,[e("div",null,[g(e("input",{type:"search","onUpdate:modelValue":t[0]||(t[0]=a=>s.filter=a),onKeydown:t[1]||(t[1]=I((...a)=>s.search&&s.search(...a),["enter"]))},null,544),[[F,s.filter]]),e("button",{class:"inputstyle",onClick:t[2]||(t[2]=(...a)=>s.search&&s.search(...a))}," Search "),s.searching?(l(),i("span",H," Searching...")):s.count!==null?(l(),i(f,{key:1},[e("span",null,[y("Found "+h(s.count),1),s.more?(l(),i(f,{key:0},[y("+")],64)):c("",!0),y(" results")]),e("span",null,", Displaying "+h(s.displayed_count)+" results",1)],64)):c("",!0)]),e("button",{class:"inputstyle w-28px",onClick:t[3]||(t[3]=a=>s.page=Math.max(0,s.page-1))}," < "),e("button",{class:"inputstyle w-28px",onClick:t[4]||(t[4]=a=>s.page=Math.min(s.last_page,s.page+1))}," > "),y(" Page "+h(s.page+1)+" / "+h(s.last_page+1)+" ",1),g(e("input",{type:"checkbox",id:"show-fullpath","onUpdate:modelValue":t[5]||(t[5]=a=>s.showFullPath=a)},null,512),[[B,s.showFullPath]]),U,A,s.results?(l(),i("div",K,[(l(!0),i(f,null,k(s.displayed_results,(a,d)=>(l(),i("div",null,[e("span",O,h(d),1),e("div",j,[(l(!0),i(f,null,k(a,r=>(l(),i("div",{class:"hover-darken cursor-pointer",onClick:v=>s.store.goto(r)},[s.showFullPath&&s.path(r).length?(l(),T(o,{key:0,path:s.path(r),onClick:v=>s.store.goto(r),class:"inline hover-darken cursor-pointer p-1px","end-arrow":""},null,8,["path","onClick"])):c("",!0),e("span",null,[e("span",x,[e("img",{class:"typeIcon mr-4px",src:`/assets/bsicons/${r.editorTypeName}.png`},null,8,z)]),e("span",null,h(s.getName(r)),1),s.getNameExtra(r)?(l(),i("span",G,"Â "+h(s.getNameExtra(r)),1)):c("",!0),s.costs(r)?(l(),i("span",{key:1,class:"ml-10px",innerHTML:s.costs(r)},null,8,J)):c("",!0)])],8,q))),256))])]))),256))])):c("",!0)])}const Y=_(D,[["render",Q]]);export{Y as default,V as formatCosts};
//# sourceMappingURL=_id_.7110ce08.js.map
