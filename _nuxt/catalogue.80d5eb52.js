import{e as te,f as nt,a as f,o as r,b as u,h as m,i,j as ye,w as y,v as w,F as k,r as B,k as O,l as x,m as _,p as V,q as E,s as q,x as p,y as N,z as S,A as ie,B as P,C as R,t as C,n as M,g as Z,c as v,D as at,E as be,G as Fe,H as Ne,I as Te,J as it,K as ae,L as Se,M as ot,N as st,O as lt,T as dt}from"./entry.c16fa1d8.js";import{_ as rt}from"./Loading.12bc47e4.js";import{_ as ut,a as ve,u as j,g as K,b as oe,c as ct,C as Ee,s as Re,d as Oe,e as ee,f as gt,h as mt,i as ht,j as Pe,P as _t,k as pt,l as ft,m as Ct,n as yt,o as bt}from"./editorStore.d22d430d.js";import{_ as I,a as vt,b as kt}from"./warning_sign.e1ebb16d.js";import{N as At}from"./NodePath.736af944.js";const xt=t=>Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0)),wt=(t,e)=>(n,d)=>(nt(()=>t({...xt(n),...d.attrs},d)),()=>{var l,a;return e?(a=(l=d.slots).default)==null?void 0:a.call(l):null}),It=te({name:"Title",inheritAttrs:!1,setup:wt((t,{slots:e})=>{var d,l,a;return{title:((a=(l=(d=e.default)==null?void 0:d.call(e))==null?void 0:l[0])==null?void 0:a.children)||null}})}),Tt=te({name:"Head",inheritAttrs:!1,setup:(t,e)=>()=>{var n,d;return(d=(n=e.slots).default)==null?void 0:d.call(n)}}),Pt={emits:["change","update:modelValue"],props:{modelValue:{type:[String,Number,Array]},placeholder:{type:String,default:""}},methods:{change(t){t.target&&(this.$emit("update:modelValue",t.target.outerText),this.$emit("change"))},get(){return this.$refs.div},toHtml(t){return t.replace(/\n/g,"<br />")},onpaste(t){var n;t.preventDefault();var e=((n=t.clipboardData)==null?void 0:n.getData("text/plain"))??"";document.execCommand("insertText",!1,e),this.$emit("update:modelValue",this.get().innerText),this.$emit("change")}},mounted(){this.get().innerText=`${this.modelValue??""}`},watch:{modelValue(){this.get().innerText!=this.modelValue&&(this.get().innerText=`${this.modelValue??""}`)}}};const Ft=["placeholder"];function Nt(t,e,n,d,l,a){return r(),u("div",{placeholder:n.placeholder,class:"editableDiv",onInput:e[0]||(e[0]=(...s)=>a.change&&a.change(...s)),onPaste:e[1]||(e[1]=(...s)=>a.onpaste&&a.onpaste(...s)),contenteditable:"true",ref:"div"},null,40,Ft)}const re=f(Pt,[["render",Nt],["__scopeId","data-v-3a6cd79d"]]),St={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},computed:{comment:{get(){return(Array.isArray(this.item.comment)?this.item.comment[0]:this.item.comment)||""},set(t){this.item.comment=t?[t]:void 0}}},methods:{changed(){this.$emit("catalogueChanged")}}},Et=i("legend",null,"Comment",-1);function Rt(t,e,n,d,l,a){const s=re;return r(),u("fieldset",null,[Et,m(s,{modelValue:a.comment,"onUpdate:modelValue":e[0]||(e[0]=o=>a.comment=o),onChange:a.changed},null,8,["modelValue","onChange"])])}const F=f(St,[["render",Rt]]),Ot={emits:["catalogueChanged","namechanged","idchanged"],props:{item:{type:Object,required:!0}},methods:{idchanged(){this.$emit("idchanged"),this.$emit("catalogueChanged")},namechanged(){this.$emit("namechanged"),this.$emit("catalogueChanged")},refresh(){this.id=ye(),this.idchanged()}},computed:{id:{get(){return this.item.id},set(t){const e=this.item,n=e.getCatalogue();n.removeFromIndex(e),e.id=t,n.addToIndex(e)}}}},Vt=""+new URL("back.33e845c9.png",import.meta.url).href;const Ut=i("legend",null,"Basics",-1),Lt={class:"editorTable"},Bt=i("td",null,"Unique ID:",-1),qt={class:"flex gap-2px"},jt=i("span",null,[i("img",{class:"h-20px w-20px icon",src:Vt,title:"Generate Id"})],-1),$t=[jt],Dt=i("td",null,"Name:",-1);function Gt(t,e,n,d,l,a){return r(),u("fieldset",null,[Ut,i("table",Lt,[i("tr",null,[Bt,i("td",qt,[y(i("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>a.id=s),onChange:e[1]||(e[1]=(...s)=>a.idchanged&&a.idchanged(...s)),class:"flex flex-shrink"},null,544),[[w,a.id]]),i("button",{class:"btn !w-34px flex items-center mr-8px",onClick:e[2]||(e[2]=(...s)=>a.refresh&&a.refresh(...s))},$t)])]),i("tr",null,[Dt,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=s=>n.item.name=s),onChange:e[4]||(e[4]=(...s)=>a.namechanged&&a.namechanged(...s))},null,544),[[w,n.item.name]])])])])])}const U=f(Ot,[["render",Gt]]),Qt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Mt=i("legend",null,"Publication",-1),Kt={class:"editorTable"},Ht=i("td",null,"Short Name",-1),zt=i("td",null,"Publication:",-1),Xt=i("td",null,"Publication Date:",-1),Wt=i("td",null,"Publication URL:",-1);function Yt(t,e,n,d,l,a){return r(),u("fieldset",null,[Mt,i("table",Kt,[i("tr",null,[Ht,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>n.item.shortName=s),onChange:e[1]||(e[1]=(...s)=>a.changed&&a.changed(...s))},null,544),[[w,n.item.shortName]])])]),i("tr",null,[zt,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=s=>n.item.publisher=s),onChange:e[3]||(e[3]=(...s)=>a.changed&&a.changed(...s))},null,544),[[w,n.item.publisher]])])]),i("tr",null,[Xt,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=s=>n.item.publicationDate=s),onChange:e[5]||(e[5]=(...s)=>a.changed&&a.changed(...s))},null,544),[[w,n.item.publicationDate]])])]),i("tr",null,[Wt,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=s=>n.item.publisherUrl=s),onChange:e[7]||(e[7]=(...s)=>a.changed&&a.changed(...s))},null,544),[[w,n.item.publisherUrl]])])])])])}const Jt=f(Qt,[["render",Yt]]),Zt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function en(t,e,n,d,l,a){const s=F,o=U,g=Jt;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{class:"section",item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])],64)}const tn=f(Zt,[["render",en]]),nn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},an=i("label",{for:"hidden"},"Hidden",-1);function on(t,e,n,d,l,a){return r(),u("fieldset",null,[i("legend",null,[B(t.$slots,"default")]),y(i("input",{id:"hidden",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=s=>n.item.hidden=s),onChange:e[1]||(e[1]=(...s)=>a.changed&&a.changed(...s))},null,544),[[O,n.item.hidden]]),an])}const X=f(nn,[["render",on]]),sn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},ln={class:"section"},dn=i("legend",null,"Limit",-1),rn={class:"editorTable"},un=i("td",null,"Default Cost Limit: ",-1),cn=i("span",{class:"gray ml-10px"},"-1 = No limit",-1);function gn(t,e,n,d,l,a){const s=F,o=U,g=X;return r(),u("div",null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Cost Types ")]),_:1},8,["item","onCatalogueChanged"]),i("div",ln,[i("fieldset",null,[dn,i("table",rn,[i("tr",null,[un,i("td",null,[y(i("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=c=>n.item.defaultCostLimit=c),onChange:e[1]||(e[1]=(...c)=>a.changed&&a.changed(...c))},null,544),[[w,n.item.defaultCostLimit]]),cn])])])])])])}const mn=f(sn,[["render",gn]]),hn=""+globalThis.__publicAssetsURL("assets/icons/undo.svg"),_n=""+globalThis.__publicAssetsURL("assets/icons/redo.svg"),pn=""+new URL("collapse-all.40557dca.svg",import.meta.url).href,W=t=>(N("data-v-4c98d6c3"),t=t(),S(),t),fn={class:"leftPanel"},Cn={class:"static sticky flex items-center h-28px z-1"},yn={class:"absolute right-30px"},bn=W(()=>i("option",{value:"none"},"No Sorting ",-1)),vn=W(()=>i("option",{value:"asc"},"Ascending ",-1)),kn=W(()=>i("option",{value:"desc"},"Descending ",-1)),An=W(()=>i("option",{value:"type"},"Type",-1)),xn=[bn,vn,kn,An],wn={class:"bottom static"},In={key:0},Tn=W(()=>i("label",{class:"unselectable cursor-pointer",for:"showimport"},"Show Imported",-1)),Pn=W(()=>i("span",null," Â ",-1)),Fn={class:"absolute right-5px"},Nn=W(()=>i("label",{class:"unselectable cursor-pointer",for:"ignoreProfilesRules"},"Ignore Profiles/Rules",-1));function Sn(t,e,n,d,l,a){const s=ve,o=V("CatalogueEntry");return r(),u("div",fn,[i("div",Cn,[i("span",{class:E([{grey:!t.store.can_back(),"cursor-pointer":t.store.can_back(),"hover-darken":t.store.can_back()},"bold p-4px unselectable icon"]),onClick:e[0]||(e[0]=(...g)=>t.store.back&&t.store.back(...g)),title:"Back"}," ðŸ¡° ",2),i("span",{class:E([{grey:!t.store.can_forward(),"cursor-pointer":t.store.can_forward(),"hover-darken":t.store.can_forward()},"bold p-4px unselectable ml-4px icon"]),onClick:e[1]||(e[1]=(...g)=>t.store.forward&&t.store.forward(...g)),title:"Forward"}," ðŸ¡² ",2),i("img",{class:E([{grey:!t.store.can_undo(),"cursor-pointer":t.store.can_undo(),"hover-darken":t.store.can_undo()},"bold p-4px unselectable ml-5px w-24px h-24px icon"]),onClick:e[2]||(e[2]=(...g)=>t.store.undo&&t.store.undo(...g)),title:"Undo",src:hn},null,2),i("img",{class:E([{grey:!t.store.can_redo(),"cursor-pointer":t.store.can_redo(),"hover-darken":t.store.can_redo()},"bold p-4px unselectable ml-4px w-24px h-24px icon"]),onClick:e[3]||(e[3]=(...g)=>t.store.redo&&t.store.redo(...g)),title:"Redo",src:_n},null,2),i("div",yn,[_(" Sort "),y(i("select",{class:"h-24px p-2px !text-sm","onUpdate:modelValue":e[4]||(e[4]=g=>t.settings.sort=g)},xn,512),[[q,t.settings.sort]])]),i("img",{onClick:e[5]||(e[5]=(...g)=>t.uistate.collapse_all&&t.uistate.collapse_all(...g)),class:"align-middle absolute right-0 p-2px hover-darken cursor-pointer icon",title:"Collapse All",src:pn}),m(s,{errors:t.catalogue.errors,showNumber:"",clickable:"",class:"z-1"},null,8,["errors"])]),i("div",{class:"top rightborder scrollable",ref:"scrollable",onScroll:e[6]||(e[6]=(...g)=>t.onscroll&&t.onscroll(...g)),onKeydownCapture:e[7]||(e[7]=(...g)=>t.keydown&&t.keydown(...g))},[m(o,{class:"mb-40px",item:t.catalogue,grouped:"",id:"editor-entries",showImported:t.showImported},null,8,["item","showImported"])],544),i("div",wn,[t.catalogue.isGameSystem()?p("",!0):(r(),u("span",In,[y(i("input",{class:"cursor-pointer","onUpdate:modelValue":e[8]||(e[8]=g=>t.showImported=g),type:"checkbox",id:"showimport"},null,512),[[O,t.showImported]]),Tn])),Pn,i("span",Fn,[y(i("input",{class:"cursor-pointer","onUpdate:modelValue":e[9]||(e[9]=g=>t.ignoreProfilesRules=g),type:"checkbox",id:"ignoreProfilesRules"},null,512),[[O,t.ignoreProfilesRules]]),Nn]),y(i("input",{"onUpdate:modelValue":e[10]||(e[10]=g=>t.filter=g),ref:"editor-searchbox",type:"search",placeholder:"search... ctrl+f",class:"w-full"},null,512),[[w,t.filter]])])])}const En=f(ut,[["render",Sn],["__scopeId","data-v-4c98d6c3"]]),Rn=te({props:{items:{type:Array,required:!0},get:{type:Function,required:!0},set:{type:Function,required:!0},del:{type:Function,required:!0}},data(){return{dragging:null,dropIndex:null}},computed:{sorted(){return ie(this.items,t=>this.get(t)??1e4)},realDropIndex(){return this.dropIndex===null?null:Math.min(this.sorted.filter(t=>this.get(t)!==void 0).length,this.dropIndex)}},methods:{dragStart(t){this.dragging=t},dragEnter(t){this.dragging!==t&&(this.dropIndex=t)},drop(t){if(t===null)return;const e=t+1;if(this.dropIndex=null,this.dragging!==null){const n=[];for(const d of this.sorted){const l=this.get(d);l!==void 0&&n.push({item:d,idx:l})}if(n.find(d=>d.idx===e))for(const{item:d,idx:l}of n)l>=e&&this.set(d,l+1);this.set(this.dragging,e),this.fixup(),this.dragging=null}},fixup(){let t=1;for(const e of this.sorted)this.get(e)!==void 0&&(this.set(e,t),t++)}}});const On={class:"scrollable max-h-60vh p-10px"},Vn=["onDragstart","onDragenter"],Un={key:1},Ln=["onClick"];function Bn(t,e,n,d,l,a){return r(),u("div",On,[(r(!0),u(k,null,P(t.sorted,(s,o)=>(r(),u("div",{class:E(["p-4px border-solid -mt-1px border-1px hover-darken unselectable 0px",{"drop-target":t.realDropIndex===o}]),draggable:"true",onDragstart:g=>t.dragStart(s),onDragover:e[0]||(e[0]=R(()=>{},["prevent"])),onDrop:e[1]||(e[1]=g=>t.drop(t.realDropIndex)),onDragenter:g=>t.dragEnter(o)},[t.get(s)===void 0?(r(),u("span",{key:0,class:E({gray:t.get(s)===void 0}),title:"Will not be ordered specifically (but will be after anything with an index set)"}," [?] ",2)):(r(),u("span",Un," ["+C(t.get(s))+"] ",1)),B(t.$slots,"item",M(Z({item:s})),void 0,!0),t.get(s)!==void 0?(r(),u("span",{key:2,class:"px-4px py-1px hover-brighten cursor-pointer unselectable float-right",onClick:R(g=>t.del(s),["stop"])},"x",8,Ln)):p("",!0)],42,Vn))),256))])}const qn=f(Rn,[["render",Bn],["__scopeId","data-v-3ac5b90f"]]),jn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},data(){return{selectedType:null,orderPopup:!1}},setup(){return{store:j()}},computed:{selected:{set(t){this.selectedType=this.item.characteristicTypes.find(e=>e.id===t)||null},get(){var t;return((t=this.selectedType)==null?void 0:t.id)||null}}},methods:{get(t){return t.sortIndex},set(t,e){t.sortIndex=e,this.store.set_catalogue_changed(t.catalogue,!0)},del(t){delete t.sortIndex,this.store.set_catalogue_changed(t.catalogue,!0)},get_profile_types(){const t=this.item.catalogue.manager.getAllLoadedCatalogues(),e=[];for(const n of t)for(const d of n.profileTypes||[])e.push(d);return e},add(){this.item.characteristicTypes||(this.item.characteristicTypes=[]);const t={id:ye(),name:"New Characteristic Type"};this.item.characteristicTypes.push(t);const e=this.item.links||[];for(const n of e)for(const d of n.profilesIterator())d.typeId===this.item.id&&(d.characteristics||(d.characteristics=[]),d.characteristics.push({typeId:t.id,name:t.name,$text:""}));this.$emit("catalogueChanged")},del(){let t;if(this.selectedType&&this.item.characteristicTypes){const n=this.item.characteristicTypes.indexOf(this.selectedType);n!=-1&&(t=this.item.characteristicTypes.splice(n,1)[0],this.selectedType=this.item.characteristicTypes[0])}const e=this.item.links||[];for(const n of e)for(const d of n.profilesIterator())d.typeId===this.item.id&&d.characteristics&&(d.characteristics=d.characteristics.filter(l=>l.typeId!==t.id));this.$emit("catalogueChanged")},characteristicIdChanged(t){const e=this.item.links||[];for(const n of e)if(n.typeId===this.item.id)for(const d of n.characteristics||[])d.name==t.name&&(d.typeId=t.id,this.store.set_catalogue_changed(n.catalogue));this.$emit("catalogueChanged")},characteristicNameChanged(t){const e=this.item.links||[];for(const n of e)if(n.typeId===this.item.id)for(const d of n.characteristics||[])d.typeId==t.id&&(d.name=t.name,this.store.set_catalogue_changed(n.catalogue));this.$emit("catalogueChanged")},init(){var t;(t=this.item.characteristicTypes)!=null&&t.length&&(this.selectedType=this.item.characteristicTypes[0])}},created(){this.init()},watch:{item(){this.init()}},components:{SortOrder:qn}},$n="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV8/RCkVB4uIOASsTlZERRy1CkWoEGqFVh1MLv2CJg1Jiouj4Fpw8GOx6uDirKuDqyAIfoA4OjkpukiJ/0sKLWI8OO7Hu3uPu3eAv15mqhkcB1TNMlKJuJDJrgqdrwiiDyGMYUhipj4nikl4jq97+Ph6F+NZ3uf+HN1KzmSATyCeZbphEW8QT29aOud94ggrSgrxOfGoQRckfuS67PIb54LDfp4ZMdKpeeIIsVBoY7mNWdFQiaeIo4qqUb4/47LCeYuzWq6y5j35C8M5bWWZ6zQHkcAiliBCgIwqSijDQoxWjRQTKdqPe/gHHL9ILplcJTByLKACFZLjB/+D392a+ckJNykcBzpebPtjGOjcBRo12/4+tu3GCRB4Bq60lr9SB2Y+Sa+1tOgR0LMNXFy3NHkPuNwB+p90yZAcKUDTn88D72f0TVmg9xYIrbm9Nfdx+gCkqavkDXBwCIwUKHvd491d7b39e6bZ3w+TdnK04tslPQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB+YEFgsEBONvEkAAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAfklEQVQ4y+2VOw7AMAhDTdVj5nbknnTpkCIMapqt8YYELx9LRlDLXC34IAOgQ63BAelpvrmTucY4EoD6xEvayDOsk533jVZC6f9NzR6kwbupzm3vPipgK8zpgdMpcFobuIG/AGoSoixglQHFB2UhGeC0v9wZxc4JyW9z8cG4AK8CG5AjF625AAAAAElFTkSuQmCC";const $=t=>(N("data-v-9a50d430"),t=t(),S(),t),Dn=$(()=>i("legend",null," Order ",-1)),Gn=$(()=>i("legend",null,"Profil Type",-1)),Qn=$(()=>i("h3",null,"Characteristic Types",-1)),Mn=["value"],Kn={class:"section add"},Hn=$(()=>i("img",{src:I},null,-1)),zn=$(()=>i("img",{src:$n},null,-1)),Xn=$(()=>i("h3",{class:"section"},"Selected Characteristic Type",-1)),Wn={class:"editorTable"},Yn=$(()=>i("td",null,"Unique Id:",-1)),Jn=$(()=>i("td",null,"Name:",-1)),Zn=$(()=>i("div",{class:"text-center"},"Drag & Drop to change profileTypes order",-1));function ea(t,e,n,d,l,a){const s=V("SortOrder"),o=at;return r(),u("span",null,[i("fieldset",null,[Dn,i("button",{class:"bouton inline",onClick:e[0]||(e[0]=g=>l.orderPopup=!0)},"Change")]),i("fieldset",null,[Gn,Qn,i("div",null,[y(i("select",{size:"2","onUpdate:modelValue":e[1]||(e[1]=g=>a.selected=g)},[(r(!0),u(k,null,P(n.item.characteristicTypes,g=>(r(),u("option",{value:g.id},C(g.name),9,Mn))),256))],512),[[q,a.selected]]),i("div",Kn,[i("button",{class:"bouton",onClick:e[2]||(e[2]=(...g)=>a.add&&a.add(...g))},[Hn,_(" Add ")]),i("button",{class:"bouton",onClick:e[3]||(e[3]=(...g)=>a.del&&a.del(...g))},[zn,_(" Delete ")])]),l.selectedType?(r(),u(k,{key:0},[Xn,i("table",Wn,[i("tr",null,[Yn,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=g=>l.selectedType.id=g),onChange:e[5]||(e[5]=g=>a.characteristicIdChanged(l.selectedType))},null,544),[[w,l.selectedType.id]])])]),i("tr",null,[Jn,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=g=>l.selectedType.name=g),onChange:e[7]||(e[7]=g=>a.characteristicNameChanged(l.selectedType))},null,544),[[w,l.selectedType.name]])])])])],64)):p("",!0)])]),l.orderPopup?(r(),v(o,{key:0,modelValue:l.orderPopup,"onUpdate:modelValue":e[8]||(e[8]=g=>l.orderPopup=g)},{default:x(()=>[Zn,m(s,{items:a.get_profile_types(),get:a.get,set:a.set,del:a.del},{item:x(({item:g})=>[_(C(g.name),1)]),_:1},8,["items","get","set","del"])]),_:1},8,["modelValue"])):p("",!0)])}const ta=f(jn,[["render",ea],["__scopeId","data-v-9a50d430"]]),na={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},setup(){return{store:j()}},methods:{changed(){this.$emit("catalogueChanged")},profileNameChanged(){const t=this.item.links||[];for(const e of t)e.typeId===this.item.id&&(e.typeName=this.item.name,this.store.set_catalogue_changed(e.catalogue));this.$emit("catalogueChanged")},profileIdChanged(){const t=this.item.links||[];for(const e of t)e.typeName===this.item.name&&(e.typeId=this.item.id,this.store.set_catalogue_changed(e.catalogue));this.$emit("catalogueChanged")}}};function aa(t,e,n,d,l,a){const s=F,o=U,g=ta;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section",onNamechanged:a.profileNameChanged,onIdchanged:a.profileIdChanged},null,8,["item","onCatalogueChanged","onNamechanged","onIdchanged"]),m(g,{class:"section",item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])],64)}const ia=f(na,[["render",aa]]),oa={props:{modelValue:String,placeholder:{type:String,default:"Search..."},min:{type:Number,default:0},max:{type:Number,default:1e3},options:{type:[Array,Function],required:!0},valueField:{type:String,default:""},filterField:{type:[String,Function],default:""},lazy:{type:Boolean,default:!1},default:{type:Object},nullable:{type:Boolean,default:!1}},created(){this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset()},data(){return{searchPattern:"",lastSearch:null,editing:!1,selectedOption:null,sleeping:this.lazy}},computed:{computedOptions(){return Array.isArray(this.options)?this.options:this.sleeping?[]:this.options()},foundOptions(){const t=this.textSearchRegex(this.searchPattern),e=[];this.nullable&&e.push({option:void 0});const n=this.computedOptions,d=this.max||n.length;for(let l=0;l<n.length;l++){const a=n[l];let s=this.getField(a);if(s&&s.match&&s.match(t)&&(e.push({option:a}),e.length>=d-1))break}return e}},methods:{getField(t){return this.filterField?this.filterField instanceof Function?this.filterField(t):t[this.filterField]:t},escapeRegex(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},textSearchRegex(t){const n=`^(?=.*\\b${this.escapeRegex(t).split(" ").join(".*)(?=.*\\b")}).*$`;return new RegExp(n,"i")},targetSelected(t){var d;let e=t.option;this.valueField.length&&(this.nullable&&!t.option?e=void 0:e=t.option[this.valueField]);const n=(d=this.selectedOption)==null?void 0:d.option;this.selectedOption={option:t.option,selected:!0},this.$emit("update:modelValue",e),this.$emit("change",t.option,n)},reset(){if(this.searchPattern="",this.selectedOption=null,this.modelValue){let t=this.computedOptions.find(e=>{let n=e;return this.valueField&&(n=e[this.valueField]),n===this.modelValue});t?this.selectedOption={option:t,selected:!0}:this.selectedOption=null}},onClickOutside(){this.editing=!1},suggest(){this.searchPattern.length<this.min?this.editing=!1:this.startEditing()},maySuggest(){this.sleeping=!1,this.searchPattern="",this.min==0&&this.suggest()},clicked(){this.editing=!1},startEditing(){this.editing||(this.sleeping=!1,this.editing=!0,this.searchPattern="")}},watch:{options(){this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset()},modelValue(){this.editing||(this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset())},async editing(){this.editing&&(await this.$nextTick(),this.$refs.edit&&this.$refs.edit.focus())}}};const sa={class:"autocomplete container"},la=["placeholder"],da={key:0,class:"gray"},ra=["onClickCapture"];function ua(t,e,n,d,l,a){const s=be("click-outside");return r(),u("div",sa,[l.editing?y((r(),u("input",{key:0,class:"input autocomplete-input",type:"text",ref:"edit",onInput:e[0]||(e[0]=(...o)=>a.suggest&&a.suggest(...o)),onClick:e[1]||(e[1]=(...o)=>a.maySuggest&&a.maySuggest(...o)),"onUpdate:modelValue":e[2]||(e[2]=o=>l.searchPattern=o),placeholder:n.placeholder},null,40,la)),[[w,l.searchPattern],[s,a.onClickOutside]]):(r(),u("div",{key:1,onClick:e[3]||(e[3]=(...o)=>a.startEditing&&a.startEditing(...o)),class:"autocomplete-input"},[l.selectedOption?B(t.$slots,"option",M(Fe({key:1},l.selectedOption)),void 0,!0):(r(),u("span",da,C(n.placeholder),1))])),i("div",{class:E(["suggestions",{hidden:!l.editing}])},[(r(!0),u(k,null,P(a.foundOptions,o=>(r(),u("div",{onClickCapture:g=>a.targetSelected(o)},[B(t.$slots,"option",M(Z(o)),void 0,!0)],40,ra))),256))],2)])}const Y=f(oa,[["render",ua],["__scopeId","data-v-8bb20fe3"]]),ca={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},computed:{publications(){return ie([...this.catalogue.iteratePublications()],t=>(t==null?void 0:t.name)||"")}},methods:{getNameExtra:K,getName:oe,changed(){this.$emit("catalogueChanged")}}},ga="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9TS0UrDhaU4pChOlkQFXHUKhShQqkVWnUwufQLmjQkKS6OgmvBwY/FqoOLs64OroIg+AHi6uKk6CIl/i8ptIjx4Lgf7+497t4BQqPCVLNrHFA1y0gn4mI2tyoGXxFAL4KIYFBipj6XSiXhOb7u4ePrXYxneZ/7c/QpeZMBPpF4lumGRbxBPL1p6Zz3icOsJCnE58RjBl2Q+JHrsstvnIsOCzwzbGTS88RhYrHYwXIHs5KhEk8RRxVVo3wh67LCeYuzWqmx1j35C0N5bWWZ6zSHkcAilpCCCBk1lFGBhRitGikm0rQf9/BHHH+KXDK5ymDkWEAVKiTHD/4Hv7s1C5MTblIoDgRebPtjBAjuAs26bX8f23bzBPA/A1da219tADOfpNfbWvQI6N8GLq7bmrwHXO4AQ0+6ZEiO5KcpFArA+xl9Uw4YuAV61tzeWvs4fQAy1FXyBjg4BEaLlL3u8e7uzt7+PdPq7wcllnKI7QJDVQAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFCwgaM9maQ54AAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAACEElEQVQ4y52RzWsTQRiHn9luvsBCFpomtISSBFRICAgeApUeipcWT176n/Tc/yPneggI3rwJfkCwhnoTP+LuyWw8JBnS2DXszoyHdbcJXtT3NHP4PfO8vxEAz1+8ND+Da/5mSuUKD+7fE8ndBrj+seD44SFaa4wxaK2JogilFEoptNYADIdDvvsj3gzemwRiARhj0mASMMaglCIMQ5bLJUEQsFgsePzomPHoG6/fXZrUQCuFZVn0+33y+TytVovBYEA2myWXyzGZTGi1WkynU87PzwHof3VvVtBaI4Sg0+mkNsk5sQjDkP39fbTWFAoFXvXfrgMAut0u5XKZdrvN2dkZhUKBer2O4zicnJzQ6/UolUo0m800YwMoFRscHR1hjKFara6FXdclk8lweBgXvbu7y4cv8QpWDFAIIfB9HyklQoi18Gg0YmNjg/F4jJQSy7JQSq0Y6Biws7MTUy2L09PTtI/kh6rVKkopbNtG6VVAFAHgeR7FYpG9vT0uLi7I5XIATKdTDg4O8DyPWq0WA35n7NUV6vU6QGqTvF4sFhFC0Gg0MMasrWABRFGEEAIpJb7vr/WxXC7TXjzPS8/RqkEYhgghcBwHx3HWDADy+fwfhmEY3gDm8zmu6yKlZDabpX1UKhWCICAIAgCklCl0Pp/HsCdPn5nPnz6yuLriX+bW5ia379zF3ipts1Xa5n/nF4VfO8AW+/8fAAAAAElFTkSuQmCC",ma=i("legend",null,[i("img",{src:ga}),_(" Reference")],-1),ha={class:"editorTable"},_a=i("td",null,"Publication:",-1),pa={class:"flex align-items flex-row"},fa=["src"],Ca={class:"inline"},ya={class:"grey"},ba=["src"],va=i("span",{class:"inline"},"None",-1),ka=i("td",null,"Page:",-1);function Aa(t,e,n,d,l,a){const s=Y;return r(),u("fieldset",null,[ma,i("table",ha,[i("tr",null,[_a,i("td",null,[m(s,{options:a.publications,filterField:o=>o.getName(),valueField:"id",modelValue:n.item.publicationId,"onUpdate:modelValue":e[0]||(e[0]=o=>n.item.publicationId=o),onChange:a.changed,nullable:""},{option:x(({option:o})=>[i("div",pa,[o?(r(),u(k,{key:0},[i("img",{class:"mr-1 my-auto",src:`assets/bsicons/${o.editorTypeName}.png`},null,8,fa),i("span",Ca,[_(C(a.getName(o))+" ",1),i("span",ya,C(a.getNameExtra(o)),1)])],64)):(r(),u(k,{key:1},[i("img",{class:"mr-1 my-auto",src:"assets/bsicons/bullet.png"},null,8,ba),va],64))])]),_:1},8,["options","filterField","modelValue","onChange"])])]),i("tr",null,[ka,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=o=>n.item.page=o),onChange:e[2]||(e[2]=(...o)=>a.changed&&a.changed(...o))},null,544),[[w,n.item.page]])])])])])}const D=f(ca,[["render",Aa]]),xa={emits:["catalogueChanged"],setup(){return{store:j()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},methods:{changed(){this.$emit("catalogueChanged")},add(t,e){this.store.create_child("constraints",this.item,{type:t,scope:e,value:1,select:!1})}}};const T=t=>(N("data-v-07f16148"),t=t(),S(),t),wa=T(()=>i("legend",null,[i("img",{src:ct}),_(" Quick Constraints")],-1)),Ia={class:"columns"},Ta={class:"column"},Pa=T(()=>i("img",{src:I},null,-1)),Fa=T(()=>i("span",{class:"text"},"MIN 1 IN PARENT",-1)),Na=[Pa,Fa],Sa=T(()=>i("img",{src:I},null,-1)),Ea=T(()=>i("span",{class:"text"},"MIN 1 IN CATEGORY",-1)),Ra=[Sa,Ea],Oa=T(()=>i("img",{src:I},null,-1)),Va=T(()=>i("span",{class:"text"},"MIN 1 IN FORCE",-1)),Ua=[Oa,Va],La=T(()=>i("img",{src:I},null,-1)),Ba=T(()=>i("span",{class:"text"},"MIN 1 IN ROSTER",-1)),qa=[La,Ba],ja={class:"column"},$a=T(()=>i("img",{src:I},null,-1)),Da=T(()=>i("span",{class:"text"},"MAX 1 IN PARENT",-1)),Ga=[$a,Da],Qa=T(()=>i("img",{src:I},null,-1)),Ma=T(()=>i("span",{class:"text"},"MAX 1 IN CATEGORY",-1)),Ka=[Qa,Ma],Ha=T(()=>i("img",{src:I},null,-1)),za=T(()=>i("span",{class:"text"},"MAX 1 IN FORCE",-1)),Xa=[Ha,za],Wa=T(()=>i("img",{src:I},null,-1)),Ya=T(()=>i("span",{class:"text"},"MAX 1 IN ROSTER",-1)),Ja=[Wa,Ya],Za={class:"column"},ei=T(()=>i("img",{src:I},null,-1)),ti=T(()=>i("span",{class:"text"},"EXACTLY 1 IN PARENT",-1)),ni=[ei,ti],ai=T(()=>i("img",{src:I},null,-1)),ii=T(()=>i("span",{class:"text"},"EXACTLY 1 IN CATEGORY",-1)),oi=[ai,ii],si=T(()=>i("img",{src:I},null,-1)),li=T(()=>i("span",{class:"text"},"EXACTLY 1 IN FORCE",-1)),di=[si,li],ri=T(()=>i("img",{src:I},null,-1)),ui=T(()=>i("span",{class:"text"},"EXACTLY 1 IN ROSTER",-1)),ci=[ri,ui];function gi(t,e,n,d,l,a){return r(),u("fieldset",null,[wa,i("div",Ia,[i("div",Ta,[i("button",{class:"bouton",onClick:e[0]||(e[0]=s=>a.add("min","parent"))},Na),n.withCategory?(r(),u("button",{key:0,class:"bouton",onClick:e[1]||(e[1]=s=>a.add("min","parent"))},Ra)):p("",!0),i("button",{class:"bouton",onClick:e[2]||(e[2]=s=>a.add("min","force"))},Ua),i("button",{class:"bouton",onClick:e[3]||(e[3]=s=>a.add("min","roster"))},qa)]),i("div",ja,[i("button",{class:"bouton",onClick:e[4]||(e[4]=s=>a.add("max","parent"))},Ga),n.withCategory?(r(),u("button",{key:0,class:"bouton",onClick:e[5]||(e[5]=s=>a.add("max","parent"))},Ka)):p("",!0),i("button",{class:"bouton",onClick:e[6]||(e[6]=s=>a.add("max","force"))},Xa),i("button",{class:"bouton",onClick:e[7]||(e[7]=s=>a.add("max","roster"))},Ja)]),i("div",Za,[i("button",{class:"bouton",onClick:e[8]||(e[8]=s=>a.add("exactly","parent"))},ni),n.withCategory?(r(),u("button",{key:0,class:"bouton",onClick:e[9]||(e[9]=s=>a.add("exactly","parent"))},oi)):p("",!0),i("button",{class:"bouton",onClick:e[10]||(e[10]=s=>a.add("exactly","force"))},di),i("button",{class:"bouton",onClick:e[11]||(e[11]=s=>a.add("exactly","roster"))},ci)])])])}const se=f(xa,[["render",gi],["__scopeId","data-v-07f16148"]]),mi={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function hi(t,e,n,d,l,a){const s=F,o=U,g=D,c=X,h=se;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(c,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(h,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const _i=f(mi,[["render",hi]]),pi={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function fi(t,e,n,d,l,a){const s=F,o=U,g=D,c=X,h=se;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(c,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(h,{item:n.item,onCatalogueChanged:a.changed,withCategory:!0,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Ci=f(pi,[["render",fi]]),yi={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{getName:oe,getNameExtra:K,changedType(t,e){this.item.getCatalogue().refreshErrors(this.item),e&&this.catalogue.removeRef(this.item,e),t&&this.catalogue.addRef(this.item,t),this.$emit("catalogueChanged")},changed(){this.$emit("catalogueChanged")}},computed:{profileTypes(){return[...this.catalogue.iterateProfileTypes()]},charactacteristics(){var d;const t={};for(const l of this.item.characteristics||[])t[l.name]=l.$text;if(!this.item.typeId)return[];const e=this.catalogue.findOptionById(this.item.typeId);this.item.isLink()||(this.item.typeName=e==null?void 0:e.name);const n=(d=e==null?void 0:e.characteristicTypes)==null?void 0:d.map(l=>({name:l.name,typeId:l.id,$text:t[l.name]||""}));return this.item.characteristics=n,n}}},bi=i("legend",null,"Characteristics",-1),vi={class:"editorTable"},ki=i("td",null,"Profile Type: ",-1),Ai={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},xi=["src"],wi={class:"inline"},Ii={class:"grey"},Ti={class:"editorTable"};function Pi(t,e,n,d,l,a){const s=Y,o=re;return r(),u("fieldset",null,[bi,i("table",vi,[i("tr",null,[ki,i("td",null,[m(s,{options:a.profileTypes,filterField:g=>g.getName(),valueField:"id",modelValue:n.item.typeId,"onUpdate:modelValue":e[0]||(e[0]=g=>n.item.typeId=g),onChange:a.changedType},{option:x(({option:g})=>[i("div",Ai,[i("img",{class:"mr-1 my-auto",src:`assets/bsicons/${g.editorTypeName}.png`},null,8,xi),i("span",wi,[_(C(a.getName(g))+" ",1),i("span",Ii,C(a.getNameExtra(g)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])])])]),i("table",Ti,[(r(!0),u(k,null,P(a.charactacteristics,g=>(r(),u("tr",null,[i("td",null,C(g.name)+": ",1),i("td",null,[m(o,{modelValue:g.$text,"onUpdate:modelValue":c=>g.$text=c,onChange:a.changed},null,8,["modelValue","onUpdate:modelValue","onChange"])])]))),256))])])}const Fi=f(yi,[["render",Pi]]),Ni={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Si(t,e,n,d,l,a){const s=F,o=U,g=D,c=X,h=Fi;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(c,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(h,{class:"section",item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const Ei=f(Ni,[["render",Si]]),Ri={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Oi=i("legend",null,"Description",-1);function Vi(t,e,n,d,l,a){const s=re;return r(),u("fieldset",null,[Oi,m(s,{modelValue:n.item.description,"onUpdate:modelValue":e[0]||(e[0]=o=>n.item.description=o),onChange:a.changed},null,8,["modelValue","onChange"])])}const Ui=f(Ri,[["render",Vi]]),Li={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Bi(t,e,n,d,l,a){const s=F,o=U,g=D,c=X,h=Ui;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(c,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(h,{class:"section",item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const qi=f(Li,[["render",Bi]]),ji={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{type:{get(){return this.item.subType??this.item.type},set(t){switch(t){case"model":case"upgrade":case"unit":default:this.item.type=t,delete this.item.subType;break;case"mount":case"crew":this.item.type="model",this.item.subType=t;break}}}}},$i={class:"editorTable"},Di=i("td",null,"Type:",-1),Gi=Ne('<option value="model">Model</option><option value="upgrade">Upgrade</option><option value="unit">Unit</option><option value="mount">Mount</option><option value="crew">Crew</option>',5),Qi=[Gi];function Mi(t,e,n,d,l,a){return r(),u("fieldset",null,[i("legend",null,[B(t.$slots,"default")]),i("table",$i,[i("tr",null,[Di,i("td",null,[y(i("select",{"onUpdate:modelValue":e[0]||(e[0]=s=>a.type=s),onChange:e[1]||(e[1]=(...s)=>a.changed&&a.changed(...s))},Qi,544),[[q,a.type]])])])])])}const Ki=f(ji,[["render",Mi]]),Hi={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{placeholder(){return`${this.item.isLink()&&this.item.getDefaultAmount()||"unset"}`}}};const Ve=t=>(N("data-v-202b280a"),t=t(),S(),t),zi=Ve(()=>i("legend",null,"Creation",-1)),Xi={class:"editorTable"},Wi=Ve(()=>i("td",null,"Default Amount:",-1)),Yi=["placeholder"];function Ji(t,e,n,d,l,a){return r(),u("fieldset",null,[zi,i("table",Xi,[i("tr",null,[Wi,i("td",null,[y(i("input",{class:"input",type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>n.item.defaultAmount=s),onChange:e[1]||(e[1]=(...s)=>a.changed&&a.changed(...s)),placeholder:a.placeholder},null,40,Yi),[[w,n.item.defaultAmount]])])])])])}const Ue=f(Hi,[["render",Ji],["__scopeId","data-v-202b280a"]]),Zi={props:{modelValue:{type:[Number,String]},required:{type:Boolean,required:!1},min:{type:Number,required:!1},max:{type:Number,required:!1}},data(){return{stringValue:null,intValue:0}},watch:{modelValue(){this.refresh()}},created(){this.refresh()},methods:{refresh(){this.intValue=this.modelValue||0,this.stringValue=""+this.modelValue},update(){this.stringValue!=null&&(this.intValue=parseFloat(this.stringValue),this.$emit("update:modelValue",this.intValue),this.$emit("change"))}}},eo=["required","min","max"];function to(t,e,n,d,l,a){return y((r(),u("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>l.stringValue=s),type:"number",onChange:e[1]||(e[1]=(...s)=>a.update&&a.update(...s)),required:n.required,min:n.min,max:n.max},null,40,eo)),[[w,l.stringValue]])}const J=f(Zi,[["render",to]]),no={emits:["catalogueChanged"],data(){return{selectedCosts:{}}},created(){this.update()},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{costTypes(){let t=[];for(let e of this.catalogue.iterateCostTypes())t.push(e);return t}},methods:{changed(){this.item.costs=Object.values(this.selectedCosts).filter(t=>isFinite(t.value)),this.$emit("catalogueChanged")},update(){this.selectedCosts={};const t=this.item.isLink()?void 0:0;for(let e of Object.values(this.costTypes))this.selectedCosts[e.id]={name:e.name,typeId:e.id,value:t};if(this.item.costs)for(let e of this.item.costs)this.selectedCosts[e.typeId]={name:e.name,typeId:e.typeId,value:e.value}}},watch:{item(){this.update()}}},ao="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAPCAYAAADtc08vAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV9bi1IqIu0g4pChumhBVMRRq1CECqFWaNXB5NIvaNKQpLg4Cq4FBz8Wqw4uzro6uAqC4AeIq4uToouU+L+k0CLGg+N+vLv3uHsH+BsVpppd44CqWUY6mRCyuVWh+xVBhNCPUUQkZupzopiC5/i6h4+vd3Ge5X3uz9Gr5E0G+ATiWaYbFvEG8fSmpXPeJ46ykqQQnxOPGXRB4keuyy6/cS467OeZUSOTnieOEgvFDpY7mJUMlXiKOKaoGuX7sy4rnLc4q5Uaa92TvzCc11aWuU5zCEksYgkiBMiooYwKLMRp1Ugxkab9hId/0PGL5JLJVQYjxwKqUCE5fvA/+N2tWZiccJPCCSD4Ytsfw0D3LtCs2/b3sW03T4DAM3Cltf3VBjDzSXq9rcWOgL5t4OK6rcl7wOUOMPCkS4bkSAGa/kIBeD+jb8oBkVsgtOb21trH6QOQoa5SN8DBITBSpOx1j3f3dPb275lWfz9cmHKeGGO3IgAAAAZiS0dEAAAAAAAA+UO7fwAAAAlwSFlzAAAuIwAALiMBeKU/dgAAAAd0SU1FB+cFChEuDQiaUlgAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAACRElEQVQoz52Sz0tUURiGn3vvuTqNdU3noiiYZYQgSgYGhiFCRAYWUYFGf0GL/A9atwnaVBtrmWZllouSJAlqEVmLcuGi0JiZmh+W5jRzdeacc2+LscGplX1wFud7z/vwfh/HePpkLNjI/OB/KuREEOs/lzlzbgjty22ZLdPm8cQ9hO8HSJVnavzutgCnBy/i+wHC9zVaKVpaWqipqys9WE6liC4t4TgO+1tbMS2rpK2m02il8H2NqbVCaYXWGqe2tnRezs4ipSQcDjMzPV2maa03PQpTa42SEqUU6WSSZ48mSSeTmIZJc3MzpmmS/ZUt05RSKCnRWiOULCaQUrKrupq+k/3FJdkCz/OIRqNkc9kybTkeR2mFkgqhtUKpIm05kSjN2dvXR3J+lAP1Idr21vJ1fhxUhgojQ/67gVIH0Voh/sRfXFykauE+DU0u2tiBl8tTyMQ4OjhMIZcjGVvADgq47k6mJj6WxhCe52GaBscGBoi/jdPTf6JkyK34zM/Nkc8XSCdiVAqIuA772nswTQPP8xAFM8zIjVsAVHifqNzdhNY+2TWPencPHYc7ikC3EjtYwXUFd26/IPVqjXCkEdF76gKpxDeklHx+fp2u7rbNBBvElqK8e2OVgJZhE0/bhBqPcKjjPPUNjRhbf9fNa1eCiBXFDoURlk3sS5xLw2e37KCYYGR0lctXJw0AsRXQdXyITGaNICje88mHPBibwQ5VISyB2jCQ6ymMmk5gEqA8wd/1+v2HwMvl/uk7jkN3Z7sB8BurPj/243CaIgAAAABJRU5ErkJggg==";const io=t=>(N("data-v-e81b0337"),t=t(),S(),t),oo=io(()=>i("legend",null,[i("img",{src:ao}),_(" Costs")],-1)),so={class:"costs"};function lo(t,e,n,d,l,a){const s=J;return r(),u("fieldset",null,[oo,i("div",so,[(r(!0),u(k,null,P(a.costTypes,o=>(r(),u("div",null,[i("label",null,C(o.name)+": ",1),l.selectedCosts[o.id]!=null?(r(),v(s,{key:0,modelValue:l.selectedCosts[o.id].value,"onUpdate:modelValue":g=>l.selectedCosts[o.id].value=g,class:"input",onChange:a.changed,placeholder:"unset"},null,8,["modelValue","onUpdate:modelValue","onChange"])):p("",!0)]))),256))])])}const Le=f(no,[["render",lo],["__scopeId","data-v-e81b0337"]]),ro={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{fields(){return[{name:"Hidden",status:this.hidden,field:"hidden"},{name:"Collective",status:this.collective,field:"collective",title:"indicates that multiple instances of this entry may be combined into one entry with an amount"},{name:"Import",status:this.eimport,field:"import",title:"Indicates that this entry may be imported by other catalogues"},{name:"No children sort",status:this.alphasort,field:"noAlphabeticalSort",title:"Children are sorted by type (groups last) and alphabetically. This will have entries sorted in the roster builder in the same order as they are in the editor"}]},hidden(){return!0},alphasort(){switch(this.item.editorTypeName){case"selectionEntry":return 1;case"selectionEntryGroup":return 1}},collective(){var t;if((t=this.item.parent)!=null&&t.isCatalogue()){const e=this.item.parentKey;if(e==="selectionEntries"||e==="entryLinks")return 0}switch(this.item.editorTypeName){case"selectionEntryLink":return 1;case"selectionEntryGroupLink":return 1;case"selectionEntry":return 1;case"selectionEntryGroup":return 1;case"categoryLink":return-1;case"infoLink":return-1;case"profileLink":return-1;case"ruleLink":return-1;case"infoGroupLink":return-1}return 1},eimport(){var t;if((t=this.item.parent)!=null&&t.isCatalogue())return 1;switch(this.item.editorTypeName){case"selectionEntryLink":return 0;case"selectionEntryGroupLink":return 0;case"selectionEntry":return 0;case"selectionEntryGroup":return 0;case"categoryLink":return-1;case"infoLink":return-1;case"profileLink":return-1;case"ruleLink":return-1;case"infoGroupLink":return-1}return 0}}};const uo={class:"booleans"},co=["id","onUpdate:modelValue","disabled"],go=["for","title"];function mo(t,e,n,d,l,a){return r(),u("fieldset",null,[i("legend",null,[B(t.$slots,"default",{},void 0,!0)]),i("div",uo,[(r(!0),u(k,null,P(a.fields.filter(s=>s.status!=-1),s=>(r(),u("div",null,[y(i("input",{class:E({"cursor-pointer":s.status!==0}),id:s.field,type:"checkbox","onUpdate:modelValue":o=>n.item[s.field]=o,onChange:e[0]||(e[0]=(...o)=>a.changed&&a.changed(...o)),disabled:s.status==0},null,42,co),[[O,n.item[s.field]]]),i("label",{class:E({"cursor-pointer":s.status!==0,gray:s.status==0,hastooltip:!!s.title}),for:s.field,title:s.title},C(s.name),11,go)]))),256))])])}const ke=f(ro,[["render",mo],["__scopeId","data-v-7bfa8ea2"]]),ho={},_o={"aria-hidden":"true",height:"16",viewBox:"0 0 16 16",version:"1.1",width:"16","data-view-component":"true",class:"octicon octicon-tag"},po=i("path",{d:"M1 7.775V2.75C1 1.784 1.784 1 2.75 1h5.025c.464 0 .91.184 1.238.513l6.25 6.25a1.75 1.75 0 0 1 0 2.474l-5.026 5.026a1.75 1.75 0 0 1-2.474 0l-6.25-6.25A1.752 1.752 0 0 1 1 7.775Zm1.5 0c0 .066.026.13.073.177l6.25 6.25a.25.25 0 0 0 .354 0l5.025-5.025a.25.25 0 0 0 0-.354l-6.25-6.25a.25.25 0 0 0-.177-.073H2.75a.25.25 0 0 0-.25.25ZM6 5a1 1 0 1 1 0 2 1 1 0 0 1 0-2Z"},null,-1),fo=[po];function Co(t,e){return r(),u("svg",_o,fo)}const Be=f(ho,[["render",Co]]),yo={props:{modelValue:String,placeholder:{type:String,default:"Search..."},min:{type:Number,default:0},max:{type:Number,default:1e3},options:{type:[Array,Function],required:!0},filterField:{type:[String,Function],default:""},lazy:{type:Boolean,default:!1},focus:{type:Boolean,default:!1},nullable:{type:Boolean,default:!1},always:{type:Boolean,default:!1}},created(){this.lazy||this.reset()},data(){return{searchPattern:"",selected:0,lastSearch:null,editing:!1,sleeping:this.lazy,bounce:!1}},computed:{boundedSelected(){return Te(this.selected,0,this.always?this.foundOptions.length:this.foundOptions.length-1)},computedOptions(){return Array.isArray(this.options)?this.options:this.sleeping?[]:this.options()},foundOptions(){const t=this.textSearchRegex(this.searchPattern),e=[];this.nullable&&e.push({option:void 0});const n=this.computedOptions,d=this.max||n.length;for(let l=0;l<n.length;l++){const a=n[l];let s=this.getField(a);if(s&&s.match&&s.match(t)&&(e.push({option:a}),e.length>=d-1))break}return e}},methods:{fix(t){return Te(t,0,this.always?this.foundOptions.length:this.foundOptions.length-1)},blur(){this.editing=!1,this.$emit("blur")},onUp(){this.selected=this.fix(this.selected-1),this.$nextTick(()=>{const t=this.$refs.suggestions.getElementsByClassName("selected")[0];t==null||t.scrollIntoView({block:"nearest",inline:"center"})})},onDown(){this.selected=this.fix(this.selected+1),this.$nextTick(()=>{const t=this.$refs.suggestions.getElementsByClassName("selected")[0];t==null||t.scrollIntoView({block:"nearest",inline:"center"})})},onEnter(){this.bounce||(this.bounce=!0,this.always&&this.selected===this.foundOptions.length?this.$emit("always",this.searchPattern):this.targetSelected(this.foundOptions[this.boundedSelected]),this.reset())},onEnterUp(){this.bounce=!1},getField(t){return this.filterField?this.filterField instanceof Function?this.filterField(t):t[this.filterField]:t},escapeRegex(t){return t.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},textSearchRegex(t){const n=`^(?=.*\\b${this.escapeRegex(t).split(" ").join(".*)(?=.*\\b")}).*$`;return new RegExp(n,"i")},targetSelected(t){console.log("selected",t),this.$emit("add",t.option)},targetSelectedRightClick(t,e){t.preventDefault(),t.stopPropagation(),console.log("selected (right click)",e),this.$emit("add-special",e.option)},reset(){this.searchPattern=""},onClickOutside(){this.blur()},suggest(){this.searchPattern.length<this.min?this.editing=!1:this.startEditing()},maySuggest(){this.sleeping=!1,this.searchPattern="",this.min==0&&this.suggest()},startEditing(){this.editing||(this.sleeping=!1,this.editing=!0,this.searchPattern="")}},mounted(){this.focus&&setTimeout(()=>{var t;(t=this.$refs.edit)==null||t.focus(),this.startEditing()},0)},watch:{options(){this.lazy||this.reset()},searchPattern(t,e){(t??"")!==(e??"")&&(this.selected=0,this.$emit("update:modelValue",t),this.$emit("change"))},modelValue:{immediate:!0,handler(t){this.searchPattern=t??""}},async editing(){this.editing&&(await this.$nextTick(),this.$refs.edit&&this.$refs.edit.focus())}}};const bo=t=>(N("data-v-e16f99ab"),t=t(),S(),t),vo=["placeholder"],ko={class:"gray"},Ao=bo(()=>i("span",{class:"float-right bold"},"+",-1)),xo=["onClickCapture","onContextmenuCapture"],wo=["onClick","onContextmenu"];function Io(t,e,n,d,l,a){const s=be("click-outside");return r(),u("div",{class:"autocomplete relative",onKeydown:[e[7]||(e[7]=ae(R((...o)=>a.onDown&&a.onDown(...o),["prevent"]),["down"])),e[8]||(e[8]=ae(R((...o)=>a.onUp&&a.onUp(...o),["prevent"]),["up"])),e[9]||(e[9]=ae(R((...o)=>a.onEnter&&a.onEnter(...o),["prevent"]),["enter"])),e[11]||(e[11]=ae(o=>a.blur(),["escape"]))],onKeyup:e[10]||(e[10]=ae(R((...o)=>a.onEnterUp&&a.onEnterUp(...o),["prevent"]),["enter"]))},[l.editing?y((r(),u("input",{key:0,class:"input autocomplete-input",type:"text",ref:"edit",autofocus:"",onInput:e[0]||(e[0]=(...o)=>a.suggest&&a.suggest(...o)),onClick:e[1]||(e[1]=(...o)=>a.maySuggest&&a.maySuggest(...o)),onFocus:e[2]||(e[2]=(...o)=>a.startEditing&&a.startEditing(...o)),"onUpdate:modelValue":e[3]||(e[3]=o=>l.searchPattern=o),placeholder:n.placeholder},null,40,vo)),[[w,l.searchPattern],[s,a.onClickOutside]]):(r(),u("div",{key:1,onClick:e[4]||(e[4]=(...o)=>a.startEditing&&a.startEditing(...o)),class:"autocomplete-input"},[i("span",ko,C(n.placeholder),1),Ao])),y(i("div",{class:E(["suggestions",{hidden:!l.editing}]),ref:"suggestions"},[(r(!0),u(k,null,P(a.foundOptions,(o,g)=>(r(),u(k,null,[g===a.boundedSelected?(r(),u("div",{key:0,class:"suggestion selected",onClickCapture:R(c=>a.targetSelected(o),["stop"]),onContextmenuCapture:c=>a.targetSelectedRightClick(c,o)},[B(t.$slots,"option",M(Z({...o,selected:!0})),void 0,!0)],40,xo)):(r(),u("div",{key:1,class:"suggestion",onClick:R(c=>a.targetSelected(o),["stop"]),onContextmenu:R(c=>a.targetSelectedRightClick(c,o),["prevent"])},[B(t.$slots,"option",M(Z(o)),void 0,!0)],40,wo))],64))),256)),n.always?(r(),u("div",{key:0,class:E(["suggestion",{selected:l.selected===a.foundOptions.length}]),onClick:e[5]||(e[5]=o=>t.$emit("always",l.searchPattern)),onContextmenu:e[6]||(e[6]=R(o=>t.$emit("always-special",l.searchPattern),["prevent"]))},[B(t.$slots,"always",M(Z({input:l.searchPattern})),void 0,!0)],34)):p("",!0)],2),[[it,l.editing]])],32)}const To=f(yo,[["render",Io],["__scopeId","data-v-e16f99ab"]]),Po=te({components:{AutocompleteTags:To,Tag:Be,ContextMenu:Ee},props:{item:{type:Object,required:!0}},data(){return{input:"",adding:!1,contextmenuopen:!1,selectedCategory:null,selectedCategoryParent:null}},setup(){return{store:j(),settings:Se()}},computed:{catalogue(){return this.item.catalogue},targetCategories(){var t;return(((t=this.item.target)==null?void 0:t.categoryLinks)||[]).filter(e=>!e.primary)},ownCategories(){return(this.item.categoryLinks||[]).filter(t=>!t.primary)},targetPrimaryCategories(){var t;return(((t=this.item.target)==null?void 0:t.categoryLinks)||[]).filter(e=>e.primary)},ownPrimaryCategories(){return(this.item.categoryLinks||[]).filter(t=>t.primary)}},methods:{getNameExtra:K,makePrimary(t,e){var n;(n=e.categoryLinks)==null||n.forEach(d=>d.primary=!1),t.primary=!0},makeSecondary(t){t.primary=!1},context(t,e){this.contextmenuopen=!0,this.selectedCategory=e,this.selectedCategoryParent=this.item,this.$nextTick(()=>{var n;(n=this.$refs.contextmenu)==null||n.show(t)})},linked_context(t,e){if(!this.item.target){console.error("Cant open context menu for a category on the target: Couldn't find target");return}this.contextmenuopen=!0,this.selectedCategory=e,this.selectedCategoryParent=this.item.target,this.$nextTick(()=>{var n;(n=this.$refs.contextmenu)==null||n.show(t)})},refreshCategories(t,e,n){t.categoryLinks||(t.categoryLinks=[]);const d=t.categoryLinks;if(n&&d.forEach(l=>l.primary=!1),e){const l=d.find(a=>a.targetId===(e==null?void 0:e.id));l&&n?l.primary=!0:l?this.removeLink(d,l):this.addLink(d,e,n)}},removeLink(t,e){const n=t.findIndex(d=>d===e);if(n!==-1){const[d]=t.splice(n,1);this.catalogue.removeFromIndex(d);const l=d.target.links;if(l){const a=l==null?void 0:l.findIndex(s=>s===d);a!==-1&&(l==null||l.splice(a,1))}}},addLink(t,e,n=!1){var a;if(!e.isCategory())throw Error("Invalid argument, target must be a category");const d=Re({targetId:e.id,target:e,id:this.item.catalogue.generateNonConflictingId(),primary:n,catalogue:this.item.catalogue,name:e.name},"categoryLinks");t.push(d),this.catalogue.addToIndex(d);const l=e;return l.links||(l.links=[]),(a=l.links)==null||a.push(d),d},allCategories(){const t=new Set;for(const n of this.item.categoryLinks||[])t.add(n.getId());const e=[];for(const n of this.item.catalogue.iterateCategoryEntries())t.has(n.getId())||e.push(n);return e},addCategory(t){this.item.categoryLinks||(this.item.categoryLinks=[]);const e=this.item.categoryLinks,n=e.find(d=>d.targetId===t.getId());return n||this.addLink(e,t,!1)},addCategoryAndMakePrimary(t){const e=this.addCategory(t);this.makePrimary(e,this.item)},removeCategory(t){this.item.categoryLinks||(this.item.categoryLinks=[]);const e=this.item.categoryLinks,n=e.find(d=>d.targetId===t.getId());n&&this.removeLink(e,n)},async createCategory(t,e=!1){var s;const n=this.item.catalogue,d="categoryEntries",l={...this.store.get_initial_object(d,n),name:t,id:ye()};await this.store.add(l,d,n);const a=(s=this.item.catalogue.categoryEntries)==null?void 0:s.find(o=>o.name===t);if(a)return e?this.addCategoryAndMakePrimary(a):this.addCategory(a)},async createPrimaryCategory(t){await this.createCategory(t,!0)},gotoCategory(t){const e=this.catalogue.findOptionById(t.id);e&&this.store.goto(e)}}});const ue=t=>(N("data-v-5b8b2533"),t=t(),S(),t),Fo=["onContextmenu"],No=ue(()=>i("span",{class:"primary bold"}," Primary ",-1)),So={class:"name"},Eo=["onClick"],Ro=["onContextmenu"],Oo={class:"name"},Vo=["onClick"],Uo={key:1,class:"gray"},Lo={class:"py-1px rounded-8px bg-lime-400"},Bo={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},qo={class:"gray"},jo={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},$o=ue(()=>i("span",null,"Create: ",-1)),Do={key:0,class:"align-top mt-4px"},Go=ue(()=>i("img",{src:Oe},null,-1)),Qo=["onContextmenu"],Mo=ue(()=>i("span",{class:"primary bold"}," Primary ",-1)),Ko={class:"name"},Ho=["onClick"],zo=["onContextmenu"],Xo={class:"name"},Wo=["onClick"],Yo={class:"gray"};function Jo(t,e,n,d,l,a){var c,h;const s=V("Tag"),o=V("AutocompleteTags"),g=V("ContextMenu");return r(),u("div",{class:E({dark:t.settings.isDarkTheme})},[i("div",null,[(c=t.ownCategories)!=null&&c.length||(h=t.ownPrimaryCategories)!=null&&h.length?(r(),u(k,{key:0},[(r(!0),u(k,null,P(t.ownPrimaryCategories,b=>(r(),u("div",{class:"label hover-brighten",onContextmenu:R(A=>t.context(A,b),["stop"])},[No,i("span",So,C(b.getName()),1),i("span",{class:"cursor-pointer hover-darken px-5px rounded-8px",onClick:A=>t.removeCategory(b)},"Ã—",8,Eo)],40,Fo))),256)),(r(!0),u(k,null,P(t.ownCategories,b=>(r(),u("div",{class:"label",onContextmenu:R(A=>t.context(A,b),["stop"])},[i("span",Oo,C(b.getName()),1),i("span",{class:"cursor-pointer hover-darken px-5px rounded-8px",onClick:A=>t.removeCategory(b)},"Ã—",8,Vo)],40,Ro))),256))],64)):(r(),u("span",Uo," None ")),i("span",Lo,[t.adding?p("",!0):(r(),u("span",{key:0,class:"px-5px py-1px rounded-8px cursor-pointer hover-darken",onClick:e[0]||(e[0]=b=>t.adding=!0),style:ot({color:t.settings.isDarkTheme?"black":"white"})},"+",4))]),t.adding?(r(),v(o,{key:2,modelValue:t.input,"onUpdate:modelValue":e[1]||(e[1]=b=>t.input=b),onBlur:e[2]||(e[2]=b=>t.adding=!1),focus:"",class:"inline-block",lazy:"",always:!!t.input.trim()&&!t.allCategories().find(b=>b.name===t.input),options:t.allCategories,dark:t.settings.isDarkTheme,placeholder:"Search... (Right click = Primary)",filterField:b=>b.getName(),onAdd:t.addCategory,onAddSpecial:t.addCategoryAndMakePrimary,onAlways:t.createCategory,onAlwaysSpecial:t.createPrimaryCategory},{option:x(({option:b,selected:A})=>[i("div",Bo,[b!=null&&b.name?(r(),u(k,{key:0},[m(s,{class:"icon"}),i("span",null,[_("Â "+C(b.name),1),i("span",qo," ["+C(b.catalogue.name)+"]",1)])],64)):p("",!0)])]),always:x(({input:b})=>[i("div",jo,[$o,_("Â  "),m(s,{class:"icon"}),i("span",null,"Â "+C(b),1)])]),_:1},8,["modelValue","always","options","dark","filterField","onAdd","onAddSpecial","onAlways","onAlwaysSpecial"])):p("",!0)]),t.targetCategories.length||t.targetPrimaryCategories.length?(r(),u("div",Do,[Go,_(" From Target: "),(r(!0),u(k,null,P(t.targetPrimaryCategories,b=>(r(),u("span",{class:"label",onContextmenu:R(A=>t.linked_context(A,b),["stop"])},[Mo,i("span",Ko,C(b.getName()),1),_("Â "),i("span",{class:"cursor-pointer hover-darken px-3px rounded-2px",onClick:A=>t.removeCategory(b)},"Ã—",8,Ho)],40,Qo))),256)),(r(!0),u(k,null,P(t.targetCategories,b=>(r(),u("span",{class:"label",onContextmenu:R(A=>t.linked_context(A,b),["stop"])},[i("span",Xo,C(b.getName()),1),_("Â "),i("span",{class:"cursor-pointer hover-darken px-3px rounded-2px",onClick:A=>t.removeCategory(b)},"Ã—",8,Wo)],40,zo))),256))])):p("",!0),t.contextmenuopen&&t.selectedCategory&&t.selectedCategoryParent?(r(),v(g,{key:1,modelValue:t.contextmenuopen,"onUpdate:modelValue":e[6]||(e[6]=b=>t.contextmenuopen=b),ref:"contextmenu"},{default:x(()=>{var b;return[t.selectedCategory.primary?p("",!0):(r(),u("div",{key:0,onClick:e[3]||(e[3]=A=>t.makePrimary(t.selectedCategory,t.selectedCategoryParent))}," Make Primary: "+C(t.selectedCategory.getName()),1)),t.selectedCategory.primary?(r(),u("div",{key:1,onClick:e[4]||(e[4]=A=>t.makeSecondary(t.selectedCategory))}," Make Secondary: "+C(t.selectedCategory.getName()),1)):p("",!0),i("div",{onClick:e[5]||(e[5]=A=>t.gotoCategory(t.selectedCategory))},[_(" Goto "+C(t.selectedCategory.getName())+" ",1),i("span",Yo," Â ("+C((b=t.selectedCategory.catalogue)==null?void 0:b.getName())+") ",1)])]}),_:1},8,["modelValue"])):p("",!0)],2)}const Zo=f(Po,[["render",Jo],["__scopeId","data-v-5b8b2533"]]),es=te({props:{category:{required:!0,type:Object},item:{type:Object,required:!0}},setup(){return{store:j()}},data(){return{contextmenuopen:!1}},methods:{menu(t){return{show:(e,n)=>{this.contextmenuopen=!0,this.$nextTick(()=>{var d;(d=this.$refs[t])==null||d.show(e,n)})},close:(e,n)=>{var d;(d=this.$refs[t])==null||d.close(e,n),this.contextmenuopen=!1}}},hasCategory(t){var n;let e=(n=this.item.categoryLinks)==null?void 0:n.find(d=>{var l;return((l=d.target)==null?void 0:l.id)===t.id});return e?e.primary?2:1:0}},computed:{contextmenu(){return this.menu("contextmenu")}},components:{ContextMenu:Ee}});const ts=["checked"],ns=["id","checked"],as=["for"],is={class:"gray"},os={class:"gray"};function ss(t,e,n,d,l,a){const s=V("ContextMenu");return r(),u("div",{class:"category",onContextmenu:e[4]||(e[4]=R((...o)=>t.contextmenu.show&&t.contextmenu.show(...o),["stop"]))},[i("div",null,[i("input",{name:"primary",type:"radio",checked:t.hasCategory(t.category)==2,onChange:e[0]||(e[0]=o=>t.$emit("primaryChanged",t.category))},null,40,ts),_(" Primary? ")]),i("div",null,[i("input",{id:`category-${t.category.id}`,type:"checkbox",checked:t.hasCategory(t.category)!=0,onChange:e[1]||(e[1]=o=>t.$emit("secondaryChanged",t.category))},null,40,ns),i("label",{for:`category-${t.category.id}`},[_(C(t.category.name),1),i("span",is," ["+C(t.category.catalogue.name)+"]",1)],8,as)]),t.contextmenuopen?(r(),v(s,{key:0,modelValue:t.contextmenuopen,"onUpdate:modelValue":e[3]||(e[3]=o=>t.contextmenuopen=o),ref:"contextmenu"},{default:x(()=>{var o;return[i("div",{onClick:e[2]||(e[2]=g=>t.store.goto(t.category))},[_(" Goto "+C(t.category.getName())+" ",1),i("span",os," Â ("+C((o=t.category.catalogue)==null?void 0:o.getName())+") ",1)])]}),_:1},8,["modelValue"])):p("",!0)],32)}const ls=f(es,[["render",ss]]),ds={components:{Category:ls,Tag:Be},emits:["catalogueChanged"],data(){return{filter:"",primaries:new Set,secondaries:new Set}},setup(){return{settings:Se()}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{hasCategory(t){var n;let e=(n=this.item.categoryLinks)==null?void 0:n.find(d=>{var l;return((l=d.target)==null?void 0:l.id)===t.id});return e?e.primary?2:1:0},primaryChanged(t){this.refreshCategories(this.item,t,!0)},secondaryChanged(t){this.refreshCategories(this.item,t,!1)},refreshCategories(t,e,n){t.categoryLinks||(t.categoryLinks=[]);const d=t.categoryLinks;if(n&&d.forEach(l=>l.primary=!1),e){const l=d.find(a=>a.targetId===(e==null?void 0:e.id));l&&n?l.primary=!0:l?this.removeLink(d,l):this.addLink(d,e,n)}this.changed()},removeLink(t,e){const n=t.findIndex(d=>d===e);if(n!==-1){const[d]=t.splice(n,1);this.catalogue.removeFromIndex(d);const l=d.target.links;if(l){const a=l==null?void 0:l.findIndex(s=>s===d);a!==-1&&(l==null||l.splice(a,1))}}},addLink(t,e,n=!1){var a;if(!e.isCategory())throw Error("Invalid argument, target must be a category");const d=Re({targetId:e.id,target:e,id:this.catalogue.generateNonConflictingId(),primary:n,catalogue:this.catalogue,name:e.name},"categoryLinks");t.push(d),this.catalogue.addToIndex(d);const l=e;return l.links||(l.links=[]),(a=l.links)==null||a.push(d),d},changed(){this.$emit("catalogueChanged")},noPrimary(){let t=!0;if(this.item.categoryLinks){for(let e of this.item.categoryLinks)if(e.primary)return!1}return t}},computed:{badLinks(){const t=[],e=new Set;for(const n of this.catalogue.iterateCategoryEntries())e.add(n.id);for(const n of this.item.categoryLinks||[])e.has(n.targetId)||t.push(n);return t},count(){var t;return((t=this.item.categoryLinks)==null?void 0:t.length)||0},categories(){let t=[];for(let e of this.catalogue.iterateCategoryEntries())this.settings.showOnlyEnabledCategories&&this.hasCategory(e)==0||e.getName().toLowerCase().includes(this.filter.toLowerCase())&&t.push(e);return t}}};const rs=t=>(N("data-v-b6400f51"),t=t(),S(),t),us={class:"inline"},cs={class:"section inline"},gs=rs(()=>i("label",{for:"onlyEnabled"},"Only show selected categories",-1)),ms={class:"section categoryList"},hs=["checked"],_s=["checked","onChange"],ps=["id","onChange"],fs=["for"];function Cs(t,e,n,d,l,a){const s=V("Tag"),o=Zo,g=V("Category"),c=ve;return r(),u("fieldset",null,[i("legend",null,[i("div",us,[m(s,{class:"icon"})]),_(" Categories ("+C(a.count)+") ",1)]),d.settings.useNewCategoriesUI?(r(),v(o,{key:0,item:n.item},null,8,["item"])):(r(),u(k,{key:1},[y(i("input",{class:"section",type:"text","onUpdate:modelValue":e[0]||(e[0]=h=>l.filter=h),placeholder:"Filter categories..."},null,512),[[w,l.filter]]),i("div",cs,[y(i("input",{type:"checkbox",id:"onlyEnabled","onUpdate:modelValue":e[1]||(e[1]=h=>d.settings.showOnlyEnabledCategories=h)},null,512),[[O,d.settings.showOnlyEnabledCategories]]),gs]),i("div",ms,[i("div",null,[i("input",{name:"primary",type:"radio",checked:a.noPrimary,onChange:e[2]||(e[2]=h=>a.primaryChanged(null))},null,40,hs),_(" No Primary ")]),(r(!0),u(k,null,P(a.categories,h=>(r(),v(g,{category:h,item:n.item,key:h.id,onPrimaryChanged:a.primaryChanged,onSecondaryChanged:a.secondaryChanged},null,8,["category","item","onPrimaryChanged","onSecondaryChanged"]))),128)),(r(!0),u(k,null,P(a.badLinks,h=>(r(),u("div",{class:"category",key:h.id},[i("div",null,[i("input",{name:"primary",type:"radio",checked:a.hasCategory(h)==2,onChange:b=>a.primaryChanged(h)},null,40,_s),_(" Primary? ")]),i("div",null,[i("input",{id:`bad${h.id}`,type:"checkbox",checked:!0,onChange:b=>a.removeLink(n.item.categoryLinks,h)},null,40,ps),i("label",{for:`bad${h.id}`},C(h.name),9,fs),m(c,{class:"ml-5px inline",errors:[{msg:`Couldn't find category with id: ${h.targetId}`,severity:"error"}]},null,8,["errors"])])]))),128))])],64))])}const Ae=f(ds,[["render",Cs],["__scopeId","data-v-b6400f51"]]),ys={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function bs(t,e,n,d,l,a){const s=F,o=U,g=D,c=Ki,h=Ue,b=Le,A=ke,H=Ae,Q=se;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(c,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Selection Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(h,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(b,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(A,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(H,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(Q,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const vs=f(ys,[["render",bs]]),ks={setup(){return{store:j()}},emits:["catalogueChanged"],data(){return{filter:"",val:null}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},type:{type:String,required:!0}},computed:{allowEntries(){return!0},allowGroups(){var t;return!((t=this.item.parent)!=null&&t.isCatalogue()&&this.item.parentKey==="entryLinks")}},methods:{getNameExtra:K,availableTargets(){if(this.type==="catalogue"){const e=this.catalogue.gameSystemId||this.catalogue.id;return Object.values(this.store.get_system(e).catalogueFiles).map(l=>({id:l.catalogue.id,name:l.catalogue.name,editorTypeName:"catalogueLink"})).filter(l=>l.id!==this.catalogue.id)}const t=[];for(const e of this.catalogue.iterateAllImported())this.targetIsValid(e)&&(e.isLink()||t.push(e));return ie(t,e=>e.name)},typeChanged(){},targetIdChanged(){this.updateLink(),this.changed()},async updateLink(){var t;if(this.type==="catalogue"&&this.item.targetId){const e=this.catalogue.gameSystemId||this.catalogue.id;await this.catalogue.reload(this.store.get_system(e));const n=this.item.target;this.item.name=((t=this.item.target)==null?void 0:t.name)||"Unknown",this.item.type=(n==null?void 0:n.editorTypeName)||this.type}else{this.catalogue.updateLink(this.item);const e=this.item.target;this.item.name=(e==null?void 0:e.name)||"Unknown",this.item.type=(e==null?void 0:e.editorTypeName)||this.item.type}},changedImportRootEntries(){this.changed()},changed(){this.$emit("catalogueChanged")},getType(t){return t.target?t.target.editorTypeName:"bullet"},itemName(t){return t.name},itemValue(t){return t.name},targetIsValid(t){return this.item.type==null||this.item.type==="category"?t.editorTypeName=="category":t.editorTypeName==this.item.type},showCatalogue(t){var e;return!(!t.catalogue||t.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))}}},qe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAFKSURBVDhPpZLBSgJRFIbvuTtHXyBaWEG0TRxFCAJd9B6B4CLoXaKVLVr4FK3GTRGEMwvXYYPQI1TQ4D2d/3gVnEFh7IPBc37mHD2/P5kcH63WuVssBmxMT9pjaESUOmPGhnl4miQJtBXrBfNOp/KbZXdS9kUsLAaylGXJY4Xo9jCOv6Hpi374SZpL9CuOosgYa03a7cqojHsc80tAdIUlFgK+OT8MbK2mTx5LdPHDfK81bpbPPppSEF2/NxqhhWHbbt6FzhANrHd7L2RJDx7oX7UndTXxP4ihlPq6NHL+3Drnxr4vMGu3zSwMNzKQI7Li5FATVh5eED1YzbbE04sbnEwm+mxhdBbHb2oiss3Mzyp7bLXqq2Uic7wGWXaDYh2gz2Yz0HhKwnYEC6eOMHwwnX5BKLyIeCJhCIm0dWjqthiWyc342dCWGPMHCdh2fZxOhd0AAAAASUVORK5CYII=";const L=t=>(N("data-v-130fa048"),t=t(),S(),t),As=L(()=>i("legend",null,[i("img",{src:Oe}),_(" Link")],-1)),xs={class:"editorTable"},ws={key:0},Is=L(()=>i("td",null,"Link Type:",-1)),Ts={key:0,value:"selectionEntry"},Ps={key:1,value:"selectionEntryGroup"},Fs={key:1},Ns=L(()=>i("td",null,"Link Type:",-1)),Ss=L(()=>i("option",{value:"profile"},"Profile",-1)),Es=L(()=>i("option",{value:"rule"}," Rule ",-1)),Rs=L(()=>i("option",{value:"infoGroup"}," Info Group ",-1)),Os=[Ss,Es,Rs],Vs=L(()=>i("td",null,"Link To:",-1)),Us=["src"],Ls=L(()=>i("img",{class:"errIcon",src:qe},null,-1)),Bs=L(()=>i("td",null,"Target ID:",-1)),qs=L(()=>i("td",null,"Target:",-1)),js={style:{"white-space":"nowrap"}},$s=["src"],Ds={class:"gray"},Gs={key:0,class:"shared"},Qs={key:1,class:"catalogueName"},Ms={key:2},Ks=L(()=>i("td",null,null,-1)),Hs=L(()=>i("label",{for:"importRoot"},"Import Root Entries",-1));function zs(t,e,n,d,l,a){const s=Y;return r(),u("fieldset",null,[As,i("table",xs,[n.type=="entry"?(r(),u("tr",ws,[Is,i("td",null,[y(i("select",{onChange:e[0]||(e[0]=(...o)=>a.typeChanged&&a.typeChanged(...o)),"onUpdate:modelValue":e[1]||(e[1]=o=>n.item.type=o)},[a.allowEntries?(r(),u("option",Ts,"Selection Entry")):p("",!0),a.allowGroups?(r(),u("option",Ps," Selection Entry Group ")):p("",!0)],544),[[q,n.item.type]])])])):p("",!0),n.type=="info"?(r(),u("tr",Fs,[Ns,i("td",null,[y(i("select",{onChange:e[2]||(e[2]=(...o)=>a.typeChanged&&a.typeChanged(...o)),"onUpdate:modelValue":e[3]||(e[3]=o=>n.item.type=o)},Os,544),[[q,n.item.type]])])])):p("",!0),i("tr",null,[Vs,i("td",null,[n.item.target?(r(),u(k,{key:0},[n.item.type?(r(),u("img",{key:0,class:"linkIcon",src:`assets/bsicons/${a.getType(n.item)}.png`},null,8,Us)):p("",!0),_(" "+C(n.item.target.name),1)],64)):(r(),u(k,{key:1},[Ls,_(" No target selected ")],64))])]),i("tr",null,[Bs,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=o=>n.item.targetId=o),onChange:e[5]||(e[5]=(...o)=>a.targetIdChanged&&a.targetIdChanged(...o))},null,544),[[w,n.item.targetId]])])]),i("tr",null,[qs,i("td",null,[m(s,{modelValue:n.item.targetId,"onUpdate:modelValue":e[6]||(e[6]=o=>n.item.targetId=o),placeholder:"Search Target...",options:a.availableTargets,valueField:"id",filterField:"name",onChange:a.targetIdChanged},{option:x(o=>[i("div",js,[i("img",{class:"mr-1 align-middle",src:`assets/bsicons/${o.option.editorTypeName}.png`},null,8,$s),_(" "+C(o.option.name)+" ",1),i("span",Ds,C(a.getNameExtra(o.option,!1)),1),o.option.shared?(r(),u("span",Gs," (shared)")):p("",!0),a.showCatalogue(o.option)?(r(),u("span",Qs," ["+C(o.option.catalogue.name)+"]",1)):p("",!0)])]),_:1},8,["modelValue","placeholder","options","onChange"])])]),n.type==="catalogue"?(r(),u("tr",Ms,[Ks,i("td",null,[y(i("input",{onChange:e[7]||(e[7]=(...o)=>a.changedImportRootEntries&&a.changedImportRootEntries(...o)),id:"importRoot",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=o=>n.item.importRootEntries=o)},null,544),[[O,n.item.importRootEntries]]),Hs])])):p("",!0)])])}const Xs=f(ks,[["render",zs],["__scopeId","data-v-130fa048"]]),Ws={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},type:{type:String,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ys(t,e,n,d,l,a){const s=F,o=U,g=D,c=Xs,h=Le,b=Ue,A=ke,H=Ae,Q=se;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),n.type!="catalogue"?(r(),v(g,{key:0,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):p("",!0),m(c,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section",type:n.type},null,8,["item","catalogue","onCatalogueChanged","type"]),n.item.editorTypeName=="selectionEntryLink"?(r(),v(h,{key:1,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):p("",!0),n.item.editorTypeName=="selectionEntryLink"?(r(),v(b,{key:2,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):p("",!0),n.type!="catalogue"?(r(),v(A,{key:3,item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Entry ")]),_:1},8,["item","onCatalogueChanged"])):p("",!0),n.item.editorTypeName=="selectionEntryLink"||n.item.editorTypeName=="selectionEntryGroupLink"?(r(),v(H,{key:4,item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):p("",!0),n.type=="entry"||n.type=="category"?(r(),v(Q,{key:5,item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])):p("",!0)],64)}const Js=f(Ws,[["render",Ys]]),Zs={props:{modelValue:{type:Object},placeholder:{type:String,default:"Search..."},fetch:{type:Function,required:!0},disabled:{type:Boolean,default:!1}},created(){this.reset()},data(){return{searchPattern:"",lastSearch:null,editing:!1,selectedOption:null,availableOptions:[]}},methods:{async foundOptions(){return(await this.fetch()).map(e=>({option:e}))},targetSelected(t){let e=t.option;this.selectedOption={option:t.option,selected:!0},this.$emit("update:modelValue",e),this.$emit("change",t.option),this.editing=!1},reset(){this.searchPattern="",this.selectedOption=null,this.modelValue&&(this.selectedOption={option:this.modelValue,selected:!0})},onClickOutside(){this.editing=!1},async startEditing(){this.disabled||(this.editing=!0,this.availableOptions=await this.foundOptions())},clicked(){this.editing=!1}}};const el={key:0,class:"gray"},tl=["onClick"];function nl(t,e,n,d,l,a){const s=be("click-outside");return r(),u("div",{class:E(["container",{disabled:n.disabled}])},[y((r(),u("div",{onClick:e[0]||(e[0]=(...o)=>a.startEditing&&a.startEditing(...o)),class:"iconselect-input"},[l.selectedOption?B(t.$slots,"option",M(Fe({key:1},l.selectedOption)),void 0,!0):(r(),u("span",el,C(n.placeholder),1))])),[[s,a.onClickOutside]]),i("div",{class:E(["suggestions",{hidden:!l.editing}])},[(r(!0),u(k,null,P(l.availableOptions,o=>(r(),u("div",{onClick:g=>a.targetSelected(o)},[B(t.$slots,"option",M(Z(o)),void 0,!0)],8,tl))),256))],2)],2)}const je=f(Zs,[["render",nl],["__scopeId","data-v-25b66910"]]),al={selectionEntry:["costs","name","page","hidden","category","constraints"],selectionEntryLink:["costs","name","page","hidden","category","constraints"],selectionEntryGroup:["name","page","hidden","category","constraints","defaultSelectionEntryId"],selectionEntryGroupLink:["name","page","hidden","category","constraints","defaultSelectionEntryId"],profile:["characteristics","name","description","page","hidden"],profileLink:["characteristics","name","description","page","hidden"],rule:["name","description","page","hidden"],ruleLink:["name","description","page","hidden"],infoLink:["name","page","hidden"],infoGroup:["name","page","hidden"],infoGroupLink:["name","page","hidden"],force:["name","page","hidden","constraints"],category:["name","page","hidden","constraints"],categoryLink:["name","page","hidden","constraints"]},il={costs:"number",name:"string",page:"string",hidden:"boolean",description:"string",category:"category",defaultSelectionEntryId:"defaultSelectionEntryId",constraints:"number"},ol={components:{ErrorIcon:ve},emits:["catalogueChanged"],data(){return{value:"",selectedField:null,selectedOperation:null,selectedValue:null}},created(){this.update()},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{getName:oe,getNameExtra:K,changed(){this.selectedField&&(this.item.field=this.selectedField.id),this.selectedOperation&&(this.item.type=this.selectedOperation.id),this.$emit("catalogueChanged")},getDefaultFieldValue(t,e,n){var d;switch(t){case"number":return typeof n=="number"?n:0;case"category":return this.allCategories[0].id;case"string":let l;if(e==="name"){const a=this.item;l=a.getName&&a.getName()||""}else l="";return typeof n=="string"?n:l;case"string-or-number":return["strint","number"].includes(typeof n)?n:"";case"boolean":return typeof n=="boolean"?n:!1;case"defaultSelectionEntryId":return(d=st(this.allGroupEntries))==null?void 0:d.id;default:throw Error(`fieldType "${t}" has no default value set"`)}},fieldChanged(){this.selectedOperation=this.operations[0],this.selectedField&&(this.item.value=this.getDefaultFieldValue(this.selectedField.type,this.selectedField.name,this.item.value)),this.changed()},update(){this.selectedField=this.fieldData.find(t=>t.id===this.item.field)||null,this.selectedOperation=this.operations.find(t=>t.id===this.item.type)||null,this.selectedField||(this.selectedField=this.fieldData[0]),this.selectedOperation||(this.selectedOperation=this.operations[0]||null)}},watch:{item(){this.update()}},computed:{inputType(){var t,e;return this.selectedField?this.selectedField.type==="category"?"category":this.selectedField.type==="defaultSelectionEntryId"?"defaultSelectionEntryId":this.selectedField.type==="number"?"number":this.selectedField.type==="boolean"?"boolean":((t=this.selectedOperation)==null?void 0:t.id)==="increment"||((e=this.selectedOperation)==null?void 0:e.id)==="decrement"?"number":"string":""},parent(){return ee(this.item)},allCategories(){let t=[];for(let e of this.catalogue.iterateCategoryEntries())t.push(e);return t},allGroupEntries(){var t;return[...((t=this.parent)==null?void 0:t.selectionsIterator())||[]]},operations(){return this.selectedField?{number:[{id:"set",name:"Set",word:"to"},{id:"increment",name:"Increment",word:"by"},{id:"decrement",name:"Decrement",word:"by"}],string:[{id:"set",name:"Set",word:"to"},{id:"append",name:"Append",word:"with"},{id:"prepend",name:"Prepend",word:"with"}],"string-or-number":[{id:"set",name:"Set",word:"to"},{id:"append",name:"Append",word:"to"},{id:"prepend",name:"Append",word:"to"},{id:"increment",name:"Increment",word:"by"},{id:"decrement",name:"Decrement",word:"by"}],boolean:[{id:"set",name:"Set",word:"to"}],defaultSelectionEntryId:[{id:"set",name:"Set",word:""}],category:[{id:"add",name:"Add",word:""},{id:"remove",name:"Remove",word:""},{id:"set-primary",name:"Set Primary",word:"to"},{id:"unset-primary",name:"Unset Primary",word:"to"}]}[this.selectedField.type]:[]},errors(){return[]},fieldData(){if(!this.parent)return[];let t=al[this.parent.editorTypeName];const e=[];if(!t)return[];if(t.includes("costs"))for(const n of this.catalogue.iterateCostTypes())e.push({id:n.id,name:n.name,type:"number",modifierType:"cost"});if(t.includes("constraints"))for(const n of this.parent.constraintsIterator())e.push({id:n.id,name:oe(n),type:"number",modifierType:"constraint"});if(t.includes("characteristics")){const n=this.parent.isLink()?this.parent.target:this.parent;n!=null&&n.characteristics&&e.push(...n.characteristics.map(d=>({id:d.typeId,name:d.name,type:"string-or-number",modifierType:"characteristic",value:d.$text})))}return t.includes("category")&&e.push({id:"category",name:"Category",type:"category",modifierType:"category"}),t=t.filter(n=>["costs","constraints","category","characteristics"].includes(n)==!1),t.map(n=>({id:n,name:n,type:il[n],modifierType:"bullet"})).concat(e)}}};const ce=t=>(N("data-v-48df2932"),t=t(),S(),t),sl=ce(()=>i("legend",null,"Modifier",-1)),ll={class:"modifier"},dl=["value"],rl={class:"flex align-items flex-row"},ul=["src"],cl={class:"inline"},gl={key:1},ml=ce(()=>i("option",{value:!0},"True",-1)),hl=ce(()=>i("option",{value:!1},"False",-1)),_l=[ml,hl],pl={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},fl=["src"],Cl={class:"inline"},yl={class:"grey"},bl={class:"flex align-items flex-row",style:{"white-space":"nowrap"}},vl=["src"],kl={class:"inline"},Al={class:"grey"},xl={class:"mt-8px flex items-center"},wl=ce(()=>i("img",{src:qe},null,-1)),Il={class:"ml-10px"};function Tl(t,e,n,d,l,a){const s=je,o=J,g=Y;return r(),u("fieldset",null,[sl,i("div",ll,[l.selectedOperation?y((r(),u("select",{key:0,"onUpdate:modelValue":e[0]||(e[0]=c=>l.selectedOperation=c),onChange:e[1]||(e[1]=(...c)=>a.changed&&a.changed(...c))},[(r(!0),u(k,null,P(a.operations,c=>(r(),u("option",{value:c},C(c.name),9,dl))),256))],544)),[[q,l.selectedOperation]]):p("",!0),m(s,{modelValue:l.selectedField,"onUpdate:modelValue":e[2]||(e[2]=c=>l.selectedField=c),fetch:()=>a.fieldData,onChange:a.fieldChanged,class:"modType min-w-200px"},{option:x(c=>[i("div",rl,[i("img",{class:"mr-1 my-auto",src:`assets/bsicons/${c.option.modifierType}.png`},null,8,ul),i("span",cl,C(c.option.name),1)])]),_:1},8,["modelValue","fetch","onChange"]),l.selectedOperation?(r(),u("span",gl,C(l.selectedOperation.word),1)):p("",!0),a.inputType==="number"?(r(),v(o,{key:2,onChange:a.changed,modelValue:n.item.value,"onUpdate:modelValue":e[3]||(e[3]=c=>n.item.value=c)},null,8,["onChange","modelValue"])):p("",!0),a.inputType=="boolean"?y((r(),u("select",{key:3,onChange:e[4]||(e[4]=(...c)=>a.changed&&a.changed(...c)),"onUpdate:modelValue":e[5]||(e[5]=c=>n.item.value=c)},_l,544)),[[q,n.item.value]]):p("",!0),a.inputType.includes("string")?y((r(),u("input",{key:4,onChange:e[6]||(e[6]=(...c)=>a.changed&&a.changed(...c)),type:"text","onUpdate:modelValue":e[7]||(e[7]=c=>n.item.value=c)},null,544)),[[w,n.item.value]]):p("",!0),a.inputType=="category"?(r(),v(g,{key:5,options:a.allCategories,filterField:c=>c.getName(),valueField:"id",modelValue:n.item.value,"onUpdate:modelValue":e[8]||(e[8]=c=>n.item.value=c),onChange:a.changed},{option:x(({option:c})=>[i("div",pl,[i("img",{class:"mr-1 my-auto",src:`assets/bsicons/${c.editorTypeName}.png`},null,8,fl),i("span",Cl,[_(C(a.getName(c))+" ",1),i("span",yl,C(a.getNameExtra(c)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])):p("",!0),a.inputType=="defaultSelectionEntryId"?(r(),v(g,{key:6,options:a.allGroupEntries,filterField:c=>c.getName(),valueField:"id",modelValue:n.item.value,"onUpdate:modelValue":e[9]||(e[9]=c=>n.item.value=c),onChange:a.changed},{option:x(({option:c})=>[i("div",bl,[i("img",{class:"mr-1 my-auto",src:`assets/bsicons/${c.editorTypeName}.png`},null,8,vl),i("span",kl,[_(C(a.getName(c))+" ",1),i("span",Al,C(a.getNameExtra(c)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])):p("",!0)]),(r(!0),u(k,null,P(a.errors,c=>(r(),u("div",xl,[wl,i("span",Il,C(c.msg),1)]))),256))])}const Pl=f(ol,[["render",Tl],["__scopeId","data-v-48df2932"]]),Fl={emits:["catalogueChanged"],setup(){return{store:j()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},computed:{type(){return this.item.editorTypeName},parent(){return this.item.parent}},methods:{changed(){this.$emit("catalogueChanged")},add(t,e,n,d){e==="id"&&(e=this.item.id);let l=this.item;this.store.create_child("conditions",l,{scope:t,field:e,type:n,value:d,childId:"any"})}}};const G=t=>(N("data-v-08607e57"),t=t(),S(),t),Nl=G(()=>i("legend",null,[i("img",{src:gt}),_(" Quick Conditions")],-1)),Sl={class:"columns"},El={class:"buttonList"},Rl=G(()=>i("img",{src:I},null,-1)),Ol=G(()=>i("img",{src:I},null,-1)),Vl=G(()=>i("img",{src:I},null,-1)),Ul=G(()=>i("img",{src:I},null,-1)),Ll={class:"buttonList"},Bl=G(()=>i("img",{src:I},null,-1)),ql=G(()=>i("img",{src:I},null,-1)),jl=G(()=>i("img",{src:I},null,-1)),$l=G(()=>i("img",{src:I},null,-1));function Dl(t,e,n,d,l,a){return r(),u("fieldset",null,[Nl,i("div",Sl,[i("div",El,[i("button",{class:"bouton",onClick:e[0]||(e[0]=s=>a.add("parent","selections","atLeast",1))},[Rl,_("PARENT ATLEAST 1 ")]),i("button",{class:"bouton",onClick:e[1]||(e[1]=s=>a.add("force","selections","atLeast",1))},[Ol,_("FORCE ATLEAST 1 ")]),i("button",{class:"bouton",onClick:e[2]||(e[2]=s=>a.add("roster","selections","atLeast",1))},[Vl,_("ROSTER ATLEAST 1 ")]),i("button",{class:"bouton",onClick:e[3]||(e[3]=s=>a.add("ancestor","selections","instanceOf",1))},[Ul,_("ANCESTOR INSTANCE OF ")])]),i("div",Ll,[i("button",{class:"bouton",onClick:e[4]||(e[4]=s=>a.add("parent","selections","lessThan",1))},[Bl,_("PARENT LESS THAN 1 ")]),i("button",{class:"bouton",onClick:e[5]||(e[5]=s=>a.add("force","selections","lessThan",1))},[ql,_("FORCE LESS THAN 1 ")]),i("button",{class:"bouton",onClick:e[6]||(e[6]=s=>a.add("roster","selections","lessThan",1))},[jl,_("ROSTER LESS THAN 1 ")]),i("button",{class:"bouton",onClick:e[7]||(e[7]=s=>a.add("ancestor","selections","notInstanceOf",1))},[$l,_("ANCESTOR NOT INSTANCE OF ")])])])])}const $e=f(Fl,[["render",Dl],["__scopeId","data-v-08607e57"]]),Gl={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ql(t,e,n,d,l,a){const s=F,o=Pl,g=$e;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),m(g,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Ml=f(Gl,[["render",Ql]]),Kl={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};const ne=t=>(N("data-v-5aec87f9"),t=t(),S(),t),Hl=ne(()=>i("legend",null,"Constraint",-1)),zl={class:"editorTable"},Xl=ne(()=>i("td",null,"Unique ID:",-1)),Wl={class:"constraint"},Yl=ne(()=>i("option",{value:"min"},"Minimum",-1)),Jl=ne(()=>i("option",{value:"max"},"Maximum",-1)),Zl=ne(()=>i("option",{value:"exactly"},"Exactly",-1)),ed=[Yl,Jl,Zl],td=ne(()=>i("label",{for:"percent"},"Percentage?",-1));function nd(t,e,n,d,l,a){const s=J;return r(),u("fieldset",null,[Hl,i("table",zl,[i("tr",null,[Xl,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>n.item.id=o),onChange:e[1]||(e[1]=(...o)=>a.changed&&a.changed(...o))},null,544),[[w,n.item.id]])])])]),i("div",Wl,[y(i("select",{"onUpdate:modelValue":e[2]||(e[2]=o=>n.item.type=o),onChange:e[3]||(e[3]=(...o)=>a.changed&&a.changed(...o))},ed,544),[[q,n.item.type]]),m(s,{modelValue:n.item.value,"onUpdate:modelValue":e[4]||(e[4]=o=>n.item.value=o),onChange:a.changed},null,8,["modelValue","onChange"]),i("div",null,[y(i("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=o=>n.item.percentValue=o),onChange:e[6]||(e[6]=(...o)=>a.changed&&a.changed(...o))},null,544),[[O,n.item.percentValue]]),td])])])}const ad=f(Kl,[["render",nd],["__scopeId","data-v-5aec87f9"]]);function ge(t){var e;return((e=t.catalogue)==null?void 0:e.getName())??null}function me(t,e,n,d=0){var l,a;for(const s of t[e]())n.push({name:s.name,editorTypeName:s.editorTypeName,id:s.id,indent:d,catalogue:ge(s),shared:((a=(l=z(s))==null?void 0:l.parentKey)==null?void 0:a.includes("shared"))||!1}),me(s,e,n,d+1)}function id(t,e,n,d,l=0){var a,s;for(const o of t[e]())d.push({name:o.name,editorTypeName:o.editorTypeName,id:o.id,indent:l,catalogue:ge(o),shared:((s=(a=z(o))==null?void 0:a.parentKey)==null?void 0:s.includes("shared"))||!1}),me(o,e,d,l+1)}function xe(t,e){let n=[];return me(t,e,n),n}function fe(t,e){const n=[];return me(t,e?"iterateSelectionEntriesWithRoot":"iterateSelectionEntries",n),n}function od(t,e){const n=[],d=t.getPrimaryCategory();return id(e,"iterateAllRootEntries",l=>z(l).getPrimaryCategory()===d,n),n}function De(t){var n,d;const e=[];for(let l of t.iterateCategoryEntries()){const a=l;a.isCatalogue()||e.push({name:a.name,editorTypeName:a.editorTypeName,id:a.id,indent:0,catalogue:ge(a),shared:((d=(n=z(a))==null?void 0:n.parentKey)==null?void 0:d.includes("shared"))||!1})}return e}function sd(t){const e=[];for(const n of Object.values(t.manager.getAllCatalogueFiles())){if(!n.catalogue)continue;const d=mt(n);e.push({name:d.name,editorTypeName:"catalogue",id:d.id,indent:0,catalogue:null,shared:!1})}return e}function ld(t){let e=0,n=ee(t);for(;n;)e++,n=n.parent;return e}function dd(t){var a,s;let e=[],n=t,d=0;const l=ld(t)-1;for(n=ee(t);n!=null&&!n.isCatalogue();)n.editorTypeName==="selectionEntry"&&(e.push({name:n.name,id:n.id,editorTypeName:n.editorTypeName,indent:d,catalogue:ge(n),shared:((s=(a=z(n))==null?void 0:a.parentKey)==null?void 0:s.includes("shared"))||!1}),d++),n=n.parent;return e=e.reverse(),e.forEach((o,g)=>{o.indent=g+l}),e}function Ce(t){const e=xe(t,"iterateRootEntries");return e.splice(0,1),e}function rd(t){return["self","parent","ancestor","primary-category","primary-catalogue","force","roster"].includes(t.scope)==!1}function z(t){let e=t;for(;e.parent!=null&&e.parent.editorTypeName!="gameSystem"&&e.parent.editorTypeName!="catalogue";)e=e.parent;return e}function ud(t,e){if(["primary-catalogue","roster","force","ancestor"].includes(t.scope))return fe(e,!0);const d=fe(e,!1);if(t.scope=="self"){const a=ee(t);return a?d.concat(Ce(a)):d}if(t.scope=="parent"){if(z(t))return fe(e,!0);const a=ee(t);return a!=null&&a.parent?d.concat(Ce(a.parent)):d}if(t.scope=="primary-category")return od(z(t),e);const l=e.findOptionById(t.scope);return l?d.concat(Ce(l)):d}const cd={emits:["catalogueChanged"],data(){return{itemField:null}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},childForces:{type:Boolean,default:!1},childSelections:{type:Boolean,default:!1},shared:{type:Boolean,default:!1}},methods:{getNameExtra:K,changed(){this.$emit("catalogueChanged")},scopeChanged(){this.item.catalogue.updateCondition(this.item),this.changed()},fieldChanged(){this.item.field=this.itemField.value,this.item.field.startsWith("limit::")&&delete this.item.childId,this.changed()},showCatalogue(t){var e;return!(!t.catalogue||t.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))}},computed:{instanceOf(){var t;return["instanceOf","notInstanceOf"].includes((t=this.item)==null?void 0:t.type)},fieldTypes(){const t=[];this.instanceOf&&t.push({name:"",value:void 0,type:null}),t.push({name:"Selections",value:"selections",type:"bullet"}),t.push({name:"Forces",value:"forces",type:"bullet"});for(const e of this.costTypes)t.push({name:e.name,value:e.id,type:"cost"}),this.item.scope==="roster"&&t.push({name:`${e.name} Limit`,value:`limit::${e.id}`,type:"cost"});return t},includeCategories(){return this.item.field!=="forces"},includeForces(){return!0},includeSelections(){return this.item.field!="forces"},parent(){return this.item.parent},costTypes(){let t=[];for(let e of this.catalogue.iterateCostTypes())t.push(e);return t},allSelections(){return this.includeSelections?dd(this.item):[]},allCategories(){return this.includeCategories?De(this.catalogue):[]},allForces(){return this.includeForces?xe(this.catalogue,"forcesIterator"):[]},allScopes(){let t=[{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"}];return this.item.field!="forces"&&["condition"].includes(this.item.editorTypeName)&&(t=[{id:"self",name:"Self",editorTypeName:"bullet"},{id:"parent",name:"Parent",editorTypeName:"bullet"},{id:"ancestor",name:"Ancestor",editorTypeName:"bullet",title:"checks the condition in all parents"},{id:"primary-category",name:"Primary Category",editorTypeName:"bullet"},{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"},{id:"primary-catalogue",name:"Primary Catalogue",editorTypeName:"bullet"}]),this.item.field!=="forces"&&["repeat","constraint"].includes(this.item.editorTypeName)&&(t=[{id:"parent",name:"Parent",editorTypeName:"bullet"},{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"},{id:"primary-catalogue",name:"Primary Catalogue",editorTypeName:"bullet"}]),t.concat(this.allSelections).concat(this.allCategories).concat(this.allForces)}},watch:{"item.field":{handler(){this.item.field=="forces"&&(this.item.scope="roster"),this.itemField=this.fieldTypes.find(t=>t.value==this.item.field)},immediate:!0}}};const le=t=>(N("data-v-53d44f52"),t=t(),S(),t),gd=le(()=>i("legend",null,"Query",-1)),md={class:"query"},hd=["src"],_d=le(()=>i("span",null," in ",-1)),pd={style:{"white-space":"nowrap"}},fd=["src"],Cd={class:"gray"},yd={key:1,class:"shared"},bd={key:2,class:"catalogueName"},vd={class:"checks"},kd={key:0},Ad=le(()=>i("label",{for:"shared"},"Shared",-1)),xd={key:1},wd=le(()=>i("label",{for:"childSelections"},"And all child Selections",-1)),Id={key:2},Td=le(()=>i("label",{for:"childForces"},"And all child Forces",-1));function Pd(t,e,n,d,l,a){var g,c;const s=je,o=Y;return r(),u("fieldset",null,[gd,i("div",md,[m(s,{modelValue:l.itemField,"onUpdate:modelValue":e[0]||(e[0]=h=>l.itemField=h),fetch:()=>a.fieldTypes,onChange:a.fieldChanged,class:"modType",disabled:a.instanceOf},{option:x(h=>[i("div",null,[i("img",{class:"mr-1 align-middle",src:`assets/bsicons/${h.option.type}.png`},null,8,hd),_(" "+C(h.option.name),1)])]),_:1},8,["modelValue","fetch","onChange","disabled"]),_d,m(o,{modelValue:n.item.scope,"onUpdate:modelValue":e[1]||(e[1]=h=>n.item.scope=h),placeholder:"Search Scope...",options:a.allScopes,valueField:"id",filterField:"name",onChange:a.scopeChanged,disabled:(c=(g=l.itemField)==null?void 0:g.value)==null?void 0:c.startsWith("limit::")},{option:x(h=>[i("div",pd,[h.option.indent>=2&&!h.selected?(r(!0),u(k,{key:0},P(h.option.indent-1,b=>(r(),u("span",null,"Â Â Â "))),256)):p("",!0),i("img",{class:"mr-1 align-middle",src:`assets/bsicons/${h.option.editorTypeName}.png`},null,8,fd),_(" "+C(h.option.name)+" ",1),i("span",Cd,C(a.getNameExtra(h.option,!1)),1),h.option.shared?(r(),u("span",yd," (shared)")):p("",!0),a.showCatalogue(h.option)?(r(),u("span",bd," ["+C(h.option.catalogue)+"]",1)):p("",!0)])]),_:1},8,["modelValue","placeholder","options","onChange","disabled"]),i("div",vd,[n.shared?(r(),u("div",kd,[y(i("input",{onChange:e[2]||(e[2]=(...h)=>a.changed&&a.changed(...h)),id:"shared",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=h=>n.item.shared=h)},null,544),[[O,n.item.shared]]),Ad])):p("",!0),n.childSelections?(r(),u("div",xd,[y(i("input",{onChange:e[4]||(e[4]=(...h)=>a.changed&&a.changed(...h)),id:"childSelections",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=h=>n.item.includeChildSelections=h)},null,544),[[O,n.item.includeChildSelections]]),wd])):p("",!0),n.childForces?(r(),u("div",Id,[y(i("input",{onChange:e[6]||(e[6]=(...h)=>a.changed&&a.changed(...h)),id:"childForces",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=h=>n.item.includeChildForces=h)},null,544),[[O,n.item.includeChildForces]]),Td])):p("",!0)])])])}const we=f(cd,[["render",Pd],["__scopeId","data-v-53d44f52"]]),Fd={emits:["catalogueChanged"],setup(){return{store:j()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},computed:{type(){return this.item.editorTypeName},parent(){return this.item.parent}},methods:{changed(){this.$emit("catalogueChanged")},add(t,e,n){t==="id"&&(t=this.item.id);let d=this.item;this.type==="constraint"&&(d=this.parent),this.store.create_child("modifiers",d,{field:t,type:e,value:n})}}};const de=t=>(N("data-v-eaa13e99"),t=t(),S(),t),Nd=de(()=>i("legend",null,[i("img",{src:ht}),_(" Quick Modifiers")],-1)),Sd={class:"columns"},Ed={class:"buttonList"},Rd=de(()=>i("img",{src:I},null,-1)),Od=de(()=>i("img",{src:I},null,-1)),Vd={class:"buttonList"},Ud=de(()=>i("img",{src:I},null,-1)),Ld=de(()=>i("img",{src:I},null,-1));function Bd(t,e,n,d,l,a){return r(),u("fieldset",null,[Nd,i("div",Sd,[a.type==="constraint"?(r(),u(k,{key:0},[i("div",Ed,[i("button",{class:"bouton",onClick:e[0]||(e[0]=s=>a.add("id","increment",1))},[Rd,_("INCREMENT 1 ")]),i("button",{class:"bouton",onClick:e[1]||(e[1]=s=>a.add("id","set",1))},[Od,_("SET 1 ")])]),i("div",Vd,[i("button",{class:"bouton",onClick:e[2]||(e[2]=s=>a.add("id","decrement",1))},[Ud,_("DECREMENT 1 ")]),i("button",{class:"bouton",onClick:e[3]||(e[3]=s=>a.add("id","set",0))},[Ld,_("SET 0 ")])])],64)):p("",!0)])])}const Ge=f(Fd,[["render",Bd],["__scopeId","data-v-eaa13e99"]]),qd=[{id:"any",name:"Anything",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"unit",name:"Unit",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"model",name:"Model",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"upgrade",name:"Upgrade",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1}],jd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},noshared:{type:Boolean,default:!1}},methods:{getNameExtra:K,changed(){this.$emit("catalogueChanged")},showCatalogue(t){var e;return!(!t.catalogue||t.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))},availableTargets(){return[...qd,...this.allCategories,...this.allEntries,...this.allForces,...this.allCatalogues]}},watch:{"item.scope"(){var t;this.child||(this.item.childId=((t=this.availableTargets()[0])==null?void 0:t.id)||void 0)}},computed:{childId:{get(){return this.item.childId},set(t){const e=this.item.childId;this.item.childId=t,this.catalogue.updateCondition(this.item,e)}},child(){if(!this.item.childId)return null;const t=this.availableTargets().find(e=>e.id===this.item.childId);return t||this.catalogue.findOptionById(this.item.childId)},instanceOf(){var t;return["instanceOf","notInstanceOf"].includes((t=this.item)==null?void 0:t.type)},allEntries(){return this.includeSelections?ud(this.item,this.catalogue):[]},allCategories(){return this.includeCategories?De(this.catalogue):[]},allForces(){return this.includeForces?xe(this.catalogue,"forcesIterator"):[]},allCatalogues(){return this.includeCatalogues?sd(this.catalogue):[]},includeSelections(){return!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.instanceOf&&this.item.scope==="primary-category")},includeCategories(){return!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.item.field==="forces")},includeForces(){return this.item.scope=="self"||this.item.scope=="parent"?!1:this.item.scope=="ancestor"?!0:!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.instanceOf&&this.item.scope==="primary-category"||rd(this.item))},includeCatalogues(){return this.instanceOf&&this.item.scope==="primary-catalogue"}}};const he=t=>(N("data-v-9575299d"),t=t(),S(),t),$d=he(()=>i("legend",null,"Filter By",-1)),Dd={class:"editorTable"},Gd=he(()=>i("td",null,"Of:",-1)),Qd={key:0},Md=["src"],Kd=he(()=>i("td",null,"Child ID:",-1)),Hd=he(()=>i("td",null,"Child:",-1)),zd={key:0,style:{"white-space":"nowrap"}},Xd=["src"],Wd={class:"gray"},Yd={key:1,class:"shared"},Jd={key:2,class:"catalogueName"},Zd=["disabled"];function er(t,e,n,d,l,a){const s=Y;return r(),u("fieldset",null,[$d,i("table",Dd,[i("tr",null,[Gd,i("td",null,[a.child?(r(),u("span",Qd,[i("img",{class:"mr-1 align-middle",src:`assets/bsicons/${a.child.editorTypeName}.png`},null,8,Md),_(" "+C(a.child.name),1)])):p("",!0)])]),i("tr",null,[Kd,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>a.childId=o),onChange:e[1]||(e[1]=(...o)=>a.changed&&a.changed(...o))},null,544),[[w,a.childId]])])]),i("tr",null,[Hd,i("td",null,[m(s,{modelValue:a.childId,"onUpdate:modelValue":e[2]||(e[2]=o=>a.childId=o),placeholder:"Search Child...",options:a.availableTargets,valueField:"id",filterField:"name",onChange:a.changed,default:a.child,lazy:""},{option:x(o=>[o.option?(r(),u("div",zd,[o.option.indent>=1&&!o.selected?(r(!0),u(k,{key:0},P(o.option.indent,g=>(r(),u("span",null,"Â Â Â "))),256)):p("",!0),i("img",{class:"mr-1 align-middle",src:`assets/bsicons/${o.option.editorTypeName}.png`},null,8,Xd),_(" "+C(o.option.name)+" ",1),i("span",Wd,C(a.getNameExtra(o.option,!1)),1),o.option.shared?(r(),u("span",Yd," (shared) ")):p("",!0),a.showCatalogue(o.option)?(r(),u("span",Jd," ["+C(o.option.catalogue)+"]",1)):p("",!0)])):p("",!0)]),_:1},8,["modelValue","placeholder","options","onChange","default"])])])]),y(i("input",{disabled:n.noshared&&n.item.shared,type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>n.item.shared=o),id:"shared",onChange:e[4]||(e[4]=(...o)=>a.changed&&a.changed(...o))},null,40,Zd),[[O,n.item.shared]]),i("label",{class:E({gray:n.noshared&&n.item.shared}),for:"shared"},"Shared?",2)])}const _e=f(jd,[["render",er],["__scopeId","data-v-9575299d"]]),tr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{showFilterBy(){var e;return((e=ee(this.item))==null?void 0:e.parentKey)==="associations"}},methods:{changed(){this.catalogue.updateCondition(this.item),this.$emit("catalogueChanged")}},components:{FilterBy:_e,QuickModifiers:Ge}};function nr(t,e,n,d,l,a){const s=F,o=ad,g=we,c=V("FilterBy"),h=Ge;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(g,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed,class:"section",childForces:"",childSelections:"",shared:""},null,8,["catalogue","item","onCatalogueChanged"]),a.showFilterBy?(r(),v(c,{key:0,class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"])):p("",!0),m(h,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const ar=f(tr,[["render",nr]]),ir={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},or=i("legend",null,"Condition Group",-1),sr={class:"editorTable"},lr=i("td",null,"Type",-1),dr=i("option",{value:"or"},"Or",-1),rr=i("option",{value:"and"},"And",-1),ur=[dr,rr];function cr(t,e,n,d,l,a){const s=F;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),i("fieldset",null,[or,i("table",sr,[i("tr",null,[lr,i("td",null,[y(i("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>n.item.type=o),onChange:e[1]||(e[1]=(...o)=>a.changed&&a.changed(...o))},ur,544),[[q,n.item.type]])])])])])],64)}const gr=f(ir,[["render",cr]]),mr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{ConditionGroup:gr}};function hr(t,e,n,d,l,a){const s=V("ConditionGroup");return r(),u("div",null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])])}const _r=f(mr,[["render",hr]]),pr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{allowNonInstanceOf(){return!0},instanceOf(){return this.item.type.includes("instance")}},components:{NumberInput:J},watch:{"item.scope"(){const t=["instanceOf","notInstanceOf"];!this.allowNonInstanceOf&&!t.includes(this.item.type)&&(this.item.type=t[0])}}};const Ie=t=>(N("data-v-b2d4a8f9"),t=t(),S(),t),fr=Ie(()=>i("legend",null,"Condition",-1)),Cr={class:"condition"},yr=Ne('<option value="lessThan" data-v-b2d4a8f9>Less Than</option><option value="greaterThan" data-v-b2d4a8f9>Greater Than</option><option value="equalTo" data-v-b2d4a8f9>Equal To</option><option value="notEqualTo" data-v-b2d4a8f9>Not Equal To</option><option value="atLeast" data-v-b2d4a8f9>At Least</option><option value="atMost" data-v-b2d4a8f9>At Most</option>',6),br=Ie(()=>i("option",{value:"instanceOf"},"Instance Of",-1)),vr=Ie(()=>i("option",{value:"notInstanceOf"},"Not Instance Of",-1)),kr=["disabled"];function Ar(t,e,n,d,l,a){const s=J;return r(),u("fieldset",null,[fr,i("div",Cr,[y(i("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>n.item.type=o),onChange:e[1]||(e[1]=(...o)=>a.changed&&a.changed(...o))},[a.allowNonInstanceOf?(r(),u(k,{key:0},[yr],64)):p("",!0),br,vr],544),[[q,n.item.type]]),m(s,{disabled:a.instanceOf,modelValue:n.item.value,"onUpdate:modelValue":e[2]||(e[2]=o=>n.item.value=o),onChange:a.changed},null,8,["disabled","modelValue","onChange"]),i("div",null,[y(i("input",{disabled:a.instanceOf,id:"percent",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=o=>n.item.percentValue=o),onChange:e[4]||(e[4]=(...o)=>a.changed&&a.changed(...o))},null,40,kr),[[O,n.item.percentValue]]),i("label",{class:E({disabled:a.instanceOf}),for:"percent"},"Percentage?",2)])])])}const xr=f(pr,[["render",Ar],["__scopeId","data-v-b2d4a8f9"]]),wr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{Condition:xr,FilterBy:_e}};function Ir(t,e,n,d,l,a){const s=F,o=V("Condition"),g=we,c=V("FilterBy");return r(),u("div",null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),m(g,{class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue,childForces:"",childSelections:""},null,8,["item","onCatalogueChanged","catalogue"]),n.item.field.startsWith("limit::")==!1?(r(),v(c,{key:0,noshared:"",class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"])):p("",!0)])}const Tr=f(wr,[["render",Ir]]),Pr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Fr(t,e,n,d,l,a){const s=F,o=$e;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Nr=f(Pr,[["render",Fr]]),Sr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Er(t,e,n,d,l,a){const s=F,o=U,g=D,c=X;return r(),u("div",null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(c,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Constraints ")]),_:1},8,["item","onCatalogueChanged"])])}const Rr=f(Sr,[["render",Er]]),Or={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{getNameExtra:K,changed(){this.$emit("catalogueChanged")}},computed:{children(){let t=[{name:"None",id:void 0,editorTypeName:"bullet"}];for(let e of this.item.entriesIterator())e.isGroup()||t.push(e);return t}}};const Qe=t=>(N("data-v-86874c18"),t=t(),S(),t),Vr=Qe(()=>i("legend",null,"Selection Entry Group",-1)),Ur={class:"editorTable"},Lr=Qe(()=>i("td",null,"Default Selection:",-1)),Br={style:{"white-space":"nowrap"}},qr=["src"],jr={class:"gray"},$r={key:1,class:"merror"};function Dr(t,e,n,d,l,a){const s=Y;return r(),u("fieldset",null,[Vr,i("table",Ur,[i("tr",null,[Lr,i("td",null,[a.children.length?(r(),v(s,{key:0,modelValue:n.item.defaultSelectionEntryId,"onUpdate:modelValue":e[0]||(e[0]=o=>n.item.defaultSelectionEntryId=o),placeholder:"Search Children...",options:a.children,valueField:"id",filterField:"name",onChange:a.changed},{option:x(o=>[i("div",Br,[o.option.indent>=2&&!o.selected?(r(!0),u(k,{key:0},P(o.option.indent-1,g=>(r(),u("span",null,"Â Â Â "))),256)):p("",!0),i("img",{class:"mr-1 align-middle",src:`assets/bsicons/${o.option.editorTypeName}.png`},null,8,qr),_(" "+C(o.option.name)+" ",1),i("span",jr,C(a.getNameExtra(o.option,!1)),1)])]),_:1},8,["modelValue","placeholder","options","onChange"])):(r(),u("span",$r,"This group does not have any child Selection Entries"))])])])])}const Gr=f(Or,[["render",Dr],["__scopeId","data-v-86874c18"]]),Qr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Mr(t,e,n,d,l,a){const s=F,o=U,g=D,c=Gr,h=ke,b=Ae,A=se;return r(),u(k,null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(c,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(h,{item:n.item,onCatalogueChanged:a.changed,fields:[{field:"hidden",enabled:!0,name:"Hidden"},{field:"collective",enabled:!1,name:"Collective"},{field:"import",enabled:!0,name:"Import"}],class:"section"},{default:x(()=>[_(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(b,{item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(A,{item:n.item,onCatalogueChanged:a.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Kr=f(Qr,[["render",Mr]]),Hr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},zr=i("legend",null,"Revision",-1),Xr={class:"editorTable"},Wr=i("td",null,"Revision Number:",-1);function Yr(t,e,n,d,l,a){return r(),u("fieldset",null,[zr,i("table",Xr,[i("tr",null,[Wr,i("td",null,[y(i("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=s=>n.item.revision=s),onChange:e[1]||(e[1]=(...s)=>a.changed&&a.changed(...s))},null,544),[[w,n.item.revision]])])])])])}const Jr=f(Hr,[["render",Yr]]),Zr={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},eu=i("legend",null,"Catalogue",-1),tu=i("label",{class:"hastooltip",for:"library",title:"indicates that this catalogue is used to store data, no forces may be created from it if true."},"Library",-1);function nu(t,e,n,d,l,a){return r(),u("fieldset",null,[eu,y(i("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=s=>n.item.library=s),onChange:e[1]||(e[1]=(...s)=>a.changed&&a.changed(...s)),id:"library"},null,544),[[O,n.item.library]]),tu])}const au=f(Zr,[["render",nu]]),iu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},ou=i("legend",null,"Information",-1),su={class:"editorTable"},lu=i("td",null,"Author Name:",-1),du=i("td",null,"Author Contact:",-1),ru=i("td",null,"Author Website:",-1),uu=i("td",null,"Readme:",-1);function cu(t,e,n,d,l,a){const s=re;return r(),u("fieldset",null,[ou,i("table",su,[i("tr",null,[lu,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>n.item.authorName=o),onChange:e[1]||(e[1]=(...o)=>a.changed&&a.changed(...o))},null,544),[[w,n.item.authorName]])])]),i("tr",null,[du,i("td",null,[m(s,{modelValue:n.item.authorContact,"onUpdate:modelValue":e[2]||(e[2]=o=>n.item.authorContact=o)},null,8,["modelValue"])])]),i("tr",null,[ru,i("td",null,[y(i("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>n.item.authorUrl=o),onChange:e[4]||(e[4]=(...o)=>a.changed&&a.changed(...o))},null,544),[[w,n.item.authorUrl]])])]),i("tr",null,[uu,i("td",null,[m(s,{type:"text",modelValue:n.item.readme,"onUpdate:modelValue":e[5]||(e[5]=o=>n.item.readme=o),onChange:a.changed},null,8,["modelValue","onChange"])])])])])}const gu=f(iu,[["render",cu]]),mu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function hu(t,e,n,d,l,a){const s=F,o=U,g=D,c=X,h=Jr,b=au,A=gu;return r(),u("div",null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(c,{item:n.item,onCatalogueChanged:a.changed,class:"section"},{default:x(()=>[_(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(h,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(b,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(A,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"])])}const _u=f(mu,[["render",hu]]),pu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{NumberInput:J}};const pe=t=>(N("data-v-c7d18dd2"),t=t(),S(),t),fu=pe(()=>i("legend",null,"Repeat",-1)),Cu={class:"condition"},yu=pe(()=>i("label",null,"times for every ",-1)),bu={class:"bools"},vu=pe(()=>i("label",{for:"percent"},"Percentage?",-1)),ku=pe(()=>i("label",{for:"percent"},"Round up?",-1));function Au(t,e,n,d,l,a){const s=J;return r(),u("fieldset",null,[fu,i("div",Cu,[m(s,{modelValue:n.item.repeats,"onUpdate:modelValue":e[0]||(e[0]=o=>n.item.repeats=o),onChange:a.changed},null,8,["modelValue","onChange"]),yu,m(s,{modelValue:n.item.value,"onUpdate:modelValue":e[1]||(e[1]=o=>n.item.value=o),onChange:a.changed},null,8,["modelValue","onChange"])]),i("div",bu,[i("div",null,[y(i("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=o=>n.item.percentValue=o),onChange:e[3]||(e[3]=(...o)=>a.changed&&a.changed(...o))},null,544),[[O,n.item.percentValue]]),vu]),i("div",null,[y(i("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=o=>n.item.roundUp=o),onChange:e[5]||(e[5]=(...o)=>a.changed&&a.changed(...o))},null,544),[[O,n.item.roundUp]]),ku])])])}const xu=f(pu,[["render",Au],["__scopeId","data-v-c7d18dd2"]]),wu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Iu(t,e,n,d,l,a){const s=F,o=xu,g=we,c=_e;return r(),u("div",null,[m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{catalogue:n.catalogue,item:n.item,onCatalogueChanged:a.changed},null,8,["catalogue","item","onCatalogueChanged"]),m(g,{class:"section",item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,childForces:"",childSelections:""},null,8,["item","catalogue","onCatalogueChanged"]),m(c,{class:"section",item:n.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])])}const Tu=f(wu,[["render",Iu]]),Pu={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{ids:{get(){var t;return((t=this.item.ids)==null?void 0:t.join(", "))||""},set(t){this.item.ids=t.split(",").map(e=>e.trim())}}},methods:{changed(){this.$emit("catalogueChanged")}},components:{FilterBy:_e}},Fu=i("p",{class:"info"},[_(" Associations are a New Recruit specific feature allowing you to associate an entry to another, such as a unit to a bataillon. "),i("br"),_(" Be aware that associations are currently in the beta phase and may undergo modifications. "),i("br"),_(" Feel free to offer feedback or ask questions on our "),i("a",{href:"https://discord.gg/cCtqGbugwb"},"Discord server"),_(". ")],-1),Nu={class:"section"},Su=i("legend",null,"Temporary",-1),Eu={class:"editorTable"},Ru=i("td",null,"min: (may be moved to child constraints)",-1),Ou=i("td",null,"max: (may be moved to child constraints)",-1),Vu=i("td",null,"label: (will be moved to name)",-1),Uu=i("td",null,"labelMembers:",-1),Lu=i("td",null,"of: (may be moved to ChildID to reuse filterBy)",-1),Bu=i("td",null,"type: (will be removed, only affects conditions)",-1),qu=i("option",{value:"or"},"or",-1),ju=i("option",{value:"and"},"and",-1),$u=[qu,ju],Du=i("td",null,"scope: ",-1),Gu=i("td",{class:"underline",title:"Ids are a string[], used by associationConstraints on entries, eg: to have a maximum number of commanders in a bataillion"}," ids: ",-1);function Qu(t,e,n,d,l,a){const s=F,o=U,g=V("FilterBy");return r(),u("div",null,[Fu,m(s,{item:n.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"]),m(o,{item:n.item,onCatalogueChanged:a.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(g,{class:"section",item:n.item,onCatalogueChanged:a.changed,catalogue:n.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),i("fieldset",Nu,[Su,i("table",Eu,[i("tr",null,[Ru,i("td",null,[y(i("input",{onInput:e[0]||(e[0]=(...c)=>a.changed&&a.changed(...c)),"onUpdate:modelValue":e[1]||(e[1]=c=>n.item.min=c),type:"number"},null,544),[[w,n.item.min]])])]),i("tr",null,[Ou,i("td",null,[y(i("input",{onInput:e[2]||(e[2]=(...c)=>a.changed&&a.changed(...c)),"onUpdate:modelValue":e[3]||(e[3]=c=>n.item.max=c),type:"number"},null,544),[[w,n.item.max]])])]),i("tr",null,[Vu,i("td",null,[y(i("input",{onInput:e[4]||(e[4]=(...c)=>a.changed&&a.changed(...c)),"onUpdate:modelValue":e[5]||(e[5]=c=>n.item.label=c),type:"text"},null,544),[[w,n.item.label]])])]),i("tr",null,[Uu,i("td",null,[y(i("input",{onInput:e[6]||(e[6]=(...c)=>a.changed&&a.changed(...c)),"onUpdate:modelValue":e[7]||(e[7]=c=>n.item.labelMembers=c),type:"text"},null,544),[[w,n.item.labelMembers]])])]),i("tr",null,[Lu,i("td",null,[y(i("input",{onInput:e[8]||(e[8]=(...c)=>a.changed&&a.changed(...c)),"onUpdate:modelValue":e[9]||(e[9]=c=>n.item.of=c),type:"text"},null,544),[[w,n.item.of]])])]),i("tr",null,[Bu,i("td",null,[y(i("select",{onChange:e[10]||(e[10]=(...c)=>a.changed&&a.changed(...c)),"onUpdate:modelValue":e[11]||(e[11]=c=>n.item.type=c)},$u,544),[[q,n.item.type]])])]),i("tr",null,[Du,i("td",null,[y(i("input",{onInput:e[12]||(e[12]=(...c)=>a.changed&&a.changed(...c)),"onUpdate:modelValue":e[13]||(e[13]=c=>n.item.scope=c),type:"text"},null,544),[[w,n.item.scope]])])]),i("tr",null,[Gu,i("td",null,[y(i("input",{"onUpdate:modelValue":e[14]||(e[14]=c=>n.item.ids=c),onInput:e[15]||(e[15]=(...c)=>a.changed&&a.changed(...c)),type:"text"},null,544),[[w,n.item.ids]])])])])])])}const Mu=f(Pu,[["render",Qu]]),Ku={props:{item:{type:Object,required:!0}},setup(){return{store:j()}},methods:{gotoTarget(t){return t.isCategory()?t.parent:t},parentEntry(t){return lt(t,e=>e.getName())},path(t,e=!0){const n=Pe(t);return e&&n.pop(),n},other_path(t){return Pe(t)}},computed:{show_link_name(){return this.item instanceof _t},links(){var t;return ie(((t=this.item)==null?void 0:t.links)||[],e=>{var n;return(n=e.catalogue)==null?void 0:n.name})},other_links(){var t;return ie(((t=this.item)==null?void 0:t.other_links)||[],e=>{var n;return(n=e.catalogue)==null?void 0:n.name})},label(){return oe(this.item)}},components:{NodePath:At}};const Hu={class:"mb-50px"},zu={class:"text-center"},Xu=i("span",{class:"gray"},"References to",-1),Wu={key:0,class:"mr-60px"},Yu={key:1,class:"mr-60px"},Ju=i("h3",null," From conditions/constraints/modifiers/repeats ",-1);function Zu(t,e,n,d,l,a){const s=V("NodePath");return r(),u("div",Hu,[i("h2",zu,[Xu,_(" "+C(a.label),1)]),a.links.length?(r(),u("div",Wu,[i("div",null,[(r(!0),u(k,null,P(a.links,o=>(r(),u("div",null,[m(s,{path:a.path(o),onClick:g=>d.store.goto(o),class:"hover-darken cursor-pointer p-1px"},null,8,["path","onClick"])]))),256))])])):p("",!0),a.other_links.length?(r(),u("div",Yu,[Ju,i("div",null,[(r(!0),u(k,null,P(a.other_links,o=>(r(),u("div",null,[m(s,{path:a.other_path(o),onClick:g=>d.store.goto(o),class:"hover-darken cursor-pointer p-1px mb-3px"},null,8,["path","onClick"])]))),256))])])):p("",!0)])}const ec=f(Ku,[["render",Zu]]),tc={setup(){return{store:j()}},emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0}},data(){return{links:["link","selectionEntryLink","selectionEntryGroupLink"],infoLinks:["infoLink","profileLink","ruleLink","infoGroupLink"]}},methods:{changed(){var t;this.store.set_catalogue_changed(((t=this.item)==null?void 0:t.catalogue)||this.catalogue)}},computed:{item(){return this.store.get_selected()},typeName(){var t;return(t=this.item)==null?void 0:t.editorTypeName}}};const nc={key:0,class:"rightPanel"},ac=i("div",{class:"min-h-100px"},null,-1);function ic(t,e,n,d,l,a){const s=tn,o=mn,g=ia,c=_i,h=Ci,b=Ei,A=qi,H=vs,Q=Js,Me=Ml,Ke=ar,He=_r,ze=Tr,Xe=Nr,We=Rr,Ye=Kr,Je=_u,Ze=Tu,et=Mu,tt=ec;return a.item?(r(),u("div",nc,[d.store.mode==="edit"?(r(),u(k,{key:0},[a.typeName=="publication"?(r(),v(s,{key:0,item:a.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])):a.typeName=="costType"?(r(),v(o,{key:1,item:a.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])):a.typeName=="profileType"?(r(),v(g,{key:2,item:a.item,onCatalogueChanged:a.changed},null,8,["item","onCatalogueChanged"])):a.typeName=="category"?(r(),v(c,{key:3,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="force"?(r(),v(h,{key:4,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="profile"?(r(),v(b,{key:5,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="rule"?(r(),v(A,{key:6,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="selectionEntry"?(r(),v(H,{key:7,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):l.links.includes(a.typeName)?(r(),v(Q,{key:8,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"entry"},null,8,["item","catalogue","onCatalogueChanged"])):l.infoLinks.includes(a.typeName)?(r(),v(Q,{key:9,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"info"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="modifier"?(r(),v(Me,{key:10,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="constraint"?(r(),v(Ke,{key:11,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="conditionGroup"?(r(),v(He,{key:12,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="condition"?(r(),v(ze,{key:13,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="categoryLink"?(r(),v(Q,{key:14,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"category"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="modifierGroup"?(r(),v(Xe,{key:15,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="infoGroup"?(r(),v(We,{key:16,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="selectionEntryGroup"?(r(),v(Ye,{key:17,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="catalogueLink"?(r(),v(Q,{key:18,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="catalogue"||a.typeName=="gameSystem"?(r(),v(Je,{key:19,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="repeat"?(r(),v(Ze,{key:20,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):a.typeName=="association"?(r(),v(et,{key:21,item:a.item,catalogue:n.catalogue,onCatalogueChanged:a.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):p("",!0),ac],64)):d.store.mode==="references"?(r(),v(tt,{key:1,item:a.item,catalogue:n.catalogue},null,8,["item","catalogue"])):p("",!0)])):p("",!0)}const oc=f(tc,[["render",ic]]),sc=te({components:{LeftPanel:En},data(){return{error:null,item:null,systemFiles:null,loading:!1,loading_all:!1,loading_progress:0,loading_progress_max:0,loading_progress_msg:"",initial:!0,saving:!1,failed:!1,id:"",cat:null,defaults:{},key:1}},setup(){return{cataloguesStore:pt(),store:j(),uistate:ft()}},mounted(){this.store.init(this),globalThis.$catalogue=this.cat,window.addEventListener("beforeunload",this.beforeUnload),document.addEventListener("keydown",this.onKeydown,!0)},updated(){this.store.init(this),globalThis.$catalogue=this.cat},unmounted(){window.removeEventListener("beforeunload",this.beforeUnload),document.removeEventListener("keydown",this.onKeydown,!0)},activated(){window.addEventListener("beforeunload",this.beforeUnload)},deactivated(){window.removeEventListener("beforeunload",this.beforeUnload)},beforeRouteUpdate(){this.id&&this.store.save_state()},beforeRouteLeave(){this.id&&this.store.save_state()},computed:{self_or_imports_changed(){var t,e;return this.file_changed(this.cat)||((e=(t=this.cat)==null?void 0:t.imports)==null?void 0:e.find(n=>this.file_changed(n)))},changed(){var t;return this.cat&&((t=this.store.get_catalogue_state(this.cat))==null?void 0:t.changed)||!1},unsaved(){var t;return this.cat&&((t=this.store.get_catalogue_state(this.cat))==null?void 0:t.unsaved)||!1},query(){return{gameSystemId:this.$route.query.systemId,catalogueId:this.$route.query.id||this.$route.query.systemId}},route_is_catalogue(){return this.$route.name==="catalogue"}},watch:{query:{async handler(t){var d;if(!this.route_is_catalogue)return;const{gameSystemId:e,catalogueId:n}=t;this.id=n||e,this.store.unselect();try{await this.load(e,this.id),(d=this.systemFiles)==null||d.loadAll(),this.error=null,this.$nextTick(()=>{this.store.$nextTickResolve&&this.store.$nextTickResolve()})}catch(l){console.error(l),this.error=l}},immediate:!0}},methods:{file_changed(t){return this.store.get_catalogue_state(t).isChangedOnDisk},async load_all(){if(this.systemFiles)try{this.loading_all=!0,await new Promise(t=>setTimeout(t,0)),await this.systemFiles.loadAll(async(t,e,n)=>{this.loading_progress=t,this.loading_progress_max=e,this.loading_progress_msg=n??"",await new Promise(d=>setTimeout(d,0))}),this.loading_progress=0,this.loading_progress_max=0,this.loading_progress_msg=""}catch(t){console.error(t)}finally{this.loading_all=!0}},async save_all(){var t;try{this.failed=await this.store.save_all((t=this.cat)==null?void 0:t.getSystemId())}finally{this.saving=!1}},async save(){try{const t=await this.store.prompt_revision(this.cat);await this.store.save_catalogue(this.systemFiles,this.cat,t)&&notify("Incremented 1 catalogue's revision"),this.failed=!1}catch{this.failed=!0}},async test(){var t;if(!((t=this.systemFiles)!=null&&t.github)){console.error("no github set");return}console.log("revision",await Ct(this.systemFiles.github,this.cat))},async beforeUnload(t){if(!globalThis._closeWindow&&(this.loading||this.store.save_state(),this.unsaved||this.store.unsavedCount)){const e="You have unsaved changes that will be lost";return t.returnValue=e,electron&&setTimeout(async()=>{await yt({message:"You have unsaved changes that will be lost?",buttons:["Cancel","Leave"],defaultId:0,cancelId:0,type:"question"})===1&&(globalThis._closeWindow=!0,bt())}),!1}},onKeydown(t){t.ctrlKey&&t.key.toLowerCase()=="s"&&(t.preventDefault(),t.stopPropagation(),this.save())},load_state(t){this.defaults=t},async load(t,e){if(!e&&!t)throw new Error("couldn't load catalogue: no id");try{this.loading=!0,this.initial&&(await new Promise(l=>setTimeout(l,10)),this.initial=!1);const n=await this.store.get_or_load_system(t);let d=n.getLoadedCatalogue({targetId:e||t});d||(d=await n.loadCatalogue({targetId:e||t})),d.processForEditor();for(const l of d.imports)l.processForEditor();if(this.systemFiles=n,this.cat=d,d){const l=this.uistate.get_data(d.id);this.load_state(l)}}finally{this.loading=!1}}}});const lc={class:"h-full"},dc={key:0},rc={class:"ml-10px"},uc={key:0,class:"inline",style:{"vertical-align":"-2px"},title:`This file or one of it's dependencies was changed by another program. 
You may want to reload the system through the Systems tab`,src:vt},cc={class:"text-slate-300"},gc={key:1,class:"status mx-2 text-red"},mc={key:2,class:"status mx-2"},hc={key:0};function _c(t,e,n,d,l,a){const s=It,o=Tt,g=rt,c=V("LeftPanel"),h=oc,b=kt;return r(),u("div",lc,[m(o,null,{default:x(()=>[m(s,null,{default:x(()=>{var A;return[_(C(t.loading?"Loading...":[(A=t.cat)==null?void 0:A.getName(),"NR-Editor"].filter(H=>H).join(" - ")),1)]}),_:1})]),_:1}),t.error?(r(),u("span",dc,C(t.error),1)):t.loading?(r(),v(g,{key:1,progress:t.loading_progress,progress_max:t.loading_progress_max,progress_msg:t.loading_progress_msg},null,8,["progress","progress_max","progress_msg"])):t.cat?(r(),v(b,{key:2,class:"h-full",draggable:"",showMiddle:"",id:"catalogueView"},{left:x(()=>[(r(),v(c,{ref:"leftpanel",class:"h-full",catalogue:t.cat,defaults:t.defaults,key:t.key,keepalive:""},null,8,["catalogue","defaults"]))]),middle:x(()=>[t.store.selectedItem!=null?(r(),v(h,{key:0,catalogue:t.cat},null,8,["catalogue"])):p("",!0)]),_:1})):p("",!0),t.cat&&t.route_is_catalogue?(r(),v(dt,{key:3,to:"#titlebar-content"},[i("span",rc,[_(" Editing "),t.self_or_imports_changed?(r(),u("img",uc)):p("",!0),_(" "+C(t.cat.name)+" ",1),i("span",cc,"v"+C(t.cat.revision),1)]),t.store.unsavedCount?(r(),u("button",{key:0,class:"bouton save ml-10px",onClick:e[0]||(e[0]=(...A)=>t.save_all&&t.save_all(...A))}," Save All ")):t.failed?(r(),u("span",gc,"failed to save")):(r(),u("span",mc,"saved")),t.systemFiles&&!t.systemFiles.allLoaded?(r(),u("button",{key:3,class:"bouton load ml-10px",onClick:e[1]||(e[1]=(...A)=>t.load_all&&t.load_all(...A))},[_("Load all "),t.loading_all?(r(),u("span",hc,"("+C(t.loading_progress)+" / "+C(t.loading_progress_max)+")",1)):p("",!0)])):p("",!0)])):p("",!0)])}const vc=f(sc,[["render",_c],["__scopeId","data-v-c750bbfa"]]);export{vc as default};
//# sourceMappingURL=catalogue.80d5eb52.js.map
