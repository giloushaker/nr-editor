import{b as me,e as Qe,a as C,o as s,f as c,h as m,i as l,w as _,v,F as b,r as D,j as R,k,l as h,m as V,p as w,t as p,q as f,s as N,x as P,y as ye,n as le,z as be,g as ve,A as S,B as G,C as ke,c as y,D as He,T as Ke}from"./entry.dcffd9c2.js";import{_ as ze}from"./Loading.58113f57.js";import{g as xe,s as Te,a as M,b as Z,_ as Ye,c as he,u as Q,d as We,f as Xe,e as X,h as Je,i as Ze,P as et,j as tt,k as nt,l as at,m as lt,n as it}from"./editorStore.7eeb7241.js";import{_ as T,a as ot}from"./SplitView.2b68aa1d.js";const st=n=>Object.fromEntries(Object.entries(n).filter(([,e])=>e!==void 0)),dt=(n,e)=>(a,u)=>(Qe(()=>n({...st(a),...u.attrs},u)),()=>{var d,t;return e?(t=(d=u.slots).default)==null?void 0:t.call(d):null}),ut=me({name:"Title",inheritAttrs:!1,setup:dt((n,{slots:e})=>{var u,d,t;return{title:((t=(d=(u=e.default)==null?void 0:u.call(e))==null?void 0:d[0])==null?void 0:t.children)||null}})}),ct=me({name:"Head",inheritAttrs:!1,setup:(n,e)=>()=>{var a,u;return(u=(a=e.slots).default)==null?void 0:u.call(a)}}),rt={emits:["change","update:modelValue"],props:{modelValue:{type:[String,Number,Array]},placeholder:{type:String,default:""}},methods:{change(n){n.target&&(this.$emit("update:modelValue",n.target.outerText),this.$emit("change"))},get(){return this.$refs.div},toHtml(n){return n.replace(/\n/g,"<br />")},onpaste(n){var a;n.preventDefault();var e=((a=n.clipboardData)==null?void 0:a.getData("text/plain"))??"";document.execCommand("insertText",!1,e),this.$emit("update:modelValue",this.get().innerText),this.$emit("change")}},mounted(){this.get().innerText=`${this.modelValue??""}`},watch:{modelValue(){this.get().innerText!=this.modelValue&&(this.get().innerText=`${this.modelValue??""}`)}}};const gt=["placeholder"];function mt(n,e,a,u,d,t){return s(),c("div",{placeholder:a.placeholder,class:"editableDiv",onInput:e[0]||(e[0]=(...o)=>t.change&&t.change(...o)),onPaste:e[1]||(e[1]=(...o)=>t.onpaste&&t.onpaste(...o)),contenteditable:"true",ref:"div"},null,40,gt)}const ie=C(rt,[["render",mt],["__scopeId","data-v-3e5dff74"]]),ht={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},computed:{comment:{get(){return(Array.isArray(this.item.comment)?this.item.comment[0]:this.item.comment)||""},set(n){this.item.comment=n?[n]:void 0}}},methods:{changed(){this.$emit("catalogueChanged")}}},_t=l("legend",null,"Comment",-1);function Ct(n,e,a,u,d,t){const o=ie;return s(),c("fieldset",null,[_t,m(o,{modelValue:t.comment,"onUpdate:modelValue":e[0]||(e[0]=i=>t.comment=i),onChange:t.changed},null,8,["modelValue","onChange"])])}const F=C(ht,[["render",Ct]]),pt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")},refresh(){this.id=xe(),this.changed()}},computed:{id:{get(){return this.item.id},set(n){const e=this.item,a=e.getCatalogue();a.removeFromIndex(e),e.id=n,a.addToIndex(e)}}}},ft=""+new URL("back.33e845c9.png",import.meta.url).href,yt=l("legend",null,"Basics",-1),bt={class:"editorTable"},vt=l("td",null,"Unique ID:",-1),kt={class:"flex gap-5px"},xt=l("span",null,[l("img",{class:"h-20px w-20px icon",src:ft,title:"Generated Id"})],-1),Tt=[xt],Ft=l("td",null,"Name:",-1);function It(n,e,a,u,d,t){return s(),c("fieldset",null,[yt,l("table",bt,[l("tr",null,[vt,l("td",kt,[_(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>t.id=o),onChange:e[1]||(e[1]=(...o)=>t.changed&&t.changed(...o)),class:"flex flex-shrink"},null,544),[[v,t.id]]),l("button",{class:"bouton !w-32px flex m-0 p-0 mr-8px",onClick:e[2]||(e[2]=(...o)=>t.refresh&&t.refresh(...o))},Tt)])]),l("tr",null,[Ft,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>a.item.name=o),onChange:e[4]||(e[4]=(...o)=>t.changed&&t.changed(...o))},null,544),[[v,a.item.name]])])])])])}const A=C(pt,[["render",It]]),Nt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Pt=l("legend",null,"Publication",-1),Rt={class:"editorTable"},wt=l("td",null,"Short Name",-1),At=l("td",null,"Publication:",-1),Ot=l("td",null,"Publication Date:",-1),Et=l("td",null,"Publication URL:",-1);function Vt(n,e,a,u,d,t){return s(),c("fieldset",null,[Pt,l("table",Rt,[l("tr",null,[wt,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.shortName=o),onChange:e[1]||(e[1]=(...o)=>t.changed&&t.changed(...o))},null,544),[[v,a.item.shortName]])])]),l("tr",null,[At,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=o=>a.item.publisher=o),onChange:e[3]||(e[3]=(...o)=>t.changed&&t.changed(...o))},null,544),[[v,a.item.publisher]])])]),l("tr",null,[Ot,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=o=>a.item.publicationDate=o),onChange:e[5]||(e[5]=(...o)=>t.changed&&t.changed(...o))},null,544),[[v,a.item.publicationDate]])])]),l("tr",null,[Et,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=o=>a.item.publisherUrl=o),onChange:e[7]||(e[7]=(...o)=>t.changed&&t.changed(...o))},null,544),[[v,a.item.publisherUrl]])])])])])}const St=C(Nt,[["render",Vt]]),Ut={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Lt(n,e,a,u,d,t){const o=F,i=A,r=St;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{class:"section",item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"])],64)}const qt=C(Ut,[["render",Lt]]),jt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Bt=l("label",{for:"hidden"},"Hidden",-1);function Dt(n,e,a,u,d,t){return s(),c("fieldset",null,[l("legend",null,[D(n.$slots,"default")]),_(l("input",{id:"hidden",type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.hidden=o),onChange:e[1]||(e[1]=(...o)=>t.changed&&t.changed(...o))},null,544),[[R,a.item.hidden]]),Bt])}const H=C(jt,[["render",Dt]]),Gt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},$t={class:"section"},Mt=l("legend",null,"Limit",-1),Qt={class:"editorTable"},Ht=l("td",null,"Default Cost Limit: ",-1),Kt=l("span",{class:"gray ml-10px"},"-1 = No limit",-1);function zt(n,e,a,u,d,t){const o=F,i=A,r=H;return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Cost Types ")]),_:1},8,["item","onCatalogueChanged"]),l("div",$t,[l("fieldset",null,[Mt,l("table",Qt,[l("tr",null,[Ht,l("td",null,[_(l("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=g=>a.item.defaultCostLimit=g),onChange:e[1]||(e[1]=(...g)=>t.changed&&t.changed(...g))},null,544),[[v,a.item.defaultCostLimit]]),Kt])])])])])])}const Yt=C(Gt,[["render",zt]]),Wt={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},data(){return{selectedType:null}},computed:{selected:{set(n){this.selectedType=this.item.characteristicTypes.find(e=>e.id===n)||null},get(){var n;return((n=this.selectedType)==null?void 0:n.id)||null}}},methods:{add(){this.item.characteristicTypes||(this.item.characteristicTypes=[]),this.item.characteristicTypes.push({id:xe(),name:"New Characteristic Type"}),this.changed()},del(){if(this.selectedType&&this.item.characteristicTypes){const n=this.item.characteristicTypes.indexOf(this.selectedType);n!=-1&&(this.item.characteristicTypes.splice(n,1),this.selectedType=this.item.characteristicTypes[0])}},changed(){this.$emit("catalogueChanged")},init(){var n;(n=this.item.characteristicTypes)!=null&&n.length&&(this.selectedType=this.item.characteristicTypes[0])}},created(){this.init()},watch:{item(){this.init()}}},Xt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAXCAYAAAALHW+jAAABhGlDQ1BJQ0MgcHJvZmlsZQAAKJF9kT1Iw0AcxV8/RCkVB4uIOASsTlZERRy1CkWoEGqFVh1MLv2CJg1Jiouj4Fpw8GOx6uDirKuDqyAIfoA4OjkpukiJ/0sKLWI8OO7Hu3uPu3eAv15mqhkcB1TNMlKJuJDJrgqdrwiiDyGMYUhipj4nikl4jq97+Ph6F+NZ3uf+HN1KzmSATyCeZbphEW8QT29aOud94ggrSgrxOfGoQRckfuS67PIb54LDfp4ZMdKpeeIIsVBoY7mNWdFQiaeIo4qqUb4/47LCeYuzWq6y5j35C8M5bWWZ6zQHkcAiliBCgIwqSijDQoxWjRQTKdqPe/gHHL9ILplcJTByLKACFZLjB/+D392a+ckJNykcBzpebPtjGOjcBRo12/4+tu3GCRB4Bq60lr9SB2Y+Sa+1tOgR0LMNXFy3NHkPuNwB+p90yZAcKUDTn88D72f0TVmg9xYIrbm9Nfdx+gCkqavkDXBwCIwUKHvd491d7b39e6bZ3w+TdnK04tslPQAAAAZiS0dEAP8A/wD/oL2nkwAAAAlwSFlzAAAOxAAADsQBlSsOGwAAAAd0SU1FB+YEFgsEBONvEkAAAAAZdEVYdENvbW1lbnQAQ3JlYXRlZCB3aXRoIEdJTVBXgQ4XAAAAfklEQVQ4y+2VOw7AMAhDTdVj5nbknnTpkCIMapqt8YYELx9LRlDLXC34IAOgQ63BAelpvrmTucY4EoD6xEvayDOsk533jVZC6f9NzR6kwbupzm3vPipgK8zpgdMpcFobuIG/AGoSoixglQHFB2UhGeC0v9wZxc4JyW9z8cG4AK8CG5AjF625AAAAAElFTkSuQmCC";const K=n=>(N("data-v-872b6126"),n=n(),P(),n),Jt=K(()=>l("legend",null,"Profil Type",-1)),Zt=K(()=>l("h3",null,"Characteristic Types",-1)),en=["value"],tn={class:"section add"},nn=K(()=>l("img",{src:T},null,-1)),an=K(()=>l("img",{src:Xt},null,-1)),ln=K(()=>l("h3",{class:"section"},"Selected Characteristic Type",-1)),on={class:"editorTable"},sn=K(()=>l("td",null,"Unique Id:",-1)),dn=K(()=>l("td",null,"Name:",-1));function un(n,e,a,u,d,t){return s(),c("fieldset",null,[Jt,Zt,l("div",null,[_(l("select",{size:"2","onUpdate:modelValue":e[0]||(e[0]=o=>t.selected=o)},[(s(!0),c(b,null,w(a.item.characteristicTypes,o=>(s(),c("option",{value:o.id},p(o.name),9,en))),256))],512),[[V,t.selected]]),l("div",tn,[l("button",{class:"bouton",onClick:e[1]||(e[1]=(...o)=>t.add&&t.add(...o))},[nn,h(" Add ")]),l("button",{class:"bouton",onClick:e[2]||(e[2]=(...o)=>t.del&&t.del(...o))},[an,h(" Delete ")])]),d.selectedType?(s(),c(b,{key:0},[ln,l("table",on,[l("tr",null,[sn,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=o=>d.selectedType.id=o),onChange:e[4]||(e[4]=(...o)=>t.changed&&t.changed(...o))},null,544),[[v,d.selectedType.id]])])]),l("tr",null,[dn,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[5]||(e[5]=o=>d.selectedType.name=o),onChange:e[6]||(e[6]=(...o)=>t.changed&&t.changed(...o))},null,544),[[v,d.selectedType.name]])])])])],64)):f("",!0)])])}const cn=C(Wt,[["render",un],["__scopeId","data-v-872b6126"]]),rn={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function gn(n,e,a,u,d,t){const o=F,i=A,r=cn;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{class:"section",item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"])],64)}const mn=C(rn,[["render",gn]]),hn={props:{modelValue:String,placeholder:{type:String,default:"Search..."},min:{type:Number,default:0},max:{type:Number,default:1e3},options:{type:[Array,Function],required:!0},valueField:{type:String,default:""},filterField:{type:[String,Function],default:""},lazy:{type:Boolean,default:!1},default:{type:Object},nullable:{type:Boolean,default:!1}},created(){this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset()},data(){return{searchPattern:"",lastSearch:null,editing:!1,selectedOption:null,sleeping:this.lazy}},computed:{computedOptions(){return Array.isArray(this.options)?this.options:this.sleeping?[]:this.options()},foundOptions(){const n=this.textSearchRegex(this.searchPattern),e=[];this.nullable&&e.push({option:void 0});const a=this.computedOptions,u=this.max||a.length;for(let d=0;d<a.length;d++){const t=a[d];let o=this.getField(t);if(o&&o.match&&o.match(n)&&(e.push({option:t}),e.length>=u-1))break}return e}},methods:{getField(n){return this.filterField?this.filterField instanceof Function?this.filterField(n):n[this.filterField]:n},escapeRegex(n){return n.replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1")},textSearchRegex(n){const a=`^(?=.*\\b${this.escapeRegex(n).split(" ").join(".*)(?=.*\\b")}).*$`;return new RegExp(a,"i")},targetSelected(n){let e=n.option;this.valueField.length&&(this.nullable&&!n.option?e=void 0:e=n.option[this.valueField]),this.selectedOption={option:n.option,selected:!0},this.$emit("update:modelValue",e),this.$emit("change")},reset(){if(this.searchPattern="",this.selectedOption=null,this.modelValue){let n=this.computedOptions.find(e=>{let a=e;return this.valueField&&(a=e[this.valueField]),a===this.modelValue});n?this.selectedOption={option:n,selected:!0}:this.selectedOption=null}},onClickOutside(){this.editing=!1},suggest(){this.searchPattern.length<this.min?this.editing=!1:this.startEditing()},maySuggest(){this.sleeping=!1,this.searchPattern="",this.min==0&&this.suggest()},clicked(){this.editing=!1},startEditing(){this.editing||(this.sleeping=!1,this.editing=!0,this.searchPattern="")}},watch:{options(){this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset()},modelValue(){this.editing||(this.lazy?this.selectedOption={option:this.default,selected:!0}:this.reset())},async editing(){this.editing&&(await this.$nextTick(),this.$refs.edit&&this.$refs.edit.focus())}}};const _n={class:"autocomplete container"},Cn=["placeholder"],pn={key:0,class:"gray"},fn=["onClickCapture"];function yn(n,e,a,u,d,t){const o=ye("click-outside");return s(),c("div",_n,[d.editing?_((s(),c("input",{key:0,class:"input autocomplete-input",type:"text",ref:"edit",onInput:e[0]||(e[0]=(...i)=>t.suggest&&t.suggest(...i)),onClick:e[1]||(e[1]=(...i)=>t.maySuggest&&t.maySuggest(...i)),"onUpdate:modelValue":e[2]||(e[2]=i=>d.searchPattern=i),placeholder:a.placeholder},null,40,Cn)),[[v,d.searchPattern],[o,t.onClickOutside]]):(s(),c("div",{key:1,onClick:e[3]||(e[3]=(...i)=>t.startEditing&&t.startEditing(...i)),class:"autocomplete-input"},[d.selectedOption?D(n.$slots,"option",le(be({key:1},d.selectedOption))):(s(),c("span",pn,p(a.placeholder),1))])),l("div",{class:S(["suggestions",{hidden:!d.editing}])},[(s(!0),c(b,null,w(t.foundOptions,i=>(s(),c("div",{onClickCapture:r=>t.targetSelected(i)},[D(n.$slots,"option",le(ve(i)))],40,fn))),256))],2)])}const z=C(hn,[["render",yn]]),bn={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},computed:{publications(){return Te([...this.catalogue.iteratePublications()],n=>(n==null?void 0:n.name)||"")}},methods:{getNameExtra:M,getName:Z,changed(){this.$emit("catalogueChanged")}}},vn=l("legend",null,"Reference",-1),kn={class:"editorTable"},xn=l("td",null,"Publication:",-1),Tn={class:"flex align-items flex-row"},Fn=["src"],In={class:"inline"},Nn={class:"grey"},Pn=["src"],Rn=l("span",{class:"inline"},"None",-1),wn=l("td",null,"Page:",-1);function An(n,e,a,u,d,t){const o=z;return s(),c("fieldset",null,[vn,l("table",kn,[l("tr",null,[xn,l("td",null,[m(o,{options:t.publications,filterField:i=>i.getName(),valueField:"id",modelValue:a.item.publicationId,"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.publicationId=i),onChange:t.changed,nullable:""},{option:k(({option:i})=>[l("div",Tn,[i?(s(),c(b,{key:0},[l("img",{class:"mr-1 my-auto",src:`./assets/bsicons/${i.editorTypeName}.png`},null,8,Fn),l("span",In,[h(p(t.getName(i))+" ",1),l("span",Nn,p(t.getNameExtra(i)),1)])],64)):(s(),c(b,{key:1},[l("img",{class:"mr-1 my-auto",src:"./assets/bsicons/bullet.png"},null,8,Pn),Rn],64))])]),_:1},8,["options","filterField","modelValue","onChange"])])]),l("tr",null,[wn,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=i=>a.item.page=i),onChange:e[2]||(e[2]=(...i)=>t.changed&&t.changed(...i))},null,544),[[v,a.item.page]])])])])])}const U=C(bn,[["render",An]]),On=""+globalThis.__publicAssetsURL("assets/icons/undo.svg"),En=""+globalThis.__publicAssetsURL("assets/icons/redo.svg"),Vn=""+new URL("collapse-all.40557dca.svg",import.meta.url).href,Y=n=>(N("data-v-1d164363"),n=n(),P(),n),Sn={class:"leftPanel"},Un={class:"static sticky flex items-center h-28px z-1"},Ln={class:"absolute right-30px"},qn=Y(()=>l("option",{value:"none"},"No Sorting ",-1)),jn=Y(()=>l("option",{value:"asc"},"Ascending ",-1)),Bn=Y(()=>l("option",{value:"desc"},"Descending ",-1)),Dn=Y(()=>l("option",{value:"type"},"Type",-1)),Gn=[qn,jn,Bn,Dn],$n={class:"bottom static"},Mn={key:0},Qn=Y(()=>l("label",{class:"unselectable cursor-pointer",for:"showimport"},"Show Imported",-1)),Hn=Y(()=>l("span",null,"  ",-1)),Kn={class:"absolute right-5px"},zn=Y(()=>l("label",{class:"unselectable cursor-pointer",for:"ignoreProfilesRules"},"Ignore Profiles/Rules",-1));function Yn(n,e,a,u,d,t){const o=he,i=G("CatalogueEntry");return s(),c("div",Sn,[l("div",Un,[l("span",{class:S([{grey:!n.store.can_back(),"cursor-pointer":n.store.can_back(),"hover-darken":n.store.can_back()},"bold p-4px unselectable icon"]),onClick:e[0]||(e[0]=(...r)=>n.store.back&&n.store.back(...r)),title:"Back"}," 🡰 ",2),l("span",{class:S([{grey:!n.store.can_forward(),"cursor-pointer":n.store.can_forward(),"hover-darken":n.store.can_forward()},"bold p-4px unselectable ml-4px icon"]),onClick:e[1]||(e[1]=(...r)=>n.store.forward&&n.store.forward(...r)),title:"Forward"}," 🡲 ",2),l("img",{class:S([{grey:!n.store.can_undo(),"cursor-pointer":n.store.can_undo(),"hover-darken":n.store.can_undo()},"bold p-4px unselectable ml-5px w-24px h-24px icon"]),onClick:e[2]||(e[2]=(...r)=>n.store.undo&&n.store.undo(...r)),title:"Undo",src:On},null,2),l("img",{class:S([{grey:!n.store.can_redo(),"cursor-pointer":n.store.can_redo(),"hover-darken":n.store.can_redo()},"bold p-4px unselectable ml-4px w-24px h-24px icon"]),onClick:e[3]||(e[3]=(...r)=>n.store.redo&&n.store.redo(...r)),title:"Redo",src:En},null,2),l("div",Ln,[h(" Sort "),_(l("select",{class:"h-24px p-2px !text-sm","onUpdate:modelValue":e[4]||(e[4]=r=>n.settings.sort=r)},Gn,512),[[V,n.settings.sort]])]),l("img",{onClick:e[5]||(e[5]=(...r)=>n.uistate.collapse_all&&n.uistate.collapse_all(...r)),class:"align-middle absolute right-0 p-2px hover-darken cursor-pointer icon",title:"Collapse All",src:Vn}),m(o,{errors:n.catalogue.errors,showNumber:"",clickable:"",class:"z-1"},null,8,["errors"])]),l("div",{class:"top rightborder scrollable",ref:"scrollable",onScroll:e[6]||(e[6]=(...r)=>n.onscroll&&n.onscroll(...r)),onKeydownCapture:e[7]||(e[7]=(...r)=>n.keydown&&n.keydown(...r))},[m(i,{class:"mb-40px",item:n.catalogue,grouped:"",id:"editor-entries",showImported:n.showImported},null,8,["item","showImported"])],544),l("div",$n,[n.catalogue.isGameSystem()?f("",!0):(s(),c("span",Mn,[_(l("input",{class:"cursor-pointer","onUpdate:modelValue":e[8]||(e[8]=r=>n.showImported=r),type:"checkbox",id:"showimport"},null,512),[[R,n.showImported]]),Qn])),Hn,l("span",Kn,[_(l("input",{class:"cursor-pointer","onUpdate:modelValue":e[9]||(e[9]=r=>n.ignoreProfilesRules=r),type:"checkbox",id:"ignoreProfilesRules"},null,512),[[R,n.ignoreProfilesRules]]),zn]),_(l("input",{"onUpdate:modelValue":e[10]||(e[10]=r=>n.filter=r),ref:"editor-searchbox",type:"search",placeholder:"search... ctrl+f",class:"w-full"},null,512),[[v,n.filter]])])])}const Wn=C(Ye,[["render",Yn],["__scopeId","data-v-1d164363"]]),Xn={emits:["catalogueChanged"],setup(){return{store:Q()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},methods:{changed(){this.$emit("catalogueChanged")},add(n,e){this.store.create_child("constraints",this.item,{type:n,scope:e,value:1,select:!1})}}};const L=n=>(N("data-v-8db7f9bc"),n=n(),P(),n),Jn=L(()=>l("legend",null,"Quick Constraints",-1)),Zn={class:"columns"},ea={class:"buttonList"},ta=L(()=>l("img",{src:T},null,-1)),na=L(()=>l("img",{src:T},null,-1)),aa=L(()=>l("img",{src:T},null,-1)),la=L(()=>l("img",{src:T},null,-1)),ia={class:"buttonList"},oa=L(()=>l("img",{src:T},null,-1)),sa=L(()=>l("img",{src:T},null,-1)),da=L(()=>l("img",{src:T},null,-1)),ua=L(()=>l("img",{src:T},null,-1));function ca(n,e,a,u,d,t){return s(),c("fieldset",null,[Jn,l("div",Zn,[l("div",ea,[l("button",{class:"bouton",onClick:e[0]||(e[0]=o=>t.add("min","parent"))},[ta,h("MIN 1 IN PARENT ")]),a.withCategory?(s(),c("button",{key:0,class:"bouton",onClick:e[1]||(e[1]=o=>t.add("min","parent"))},[na,h("MIN 1 IN CATEGORY ")])):f("",!0),l("button",{class:"bouton",onClick:e[2]||(e[2]=o=>t.add("min","force"))},[aa,h("MIN 1 IN FORCE ")]),l("button",{class:"bouton",onClick:e[3]||(e[3]=o=>t.add("min","roster"))},[la,h("MIN 1 IN ROSTER ")])]),l("div",ia,[l("button",{class:"bouton",onClick:e[4]||(e[4]=o=>t.add("max","parent"))},[oa,h("MAX 1 IN PARENT ")]),a.withCategory?(s(),c("button",{key:0,class:"bouton",onClick:e[5]||(e[5]=o=>t.add("max","parent"))},[sa,h("MAX 1 IN CATEGORY ")])):f("",!0),l("button",{class:"bouton",onClick:e[6]||(e[6]=o=>t.add("max","force"))},[da,h("MAX 1 IN FORCE ")]),l("button",{class:"bouton",onClick:e[7]||(e[7]=o=>t.add("max","roster"))},[ua,h("MAX 1 IN ROSTER ")])])])])}const ee=C(Xn,[["render",ca],["__scopeId","data-v-8db7f9bc"]]),ra={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function ga(n,e,a,u,d,t){const o=F,i=A,r=U,g=H,x=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(x,{item:a.item,onCatalogueChanged:t.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const ma=C(ra,[["render",ga]]),ha={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function _a(n,e,a,u,d,t){const o=F,i=A,r=U,g=H,x=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(x,{item:a.item,onCatalogueChanged:t.changed,withCategory:!0,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Ca=C(ha,[["render",_a]]),pa={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{getName:Z,getNameExtra:M,changedType(){this.item.getCatalogue().refreshErrors(this.item),this.$emit("catalogueChanged")},changed(){this.$emit("catalogueChanged")}},computed:{profileTypes(){return[...this.catalogue.iterateProfileTypes()]},charactacteristics(){var u;const n={};for(const d of this.item.characteristics||[])n[d.name]=d.$text;const e=this.catalogue.findOptionById(this.item.typeId);this.item.isLink()||(this.item.typeName=e==null?void 0:e.name);const a=(u=e==null?void 0:e.characteristicTypes)==null?void 0:u.map(d=>({name:d.name,typeId:d.id,$text:n[d.name]||""}));return this.item.characteristics=a,a}}},fa=l("legend",null,"Characteristics",-1),ya={class:"editorTable"},ba=l("td",null,"Profile Type: ",-1),va={class:"flex align-items flex-row"},ka=["src"],xa={class:"inline"},Ta={class:"grey"},Fa={class:"editorTable"};function Ia(n,e,a,u,d,t){const o=z,i=ie;return s(),c("fieldset",null,[fa,l("table",ya,[l("tr",null,[ba,l("td",null,[m(o,{options:t.profileTypes,filterField:r=>r.getName(),valueField:"id",modelValue:a.item.typeId,"onUpdate:modelValue":e[0]||(e[0]=r=>a.item.typeId=r),onChange:t.changed},{option:k(({option:r})=>[l("div",va,[l("img",{class:"mr-1 my-auto",src:`./assets/bsicons/${r.editorTypeName}.png`},null,8,ka),l("span",xa,[h(p(t.getName(r))+" ",1),l("span",Ta,p(t.getNameExtra(r)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])])])]),l("table",Fa,[(s(!0),c(b,null,w(t.charactacteristics,r=>(s(),c("tr",null,[l("td",null,p(r.name)+": ",1),l("td",null,[m(i,{modelValue:r.$text,"onUpdate:modelValue":g=>r.$text=g,onChange:t.changed},null,8,["modelValue","onUpdate:modelValue","onChange"])])]))),256))])])}const Na=C(pa,[["render",Ia]]),Pa={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ra(n,e,a,u,d,t){const o=F,i=A,r=U,g=H,x=Na;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(x,{class:"section",item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const wa=C(Pa,[["render",Ra]]),Aa={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Oa=l("legend",null,"Description",-1);function Ea(n,e,a,u,d,t){const o=ie;return s(),c("fieldset",null,[Oa,m(o,{modelValue:a.item.description,"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.description=i),onChange:t.changed},null,8,["modelValue","onChange"])])}const Va=C(Aa,[["render",Ea]]),Sa={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ua(n,e,a,u,d,t){const o=F,i=A,r=U,g=H,x=Va;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(x,{class:"section",item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])],64)}const La=C(Sa,[["render",Ua]]),qa={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},ja={class:"editorTable"},Ba=l("td",null,"Type:",-1),Da=ke('<option value="model">Model</option><option value="upgrade">Upgrade</option><option value="unit">Unit</option><option value="mount">Mount</option><option value="crew">Crew</option>',5),Ga=[Da];function $a(n,e,a,u,d,t){return s(),c("fieldset",null,[l("legend",null,[D(n.$slots,"default")]),l("table",ja,[l("tr",null,[Ba,l("td",null,[_(l("select",{"onUpdate:modelValue":e[0]||(e[0]=o=>a.item.type=o),onChange:e[1]||(e[1]=(...o)=>t.changed&&t.changed(...o))},Ga,544),[[V,a.item.type]])])])])])}const Ma=C(qa,[["render",$a]]),Qa={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{placeholder(){return`${this.item.isLink()&&this.item.getDefaultAmount()||"unset"}`}}};const Fe=n=>(N("data-v-202b280a"),n=n(),P(),n),Ha=Fe(()=>l("legend",null,"Creation",-1)),Ka={class:"editorTable"},za=Fe(()=>l("td",null,"Default Amount:",-1)),Ya=["placeholder"];function Wa(n,e,a,u,d,t){return s(),c("fieldset",null,[Ha,l("table",Ka,[l("tr",null,[za,l("td",null,[_(l("input",{class:"input",type:"number","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.defaultAmount=o),onChange:e[1]||(e[1]=(...o)=>t.changed&&t.changed(...o)),placeholder:t.placeholder},null,40,Ya),[[v,a.item.defaultAmount]])])])])])}const Ie=C(Qa,[["render",Wa],["__scopeId","data-v-202b280a"]]),Xa={props:{modelValue:{type:[Number,String]},required:{type:Boolean,required:!1},min:{type:Number,required:!1},max:{type:Number,required:!1}},data(){return{stringValue:null,intValue:0}},watch:{modelValue(){this.refresh()}},created(){this.refresh()},methods:{refresh(){this.intValue=this.modelValue||0,this.stringValue=""+this.modelValue},update(){this.stringValue!=null&&(this.intValue=parseFloat(this.stringValue),this.$emit("update:modelValue",this.intValue),this.$emit("change"))}}},Ja=["required","min","max"];function Za(n,e,a,u,d,t){return _((s(),c("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>d.stringValue=o),type:"number",onChange:e[1]||(e[1]=(...o)=>t.update&&t.update(...o)),required:a.required,min:a.min,max:a.max},null,40,Ja)),[[v,d.stringValue]])}const W=C(Xa,[["render",Za]]),el={emits:["catalogueChanged"],data(){return{selectedCosts:{}}},created(){this.update()},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{costTypes(){let n=[];for(let e of this.catalogue.iterateCostTypes())n.push(e);return n}},methods:{changed(){this.item.costs=Object.values(this.selectedCosts).filter(n=>isFinite(n.value)),this.$emit("catalogueChanged")},update(){this.selectedCosts={};const n=this.item.isLink()?void 0:0;for(let e of Object.values(this.costTypes))this.selectedCosts[e.id]={name:e.name,typeId:e.id,value:n};if(this.item.costs)for(let e of this.item.costs)this.selectedCosts[e.typeId]={name:e.name,typeId:e.typeId,value:e.value}}},watch:{item(){this.update()}}};const tl=n=>(N("data-v-bad156ce"),n=n(),P(),n),nl=tl(()=>l("legend",null,"Costs",-1)),al={class:"costs"};function ll(n,e,a,u,d,t){const o=W;return s(),c("fieldset",null,[nl,l("div",al,[(s(!0),c(b,null,w(t.costTypes,i=>(s(),c("div",null,[l("label",null,p(i.name)+": ",1),d.selectedCosts[i.id]!=null?(s(),y(o,{key:0,modelValue:d.selectedCosts[i.id].value,"onUpdate:modelValue":r=>d.selectedCosts[i.id].value=r,class:"input",onChange:t.changed,placeholder:"unset"},null,8,["modelValue","onUpdate:modelValue","onChange"])):f("",!0)]))),256))])])}const Ne=C(el,[["render",ll],["__scopeId","data-v-bad156ce"]]),il={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{fields(){return[{name:"Hidden",status:this.hidden,field:"hidden"},{name:"Collective",status:this.collective,field:"collective",title:"indicates that multiple instances of this entry may be combined into one entry with an amount"},{name:"Import",status:this.eimport,field:"import",title:"Indicates that this entry may be imported by other catalogues"}]},hidden(){return!0},collective(){var n;if((n=this.item.parent)!=null&&n.isCatalogue()){const e=this.item.parentKey;if(e==="selectionEntries"||e==="entryLinks")return 0}switch(this.item.editorTypeName){case"selectionEntryLink":return 1;case"selectionEntryGroupLink":return 1;case"selectionEntry":return 1;case"selectionEntryGroup":return 1;case"categoryLink":return-1;case"infoLink":return-1;case"profileLink":return-1;case"ruleLink":return-1;case"infoGroupLink":return-1}return 1},eimport(){var n;if((n=this.item.parent)!=null&&n.isCatalogue())return 1;switch(this.item.editorTypeName){case"selectionEntryLink":return 0;case"selectionEntryGroupLink":return 0;case"selectionEntry":return 0;case"selectionEntryGroup":return 0;case"categoryLink":return-1;case"infoLink":return-1;case"profileLink":return-1;case"ruleLink":return-1;case"infoGroupLink":return-1}return 0}}};const ol={class:"booleans"},sl=["id","onUpdate:modelValue","disabled"],dl=["for","title"];function ul(n,e,a,u,d,t){return s(),c("fieldset",null,[l("legend",null,[D(n.$slots,"default",{},void 0,!0)]),l("div",ol,[(s(!0),c(b,null,w(t.fields.filter(o=>o.status!=-1),o=>(s(),c("div",null,[_(l("input",{class:S({"cursor-pointer":o.status!==0}),id:o.field,type:"checkbox","onUpdate:modelValue":i=>a.item[o.field]=i,onChange:e[0]||(e[0]=(...i)=>t.changed&&t.changed(...i)),disabled:o.status==0},null,42,sl),[[R,a.item[o.field]]]),l("label",{class:S({"cursor-pointer":o.status!==0,gray:o.status==0,hastooltip:!!o.title}),for:o.field,title:o.title},p(o.name),11,dl)]))),256))])])}const _e=C(il,[["render",ul],["__scopeId","data-v-8aa7e0e5"]]),cl={emits:["catalogueChanged"],data(){return{filter:"",primaries:new Set,secondaries:new Set}},setup(){return{settings:He()}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{primaryChanged(n){this.refreshCategories(this.item,n,!0)},secondaryChanged(n){this.refreshCategories(this.item,n,!1)},refreshCategories(n,e,a){n.categoryLinks||(n.categoryLinks=[]);const u=n.categoryLinks;if(a&&u.forEach(d=>d.primary=!1),e){const d=u.find(t=>t.targetId===(e==null?void 0:e.id));d&&a?d.primary=!0:d?this.removeLink(u,d):this.addLink(u,e,a)}this.changed()},removeLink(n,e){const a=n.findIndex(u=>u===e);if(a!==-1){const[u]=n.splice(a,1);this.catalogue.removeFromIndex(u);const d=u.target.links;if(d){const t=d==null?void 0:d.findIndex(o=>o===u);t!==-1&&(d==null||d.splice(t,1))}}},addLink(n,e,a=!1){var t;if(!e.isCategory())throw Error("Invalid argument, target must be a category");const u=We({targetId:e.id,target:e,id:this.catalogue.generateNonConflictingId(),primary:a,catalogue:this.catalogue,name:e.name},"categoryLinks");n.push(u),this.catalogue.addToIndex(u);const d=e;return d.links||(d.links=[]),(t=d.links)==null||t.push(u),u},changed(){this.$emit("catalogueChanged")},hasCategory(n){var a;let e=(a=this.item.categoryLinks)==null?void 0:a.find(u=>{var d;return((d=u.target)==null?void 0:d.id)===n.id});return e?e.primary?2:1:0},noPrimary(){let n=!0;if(this.item.categoryLinks){for(let e of this.item.categoryLinks)if(e.primary)return!1}return n}},computed:{badLinks(){const n=[],e=new Set;for(const a of this.catalogue.iterateCategoryEntries())e.add(a.id);for(const a of this.item.categoryLinks||[])e.has(a.targetId)||n.push(a);return n},count(){var n;return((n=this.item.categoryLinks)==null?void 0:n.length)||0},categories(){let n=[];for(let e of this.catalogue.iterateCategoryEntries())this.settings.showOnlyEnabledCategories&&this.hasCategory(e)==0||e.getName().toLowerCase().includes(this.filter.toLowerCase())&&n.push(e);return n}}};const rl=n=>(N("data-v-2be2c149"),n=n(),P(),n),gl={class:"section inline"},ml=rl(()=>l("label",{for:"onlyEnabled"},"Only show selected categories",-1)),hl={class:"section categoryList"},_l=["checked"],Cl=["checked","onChange"],pl=["id","checked","onChange"],fl=["for"],yl=["checked","onChange"],bl=["id","onChange"],vl=["for"];function kl(n,e,a,u,d,t){const o=he;return s(),c("fieldset",null,[l("legend",null,"Categories ("+p(t.count)+")",1),_(l("input",{class:"section",type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>d.filter=i),placeholder:"Filter categories..."},null,512),[[v,d.filter]]),l("div",gl,[_(l("input",{type:"checkbox",id:"onlyEnabled","onUpdate:modelValue":e[1]||(e[1]=i=>u.settings.showOnlyEnabledCategories=i)},null,512),[[R,u.settings.showOnlyEnabledCategories]]),ml]),l("div",hl,[l("div",null,[l("input",{name:"primary",type:"radio",checked:t.noPrimary,onChange:e[2]||(e[2]=i=>t.primaryChanged(null))},null,40,_l),h(" No Primary ")]),(s(!0),c(b,null,w(t.categories,i=>(s(),c("div",{class:"category",key:i.id},[l("div",null,[l("input",{name:"primary",type:"radio",checked:t.hasCategory(i)==2,onChange:r=>t.primaryChanged(i)},null,40,Cl),h(" Primary? ")]),l("div",null,[l("input",{id:`cat${i.id}`,type:"checkbox",checked:t.hasCategory(i)!=0,onChange:r=>t.secondaryChanged(i)},null,40,pl),l("label",{for:`cat${i.id}`},p(i.name),9,fl)])]))),128)),(s(!0),c(b,null,w(t.badLinks,i=>(s(),c("div",{class:"category",key:i.id},[l("div",null,[l("input",{name:"primary",type:"radio",checked:t.hasCategory(i)==2,onChange:r=>t.primaryChanged(i)},null,40,yl),h(" Primary? ")]),l("div",null,[l("input",{id:`bad${i.id}`,type:"checkbox",checked:!0,onChange:r=>t.removeLink(a.item.categoryLinks,i)},null,40,bl),l("label",{for:`bad${i.id}`},p(i.name),9,vl),m(o,{class:"ml-5px inline",errors:[{msg:`Couldn't find category with id: ${i.targetId}`,severity:"error"}]},null,8,["errors"])])]))),128))])])}const Ce=C(cl,[["render",kl],["__scopeId","data-v-2be2c149"]]),xl={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Tl(n,e,a,u,d,t){const o=F,i=A,r=U,g=Ma,x=Ie,E=Ne,I=_e,B=Ce,j=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Selection Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(x,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(E,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(I,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(B,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(j,{item:a.item,onCatalogueChanged:t.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Fl=C(xl,[["render",Tl]]),Il={setup(){return{store:Q()}},emits:["catalogueChanged"],data(){return{filter:"",val:null}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},type:{type:String,required:!0}},computed:{allowEntries(){return!0},allowGroups(){var n;return!((n=this.item.parent)!=null&&n.isCatalogue()&&this.item.parentKey==="entryLinks")}},methods:{getNameExtra:M,availableTargets(){if(this.type==="catalogue"){const e=this.catalogue.gameSystemId||this.catalogue.id;return Object.values(this.store.get_system(e).catalogueFiles).map(d=>({id:d.catalogue.id,name:d.catalogue.name,editorTypeName:"catalogueLink"}))}const n=[];for(const e of this.catalogue.iterateAllImported())this.targetIsValid(e)&&(e.isLink()||n.push(e));return Te(n,e=>e.name)},typeChanged(){},targetIdChanged(){this.updateLink(),this.changed()},async updateLink(){var n;if(this.type==="catalogue"&&this.item.targetId){const e=this.catalogue.gameSystemId||this.catalogue.id;await this.catalogue.reload(this.store.get_system(e));const a=this.item.target;this.item.name=((n=this.item.target)==null?void 0:n.name)||"Unknown",this.item.type=(a==null?void 0:a.editorTypeName)||this.type}else{this.catalogue.updateLink(this.item);const e=this.item.target;this.item.name=(e==null?void 0:e.name)||"Unknown",this.item.type=(e==null?void 0:e.editorTypeName)||this.item.type}},changedImportRootEntries(){this.changed()},changed(){this.$emit("catalogueChanged")},getType(n){return n.target?n.target.editorTypeName:"bullet"},itemName(n){return n.name},itemValue(n){return n.name},targetIsValid(n){return this.item.type==null||this.item.type==="category"?n.editorTypeName=="category":n.editorTypeName==this.item.type},showCatalogue(n){var e;return!(!n.catalogue||n.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))}}},Pe="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAFKSURBVDhPpZLBSgJRFIbvuTtHXyBaWEG0TRxFCAJd9B6B4CLoXaKVLVr4FK3GTRGEMwvXYYPQI1TQ4D2d/3gVnEFh7IPBc37mHD2/P5kcH63WuVssBmxMT9pjaESUOmPGhnl4miQJtBXrBfNOp/KbZXdS9kUsLAaylGXJY4Xo9jCOv6Hpi374SZpL9CuOosgYa03a7cqojHsc80tAdIUlFgK+OT8MbK2mTx5LdPHDfK81bpbPPppSEF2/NxqhhWHbbt6FzhANrHd7L2RJDx7oX7UndTXxP4ihlPq6NHL+3Drnxr4vMGu3zSwMNzKQI7Li5FATVh5eED1YzbbE04sbnEwm+mxhdBbHb2oiss3Mzyp7bLXqq2Uic7wGWXaDYh2gz2Yz0HhKwnYEC6eOMHwwnX5BKLyIeCJhCIm0dWjqthiWyc342dCWGPMHCdh2fZxOhd0AAAAASUVORK5CYII=";const O=n=>(N("data-v-5c15c63e"),n=n(),P(),n),Nl=O(()=>l("legend",null,"Link",-1)),Pl={class:"editorTable"},Rl={key:0},wl=O(()=>l("td",null,"Link Type:",-1)),Al={key:0,value:"selectionEntry"},Ol={key:1,value:"selectionEntryGroup"},El={key:1},Vl=O(()=>l("td",null,"Link Type:",-1)),Sl=O(()=>l("option",{value:"profile"},"Profile",-1)),Ul=O(()=>l("option",{value:"rule"}," Rule ",-1)),Ll=O(()=>l("option",{value:"infoGroup"}," Info Group ",-1)),ql=[Sl,Ul,Ll],jl=O(()=>l("td",null,"Link To:",-1)),Bl=["src"],Dl=O(()=>l("img",{class:"errIcon",src:Pe},null,-1)),Gl=O(()=>l("td",null,"Target ID:",-1)),$l=O(()=>l("td",null,"Target:",-1)),Ml=["src"],Ql={class:"gray"},Hl={key:0,class:"shared"},Kl={key:1,class:"catalogueName"},zl={key:2},Yl=O(()=>l("td",null,null,-1)),Wl=O(()=>l("label",{for:"importRoot"},"Import Root Entries",-1));function Xl(n,e,a,u,d,t){const o=z;return s(),c("fieldset",null,[Nl,l("table",Pl,[a.type=="entry"?(s(),c("tr",Rl,[wl,l("td",null,[_(l("select",{onChange:e[0]||(e[0]=(...i)=>t.typeChanged&&t.typeChanged(...i)),"onUpdate:modelValue":e[1]||(e[1]=i=>a.item.type=i)},[t.allowEntries?(s(),c("option",Al,"Selection Entry")):f("",!0),t.allowGroups?(s(),c("option",Ol," Selection Entry Group ")):f("",!0)],544),[[V,a.item.type]])])])):f("",!0),a.type=="info"?(s(),c("tr",El,[Vl,l("td",null,[_(l("select",{onChange:e[2]||(e[2]=(...i)=>t.typeChanged&&t.typeChanged(...i)),"onUpdate:modelValue":e[3]||(e[3]=i=>a.item.type=i)},ql,544),[[V,a.item.type]])])])):f("",!0),l("tr",null,[jl,l("td",null,[a.item.target?(s(),c(b,{key:0},[a.item.type?(s(),c("img",{key:0,class:"linkIcon",src:`./assets/bsicons/${t.getType(a.item)}.png`},null,8,Bl)):f("",!0),h(" "+p(a.item.target.name),1)],64)):(s(),c(b,{key:1},[Dl,h(" No target selected ")],64))])]),l("tr",null,[Gl,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=i=>a.item.targetId=i),onChange:e[5]||(e[5]=(...i)=>t.targetIdChanged&&t.targetIdChanged(...i))},null,544),[[v,a.item.targetId]])])]),l("tr",null,[$l,l("td",null,[m(o,{modelValue:a.item.targetId,"onUpdate:modelValue":e[6]||(e[6]=i=>a.item.targetId=i),placeholder:"Search Target...",options:t.availableTargets,valueField:"id",filterField:"name",onChange:t.targetIdChanged},{option:k(i=>[l("div",null,[l("img",{class:"mr-1 align-middle",src:`./assets/bsicons/${i.option.editorTypeName}.png`},null,8,Ml),h(" "+p(i.option.name)+" ",1),l("span",Ql,p(t.getNameExtra(i.option,!1)),1),i.option.shared?(s(),c("span",Hl," (shared)")):f("",!0),t.showCatalogue(i.option)?(s(),c("span",Kl," ["+p(i.option.catalogue)+"]",1)):f("",!0)])]),_:1},8,["modelValue","placeholder","options","onChange"])])]),a.type==="catalogue"?(s(),c("tr",zl,[Yl,l("td",null,[_(l("input",{onChange:e[7]||(e[7]=(...i)=>t.changedImportRootEntries&&t.changedImportRootEntries(...i)),id:"importRoot",type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=i=>a.item.importRootEntries=i)},null,544),[[R,a.item.importRootEntries]]),Wl])])):f("",!0)])])}const Jl=C(Il,[["render",Xl],["__scopeId","data-v-5c15c63e"]]),Zl={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},type:{type:String,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function ei(n,e,a,u,d,t){const o=F,i=A,r=U,g=Jl,x=Ne,E=Ie,I=_e,B=Ce,j=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),a.type!="catalogue"?(s(),y(r,{key:0,item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):f("",!0),m(g,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section",type:a.type},null,8,["item","catalogue","onCatalogueChanged","type"]),a.item.editorTypeName=="selectionEntryLink"?(s(),y(x,{key:1,item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):f("",!0),a.item.editorTypeName=="selectionEntryLink"?(s(),y(E,{key:2,item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):f("",!0),a.type!="catalogue"?(s(),y(I,{key:3,item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"])):f("",!0),a.item.editorTypeName=="selectionEntryLink"||a.item.editorTypeName=="selectionEntryGroupLink"?(s(),y(B,{key:4,item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"])):f("",!0),a.type=="entry"||a.type=="category"?(s(),y(j,{key:5,item:a.item,onCatalogueChanged:t.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])):f("",!0)],64)}const ti=C(Zl,[["render",ei]]),ni={props:{modelValue:{type:Object},placeholder:{type:String,default:"Search..."},fetch:{type:Function,required:!0},disabled:{type:Boolean,default:!1}},created(){this.reset()},data(){return{searchPattern:"",lastSearch:null,editing:!1,selectedOption:null,availableOptions:[]}},methods:{async foundOptions(){return(await this.fetch()).map(e=>({option:e}))},targetSelected(n){let e=n.option;this.selectedOption={option:n.option,selected:!0},this.$emit("update:modelValue",e),this.$emit("change",n.option),this.editing=!1},reset(){this.searchPattern="",this.selectedOption=null,this.modelValue&&(this.selectedOption={option:this.modelValue,selected:!0})},onClickOutside(){this.editing=!1},async startEditing(){this.disabled||(this.editing=!0,this.availableOptions=await this.foundOptions())},clicked(){this.editing=!1}}};const ai={key:0,class:"gray"},li=["onClick"];function ii(n,e,a,u,d,t){const o=ye("click-outside");return s(),c("div",{class:S(["container",{disabled:a.disabled}])},[_((s(),c("div",{onClick:e[0]||(e[0]=(...i)=>t.startEditing&&t.startEditing(...i)),class:"iconselect-input"},[d.selectedOption?D(n.$slots,"option",le(be({key:1},d.selectedOption))):(s(),c("span",ai,p(a.placeholder),1))])),[[o,t.onClickOutside]]),l("div",{class:S(["suggestions",{hidden:!d.editing}])},[(s(!0),c(b,null,w(d.availableOptions,i=>(s(),c("div",{onClick:r=>t.targetSelected(i)},[D(n.$slots,"option",le(ve(i)))],8,li))),256))],2)],2)}const Re=C(ni,[["render",ii]]),oi={selectionEntry:["costs","name","page","hidden","category","constraints"],selectionEntryLink:["costs","name","page","hidden","category","constraints"],selectionEntryGroup:["name","page","hidden","category","constraints","defaultSelectionEntryId"],selectionEntryGroupLink:["name","page","hidden","category","constraints","defaultSelectionEntryId"],profile:["characteristics","name","description","page","hidden"],profileLink:["characteristics","name","description","page","hidden"],rule:["name","description","page","hidden"],ruleLink:["name","description","page","hidden"],infoLink:["name","page","hidden"],infoGroup:["name","page","hidden"],infoGroupLink:["name","page","hidden"],force:["name","page","hidden","constraints"],category:["name","page","hidden","constraints"],categoryLink:["name","page","hidden","constraints"]},si={costs:"number",name:"string",page:"string",hidden:"boolean",description:"string",category:"category",defaultSelectionEntryId:"defaultSelectionEntryId",constraints:"number"},di={components:{ErrorIcon:he},emits:["catalogueChanged"],data(){return{value:"",selectedField:null,selectedOperation:null,selectedValue:null}},created(){this.update()},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{getName:Z,getNameExtra:M,changed(){this.selectedField&&(this.item.field=this.selectedField.id),this.selectedOperation&&(this.item.type=this.selectedOperation.id),this.$emit("catalogueChanged")},getDefaultFieldValue(n,e,a){var u;switch(n){case"number":return typeof a=="number"?a:0;case"category":return this.allCategories[0].id;case"string":let d;if(e==="name"){const t=this.item;d=t.getName&&t.getName()||""}else d="";return typeof a=="string"?a:d;case"string-or-number":return["strint","number"].includes(typeof a)?a:"";case"boolean":return typeof a=="boolean"?a:!1;case"defaultSelectionEntryId":return(u=Xe(this.allGroupEntries))==null?void 0:u.id;default:throw Error(`fieldType "${n}" has no default value set"`)}},fieldChanged(){this.selectedOperation=this.operations[0],this.selectedField&&(this.item.value=this.getDefaultFieldValue(this.selectedField.type,this.selectedField.name,this.item.value)),this.changed()},update(){this.selectedField=this.fieldData.find(n=>n.id===this.item.field)||null,this.selectedOperation=this.operations.find(n=>n.id===this.item.type)||null,this.selectedField||(this.selectedField=this.fieldData[0]),this.selectedOperation||(this.selectedOperation=this.operations[0]||null)}},watch:{item(){this.update()}},computed:{inputType(){var n,e;return this.selectedField?this.selectedField.type==="category"?"category":this.selectedField.type==="defaultSelectionEntryId"?"defaultSelectionEntryId":this.selectedField.type==="number"?"number":this.selectedField.type==="boolean"?"boolean":((n=this.selectedOperation)==null?void 0:n.id)==="increment"||((e=this.selectedOperation)==null?void 0:e.id)==="decrement"?"number":"string":""},parent(){return X(this.item)},allCategories(){let n=[];for(let e of this.catalogue.iterateCategoryEntries())n.push(e);return n},allGroupEntries(){var n;return[...((n=this.parent)==null?void 0:n.selectionsIterator())||[]]},operations(){return this.selectedField?{number:[{id:"set",name:"Set",word:"to"},{id:"increment",name:"Increment",word:"by"},{id:"decrement",name:"Decrement",word:"by"}],string:[{id:"set",name:"Set",word:"to"},{id:"append",name:"Append",word:"to"}],"string-or-number":[{id:"set",name:"Set",word:"to"},{id:"append",name:"Append",word:"to"},{id:"increment",name:"Increment",word:"by"},{id:"decrement",name:"Decrement",word:"by"}],boolean:[{id:"set",name:"Set",word:"to"}],defaultSelectionEntryId:[{id:"set",name:"Set",word:""}],category:[{id:"add",name:"Add",word:""},{id:"remove",name:"Remove",word:""},{id:"set-primary",name:"Set Primary",word:"to"},{id:"unset-primary",name:"Unset Primary",word:"to"}]}[this.selectedField.type]:[]},errors(){return[]},fieldData(){if(!this.parent)return[];let n=oi[this.parent.editorTypeName];const e=[];if(!n)return[];if(n.includes("costs"))for(const a of this.catalogue.iterateCostTypes())e.push({id:a.id,name:a.name,type:"number",modifierType:"cost"});if(n.includes("constraints"))for(const a of this.parent.constraintsIterator())e.push({id:a.id,name:Z(a),type:"number",modifierType:"constraint"});if(n.includes("characteristics")){const a=this.parent.isLink()?this.parent.target:this.parent;a!=null&&a.characteristics&&e.push(...a.characteristics.map(u=>({id:u.typeId,name:u.name,type:"string-or-number",modifierType:"characteristic",value:u.$text})))}return n.includes("category")&&e.push({id:"category",name:"Category",type:"category",modifierType:"category"}),n=n.filter(a=>["costs","constraints","category","characteristics"].includes(a)==!1),n.map(a=>({id:a,name:a,type:si[a],modifierType:"bullet"})).concat(e)}}};const oe=n=>(N("data-v-e259c784"),n=n(),P(),n),ui=oe(()=>l("legend",null,"Modifier",-1)),ci={class:"modifier"},ri=["value"],gi={class:"flex align-items flex-row"},mi=["src"],hi={class:"inline"},_i={key:1},Ci=oe(()=>l("option",{value:!0},"True",-1)),pi=oe(()=>l("option",{value:!1},"False",-1)),fi=[Ci,pi],yi={class:"flex align-items flex-row"},bi=["src"],vi={class:"inline"},ki={class:"grey"},xi={class:"flex align-items flex-row"},Ti=["src"],Fi={class:"inline"},Ii={class:"grey"},Ni={class:"mt-8px flex items-center"},Pi=oe(()=>l("img",{src:Pe},null,-1)),Ri={class:"ml-10px"};function wi(n,e,a,u,d,t){const o=Re,i=W,r=z;return s(),c("fieldset",null,[ui,l("div",ci,[d.selectedOperation?_((s(),c("select",{key:0,"onUpdate:modelValue":e[0]||(e[0]=g=>d.selectedOperation=g),onChange:e[1]||(e[1]=(...g)=>t.changed&&t.changed(...g))},[(s(!0),c(b,null,w(t.operations,g=>(s(),c("option",{value:g},p(g.name),9,ri))),256))],544)),[[V,d.selectedOperation]]):f("",!0),m(o,{modelValue:d.selectedField,"onUpdate:modelValue":e[2]||(e[2]=g=>d.selectedField=g),fetch:()=>t.fieldData,onChange:t.fieldChanged,class:"modType min-w-200px"},{option:k(g=>[l("div",gi,[l("img",{class:"mr-1 my-auto",src:`./assets/bsicons/${g.option.modifierType}.png`},null,8,mi),l("span",hi,p(g.option.name),1)])]),_:1},8,["modelValue","fetch","onChange"]),d.selectedOperation?(s(),c("span",_i,p(d.selectedOperation.word),1)):f("",!0),t.inputType==="number"?(s(),y(i,{key:2,onChange:t.changed,modelValue:a.item.value,"onUpdate:modelValue":e[3]||(e[3]=g=>a.item.value=g)},null,8,["onChange","modelValue"])):f("",!0),t.inputType=="boolean"?_((s(),c("select",{key:3,onChange:e[4]||(e[4]=(...g)=>t.changed&&t.changed(...g)),"onUpdate:modelValue":e[5]||(e[5]=g=>a.item.value=g)},fi,544)),[[V,a.item.value]]):f("",!0),t.inputType.includes("string")?_((s(),c("input",{key:4,onChange:e[6]||(e[6]=(...g)=>t.changed&&t.changed(...g)),type:"text","onUpdate:modelValue":e[7]||(e[7]=g=>a.item.value=g)},null,544)),[[v,a.item.value]]):f("",!0),t.inputType=="category"?(s(),y(r,{key:5,options:t.allCategories,filterField:g=>g.getName(),valueField:"id",modelValue:a.item.value,"onUpdate:modelValue":e[8]||(e[8]=g=>a.item.value=g),onChange:t.changed},{option:k(({option:g})=>[l("div",yi,[l("img",{class:"mr-1 my-auto",src:`./assets/bsicons/${g.editorTypeName}.png`},null,8,bi),l("span",vi,[h(p(t.getName(g))+" ",1),l("span",ki,p(t.getNameExtra(g)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])):f("",!0),t.inputType=="defaultSelectionEntryId"?(s(),y(r,{key:6,options:t.allGroupEntries,filterField:g=>g.getName(),valueField:"id",modelValue:a.item.value,"onUpdate:modelValue":e[9]||(e[9]=g=>a.item.value=g),onChange:t.changed},{option:k(({option:g})=>[l("div",xi,[l("img",{class:"mr-1 my-auto",src:`./assets/bsicons/${g.editorTypeName}.png`},null,8,Ti),l("span",Fi,[h(p(t.getName(g))+" ",1),l("span",Ii,p(t.getNameExtra(g)),1)])])]),_:1},8,["options","filterField","modelValue","onChange"])):f("",!0)]),(s(!0),c(b,null,w(t.errors,g=>(s(),c("div",Ni,[Pi,l("span",Ri,p(g.msg),1)]))),256))])}const Ai=C(di,[["render",wi],["__scopeId","data-v-e259c784"]]),Oi={emits:["catalogueChanged"],setup(){return{store:Q()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},computed:{type(){return this.item.editorTypeName},parent(){return this.item.parent}},methods:{changed(){this.$emit("catalogueChanged")},add(n,e,a,u){e==="id"&&(e=this.item.id);let d=this.item;this.store.create_child("conditions",d,{scope:n,field:e,type:a,value:u,childId:"any"})}}};const q=n=>(N("data-v-5d031eba"),n=n(),P(),n),Ei=q(()=>l("legend",null,"Quick Conditions",-1)),Vi={class:"columns"},Si={class:"buttonList"},Ui=q(()=>l("img",{src:T},null,-1)),Li=q(()=>l("img",{src:T},null,-1)),qi=q(()=>l("img",{src:T},null,-1)),ji=q(()=>l("img",{src:T},null,-1)),Bi={class:"buttonList"},Di=q(()=>l("img",{src:T},null,-1)),Gi=q(()=>l("img",{src:T},null,-1)),$i=q(()=>l("img",{src:T},null,-1)),Mi=q(()=>l("img",{src:T},null,-1));function Qi(n,e,a,u,d,t){return s(),c("fieldset",null,[Ei,l("div",Vi,[l("div",Si,[l("button",{class:"bouton",onClick:e[0]||(e[0]=o=>t.add("parent","selections","atLeast",1))},[Ui,h("PARENT ATLEAST 1 ")]),l("button",{class:"bouton",onClick:e[1]||(e[1]=o=>t.add("force","selections","atLeast",1))},[Li,h("FORCE ATLEAST 1 ")]),l("button",{class:"bouton",onClick:e[2]||(e[2]=o=>t.add("roster","selections","atLeast",1))},[qi,h("ROSTER ATLEAST 1 ")]),l("button",{class:"bouton",onClick:e[3]||(e[3]=o=>t.add("ancestor","selections","instanceOf",1))},[ji,h("ANCESTOR INSTANCE OF ")])]),l("div",Bi,[l("button",{class:"bouton",onClick:e[4]||(e[4]=o=>t.add("parent","selections","lessThan",1))},[Di,h("PARENT LESS THAN 1 ")]),l("button",{class:"bouton",onClick:e[5]||(e[5]=o=>t.add("force","selections","lessThan",1))},[Gi,h("FORCE LESS THAN 1 ")]),l("button",{class:"bouton",onClick:e[6]||(e[6]=o=>t.add("roster","selections","lessThan",1))},[$i,h("ROSTER LESS THAN 1 ")]),l("button",{class:"bouton",onClick:e[7]||(e[7]=o=>t.add("ancestor","selections","notInstanceOf",1))},[Mi,h("ANCESTOR NOT INSTANCE OF ")])])])])}const we=C(Oi,[["render",Qi],["__scopeId","data-v-5d031eba"]]),Hi={emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0},item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ki(n,e,a,u,d,t){const o=F,i=Ai,r=we;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{class:"section",item:a.item,onCatalogueChanged:t.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),m(r,{item:a.item,onCatalogueChanged:t.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const zi=C(Hi,[["render",Ki]]),Yi={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};const J=n=>(N("data-v-5aec87f9"),n=n(),P(),n),Wi=J(()=>l("legend",null,"Constraint",-1)),Xi={class:"editorTable"},Ji=J(()=>l("td",null,"Unique ID:",-1)),Zi={class:"constraint"},eo=J(()=>l("option",{value:"min"},"Minimum",-1)),to=J(()=>l("option",{value:"max"},"Maximum",-1)),no=J(()=>l("option",{value:"exactly"},"Exactly",-1)),ao=[eo,to,no],lo=J(()=>l("label",{for:"percent"},"Percentage?",-1));function io(n,e,a,u,d,t){const o=W;return s(),c("fieldset",null,[Wi,l("table",Xi,[l("tr",null,[Ji,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>a.item.id=i),onChange:e[1]||(e[1]=(...i)=>t.changed&&t.changed(...i))},null,544),[[v,a.item.id]])])])]),l("div",Zi,[_(l("select",{"onUpdate:modelValue":e[2]||(e[2]=i=>a.item.type=i),onChange:e[3]||(e[3]=(...i)=>t.changed&&t.changed(...i))},ao,544),[[V,a.item.type]]),m(o,{modelValue:a.item.value,"onUpdate:modelValue":e[4]||(e[4]=i=>a.item.value=i),onChange:t.changed},null,8,["modelValue","onChange"]),l("div",null,[_(l("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=i=>a.item.percentValue=i),onChange:e[6]||(e[6]=(...i)=>t.changed&&t.changed(...i))},null,544),[[R,a.item.percentValue]]),lo])])])}const oo=C(Yi,[["render",io],["__scopeId","data-v-5aec87f9"]]);function se(n,e,a,u=0){var d,t;for(const o of n[e]())a.push({name:o.name,editorTypeName:o.editorTypeName,id:o.id,indent:u,catalogue:o.catalogue.getName(),shared:((t=(d=$(o))==null?void 0:d.parentKey)==null?void 0:t.includes("shared"))||!1}),se(o,e,a,u+1)}function so(n,e,a,u,d=0){var t,o;for(const i of n[e]())u.push({name:i.name,editorTypeName:i.editorTypeName,id:i.id,indent:d,catalogue:i.catalogue.getName(),shared:((o=(t=$(i))==null?void 0:t.parentKey)==null?void 0:o.includes("shared"))||!1}),se(i,e,u,d+1)}function pe(n,e){let a=[];return se(n,e,a),a}function re(n,e){const a=[];return se(n,e?"iterateSelectionEntriesWithRoot":"iterateSelectionEntries",a),a}function uo(n,e){const a=[],u=n.getPrimaryCategory();return so(e,"iterateAllRootEntries",d=>$(d).getPrimaryCategory()===u,a),a}function Ae(n){var a,u;const e=[];for(let d of n.iterateCategoryEntries()){const t=d;t.isCatalogue()||e.push({name:t.name,editorTypeName:t.editorTypeName,id:t.id,indent:0,catalogue:t.catalogue.getName(),shared:((u=(a=$(t))==null?void 0:a.parentKey)==null?void 0:u.includes("shared"))||!1})}return e}function co(n){const e=[];for(const a of Object.values(n.manager.getAllCatalogueFiles())){if(!a.catalogue)continue;const u=Je(a);e.push({name:u.name,editorTypeName:"catalogue",id:u.id,indent:0,catalogue:null,shared:!1})}return e}function ro(n){let e=0,a=X(n);for(;a;)e++,a=a.parent;return e}function go(n){var t,o;let e=[],a=n,u=0;const d=ro(n)-1;for(a=X(n);a!=null&&!a.isCatalogue();)a.editorTypeName==="selectionEntry"&&(e.push({name:a.name,id:a.id,editorTypeName:a.editorTypeName,indent:u,catalogue:a.catalogue.getName(),shared:((o=(t=$(a))==null?void 0:t.parentKey)==null?void 0:o.includes("shared"))||!1}),u++),a=a.parent;return e=e.reverse(),e.forEach((i,r)=>{i.indent=r+d}),e}function ge(n){const e=pe(n,"iterateRootEntries");return e.splice(0,1),e}function mo(n){return["self","parent","ancestor","primary-category","primary-catalogue","force","roster"].includes(n.scope)==!1}function $(n){let e=n;for(;e.parent!=null&&e.parent.editorTypeName!="gameSystem"&&e.parent.editorTypeName!="catalogue";)e=e.parent;return e}function ho(n,e){if(["primary-catalogue","roster","force","ancestor"].includes(n.scope))return re(e,!0);const u=re(e,!1);if(n.scope=="self"){const t=X(n);return t?u.concat(ge(t)):u}if(n.scope=="parent"){if($(n))return re(e,!0);const t=X(n);return t!=null&&t.parent?u.concat(ge(t.parent)):u}if(n.scope=="primary-category")return uo($(n),e);const d=e.findOptionById(n.scope);return d?u.concat(ge(d)):u}const _o={emits:["catalogueChanged"],data(){return{itemField:null}},props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0},childForces:{type:Boolean,default:!1},childSelections:{type:Boolean,default:!1},shared:{type:Boolean,default:!1}},methods:{getNameExtra:M,changed(){this.$emit("catalogueChanged")},fieldChanged(){this.item.field=this.itemField.value,this.changed()},showCatalogue(n){var e;return!(!n.catalogue||n.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))}},computed:{instanceOf(){var n;return["instanceOf","notInstanceOf"].includes((n=this.item)==null?void 0:n.type)},fieldTypes(){const n=[];this.instanceOf&&n.push({name:"",value:void 0,type:null}),n.push({name:"Selections",value:"selections",type:"bullet"}),n.push({name:"Forces",value:"forces",type:"bullet"});for(const e of this.costTypes)n.push({name:e.name,value:e.id,type:"cost"}),this.item.scope==="roster"&&n.push({name:`${e.name} Limit`,value:`limit::${e.id}`,type:"cost"});return n},includeCategories(){return this.item.field!=="forces"},includeForces(){return!0},includeSelections(){return this.item.field!="forces"},parent(){return this.item.parent},costTypes(){let n=[];for(let e of this.catalogue.iterateCostTypes())n.push(e);return n},allSelections(){return this.includeSelections?go(this.item):[]},allCategories(){return this.includeCategories?Ae(this.catalogue):[]},allForces(){return this.includeForces?pe(this.catalogue,"forcesIterator"):[]},allScopes(){let n=[{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"}];return this.item.field!="forces"&&["condition"].includes(this.item.editorTypeName)&&(n=[{id:"self",name:"Self",editorTypeName:"bullet"},{id:"parent",name:"Parent",editorTypeName:"bullet"},{id:"ancestor",name:"Ancestor",editorTypeName:"bullet",title:"checks the condition in all parents"},{id:"primary-category",name:"Primary Category",editorTypeName:"bullet"},{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"},{id:"primary-catalogue",name:"Primary Catalogue",editorTypeName:"bullet"}]),this.item.field!=="forces"&&["repeat","constraint"].includes(this.item.editorTypeName)&&(n=[{id:"parent",name:"Parent",editorTypeName:"bullet"},{id:"force",name:"Force",editorTypeName:"bullet"},{id:"roster",name:"Roster",editorTypeName:"bullet"},{id:"primary-catalogue",name:"Primary Catalogue",editorTypeName:"bullet"}]),n.concat(this.allSelections).concat(this.allCategories).concat(this.allForces)}},watch:{"item.field":{handler(){this.item.field=="forces"&&(this.item.scope="roster"),this.itemField=this.fieldTypes.find(n=>n.value==this.item.field)},immediate:!0}}};const te=n=>(N("data-v-5ebf8d17"),n=n(),P(),n),Co=te(()=>l("legend",null,"Query",-1)),po={class:"query"},fo=["src"],yo=te(()=>l("span",null," in ",-1)),bo=["src"],vo={class:"gray"},ko={key:1,class:"shared"},xo={key:2,class:"catalogueName"},To={class:"checks"},Fo={key:0},Io=te(()=>l("label",{for:"shared"},"Shared",-1)),No={key:1},Po=te(()=>l("label",{for:"childSelections"},"And all child Selections",-1)),Ro={key:2},wo=te(()=>l("label",{for:"childForces"},"And all child Forces",-1));function Ao(n,e,a,u,d,t){const o=Re,i=z;return s(),c("fieldset",null,[Co,l("div",po,[m(o,{modelValue:d.itemField,"onUpdate:modelValue":e[0]||(e[0]=r=>d.itemField=r),fetch:()=>t.fieldTypes,onChange:t.fieldChanged,class:"modType",disabled:t.instanceOf},{option:k(r=>[l("div",null,[l("img",{class:"mr-1 align-middle",src:`./assets/bsicons/${r.option.type}.png`},null,8,fo),h(" "+p(r.option.name),1)])]),_:1},8,["modelValue","fetch","onChange","disabled"]),yo,m(i,{modelValue:a.item.scope,"onUpdate:modelValue":e[1]||(e[1]=r=>a.item.scope=r),placeholder:"Search Scope...",options:t.allScopes,valueField:"id",filterField:"name",onChange:t.changed},{option:k(r=>[l("div",null,[r.option.indent>=2&&!r.selected?(s(!0),c(b,{key:0},w(r.option.indent-1,g=>(s(),c("span",null,"   "))),256)):f("",!0),l("img",{class:"mr-1 align-middle",src:`./assets/bsicons/${r.option.editorTypeName}.png`},null,8,bo),h(" "+p(r.option.name)+" ",1),l("span",vo,p(t.getNameExtra(r.option,!1)),1),r.option.shared?(s(),c("span",ko," (shared)")):f("",!0),t.showCatalogue(r.option)?(s(),c("span",xo," ["+p(r.option.catalogue)+"]",1)):f("",!0)])]),_:1},8,["modelValue","placeholder","options","onChange"]),l("div",To,[a.shared?(s(),c("div",Fo,[_(l("input",{onChange:e[2]||(e[2]=(...r)=>t.changed&&t.changed(...r)),id:"shared",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=r=>a.item.shared=r)},null,544),[[R,a.item.shared]]),Io])):f("",!0),a.childSelections?(s(),c("div",No,[_(l("input",{onChange:e[4]||(e[4]=(...r)=>t.changed&&t.changed(...r)),id:"childSelections",type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=r=>a.item.includeChildSelections=r)},null,544),[[R,a.item.includeChildSelections]]),Po])):f("",!0),a.childForces?(s(),c("div",Ro,[_(l("input",{onChange:e[6]||(e[6]=(...r)=>t.changed&&t.changed(...r)),id:"childForces",type:"checkbox","onUpdate:modelValue":e[7]||(e[7]=r=>a.item.includeChildForces=r)},null,544),[[R,a.item.includeChildForces]]),wo])):f("",!0)])])])}const fe=C(_o,[["render",Ao],["__scopeId","data-v-5ebf8d17"]]),Oo={emits:["catalogueChanged"],setup(){return{store:Q()}},props:{item:{type:Object,required:!0},withCategory:{type:Boolean,default:!1}},computed:{type(){return this.item.editorTypeName},parent(){return this.item.parent}},methods:{changed(){this.$emit("catalogueChanged")},add(n,e,a){n==="id"&&(n=this.item.id);let u=this.item;this.type==="constraint"&&(u=this.parent),this.store.create_child("modifiers",u,{field:n,type:e,value:a})}}};const ne=n=>(N("data-v-39863412"),n=n(),P(),n),Eo=ne(()=>l("legend",null,"Quick Modifiers",-1)),Vo={class:"columns"},So={class:"buttonList"},Uo=ne(()=>l("img",{src:T},null,-1)),Lo=ne(()=>l("img",{src:T},null,-1)),qo={class:"buttonList"},jo=ne(()=>l("img",{src:T},null,-1)),Bo=ne(()=>l("img",{src:T},null,-1));function Do(n,e,a,u,d,t){return s(),c("fieldset",null,[Eo,l("div",Vo,[t.type==="constraint"?(s(),c(b,{key:0},[l("div",So,[l("button",{class:"bouton",onClick:e[0]||(e[0]=o=>t.add("id","increment",1))},[Uo,h("INCREMENT 1 ")]),l("button",{class:"bouton",onClick:e[1]||(e[1]=o=>t.add("id","set",1))},[Lo,h("SET 1 ")])]),l("div",qo,[l("button",{class:"bouton",onClick:e[2]||(e[2]=o=>t.add("id","decrement",1))},[jo,h("DECREMENT 1 ")]),l("button",{class:"bouton",onClick:e[3]||(e[3]=o=>t.add("id","set",0))},[Bo,h("SET 0 ")])])],64)):f("",!0)])])}const Oe=C(Oo,[["render",Do],["__scopeId","data-v-39863412"]]),Go=[{id:"any",name:"Anything",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"unit",name:"Unit",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"model",name:"Model",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1},{id:"upgrade",name:"Upgrade",editorTypeName:"bullet",indent:0,catalogue:null,shared:!1}],$o={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{getNameExtra:M,changed(){this.$emit("catalogueChanged")},showCatalogue(n){var e;return!(!n.catalogue||n.catalogue===((e=this.item.catalogue)==null?void 0:e.getName()))},availableTargets(){return[...Go,...this.allCategories,...this.allEntries,...this.allForces,...this.allCatalogues]}},watch:{"item.scope"(){var n;this.child||(this.item.childId=((n=this.availableTargets()[0])==null?void 0:n.id)||void 0)}},computed:{childId:{get(){return this.item.childId},set(n){const e=this.item.childId;this.item.childId=n,this.catalogue.updateCondition(this.item,e)}},child(){if(!this.item.childId)return null;const n=this.availableTargets().find(e=>e.id===this.item.childId);return n||this.catalogue.findOptionById(this.item.childId)},instanceOf(){var n;return["instanceOf","notInstanceOf"].includes((n=this.item)==null?void 0:n.type)},allEntries(){return this.includeSelections?ho(this.item,this.catalogue):[]},allCategories(){return this.includeCategories?Ae(this.catalogue):[]},allForces(){return this.includeForces?pe(this.catalogue,"forcesIterator"):[]},allCatalogues(){return this.includeCatalogues?co(this.catalogue):[]},includeSelections(){return!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.instanceOf&&this.item.scope==="primary-category")},includeCategories(){return!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.item.field==="forces")},includeForces(){return this.item.scope=="self"||this.item.scope=="parent"?!1:this.item.scope=="ancestor"?!0:!(this.instanceOf&&this.item.scope==="primary-catalogue"||this.instanceOf&&this.item.scope==="primary-category"||mo(this.item))},includeCatalogues(){return this.instanceOf&&this.item.scope==="primary-catalogue"}}};const ae=n=>(N("data-v-d22adf08"),n=n(),P(),n),Mo=ae(()=>l("legend",null,"Filter By",-1)),Qo={class:"editorTable"},Ho=ae(()=>l("td",null,"Of:",-1)),Ko={key:0},zo=["src"],Yo=ae(()=>l("td",null,"Child ID:",-1)),Wo=ae(()=>l("td",null,"Child:",-1)),Xo={key:0},Jo=["src"],Zo={class:"gray"},es={key:1,class:"shared"},ts={key:2,class:"catalogueName"},ns=ae(()=>l("label",{for:"shared"},"Shared?",-1));function as(n,e,a,u,d,t){const o=z;return s(),c("fieldset",null,[Mo,l("table",Qo,[l("tr",null,[Ho,l("td",null,[t.child?(s(),c("span",Ko,[l("img",{class:"mr-1 align-middle",src:`./assets/bsicons/${t.child.editorTypeName}.png`},null,8,zo),h(" "+p(t.child.name),1)])):f("",!0)])]),l("tr",null,[Yo,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>t.childId=i),onChange:e[1]||(e[1]=(...i)=>t.changed&&t.changed(...i))},null,544),[[v,t.childId]])])]),l("tr",null,[Wo,l("td",null,[m(o,{modelValue:t.childId,"onUpdate:modelValue":e[2]||(e[2]=i=>t.childId=i),placeholder:"Search Child...",options:t.availableTargets,valueField:"id",filterField:"name",onChange:t.changed,default:t.child,lazy:""},{option:k(i=>[i.option?(s(),c("div",Xo,[i.option.indent>=1&&!i.selected?(s(!0),c(b,{key:0},w(i.option.indent,r=>(s(),c("span",null,"   "))),256)):f("",!0),l("img",{class:"mr-1 align-middle",src:`./assets/bsicons/${i.option.editorTypeName}.png`},null,8,Jo),h(" "+p(i.option.name)+" ",1),l("span",Zo,p(t.getNameExtra(i.option,!1)),1),i.option.shared?(s(),c("span",es," (shared) ")):f("",!0),t.showCatalogue(i.option)?(s(),c("span",ts," ["+p(i.option.catalogue)+"]",1)):f("",!0)])):f("",!0)]),_:1},8,["modelValue","placeholder","options","onChange","default"])])])]),_(l("input",{type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=i=>a.item.shared=i),id:"shared",onChange:e[4]||(e[4]=(...i)=>t.changed&&t.changed(...i))},null,544),[[R,a.item.shared]]),ns])}const de=C($o,[["render",as],["__scopeId","data-v-d22adf08"]]),ls={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{showFilterBy(){var e;return((e=X(this.item))==null?void 0:e.parentKey)==="associations"}},methods:{changed(){this.catalogue.updateCondition(this.item),this.$emit("catalogueChanged")}},components:{FilterBy:de,QuickModifiers:Oe}};function is(n,e,a,u,d,t){const o=F,i=oo,r=fe,g=G("FilterBy"),x=Oe;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(r,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:t.changed,class:"section",childForces:"",childSelections:"",shared:""},null,8,["catalogue","item","onCatalogueChanged"]),t.showFilterBy?(s(),y(g,{key:0,class:"section",item:a.item,onCatalogueChanged:t.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"])):f("",!0),m(x,{item:a.item,onCatalogueChanged:t.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const os=C(ls,[["render",is]]),ss={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},ds=l("legend",null,"Condition Group",-1),us={class:"editorTable"},cs=l("td",null,"Type",-1),rs=l("option",{value:"or"},"Or",-1),gs=l("option",{value:"and"},"And",-1),ms=[rs,gs];function hs(n,e,a,u,d,t){const o=F;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),l("fieldset",null,[ds,l("table",us,[l("tr",null,[cs,l("td",null,[_(l("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.type=i),onChange:e[1]||(e[1]=(...i)=>t.changed&&t.changed(...i))},ms,544),[[V,a.item.type]])])])])])],64)}const _s=C(ss,[["render",hs]]),Cs={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{ConditionGroup:_s}};function ps(n,e,a,u,d,t){const o=G("ConditionGroup");return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"])])}const fs=C(Cs,[["render",ps]]),ys={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},computed:{allowNonInstanceOf(){return["primary-category","ancestor"].includes(this.item.scope)==!1}},components:{NumberInput:W},watch:{"item.scope"(){const n=["instanceOf","notInstanceOf"];!this.allowNonInstanceOf&&!n.includes(this.item.type)&&(this.item.type=n[0])}}};const ue=n=>(N("data-v-bbc64d43"),n=n(),P(),n),bs=ue(()=>l("legend",null,"Condition",-1)),vs={class:"condition"},ks=ke('<option value="lessThan" data-v-bbc64d43>Less Than</option><option value="greaterThan" data-v-bbc64d43>Greater Than</option><option value="equalTo" data-v-bbc64d43>Equal To</option><option value="notEqualTo" data-v-bbc64d43>Not Equal To</option><option value="atLeast" data-v-bbc64d43>At Least</option><option value="atMost" data-v-bbc64d43>At Most</option>',6),xs=ue(()=>l("option",{value:"instanceOf"},"Instance Of",-1)),Ts=ue(()=>l("option",{value:"notInstanceOf"},"Not Instance Of",-1)),Fs=ue(()=>l("label",{for:"percent"},"Percentage?",-1));function Is(n,e,a,u,d,t){const o=W;return s(),c("fieldset",null,[bs,l("div",vs,[_(l("select",{"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.type=i),onChange:e[1]||(e[1]=(...i)=>t.changed&&t.changed(...i))},[t.allowNonInstanceOf?(s(),c(b,{key:0},[ks],64)):f("",!0),xs,Ts],544),[[V,a.item.type]]),m(o,{modelValue:a.item.value,"onUpdate:modelValue":e[2]||(e[2]=i=>a.item.value=i),onChange:t.changed},null,8,["modelValue","onChange"]),l("div",null,[_(l("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[3]||(e[3]=i=>a.item.percentValue=i),onChange:e[4]||(e[4]=(...i)=>t.changed&&t.changed(...i))},null,544),[[R,a.item.percentValue]]),Fs])])])}const Ns=C(ys,[["render",Is],["__scopeId","data-v-bbc64d43"]]),Ps={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{Condition:Ns,FilterBy:de}};function Rs(n,e,a,u,d,t){const o=F,i=G("Condition"),r=fe,g=G("FilterBy");return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{class:"section",item:a.item,onCatalogueChanged:t.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),m(r,{class:"section",item:a.item,onCatalogueChanged:t.changed,catalogue:a.catalogue,childForces:"",childSelections:""},null,8,["item","onCatalogueChanged","catalogue"]),m(g,{class:"section",item:a.item,onCatalogueChanged:t.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"])])}const ws=C(Ps,[["render",Rs]]),As={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Os(n,e,a,u,d,t){const o=F,i=we;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const Es=C(As,[["render",Os]]),Vs={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ss(n,e,a,u,d,t){const o=F,i=A,r=U,g=H;return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Constraints ")]),_:1},8,["item","onCatalogueChanged"])])}const Us=C(Vs,[["render",Ss]]),Ls={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{getNameExtra:M,changed(){this.$emit("catalogueChanged")}},computed:{children(){let n=[{name:"None",id:void 0,editorTypeName:"bullet"}];for(let e of this.item.entriesIterator())e.isGroup()||n.push(e);return n}}};const Ee=n=>(N("data-v-e2c93415"),n=n(),P(),n),qs=Ee(()=>l("legend",null,"Selection Entry Group",-1)),js={class:"editorTable"},Bs=Ee(()=>l("td",null,"Default Selection:",-1)),Ds=["src"],Gs={class:"gray"},$s={key:1,class:"merror"};function Ms(n,e,a,u,d,t){const o=z;return s(),c("fieldset",null,[qs,l("table",js,[l("tr",null,[Bs,l("td",null,[t.children.length?(s(),y(o,{key:0,modelValue:a.item.defaultSelectionEntryId,"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.defaultSelectionEntryId=i),placeholder:"Search Children...",options:t.children,valueField:"id",filterField:"name",onChange:t.changed},{option:k(i=>[l("div",null,[i.option.indent>=2&&!i.selected?(s(!0),c(b,{key:0},w(i.option.indent-1,r=>(s(),c("span",null,"   "))),256)):f("",!0),l("img",{class:"mr-1 align-middle",src:`./assets/bsicons/${i.option.editorTypeName}.png`},null,8,Ds),h(" "+p(i.option.name)+" ",1),l("span",Gs,p(t.getNameExtra(i.option,!1)),1)])]),_:1},8,["modelValue","placeholder","options","onChange"])):(s(),c("span",$s,"This group does not have any child Selection Entries"))])])])])}const Qs=C(Ls,[["render",Ms],["__scopeId","data-v-e2c93415"]]),Hs={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Ks(n,e,a,u,d,t){const o=F,i=A,r=U,g=Qs,x=_e,E=Ce,I=ee;return s(),c(b,null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(x,{item:a.item,onCatalogueChanged:t.changed,fields:[{field:"hidden",enabled:!0,name:"Hidden"},{field:"collective",enabled:!1,name:"Collective"},{field:"import",enabled:!0,name:"Import"}],class:"section"},{default:k(()=>[h(" Entry ")]),_:1},8,["item","onCatalogueChanged"]),m(E,{item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,class:"section"},null,8,["item","catalogue","onCatalogueChanged"]),m(I,{item:a.item,onCatalogueChanged:t.changed,withCategory:!1,class:"section"},null,8,["item","onCatalogueChanged"])],64)}const zs=C(Hs,[["render",Ks]]),Ys={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},Ws=l("legend",null,"Revision",-1),Xs={class:"editorTable"},Js=l("td",null,"Revision Number:",-1);function Zs(n,e,a,u,d,t){return s(),c("fieldset",null,[Ws,l("table",Xs,[l("tr",null,[Js,l("td",null,[_(l("input",{type:"number","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.revision=o),onChange:e[1]||(e[1]=(...o)=>t.changed&&t.changed(...o))},null,544),[[v,a.item.revision]])])])])])}const ed=C(Ys,[["render",Zs]]),td={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},nd=l("legend",null,"Catalogue",-1),ad=l("label",{class:"hastooltip",for:"library",title:"indicates that this catalogue is used to store data, no forces may be created from it if true."},"Library",-1);function ld(n,e,a,u,d,t){return s(),c("fieldset",null,[nd,_(l("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>a.item.library=o),onChange:e[1]||(e[1]=(...o)=>t.changed&&t.changed(...o)),id:"library"},null,544),[[R,a.item.library]]),ad])}const id=C(td,[["render",ld]]),od={emits:["catalogueChanged"],props:{item:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}},sd=l("legend",null,"Information",-1),dd={class:"editorTable"},ud=l("td",null,"Author Name:",-1),cd=l("td",null,"Author Contact:",-1),rd=l("td",null,"Author Website:",-1),gd=l("td",null,"Readme:",-1);function md(n,e,a,u,d,t){const o=ie;return s(),c("fieldset",null,[sd,l("table",dd,[l("tr",null,[ud,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=i=>a.item.authorName=i),onChange:e[1]||(e[1]=(...i)=>t.changed&&t.changed(...i))},null,544),[[v,a.item.authorName]])])]),l("tr",null,[cd,l("td",null,[m(o,{modelValue:a.item.authorContact,"onUpdate:modelValue":e[2]||(e[2]=i=>a.item.authorContact=i)},null,8,["modelValue"])])]),l("tr",null,[rd,l("td",null,[_(l("input",{type:"text","onUpdate:modelValue":e[3]||(e[3]=i=>a.item.authorUrl=i),onChange:e[4]||(e[4]=(...i)=>t.changed&&t.changed(...i))},null,544),[[v,a.item.authorUrl]])])]),l("tr",null,[gd,l("td",null,[m(o,{type:"text",modelValue:a.item.readme,"onUpdate:modelValue":e[5]||(e[5]=i=>a.item.readme=i),onChange:t.changed},null,8,["modelValue","onChange"])])])])])}const hd=C(od,[["render",md]]),_d={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Cd(n,e,a,u,d,t){const o=F,i=A,r=U,g=H,x=ed,E=id,I=hd;return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["catalogue","item","onCatalogueChanged"]),m(g,{item:a.item,onCatalogueChanged:t.changed,class:"section"},{default:k(()=>[h(" Constraints ")]),_:1},8,["item","onCatalogueChanged"]),m(x,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(E,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(I,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"])])}const pd=C(_d,[["render",Cd]]),fd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}},components:{NumberInput:W}};const ce=n=>(N("data-v-c7d18dd2"),n=n(),P(),n),yd=ce(()=>l("legend",null,"Repeat",-1)),bd={class:"condition"},vd=ce(()=>l("label",null,"times for every ",-1)),kd={class:"bools"},xd=ce(()=>l("label",{for:"percent"},"Percentage?",-1)),Td=ce(()=>l("label",{for:"percent"},"Round up?",-1));function Fd(n,e,a,u,d,t){const o=W;return s(),c("fieldset",null,[yd,l("div",bd,[m(o,{modelValue:a.item.repeats,"onUpdate:modelValue":e[0]||(e[0]=i=>a.item.repeats=i),onChange:t.changed},null,8,["modelValue","onChange"]),vd,m(o,{modelValue:a.item.value,"onUpdate:modelValue":e[1]||(e[1]=i=>a.item.value=i),onChange:t.changed},null,8,["modelValue","onChange"])]),l("div",kd,[l("div",null,[_(l("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=i=>a.item.percentValue=i),onChange:e[3]||(e[3]=(...i)=>t.changed&&t.changed(...i))},null,544),[[R,a.item.percentValue]]),xd]),l("div",null,[_(l("input",{id:"percent",type:"checkbox","onUpdate:modelValue":e[4]||(e[4]=i=>a.item.roundUp=i),onChange:e[5]||(e[5]=(...i)=>t.changed&&t.changed(...i))},null,544),[[R,a.item.roundUp]]),Td])])])}const Id=C(fd,[["render",Fd],["__scopeId","data-v-c7d18dd2"]]),Nd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},methods:{changed(){this.$emit("catalogueChanged")}}};function Pd(n,e,a,u,d,t){const o=F,i=Id,r=fe,g=de;return s(),c("div",null,[m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{catalogue:a.catalogue,item:a.item,onCatalogueChanged:t.changed},null,8,["catalogue","item","onCatalogueChanged"]),m(r,{class:"section",item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,childForces:"",childSelections:""},null,8,["item","catalogue","onCatalogueChanged"]),m(g,{class:"section",item:a.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])])}const Rd=C(Nd,[["render",Pd]]),wd={emits:["catalogueChanged"],props:{item:{type:Object,required:!0},catalogue:{type:Object,required:!0}},computed:{ids:{get(){var n;return((n=this.item.ids)==null?void 0:n.join(", "))||""},set(n){this.item.ids=n.split(",").map(e=>e.trim())}}},methods:{changed(){this.$emit("catalogueChanged")}},components:{FilterBy:de}},Ad=l("p",{class:"info"},[h(" Associations are a New Recruit specific feature allowing you to associate an entry to another, such as a unit to a bataillon. "),l("br"),h(" Be aware that associations are currently in the beta phase and may undergo modifications. "),l("br"),h(" Feel free to offer feedback or ask questions on our "),l("a",{href:"https://discord.gg/cCtqGbugwb"},"Discord server"),h(". ")],-1),Od={class:"section"},Ed=l("legend",null,"Temporary",-1),Vd={class:"editorTable"},Sd=l("td",null,"min: (may be moved to child constraints)",-1),Ud=l("td",null,"max: (may be moved to child constraints)",-1),Ld=l("td",null,"label: (will be moved to name)",-1),qd=l("td",null,"labelMembers:",-1),jd=l("td",null,"of: (may be moved to ChildID to reuse filterBy)",-1),Bd=l("td",null,"type: (will be removed, only affects conditions)",-1),Dd=l("option",{value:"or"},"or",-1),Gd=l("option",{value:"and"},"and",-1),$d=[Dd,Gd],Md=l("td",null,"scope: ",-1),Qd=l("td",{class:"underline",title:"Ids are a string[], used by associationConstraints on entries, eg: to have a maximum number of commanders in a bataillion"}," ids: ",-1);function Hd(n,e,a,u,d,t){const o=F,i=A,r=G("FilterBy");return s(),c("div",null,[Ad,m(o,{item:a.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"]),m(i,{item:a.item,onCatalogueChanged:t.changed,class:"section"},null,8,["item","onCatalogueChanged"]),m(r,{class:"section",item:a.item,onCatalogueChanged:t.changed,catalogue:a.catalogue},null,8,["item","onCatalogueChanged","catalogue"]),l("fieldset",Od,[Ed,l("table",Vd,[l("tr",null,[Sd,l("td",null,[_(l("input",{onInput:e[0]||(e[0]=(...g)=>t.changed&&t.changed(...g)),"onUpdate:modelValue":e[1]||(e[1]=g=>a.item.min=g),type:"number"},null,544),[[v,a.item.min]])])]),l("tr",null,[Ud,l("td",null,[_(l("input",{onInput:e[2]||(e[2]=(...g)=>t.changed&&t.changed(...g)),"onUpdate:modelValue":e[3]||(e[3]=g=>a.item.max=g),type:"number"},null,544),[[v,a.item.max]])])]),l("tr",null,[Ld,l("td",null,[_(l("input",{onInput:e[4]||(e[4]=(...g)=>t.changed&&t.changed(...g)),"onUpdate:modelValue":e[5]||(e[5]=g=>a.item.label=g),type:"text"},null,544),[[v,a.item.label]])])]),l("tr",null,[qd,l("td",null,[_(l("input",{onInput:e[6]||(e[6]=(...g)=>t.changed&&t.changed(...g)),"onUpdate:modelValue":e[7]||(e[7]=g=>a.item.labelMembers=g),type:"text"},null,544),[[v,a.item.labelMembers]])])]),l("tr",null,[jd,l("td",null,[_(l("input",{onInput:e[8]||(e[8]=(...g)=>t.changed&&t.changed(...g)),"onUpdate:modelValue":e[9]||(e[9]=g=>a.item.of=g),type:"text"},null,544),[[v,a.item.of]])])]),l("tr",null,[Bd,l("td",null,[_(l("select",{onChange:e[10]||(e[10]=(...g)=>t.changed&&t.changed(...g)),"onUpdate:modelValue":e[11]||(e[11]=g=>a.item.type=g)},$d,544),[[V,a.item.type]])])]),l("tr",null,[Md,l("td",null,[_(l("input",{onInput:e[12]||(e[12]=(...g)=>t.changed&&t.changed(...g)),"onUpdate:modelValue":e[13]||(e[13]=g=>a.item.scope=g),type:"text"},null,544),[[v,a.item.scope]])])]),l("tr",null,[Qd,l("td",null,[_(l("input",{"onUpdate:modelValue":e[14]||(e[14]=g=>a.item.ids=g),onInput:e[15]||(e[15]=(...g)=>t.changed&&t.changed(...g)),type:"text"},null,544),[[v,a.item.ids]])])])])])])}const Kd=C(wd,[["render",Hd]]),zd={props:{item:{type:Object,required:!0}},setup(){return{store:Q()}},methods:{gotoTarget(n){return n.isCategory()?n.parent:n},parentEntry(n){return Ze(n,e=>e.getName())}},computed:{show_link_name(){return this.item instanceof et},links(){var n;return((n=this.item)==null?void 0:n.links)||[]},other_links(){var n;return((n=this.item)==null?void 0:n.other_links)||[]},label(){return Z(this.item)}}};const Yd={class:"text-center"},Wd=l("span",{class:"gray"},"References to",-1),Xd=l("p",{class:"ml-10px info"}," Click Load All to have refs from all other catalogues appear. ",-1),Jd={class:"mb-20px"},Zd=l("tr",null,[l("th",null," Catalogue "),l("th",null," Name ")],-1),eu={class:"gray"},tu=["onClick"],nu={key:0},au=l("h3",null," From conditions/constraints/modifiers/repeats: ",-1),lu={class:"mb-20px"},iu=l("tr",null,[l("th",null," Catalogue "),l("th",null," Name "),l("th",null," Type "),l("th",null," Details ")],-1),ou={class:"gray"},su=["onClick"];function du(n,e,a,u,d,t){return s(),c("div",null,[l("h2",Yd,[Wd,h(" "+p(t.label),1)]),Xd,l("table",Jd,[Zd,(s(!0),c(b,null,w(t.links,o=>{var i,r;return s(),c("tr",null,[l("td",eu,p(o.isCatalogue()?o.getName():(i=o.catalogue)==null?void 0:i.getName()),1),l("td",null,[t.show_link_name?(s(),c(b,{key:0},[h(p(o.getName()),1)],64)):(s(),c(b,{key:1},[h(p((r=o.parent)==null?void 0:r.getName()),1)],64))]),l("td",null,[l("button",{onClick:g=>u.store.goto(t.gotoTarget(o))},"Goto",8,tu)])])}),256))]),t.other_links.length?(s(),c("div",nu,[au,l("table",lu,[iu,(s(!0),c(b,null,w(t.other_links,o=>{var i,r;return s(),c("tr",null,[l("td",ou,p(o.isCatalogue()?o.getName():(i=o.catalogue)==null?void 0:i.getName()),1),l("td",null,p(((r=t.parentEntry(o))==null?void 0:r.getName())||"No parent (likely a bug)"),1),l("td",null,p(o.editorTypeName),1),l("td",null,p(o.type)+" "+p(o.value),1),l("td",null,[l("button",{onClick:g=>u.store.goto(o)},"Goto",8,su)])])}),256))])])):f("",!0)])}const uu=C(zd,[["render",du]]),cu={setup(){return{store:Q()}},emits:["catalogueChanged"],props:{catalogue:{type:Object,required:!0}},data(){return{links:["link","selectionEntryLink","selectionEntryGroupLink"],infoLinks:["infoLink","profileLink","ruleLink","infoGroupLink"]}},methods:{changed(){var n;this.store.set_catalogue_changed(((n=this.item)==null?void 0:n.catalogue)||this.catalogue)}},computed:{item(){return this.store.get_selected()},typeName(){var n;return(n=this.item)==null?void 0:n.editorTypeName}}};const ru={key:0,class:"rightPanel h-full"},gu=l("div",{class:"min-h-100px"},null,-1);function mu(n,e,a,u,d,t){const o=qt,i=Yt,r=mn,g=ma,x=Ca,E=wa,I=La,B=Fl,j=ti,Ve=zi,Se=os,Ue=fs,Le=ws,qe=Es,je=Us,Be=zs,De=pd,Ge=Rd,$e=Kd,Me=uu;return t.item?(s(),c("div",ru,[u.store.mode==="edit"?(s(),c(b,{key:0},[t.typeName=="publication"?(s(),y(o,{key:0,item:t.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"])):t.typeName=="costType"?(s(),y(i,{key:1,item:t.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"])):t.typeName=="profileType"?(s(),y(r,{key:2,item:t.item,onCatalogueChanged:t.changed},null,8,["item","onCatalogueChanged"])):t.typeName=="category"?(s(),y(g,{key:3,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="force"?(s(),y(x,{key:4,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="profile"?(s(),y(E,{key:5,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="rule"?(s(),y(I,{key:6,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="selectionEntry"?(s(),y(B,{key:7,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):d.links.includes(t.typeName)?(s(),y(j,{key:8,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,type:"entry"},null,8,["item","catalogue","onCatalogueChanged"])):d.infoLinks.includes(t.typeName)?(s(),y(j,{key:9,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,type:"info"},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="modifier"?(s(),y(Ve,{key:10,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="constraint"?(s(),y(Se,{key:11,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="conditionGroup"?(s(),y(Ue,{key:12,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="condition"?(s(),y(Le,{key:13,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="categoryLink"?(s(),y(j,{key:14,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,type:"category"},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="modifierGroup"?(s(),y(qe,{key:15,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="infoGroup"?(s(),y(je,{key:16,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="selectionEntryGroup"?(s(),y(Be,{key:17,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="catalogueLink"?(s(),y(j,{key:18,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="catalogue"||t.typeName=="gameSystem"?(s(),y(De,{key:19,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="repeat"?(s(),y(Ge,{key:20,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):t.typeName=="association"?(s(),y($e,{key:21,item:t.item,catalogue:a.catalogue,onCatalogueChanged:t.changed,type:"catalogue"},null,8,["item","catalogue","onCatalogueChanged"])):f("",!0),gu],64)):u.store.mode==="references"?(s(),y(Me,{key:1,item:t.item,catalogue:a.catalogue},null,8,["item","catalogue"])):f("",!0)])):f("",!0)}const hu=C(cu,[["render",mu]]),_u=me({components:{LeftPanel:Wn},data(){return{error:null,item:null,systemFiles:null,loading:!1,loading_all:!1,loading_progress:0,loading_progress_max:0,loading_progress_msg:"",saving:!1,failed:!1,id:"",cat:null,defaults:{},key:1}},setup(){return{cataloguesStore:tt(),store:Q(),uistate:nt()}},mounted(){this.store.init(this),globalThis.$catalogue=this.cat,window.addEventListener("beforeunload",this.beforeUnload),document.addEventListener("keydown",this.onKeydown,!0)},updated(){this.store.init(this),globalThis.$catalogue=this.cat},unmounted(){window.removeEventListener("beforeunload",this.beforeUnload),document.removeEventListener("keydown",this.onKeydown,!0)},activated(){window.addEventListener("beforeunload",this.beforeUnload)},deactivated(){window.removeEventListener("beforeunload",this.beforeUnload)},beforeRouteUpdate(){this.id&&this.store.save_state()},beforeRouteLeave(){this.id&&this.store.save_state()},computed:{changed(){var n;return this.cat&&((n=this.store.get_catalogue_state(this.cat))==null?void 0:n.changed)||!1},unsaved(){var n;return this.cat&&((n=this.store.get_catalogue_state(this.cat))==null?void 0:n.unsaved)||!1},query(){return{gameSystemId:this.$route.query.systemId,catalogueId:this.$route.query.id||this.$route.query.systemId}},route_is_catalogue(){return this.$route.name==="catalogue"}},watch:{query:{async handler(n){var u;if(!this.route_is_catalogue)return;const{gameSystemId:e,catalogueId:a}=n;this.id=a||e,this.store.unselect();try{await this.load(e,this.id),(u=this.systemFiles)==null||u.loadAll(),this.error=null,this.$nextTick(()=>{this.store.$nextTickResolve&&this.store.$nextTickResolve()})}catch(d){console.error(d),this.error=d}},immediate:!0}},methods:{async load_all(){if(this.systemFiles)try{this.loading_all=!0,await new Promise(n=>setTimeout(n,0)),await this.systemFiles.loadAll(async(n,e,a)=>{this.loading_progress=n,this.loading_progress_max=e,this.loading_progress_msg=a,await new Promise(u=>setTimeout(u,0))}),this.loading_progress=0,this.loading_progress_max=0,this.loading_progress_msg=""}catch(n){console.error(n)}finally{this.loading_all=!0}},async save_all(){var n;try{this.failed=await this.store.save_all((n=this.cat)==null?void 0:n.getSystemId())}finally{this.saving=!1}},async save(){try{await this.store.save_catalogue(this.systemFiles,this.cat)&&notify("Incremented 1 catalogue's revision"),this.failed=!1}catch{this.failed=!0}},async test(){var n;if(!((n=this.systemFiles)!=null&&n.github)){console.error("no github set");return}console.log("revision",await at(this.systemFiles.github,this.cat))},async beforeUnload(n){if(!globalThis._closeWindow&&(this.loading||this.store.save_state(),this.unsaved||this.store.unsavedCount)){const e="You have unsaved changes that will be lost";return n.returnValue=e,electron&&setTimeout(async()=>{await lt({message:"You have unsaved changes that will be lost?",buttons:["Cancel","Leave"],defaultId:0,cancelId:0,type:"question"})===1&&(globalThis._closeWindow=!0,it())}),!1}},onKeydown(n){n.ctrlKey&&n.key.toLowerCase()=="s"&&(n.preventDefault(),n.stopPropagation(),this.save())},load_state(n){this.defaults=n},async load(n,e){if(!e&&!n)throw new Error("couldn't load catalogue: no id");try{this.loading=!0;const a=await this.store.get_or_load_system(n);let u=a.getLoadedCatalogue({targetId:e||n});u||(u=await a.loadCatalogue({targetId:e||n})),u.processForEditor();for(const d of u.imports)d.processForEditor();if(this.systemFiles=a,this.cat=u,u){const d=this.uistate.get_data(u.id);this.load_state(d)}}finally{this.loading=!1}}}});const Cu={class:"h-full"},pu={key:0},fu={class:"ml-10px"},yu={class:"text-slate-300"},bu={key:1,class:"status mx-2 text-red"},vu={key:2,class:"status mx-2"},ku={key:0};function xu(n,e,a,u,d,t){const o=ut,i=ct,r=ze,g=G("LeftPanel"),x=hu,E=ot;return s(),c("div",Cu,[m(i,null,{default:k(()=>[m(o,null,{default:k(()=>{var I;return[h(p(n.loading?"Loading...":[(I=n.cat)==null?void 0:I.getName(),"NR-Editor"].filter(B=>B).join(" - ")),1)]}),_:1})]),_:1}),n.error?(s(),c("span",pu,p(n.error),1)):n.loading?(s(),y(r,{key:1,progress:n.loading_progress,progress_max:n.loading_progress_max,progress_msg:n.loading_progress_msg},null,8,["progress","progress_max","progress_msg"])):n.cat?(s(),y(E,{key:2,class:"h-full",draggable:"",showMiddle:"",id:"catalogueView"},{left:k(()=>[(s(),y(g,{ref:"leftpanel",class:"h-full",catalogue:n.cat,defaults:n.defaults,key:n.key,keepalive:""},null,8,["catalogue","defaults"]))]),middle:k(()=>[n.store.selectedItem!=null?(s(),y(x,{key:0,class:"h-full overflow-y-auto",catalogue:n.cat},null,8,["catalogue"])):f("",!0)]),_:1})):f("",!0),n.cat&&n.route_is_catalogue?(s(),y(Ke,{key:3,to:"#titlebar-content"},[l("span",fu,[h(" Editing "+p(n.cat.name)+" ",1),l("span",yu,"v"+p(n.cat.revision),1)]),n.store.unsavedCount?(s(),c("button",{key:0,class:"bouton save ml-10px",onClick:e[0]||(e[0]=(...I)=>n.save_all&&n.save_all(...I))}," Save All ")):n.failed?(s(),c("span",bu,"failed to save")):(s(),c("span",vu,"saved")),n.systemFiles&&!n.systemFiles.allLoaded?(s(),c("button",{key:3,class:"bouton load ml-10px",onClick:e[1]||(e[1]=(...I)=>n.load_all&&n.load_all(...I))},[h("Load all "),n.loading_all?(s(),c("span",ku,"("+p(n.loading_progress)+" / "+p(n.loading_progress_max)+")",1)):f("",!0)])):f("",!0)])):f("",!0)])}const Pu=C(_u,[["render",xu],["__scopeId","data-v-b51f7edd"]]);export{Pu as default};
//# sourceMappingURL=catalogue.a3726d54.js.map
