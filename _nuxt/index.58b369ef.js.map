{"version":3,"file":"index.58b369ef.js","sources":["../../../../components/UploadJson.vue","../../../../components/ImportFromGithub.vue","../../../../components/IconContainer.vue","../../../../components/my_catalogues/CataloguesDetail.vue","../../../../components/my_catalogues/CataloguesCreate.vue","../../../../pages/index.vue"],"sourcesContent":["<template>\n  <input\n    type=\"file\"\n    accept=\".gst, .gstz, .xml, .zip, .cat, .catz, .json\"\n    multiple\n    @change=\"onFileSelected\"\n    class=\"invisible\"\n    ref=\"fileinput\"\n  />\n  <button @click=\"popFileInput\" class=\"bouton\" :disabled=\"uploading\">\n    <template v-if=\"!uploading\"> Import Catalogues </template>\n    <template v-else> ... </template>\n  </button>\n</template>\n\n<script setup lang=\"ts\">\nimport {\n  convertToJson,\n  getExtension,\n  isAllowedExtension,\n  isZipExtension,\n} from \"~/assets/shared/battlescribe/bs_convert\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nconst fileinput = ref(null);\nconst uploading = ref(false);\nconst emit = defineEmits<{\n  (e: \"uploaded\", files: Object[]): void;\n}>();\n\nasync function onFileSelected(event: any) {\n  try {\n    uploading.value = true;\n    const input_files = [...((event.target?.files as FileList | null) || [])];\n    if (!input_files) {\n      uploading.value = false;\n      return;\n    }\n\n    const result_files = [] as Object[];\n    for (const file of input_files.filter((o) => isAllowedExtension(o.name))) {\n      const content = isZipExtension(file.name) ? await file.arrayBuffer() : await file.text();\n      const asJson = await convertToJson(content, getExtension(file.name));\n      const obj = ((getDataObject(asJson) as any).fullFilePath = \"none\");\n      result_files.push(asJson);\n    }\n    if (result_files.length) {\n      emit(\"uploaded\", result_files);\n    }\n    uploading.value = false;\n  } catch (e) {\n    console.error(e);\n    uploading.value = false;\n  }\n}\nasync function popFileInput() {\n  (fileinput.value as any).click();\n}\n</script>\n<style scoped lang=\"scss\">\n.invisible {\n  opacity: 0; /* make transparent */\n  z-index: -1; /* move under anything else */\n  position: absolute; /* don't let it take up space */\n}\n</style>\n","<script setup lang=\"ts\">\nimport { convertToJson, getExtension, isAllowedExtension, unzipFolder } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nimport { normalizeGithubRepoUrl } from \"~/assets/shared/battlescribe/github\";\nconst inputUrl = ref(\"\");\nconst busy = ref(false);\nconst emit = defineEmits<{\n  (e: \"uploaded\", files: Object[]): void;\n}>();\nasync function submit(url: string | null) {\n  if (!url || normalizeGithubRepoUrl(url) !== url) {\n    console.log(\"bad url\", url);\n    return;\n  }\n  try {\n    busy.value = true;\n    // Get the zip of the repo:\n    const repoPath = url.split(\"/\").slice(-2).join(\"/\"); // BSData/wh40k\n    const repoName = repoPath.split(\"/\")[1];\n    const apiUrl = `https://api.github.com/repos/${repoPath}`;\n    const defaultBranch = (await $fetch<any>(apiUrl)).default_branch; // master\n    const zipDlUrl = `https://codeload.github.com/${repoPath}/zip/refs/heads/${defaultBranch}`;\n\n    // Download the zip through a cors proxy\n    const zipFile = await $fetch<Blob>(`https://corsproxy.io/?${zipDlUrl}`);\n\n    // Extract the useful files\n    const folder = await unzipFolder(zipFile, `${repoName}-${defaultBranch}`);\n    const result_files = [] as Object[];\n    for (const [name, content] of Object.entries(folder)) {\n      const extension = getExtension(name);\n      if (isAllowedExtension(extension)) {\n        const json = await convertToJson(content, extension);\n        result_files.push(json);\n        getDataObject(json).fullFilePath = name;\n      }\n    }\n    if (result_files.length) {\n      emit(\"uploaded\", result_files);\n    }\n    inputUrl.value = \"\";\n  } catch (e) {\n    console.error(e);\n  } finally {\n    busy.value = false;\n  }\n}\n</script>\n<template>\n  <input type=\"text\" class=\"bouton !font-normal\" v-model=\"inputUrl\" placeholder='repo eg: \"BSData/wh40k\"' />\n  <button\n    @click=\"submit(normalizeGithubRepoUrl(inputUrl))\"\n    class=\"bouton\"\n    :disabled=\"normalizeGithubRepoUrl(inputUrl) == null || busy\"\n  >\n    {{ busy ? \"...\" : \"Import from github\" }}\n  </button>\n</template>\n","<template>\n  <div class=\"items\">\n    <div\n      v-for=\"item of sortedItems\"\n      class=\"relative item unselectable\"\n      :class=\"{ edited: edited(item), selected: item === modelValue }\"\n      @click=\"elementClicked(item)\"\n      @dblclick=\"elementDoubleClicked(item)\"\n    >\n      <ErrorIcon class=\"error\" :errors=\"errors(item)\" />\n      <img class=\"icon\" :src=\"getType(item).icon\" />\n      <div>{{ name(item) }}</div>\n    </div>\n    <div class=\"relative item add unselectable\" @click=\"add\">\n      <img class=\"w-40px h-40px\" src=\"/assets/icons/iconeplus.png\" />\n      <div class=\"bold text-blue\">New</div>\n    </div>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { addOne, capitalize, sortByAscending } from \"~/assets/shared/battlescribe/bs_helpers\";\nimport { BSIData } from \"~/assets/shared/battlescribe/bs_types\";\nimport ErrorIcon, { IErrorMessage } from \"./ErrorIcon.vue\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\nexport default {\n  emits: [\"new\", \"itemClicked\", \"itemDoubleClicked\"],\n  setup() {\n    return { cataloguesStore: useCataloguesStore(), store: useEditorStore() };\n  },\n  props: {\n    items: {\n      type: Array as PropType<BSIData[]>,\n      required: true,\n    },\n    modelValue: {\n      required: true,\n    },\n  },\n  methods: {\n    getType(item: BSIData) {\n      if (item.gameSystem) {\n        return { icon: \"./assets/icons/system1.png\", order: 1 };\n      } else if (item.catalogue?.library) {\n        return { icon: \"./assets/icons/library.png\", order: 2 };\n      } else {\n        return { icon: \"./assets/icons/book.png\", order: 3 };\n      }\n    },\n    elementDoubleClicked(item: BSIData) {\n      this.$emit(\"itemDoubleClicked\", item);\n    },\n    elementClicked(item: BSIData) {\n      this.$emit(\"itemClicked\", item);\n    },\n    errors(data: BSIData): IErrorMessage[] {\n      const result = [] as IErrorMessage[];\n      if (this.store.get_catalogue_state(data)?.unsaved) {\n        result.push({\n          severity: \"info\",\n          msg: \"Unsaved\",\n        });\n      }\n      const errors = (getDataObject(data) as any as { errors: IErrorMessage[] }).errors;\n\n      if (errors?.length) {\n        const counts = {} as Record<string, number>;\n\n        for (const error of errors) {\n          if (error.severity) {\n            addOne(counts, error.severity);\n          } else {\n            addOne(counts, \"error\");\n          }\n        }\n\n        let msgPieces = [];\n        for (const key in counts) {\n          msgPieces.push(`${counts[key]} ${capitalize(key)}${counts[key] === 1 ? \"\" : \"s\"}`);\n        }\n        if (errors.find((o) => o.severity === \"error\")) {\n          result.push({\n            severity: \"error\",\n            msg: `Has ${msgPieces.join(\", \")}`,\n          });\n        } else if (errors.find((o) => o.severity === \"warning\")) {\n          result.push({\n            severity: \"warning\",\n            msg: `Has ${msgPieces.join(\", \")}`,\n          });\n        }\n      }\n      return result;\n    },\n    edited(data: BSIData) {\n      return this.cataloguesStore.getEdited(getDataDbId(data));\n    },\n    name(data: BSIData) {\n      return getDataObject(data).name;\n    },\n    add() {\n      this.$emit(\"new\");\n    },\n  },\n  computed: {\n    sortedItems() {\n      return sortByAscending(\n        sortByAscending(this.items, (o) => this.name(o)),\n        (o) => this.getType(o).order\n      );\n    },\n  },\n  components: { ErrorIcon },\n};\n</script>\n\n<style scoped lang=\"scss\">\n@import \"@/shared_components/css/vars.scss\";\n\n.item {\n  display: grid;\n  grid-template-columns: \"max-content\";\n  align-items: center;\n  justify-items: center;\n  &:last-child {\n    margin-right: 0;\n  }\n  font-size: 12px;\n  border: 1px $box_border solid;\n  padding: 3px;\n  border-radius: 5px;\n  box-shadow: $box_shadow;\n  color: $fontColor;\n  cursor: pointer;\n  width: 100px;\n  text-align: center;\n}\n\n.items {\n  display: grid;\n  grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));\n  grid-gap: 5px 0px;\n  grid-auto-rows: 1fr;\n  align-items: stretch;\n}\n\n.error {\n  position: absolute;\n  right: 5px;\n  top: 5px;\n}\n\n.item:hover {\n  background-color: rgba($color: #000000, $alpha: 0.05);\n}\n.selected {\n  border: solid black 2px;\n  padding: 2px;\n}\n\n.edited {\n  background-color: rgba(40, 120, 250, 0.15);\n}\n.add {\n  border: solid rgb(45, 190, 45) 2px;\n}\n</style>\n","<template>\n  <fieldset class=\"details\">\n    <div>\n      <legend>{{ cataloguedata.name }}</legend>\n      <div v-if=\"is_catalogue\">\n        <span\n          class=\"grey hastooltip\"\n          title=\"indicates that this catalogue is used to store data, no forces may be created from it if true.\"\n        >\n          Library:\n        </span>\n        {{ cataloguedata.library }}\n      </div>\n      <div><span class=\"grey\">Id:</span> {{ cataloguedata.id }}</div>\n      <div><span class=\"grey\">path:</span> {{ cataloguedata.fullFilePath }}</div>\n      <div v-if=\"electron\"> <span class=\"grey\">authorUrl:</span> {{ cataloguedata.authorUrl }} </div>\n      <div>\n        <span class=\"grey\">authorContact:</span>\n        {{ cataloguedata.authorContact }}\n      </div>\n      <div> <span class=\"grey\">authorName:</span> {{ cataloguedata.authorName }} </div>\n      <div v-if=\"(cataloguedata as BSICatalogue).catalogueLinks?.length \">\n        <span class=\"bold\">imports:</span>\n        <div class=\"ml-10px\">\n          <div v-for=\"link in (cataloguedata as BSICatalogue).catalogueLinks\">\n            <span :class=\"{ grey: !link.importRootEntries }\">\n              {{ link.name }}\n            </span>\n          </div>\n        </div>\n      </div>\n      <div v-if=\"refs.length && !isSystem\">\n        <span class=\"bold\">imported by:</span>\n        <div class=\"ml-10px\">\n          <div v-for=\"ref in refs\">\n            <span :class=\"{ grey: !ref.importRootEntries }\">\n              {{ ref.sourceName }}\n            </span>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <div class=\"section boutons\">\n      <button class=\"bouton\" @click=\"$emit('edit', catalogue)\">Edit</button>\n      <button class=\"bouton\" @click=\"deletePopup = true\">Delete</button>\n      <button class=\"bouton\" @click=\"download_file\">Download</button>\n      <p class=\"info\"> To quickly edit a catalogue, you can double-click on it. </p>\n    </div>\n    <PopupDialog\n      button=\"Confirm\"\n      text=\"Cancel\"\n      @button=\"$emit('delete', catalogue)\"\n      v-model=\"deletePopup\"\n      v-if=\"deletePopup\"\n    >\n      <div>Are you sure you want to delete this {{ is_catalogue ? \"catalogue\" : \"Game System\" }}?</div>\n    </PopupDialog>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { convertToXml } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport { BSIDataCatalogue, BSIDataSystem, BSICatalogue, BSIGameSystem } from \"~/assets/shared/battlescribe/bs_types\";\nimport { download } from \"~/assets/shared/util\";\nimport { filename } from \"~/electron/node_helpers\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\nexport default {\n  emits: [\"edit\", \"delete\"],\n  props: {\n    catalogue: {\n      type: Object as PropType<BSIDataCatalogue | BSIDataSystem>,\n      required: true,\n    },\n  },\n  setup() {\n    return { catalogueStore: useCataloguesStore(), store: useEditorStore() };\n  },\n  data() {\n    return {\n      deletePopup: false,\n    };\n  },\n  methods: {\n    download_file() {\n      const data = getDataObject(this.catalogue);\n      const loaded = this.store.get_system(data.gameSystemId || data.id).getLoadedCatalogue({ targetId: data.id });\n      const xml = convertToXml(loaded || data);\n      const fileName = data.fullFilePath ? filename(data.fullFilePath) : data.name;\n      const extension = data.gameSystemId ? `cat` : `gst`;\n      download(`${fileName}.${extension}`, \"application/xml\", xml);\n    },\n  },\n  computed: {\n    is_catalogue() {\n      return Boolean((this.catalogue as BSIDataCatalogue).catalogue);\n    },\n    electron() {\n      return Boolean(globalThis.electron);\n    },\n    imports() {\n      return (this.cataloguedata as BSICatalogue).catalogueLinks || [];\n    },\n    refs() {\n      return this.catalogueStore.getDependents(getDataDbId(this.catalogue)) || [];\n    },\n    cataloguedata(): BSICatalogue | BSIGameSystem {\n      return getDataObject(this.catalogue);\n    },\n    isSystem() {\n      return !this.cataloguedata.gameSystemId;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.details {\n  h4 {\n    margin: 0;\n    font-size: 16px;\n    font-weight: bold;\n  }\n}\n</style>\n","<template>\n  <fieldset class=\"details\">\n    <legend>{{ cataloguedata.name }}</legend>\n    <table class=\"editorTable\">\n      <tr>\n        <td>\n          <label for=\"name\"> name: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"name\" v-model=\"cataloguedata.name\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorUrl\"> authorUrl: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"authorUrl\" v-model=\"cataloguedata.authorUrl\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorContact\"> authorContact: </label>\n        </td>\n        <td>\n          <input type=\"text\" id=\"authorContact\" v-model=\"cataloguedata.authorContact\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label for=\"authorName\"> authorName: </label>\n        </td>\n\n        <td>\n          <input type=\"text\" id=\"authorName\" v-model=\"cataloguedata.authorName\" />\n        </td>\n      </tr>\n      <tr>\n        <td>id:</td>\n        <td>\n          <input type=\"text\" class=\"gray\" id=\"id\" v-model=\"cataloguedata.id\" />\n        </td>\n      </tr>\n      <tr>\n        <td>\n          <label\n            for=\"library\"\n            class=\"hastooltip\"\n            title=\"indicates that this catalogue is used to store data, no forces may be created from it if true.\"\n          >\n            library:\n          </label>\n        </td>\n        <td>\n          <input type=\"checkbox\" id=\"library\" v-model=\"cataloguedata.library\" />\n        </td>\n      </tr>\n    </table>\n\n    <button class=\"bouton\" @click=\"$emit('create', catalogue)\"> Create Catalogue </button>\n  </fieldset>\n</template>\n\n<script lang=\"ts\">\nimport { PropType } from \"vue\";\nimport { getDataObject } from \"~/assets/shared/battlescribe/bs_main\";\nimport { BSIDataCatalogue, BSIDataSystem, BSICatalogue, BSIGameSystem } from \"~/assets/shared/battlescribe/bs_types\";\n\nexport default {\n  emits: [\"create\"],\n  props: {\n    catalogue: {\n      type: Object as PropType<BSIDataCatalogue | BSIDataSystem>,\n      required: true,\n    },\n  },\n\n  computed: {\n    cataloguedata(): BSICatalogue {\n      return getDataObject(this.catalogue) as BSICatalogue;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.details {\n  h4 {\n    margin: 0;\n    font-size: 16px;\n    font-weight: bold;\n  }\n}\n.editorTable {\n  td {\n    border: none;\n    text-align: left;\n    &:first-child {\n      text-align: right;\n    }\n  }\n}\n</style>\n","<template>\n  <div class=\"p-10px\" v-if=\"!electron\">\n    <div class=\"box\">\n      <h3>My Catalogues</h3>\n      <div class=\"boutons\">\n        <SelectFile v-if=\"electron\" @uploaded=\"filesUploaded\" />\n        <UploadJson @uploaded=\"filesUploaded\" />\n        <ImportFromGithub @uploaded=\"filesUploaded\" />\n        <CreateSystem />\n      </div>\n      <div v-if=\"electron\">\n        Note: if you modify an already imported file in another program, you will need to import it again\n      </div>\n    </div>\n  </div>\n  <p class=\"info\">\n    To return to this page, simply click on the 'New Recruit' icon located in the top-left corner of the screen.\n    <br />\n    Returning to this page will not cause you to lose your changes.\n  </p>\n  <div class=\"mx-10px box h-full pb-200px\">\n    <SplitView showMiddle showRight :rightWidth=\"400\" id=\"systemView\">\n      <template #middle>\n        <div class=\"scrollable\">\n          <fieldset v-for=\"gst in systems\">\n            <legend>\n              {{ gst.gameSystem?.gameSystem.name || \"Unknown GameSystem\" }}\n              <a v-if=\"gst.github?.githubUrl\" :href=\"gst.github.githubUrl\" target=\"_blank\">\n                <img\n                  class=\"w-24px h-24px align-bottom\"\n                  :src=\"settings.theme === 'dark' ? 'assets/icons/github-dark.png' : 'assets/icons/github-light.png'\"\n                  :title=\"`using repo at ${gst.github.githubUrl}`\"\n                />\n              </a>\n            </legend>\n            <IconContainer\n              :items=\"systemAndCatalogues(gst)\"\n              @itemClicked=\"itemClicked\"\n              @itemDoubleClicked=\"itemDoubleClicked\"\n              @new=\"newCatalogue(gst)\"\n              v-model=\"selectedItem\"\n            />\n          </fieldset>\n        </div>\n      </template>\n      <template #right>\n        <div v-if=\"selectedItem\" class=\"scrollable\">\n          <template v-if=\"mode === 'create'\">\n            <CataloguesCreate @create=\"createCatalogue\" :catalogue=\"selectedItem\" />\n          </template>\n          <template v-else>\n            <CataloguesDetail @delete=\"deleteCatalogue\" @edit=\"editCatalogue\" :catalogue=\"selectedItem\" />\n          </template>\n        </div>\n      </template>\n    </SplitView>\n    <Teleport to=\"#titlebar-content\" v-if=\"store.unsavedCount && $route.name == 'index'\">\n      <template v-if=\"store.unsavedCount\">\n        <button class=\"bouton save ml-10px !w-100px\" @click=\"saveAll\">Save All</button>\n      </template>\n      <template v-else-if=\"failed\">\n        <span class=\"status mx-2 text-red\">failed to save</span>\n      </template>\n      <template v-else>\n        <span class=\"status mx-2\">saved</span>\n      </template>\n    </Teleport>\n  </div>\n</template>\n\n<script lang=\"ts\">\nimport { BSIData, BSIDataCatalogue, BSIDataSystem } from \"~/assets/shared/battlescribe/bs_types\";\nimport { getDataObject, getDataDbId } from \"~/assets/shared/battlescribe/bs_main\";\nimport UploadJson from \"~/components/UploadJson.vue\";\nimport CataloguesDetail from \"~/components/my_catalogues/CataloguesDetail.vue\";\n\nimport CataloguesCreate from \"~/components/my_catalogues/CataloguesCreate.vue\";\nimport { generateBattlescribeId } from \"~/assets/shared/battlescribe/bs_helpers\";\nimport { useCataloguesStore } from \"~/stores/cataloguesState\";\nimport { useEditorStore } from \"~/stores/editorStore\";\nimport ImportFromGithub from \"~/components/ImportFromGithub.vue\";\nimport SelectFile from \"~/components/SelectFile.vue\";\nimport { closeWindow, dirname, showMessageBox } from \"~/electron/node_helpers\";\nimport IconContainer from \"~/components/IconContainer.vue\";\nimport SplitView from \"~/components/SplitView.vue\";\nimport { getExtension } from \"~/assets/shared/battlescribe/bs_convert\";\nimport { useSettingsStore } from \"~/stores/settingsState\";\nimport { db } from \"~/assets/shared/battlescribe/cataloguesdexie\";\nimport { GameSystemFiles } from \"~/assets/shared/battlescribe/local_game_system\";\n\nexport default defineComponent({\n  components: {\n    UploadJson,\n    CataloguesDetail,\n    ImportFromGithub,\n    CataloguesCreate,\n    SelectFile,\n    IconContainer,\n    SplitView,\n  },\n  head() {\n    return {\n      title: \"New Recruit - Editor\",\n    };\n  },\n  data() {\n    return {\n      msg: \"\",\n      selectedItem: null as BSIDataCatalogue | BSIDataSystem | null,\n      mode: \"edit\",\n      editingItem: null as BSIData | null,\n      failed: false,\n    };\n  },\n  setup() {\n    return { cataloguesStore: useCataloguesStore(), store: useEditorStore(), settings: useSettingsStore() };\n  },\n  created() {\n    this.store.init(this.$router);\n    if (!electron) {\n      this.store.load_systems_from_db();\n    }\n  },\n  activated() {\n    window.addEventListener(\"beforeunload\", this.beforeUnload);\n  },\n  deactivated() {\n    window.removeEventListener(\"beforeunload\", this.beforeUnload);\n  },\n  computed: {\n    electron() {\n      return Boolean(globalThis.electron);\n    },\n    filter() {\n      const id = this.$route.query?.id;\n      if (!id) return undefined;\n      return (id as string).split(\",\");\n    },\n    systems(): Record<string, GameSystemFiles> {\n      if (this.filter) {\n        const result = {} as Record<string, GameSystemFiles>;\n        for (const id of this.filter) {\n          const found = this.store.gameSystems[id];\n          if (found) {\n            result[id] = found;\n          }\n\n          return result;\n        }\n      }\n\n      return this.store.gameSystems;\n    },\n  },\n  methods: {\n    saveAll() {\n      let failed = false;\n      try {\n        for (const sys of Object.values(this.systems)) {\n          for (const cat of sys.getAllLoadedCatalogues()) {\n            if (this.store.get_catalogue_state(cat)?.unsaved) {\n              this.store.save_catalogue(sys, cat);\n            }\n          }\n        }\n      } catch (e) {\n        failed = true;\n      }\n      this.failed = failed;\n    },\n    async beforeUnload(event: BeforeUnloadEvent) {\n      if (globalThis._closeWindow) return;\n      if (this.store.unsavedCount) {\n        const message = \"You have unsaved changes that will be lost\";\n        event.returnValue = message;\n        if (electron) {\n          setTimeout(async () => {\n            const result = await showMessageBox({\n              message: \"You have unsaved changes that will be lost?\",\n              buttons: [\"Cancel\", \"Leave\"],\n              defaultId: 0,\n              cancelId: 0,\n              type: \"question\",\n            });\n            if (result === 1) {\n              globalThis._closeWindow = true;\n              closeWindow();\n            }\n          });\n        }\n      }\n      return false;\n    },\n    systemAndCatalogues(gst: GameSystemFiles) {\n      let res = [];\n      if (gst.gameSystem) {\n        res.push(gst.gameSystem);\n      }\n      if (gst.catalogueFiles) {\n        res.push(...Object.values(gst.catalogueFiles));\n      }\n      return res;\n    },\n\n    itemClicked(item: BSIDataCatalogue) {\n      this.selectedItem = item;\n      this.mode = \"edit\";\n    },\n\n    itemDoubleClicked(item: BSIDataCatalogue) {\n      const id = getDataObject(item).id;\n      const systemId = getDataObject(item).gameSystemId || id;\n      this.$router.push({\n        name: \"catalogue\",\n        query: { systemId, id },\n      });\n    },\n    newCatalogue(gst: GameSystemFiles) {\n      if (!gst.gameSystem) return;\n      const gameSystem = gst.gameSystem.gameSystem;\n      this.mode = \"create\";\n      this.selectedItem = {\n        catalogue: {\n          library: false,\n          id: generateBattlescribeId(),\n          name: \"New Catalogue\",\n          gameSystemId: gameSystem.id,\n          gameSystemRevision: gameSystem.revision,\n          revision: 1,\n        },\n      } as any;\n    },\n    getCatExtension(gstPath: string): string {\n      switch (getExtension(gstPath)) {\n        case \"json\":\n          return \"json\";\n        case \"gstz\":\n          return \"catz\";\n        default:\n        case \"gst\":\n          return \"cat\";\n      }\n    },\n    createCatalogue(data: BSIDataCatalogue) {\n      const system = this.store.get_system(data.catalogue.gameSystemId);\n      const copy = JSON.parse(JSON.stringify(data)) as BSIDataCatalogue;\n      copy.catalogue.battleScribeVersion = \"2.03\";\n      if (electron) {\n        if (!system.gameSystem) {\n          throw new Error(\"Cannot create catalogue: no game system\");\n        }\n        const systemPath = getDataObject(system.gameSystem).fullFilePath;\n        if (!systemPath) {\n          throw new Error(\"Cannot create catalogue: game system has no path set\");\n        }\n        const name = copy.catalogue.name;\n        if (!name) {\n          throw new Error(\"Cannot create catalogue: no name provided\");\n        }\n        const folder = dirname(systemPath);\n\n        getDataObject(copy).fullFilePath = `${folder}/${name}.${this.getCatExtension(systemPath)}`;\n      }\n      system.setCatalogue(copy);\n      this.cataloguesStore.setEdited(getDataDbId(copy), true);\n      this.store.set_catalogue_changed(copy, true);\n      this.selectedItem = copy;\n      if (!electron) {\n        db.catalogues.put({\n          content: copy,\n          id: getDataDbId(data),\n        });\n      }\n      this.mode = \"edit\";\n    },\n    deleteCatalogue(data: BSIDataCatalogue | BSIDataSystem) {\n      console.log(\"Deleted catalogue\", data);\n      const obj = getDataObject(data);\n      const systemId = obj.gameSystemId || obj.id;\n      if ((data as BSIDataCatalogue).catalogue) {\n        this.store.get_system(systemId).removeCatalogue(data as BSIDataCatalogue);\n        if (!electron) {\n          db.catalogues.delete(getDataDbId(data));\n        }\n      } else if ((data as BSIDataSystem).gameSystem) {\n        const sys = this.store.get_system(systemId);\n        for (const catalogue of Object.values(sys.catalogueFiles)) {\n          const id = getDataDbId(catalogue);\n          db.catalogues.delete(id);\n        }\n        db.catalogues.delete(getDataDbId(sys.gameSystem!));\n        db.systems.delete(getDataDbId(sys.gameSystem!));\n        this.store.delete_system(systemId);\n      }\n      this.selectedItem = null;\n    },\n\n    filesUploaded(files: any[]) {\n      console.log(\"Uploaded\", files.length, \"files\", files);\n      const systems = files.filter((o) => o.gameSystem) as BSIDataSystem[];\n      for (const system of systems) {\n        const systemId = system.gameSystem.id;\n        const dbId = getDataDbId(system);\n        this.store.get_system(systemId).setSystem(system);\n        if (!electron) {\n          db.systems.put({ content: system, id: dbId });\n        }\n        this.cataloguesStore.updateCatalogue(system.gameSystem);\n        this.cataloguesStore.setEdited(dbId, false);\n      }\n\n      const catalogues = files.filter((o) => o.catalogue) as BSIDataCatalogue[];\n      for (const catalogue of catalogues) {\n        const systemId = catalogue.catalogue.gameSystemId;\n        this.store.get_system(systemId).setCatalogue(catalogue);\n        if (!electron) {\n          db.catalogues.put({ content: catalogue, id: getDataDbId(catalogue) });\n        }\n        this.cataloguesStore.updateCatalogue(catalogue.catalogue);\n        this.cataloguesStore.setEdited(getDataDbId(catalogue), false);\n      }\n      delete this.$route.query.id;\n    },\n    async editCatalogue(file: BSIData) {\n      const id = getDataObject(file).id;\n      const systemId = getDataObject(file).gameSystemId || id;\n      this.$router.push({\n        name: \"catalogue\",\n        query: { systemId, id },\n      });\n    },\n  },\n});\n</script>\n\n<style scope>\n.scrollable {\n  height: 100%;\n  overflow-y: auto;\n}\n</style>\n"],"names":["fileinput","ref","uploading","onFileSelected","event","input_files","_a","result_files","file","o","isAllowedExtension","content","isZipExtension","asJson","convertToJson","getExtension","obj","getDataObject","emit","e","popFileInput","inputUrl","busy","submit","url","normalizeGithubRepoUrl","repoPath","repoName","apiUrl","defaultBranch","zipDlUrl","zipFile","folder","unzipFolder","name","extension","json","_sfc_main$3","useCataloguesStore","useEditorStore","item","data","result","errors","counts","error","addOne","msgPieces","key","capitalize","getDataDbId","sortByAscending","ErrorIcon","_hoisted_3","_hoisted_4","_withScopeId","_createElementVNode","_hoisted_5","_hoisted_6","_component_ErrorIcon","__nuxt_component_0","_hoisted_1","_openBlock","_createElementBlock","_Fragment","_renderList","$options","_normalizeClass","$props","$event","_hoisted_2","_sfc_main$2","loaded","xml","convertToXml","fileName","filename","download","_hoisted_7","_hoisted_10","_hoisted_13","_component_PopupDialog","_toDisplayString","_createCommentVNode","_createTextVNode","_hoisted_8","_hoisted_9","_hoisted_11","_hoisted_12","link","_hoisted_14","_hoisted_15","_hoisted_16","_cache","_ctx","$data","args","_hoisted_17","_createBlock","_sfc_main$1","n","_pushScopeId","_popScopeId","_sfc_render","$setup","_withDirectives","_sfc_main","UploadJson","CataloguesDetail","ImportFromGithub","CataloguesCreate","SelectFile","IconContainer","SplitView","useSettingsStore","id","found","failed","sys","cat","message","showMessageBox","closeWindow","gst","res","systemId","gameSystem","generateBattlescribeId","gstPath","system","copy","systemPath","dirname","db","catalogue","files","systems","dbId","catalogues","_component_SelectFile","_createVNode","_component_UploadJson","_component_ImportFromGithub","_component_CreateSystem","_component_SplitView","_withCtx","_b","_component_IconContainer","_component_CataloguesCreate","_component_CataloguesDetail","_Teleport"],"mappings":"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"}